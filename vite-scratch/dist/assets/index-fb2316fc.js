var E_=Object.defineProperty;var w_=(t,e,n)=>e in t?E_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var oo=(t,e,n)=>(w_(t,typeof e!="symbol"?e+"":e,n),n);function T_(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var cM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function S_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var na={},b_={get exports(){return na},set exports(t){na=t}},Ga={},O={},A_={get exports(){return O},set exports(t){O=t}},W={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ns=Symbol.for("react.element"),P_=Symbol.for("react.portal"),x_=Symbol.for("react.fragment"),L_=Symbol.for("react.strict_mode"),C_=Symbol.for("react.profiler"),R_=Symbol.for("react.provider"),M_=Symbol.for("react.context"),I_=Symbol.for("react.forward_ref"),O_=Symbol.for("react.suspense"),k_=Symbol.for("react.memo"),N_=Symbol.for("react.lazy"),Vh=Symbol.iterator;function D_(t){return t===null||typeof t!="object"?null:(t=Vh&&t[Vh]||t["@@iterator"],typeof t=="function"?t:null)}var Zg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Kg=Object.assign,Qg={};function _i(t,e,n){this.props=t,this.context=e,this.refs=Qg,this.updater=n||Zg}_i.prototype.isReactComponent={};_i.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};_i.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Jg(){}Jg.prototype=_i.prototype;function ef(t,e,n){this.props=t,this.context=e,this.refs=Qg,this.updater=n||Zg}var tf=ef.prototype=new Jg;tf.constructor=ef;Kg(tf,_i.prototype);tf.isPureReactComponent=!0;var jh=Array.isArray,em=Object.prototype.hasOwnProperty,nf={current:null},tm={key:!0,ref:!0,__self:!0,__source:!0};function nm(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)em.call(e,r)&&!tm.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Ns,type:t,key:s,ref:o,props:i,_owner:nf.current}}function F_(t,e){return{$$typeof:Ns,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function rf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ns}function U_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Gh=/\/+/g;function bl(t,e){return typeof t=="object"&&t!==null&&t.key!=null?U_(""+t.key):e.toString(36)}function Fo(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ns:case P_:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+bl(o,0):r,jh(i)?(n="",t!=null&&(n=t.replace(Gh,"$&/")+"/"),Fo(i,e,n,"",function(u){return u})):i!=null&&(rf(i)&&(i=F_(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Gh,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",jh(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+bl(s,a);o+=Fo(s,e,n,l,i)}else if(l=D_(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+bl(s,a++),o+=Fo(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ao(t,e,n){if(t==null)return t;var r=[],i=0;return Fo(t,r,"","",function(s){return e.call(n,s,i++)}),r}function B_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var je={current:null},Uo={transition:null},z_={ReactCurrentDispatcher:je,ReactCurrentBatchConfig:Uo,ReactCurrentOwner:nf};W.Children={map:ao,forEach:function(t,e,n){ao(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ao(t,function(){e++}),e},toArray:function(t){return ao(t,function(e){return e})||[]},only:function(t){if(!rf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};W.Component=_i;W.Fragment=x_;W.Profiler=C_;W.PureComponent=ef;W.StrictMode=L_;W.Suspense=O_;W.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z_;W.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Kg({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=nf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)em.call(e,l)&&!tm.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Ns,type:t.type,key:i,ref:s,props:r,_owner:o}};W.createContext=function(t){return t={$$typeof:M_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:R_,_context:t},t.Consumer=t};W.createElement=nm;W.createFactory=function(t){var e=nm.bind(null,t);return e.type=t,e};W.createRef=function(){return{current:null}};W.forwardRef=function(t){return{$$typeof:I_,render:t}};W.isValidElement=rf;W.lazy=function(t){return{$$typeof:N_,_payload:{_status:-1,_result:t},_init:B_}};W.memo=function(t,e){return{$$typeof:k_,type:t,compare:e===void 0?null:e}};W.startTransition=function(t){var e=Uo.transition;Uo.transition={};try{t()}finally{Uo.transition=e}};W.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};W.useCallback=function(t,e){return je.current.useCallback(t,e)};W.useContext=function(t){return je.current.useContext(t)};W.useDebugValue=function(){};W.useDeferredValue=function(t){return je.current.useDeferredValue(t)};W.useEffect=function(t,e){return je.current.useEffect(t,e)};W.useId=function(){return je.current.useId()};W.useImperativeHandle=function(t,e,n){return je.current.useImperativeHandle(t,e,n)};W.useInsertionEffect=function(t,e){return je.current.useInsertionEffect(t,e)};W.useLayoutEffect=function(t,e){return je.current.useLayoutEffect(t,e)};W.useMemo=function(t,e){return je.current.useMemo(t,e)};W.useReducer=function(t,e,n){return je.current.useReducer(t,e,n)};W.useRef=function(t){return je.current.useRef(t)};W.useState=function(t){return je.current.useState(t)};W.useSyncExternalStore=function(t,e,n){return je.current.useSyncExternalStore(t,e,n)};W.useTransition=function(){return je.current.useTransition()};W.version="18.2.0";(function(t){t.exports=W})(A_);const V_=S_(O);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j_=O,G_=Symbol.for("react.element"),H_=Symbol.for("react.fragment"),W_=Object.prototype.hasOwnProperty,Y_=j_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,X_={key:!0,ref:!0,__self:!0,__source:!0};function rm(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)W_.call(e,r)&&!X_.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:G_,type:t,key:s,ref:o,props:i,_owner:Y_.current}}Ga.Fragment=H_;Ga.jsx=rm;Ga.jsxs=rm;(function(t){t.exports=Ga})(b_);const ra=na.jsx,$_=na.jsxs;var Cu={},hs={},q_={get exports(){return hs},set exports(t){hs=t}},at={},Ru={},Z_={get exports(){return Ru},set exports(t){Ru=t}},im={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,V){var j=F.length;F.push(V);e:for(;0<j;){var le=j-1>>>1,se=F[le];if(0<i(se,V))F[le]=V,F[j]=se,j=le;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var V=F[0],j=F.pop();if(j!==V){F[0]=j;e:for(var le=0,se=F.length,Tr=se>>>1;le<Tr;){var _t=2*(le+1)-1,Pi=F[_t],$t=_t+1,ge=F[$t];if(0>i(Pi,j))$t<se&&0>i(ge,Pi)?(F[le]=ge,F[$t]=j,le=$t):(F[le]=Pi,F[_t]=j,le=_t);else if($t<se&&0>i(ge,j))F[le]=ge,F[$t]=j,le=$t;else break e}}return V}function i(F,V){var j=F.sortIndex-V.sortIndex;return j!==0?j:F.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,f=null,h=3,m=!1,E=!1,w=!1,b=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(F){for(var V=n(u);V!==null;){if(V.callback===null)r(u);else if(V.startTime<=F)r(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(u)}}function S(F){if(w=!1,_(F),!E)if(n(l)!==null)E=!0,Ai(P);else{var V=n(u);V!==null&&wr(S,V.startTime-F)}}function P(F,V){E=!1,w&&(w=!1,v(M),M=-1),m=!0;var j=h;try{for(_(V),f=n(l);f!==null&&(!(f.expirationTime>V)||F&&!z());){var le=f.callback;if(typeof le=="function"){f.callback=null,h=f.priorityLevel;var se=le(f.expirationTime<=V);V=t.unstable_now(),typeof se=="function"?f.callback=se:f===n(l)&&r(l),_(V)}else r(l);f=n(l)}if(f!==null)var Tr=!0;else{var _t=n(u);_t!==null&&wr(S,_t.startTime-V),Tr=!1}return Tr}finally{f=null,h=j,m=!1}}var x=!1,L=null,M=-1,k=5,I=-1;function z(){return!(t.unstable_now()-I<k)}function ee(){if(L!==null){var F=t.unstable_now();I=F;var V=!0;try{V=L(!0,F)}finally{V?ie():(x=!1,L=null)}}else x=!1}var ie;if(typeof g=="function")ie=function(){g(ee)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,Xt=Y.port2;Y.port1.onmessage=ee,ie=function(){Xt.postMessage(null)}}else ie=function(){b(ee,0)};function Ai(F){L=F,x||(x=!0,ie())}function wr(F,V){M=b(function(){F(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){E||m||(E=!0,Ai(P))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var j=h;h=V;try{return F()}finally{h=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,V){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var j=h;h=F;try{return V()}finally{h=j}},t.unstable_scheduleCallback=function(F,V,j){var le=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?le+j:le):j=le,F){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=j+se,F={id:c++,callback:V,priorityLevel:F,startTime:j,expirationTime:se,sortIndex:-1},j>le?(F.sortIndex=j,e(u,F),n(l)===null&&F===n(u)&&(w?(v(M),M=-1):w=!0,wr(S,j-le))):(F.sortIndex=se,e(l,F),E||m||(E=!0,Ai(P))),F},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(F){var V=h;return function(){var j=h;h=V;try{return F.apply(this,arguments)}finally{h=j}}}})(im);(function(t){t.exports=im})(Z_);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sm=O,ot=Ru;function R(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var om=new Set,ds={};function yr(t,e){ei(t,e),ei(t+"Capture",e)}function ei(t,e){for(ds[t]=e,t=0;t<e.length;t++)om.add(e[t])}var on=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mu=Object.prototype.hasOwnProperty,K_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Hh={},Wh={};function Q_(t){return Mu.call(Wh,t)?!0:Mu.call(Hh,t)?!1:K_.test(t)?Wh[t]=!0:(Hh[t]=!0,!1)}function J_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function e1(t,e,n,r){if(e===null||typeof e>"u"||J_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ge(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Re={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Re[t]=new Ge(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Re[e]=new Ge(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Re[t]=new Ge(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Re[t]=new Ge(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Re[t]=new Ge(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Re[t]=new Ge(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Re[t]=new Ge(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Re[t]=new Ge(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Re[t]=new Ge(t,5,!1,t.toLowerCase(),null,!1,!1)});var sf=/[\-:]([a-z])/g;function of(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(sf,of);Re[e]=new Ge(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(sf,of);Re[e]=new Ge(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(sf,of);Re[e]=new Ge(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Re[t]=new Ge(t,1,!1,t.toLowerCase(),null,!1,!1)});Re.xlinkHref=new Ge("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Re[t]=new Ge(t,1,!1,t.toLowerCase(),null,!0,!0)});function af(t,e,n,r){var i=Re.hasOwnProperty(e)?Re[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(e1(e,n,i,r)&&(n=null),r||i===null?Q_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var dn=sm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,lo=Symbol.for("react.element"),Ir=Symbol.for("react.portal"),Or=Symbol.for("react.fragment"),lf=Symbol.for("react.strict_mode"),Iu=Symbol.for("react.profiler"),am=Symbol.for("react.provider"),lm=Symbol.for("react.context"),uf=Symbol.for("react.forward_ref"),Ou=Symbol.for("react.suspense"),ku=Symbol.for("react.suspense_list"),cf=Symbol.for("react.memo"),Sn=Symbol.for("react.lazy"),um=Symbol.for("react.offscreen"),Yh=Symbol.iterator;function ki(t){return t===null||typeof t!="object"?null:(t=Yh&&t[Yh]||t["@@iterator"],typeof t=="function"?t:null)}var fe=Object.assign,Al;function $i(t){if(Al===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Al=e&&e[1]||""}return`
`+Al+t}var Pl=!1;function xl(t,e){if(!t||Pl)return"";Pl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Pl=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?$i(t):""}function t1(t){switch(t.tag){case 5:return $i(t.type);case 16:return $i("Lazy");case 13:return $i("Suspense");case 19:return $i("SuspenseList");case 0:case 2:case 15:return t=xl(t.type,!1),t;case 11:return t=xl(t.type.render,!1),t;case 1:return t=xl(t.type,!0),t;default:return""}}function Nu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Or:return"Fragment";case Ir:return"Portal";case Iu:return"Profiler";case lf:return"StrictMode";case Ou:return"Suspense";case ku:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case lm:return(t.displayName||"Context")+".Consumer";case am:return(t._context.displayName||"Context")+".Provider";case uf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cf:return e=t.displayName||null,e!==null?e:Nu(t.type)||"Memo";case Sn:e=t._payload,t=t._init;try{return Nu(t(e))}catch{}}return null}function n1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Nu(e);case 8:return e===lf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function cm(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function r1(t){var e=cm(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function uo(t){t._valueTracker||(t._valueTracker=r1(t))}function fm(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=cm(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ia(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Du(t,e){var n=e.checked;return fe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Xh(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Vn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hm(t,e){e=e.checked,e!=null&&af(t,"checked",e,!1)}function Fu(t,e){hm(t,e);var n=Vn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Uu(t,e.type,n):e.hasOwnProperty("defaultValue")&&Uu(t,e.type,Vn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function $h(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Uu(t,e,n){(e!=="number"||ia(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var qi=Array.isArray;function Yr(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Vn(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Bu(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(R(91));return fe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function qh(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(R(92));if(qi(n)){if(1<n.length)throw Error(R(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Vn(n)}}function dm(t,e){var n=Vn(e.value),r=Vn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Zh(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function pm(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?pm(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var co,gm=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(co=co||document.createElement("div"),co.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=co.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ps(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var es={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},i1=["Webkit","ms","Moz","O"];Object.keys(es).forEach(function(t){i1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),es[e]=es[t]})});function mm(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||es.hasOwnProperty(t)&&es[t]?(""+e).trim():e+"px"}function ym(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=mm(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var s1=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vu(t,e){if(e){if(s1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(R(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(R(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(R(61))}if(e.style!=null&&typeof e.style!="object")throw Error(R(62))}}function ju(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gu=null;function ff(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hu=null,Xr=null,$r=null;function Kh(t){if(t=Us(t)){if(typeof Hu!="function")throw Error(R(280));var e=t.stateNode;e&&(e=$a(e),Hu(t.stateNode,t.type,e))}}function vm(t){Xr?$r?$r.push(t):$r=[t]:Xr=t}function _m(){if(Xr){var t=Xr,e=$r;if($r=Xr=null,Kh(t),e)for(t=0;t<e.length;t++)Kh(e[t])}}function Em(t,e){return t(e)}function wm(){}var Ll=!1;function Tm(t,e,n){if(Ll)return t(e,n);Ll=!0;try{return Em(t,e,n)}finally{Ll=!1,(Xr!==null||$r!==null)&&(wm(),_m())}}function gs(t,e){var n=t.stateNode;if(n===null)return null;var r=$a(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(R(231,e,typeof n));return n}var Wu=!1;if(on)try{var Ni={};Object.defineProperty(Ni,"passive",{get:function(){Wu=!0}}),window.addEventListener("test",Ni,Ni),window.removeEventListener("test",Ni,Ni)}catch{Wu=!1}function o1(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var ts=!1,sa=null,oa=!1,Yu=null,a1={onError:function(t){ts=!0,sa=t}};function l1(t,e,n,r,i,s,o,a,l){ts=!1,sa=null,o1.apply(a1,arguments)}function u1(t,e,n,r,i,s,o,a,l){if(l1.apply(this,arguments),ts){if(ts){var u=sa;ts=!1,sa=null}else throw Error(R(198));oa||(oa=!0,Yu=u)}}function vr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Sm(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Qh(t){if(vr(t)!==t)throw Error(R(188))}function c1(t){var e=t.alternate;if(!e){if(e=vr(t),e===null)throw Error(R(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Qh(i),t;if(s===r)return Qh(i),e;s=s.sibling}throw Error(R(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(R(189))}}if(n.alternate!==r)throw Error(R(190))}if(n.tag!==3)throw Error(R(188));return n.stateNode.current===n?t:e}function bm(t){return t=c1(t),t!==null?Am(t):null}function Am(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Am(t);if(e!==null)return e;t=t.sibling}return null}var Pm=ot.unstable_scheduleCallback,Jh=ot.unstable_cancelCallback,f1=ot.unstable_shouldYield,h1=ot.unstable_requestPaint,pe=ot.unstable_now,d1=ot.unstable_getCurrentPriorityLevel,hf=ot.unstable_ImmediatePriority,xm=ot.unstable_UserBlockingPriority,aa=ot.unstable_NormalPriority,p1=ot.unstable_LowPriority,Lm=ot.unstable_IdlePriority,Ha=null,Gt=null;function g1(t){if(Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(Ha,t,void 0,(t.current.flags&128)===128)}catch{}}var Pt=Math.clz32?Math.clz32:v1,m1=Math.log,y1=Math.LN2;function v1(t){return t>>>=0,t===0?32:31-(m1(t)/y1|0)|0}var fo=64,ho=4194304;function Zi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function la(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Zi(a):(s&=o,s!==0&&(r=Zi(s)))}else o=n&~i,o!==0?r=Zi(o):s!==0&&(r=Zi(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Pt(e),i=1<<n,r|=t[n],e&=~i;return r}function _1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function E1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Pt(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=_1(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Xu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Cm(){var t=fo;return fo<<=1,!(fo&4194240)&&(fo=64),t}function Cl(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ds(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pt(e),t[e]=n}function w1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Pt(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function df(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Pt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var q=0;function Rm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Mm,pf,Im,Om,km,$u=!1,po=[],In=null,On=null,kn=null,ms=new Map,ys=new Map,An=[],T1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ed(t,e){switch(t){case"focusin":case"focusout":In=null;break;case"dragenter":case"dragleave":On=null;break;case"mouseover":case"mouseout":kn=null;break;case"pointerover":case"pointerout":ms.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ys.delete(e.pointerId)}}function Di(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Us(e),e!==null&&pf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function S1(t,e,n,r,i){switch(e){case"focusin":return In=Di(In,t,e,n,r,i),!0;case"dragenter":return On=Di(On,t,e,n,r,i),!0;case"mouseover":return kn=Di(kn,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return ms.set(s,Di(ms.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ys.set(s,Di(ys.get(s)||null,t,e,n,r,i)),!0}return!1}function Nm(t){var e=nr(t.target);if(e!==null){var n=vr(e);if(n!==null){if(e=n.tag,e===13){if(e=Sm(n),e!==null){t.blockedOn=e,km(t.priority,function(){Im(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Bo(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=qu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Gu=r,n.target.dispatchEvent(r),Gu=null}else return e=Us(n),e!==null&&pf(e),t.blockedOn=n,!1;e.shift()}return!0}function td(t,e,n){Bo(t)&&n.delete(e)}function b1(){$u=!1,In!==null&&Bo(In)&&(In=null),On!==null&&Bo(On)&&(On=null),kn!==null&&Bo(kn)&&(kn=null),ms.forEach(td),ys.forEach(td)}function Fi(t,e){t.blockedOn===e&&(t.blockedOn=null,$u||($u=!0,ot.unstable_scheduleCallback(ot.unstable_NormalPriority,b1)))}function vs(t){function e(i){return Fi(i,t)}if(0<po.length){Fi(po[0],t);for(var n=1;n<po.length;n++){var r=po[n];r.blockedOn===t&&(r.blockedOn=null)}}for(In!==null&&Fi(In,t),On!==null&&Fi(On,t),kn!==null&&Fi(kn,t),ms.forEach(e),ys.forEach(e),n=0;n<An.length;n++)r=An[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<An.length&&(n=An[0],n.blockedOn===null);)Nm(n),n.blockedOn===null&&An.shift()}var qr=dn.ReactCurrentBatchConfig,ua=!0;function A1(t,e,n,r){var i=q,s=qr.transition;qr.transition=null;try{q=1,gf(t,e,n,r)}finally{q=i,qr.transition=s}}function P1(t,e,n,r){var i=q,s=qr.transition;qr.transition=null;try{q=4,gf(t,e,n,r)}finally{q=i,qr.transition=s}}function gf(t,e,n,r){if(ua){var i=qu(t,e,n,r);if(i===null)Bl(t,e,r,ca,n),ed(t,r);else if(S1(i,t,e,n,r))r.stopPropagation();else if(ed(t,r),e&4&&-1<T1.indexOf(t)){for(;i!==null;){var s=Us(i);if(s!==null&&Mm(s),s=qu(t,e,n,r),s===null&&Bl(t,e,r,ca,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Bl(t,e,r,null,n)}}var ca=null;function qu(t,e,n,r){if(ca=null,t=ff(r),t=nr(t),t!==null)if(e=vr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Sm(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ca=t,null}function Dm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(d1()){case hf:return 1;case xm:return 4;case aa:case p1:return 16;case Lm:return 536870912;default:return 16}default:return 16}}var Ln=null,mf=null,zo=null;function Fm(){if(zo)return zo;var t,e=mf,n=e.length,r,i="value"in Ln?Ln.value:Ln.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return zo=i.slice(t,1<r?1-r:void 0)}function Vo(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function go(){return!0}function nd(){return!1}function lt(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?go:nd,this.isPropagationStopped=nd,this}return fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=go)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=go)},persist:function(){},isPersistent:go}),e}var Ei={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yf=lt(Ei),Fs=fe({},Ei,{view:0,detail:0}),x1=lt(Fs),Rl,Ml,Ui,Wa=fe({},Fs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ui&&(Ui&&t.type==="mousemove"?(Rl=t.screenX-Ui.screenX,Ml=t.screenY-Ui.screenY):Ml=Rl=0,Ui=t),Rl)},movementY:function(t){return"movementY"in t?t.movementY:Ml}}),rd=lt(Wa),L1=fe({},Wa,{dataTransfer:0}),C1=lt(L1),R1=fe({},Fs,{relatedTarget:0}),Il=lt(R1),M1=fe({},Ei,{animationName:0,elapsedTime:0,pseudoElement:0}),I1=lt(M1),O1=fe({},Ei,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),k1=lt(O1),N1=fe({},Ei,{data:0}),id=lt(N1),D1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},F1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},U1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function B1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=U1[t])?!!e[t]:!1}function vf(){return B1}var z1=fe({},Fs,{key:function(t){if(t.key){var e=D1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Vo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?F1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vf,charCode:function(t){return t.type==="keypress"?Vo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Vo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),V1=lt(z1),j1=fe({},Wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sd=lt(j1),G1=fe({},Fs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vf}),H1=lt(G1),W1=fe({},Ei,{propertyName:0,elapsedTime:0,pseudoElement:0}),Y1=lt(W1),X1=fe({},Wa,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),$1=lt(X1),q1=[9,13,27,32],_f=on&&"CompositionEvent"in window,ns=null;on&&"documentMode"in document&&(ns=document.documentMode);var Z1=on&&"TextEvent"in window&&!ns,Um=on&&(!_f||ns&&8<ns&&11>=ns),od=String.fromCharCode(32),ad=!1;function Bm(t,e){switch(t){case"keyup":return q1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var kr=!1;function K1(t,e){switch(t){case"compositionend":return zm(e);case"keypress":return e.which!==32?null:(ad=!0,od);case"textInput":return t=e.data,t===od&&ad?null:t;default:return null}}function Q1(t,e){if(kr)return t==="compositionend"||!_f&&Bm(t,e)?(t=Fm(),zo=mf=Ln=null,kr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Um&&e.locale!=="ko"?null:e.data;default:return null}}var J1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ld(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!J1[t.type]:e==="textarea"}function Vm(t,e,n,r){vm(r),e=fa(e,"onChange"),0<e.length&&(n=new yf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var rs=null,_s=null;function eE(t){Qm(t,0)}function Ya(t){var e=Fr(t);if(fm(e))return t}function tE(t,e){if(t==="change")return e}var jm=!1;if(on){var Ol;if(on){var kl="oninput"in document;if(!kl){var ud=document.createElement("div");ud.setAttribute("oninput","return;"),kl=typeof ud.oninput=="function"}Ol=kl}else Ol=!1;jm=Ol&&(!document.documentMode||9<document.documentMode)}function cd(){rs&&(rs.detachEvent("onpropertychange",Gm),_s=rs=null)}function Gm(t){if(t.propertyName==="value"&&Ya(_s)){var e=[];Vm(e,_s,t,ff(t)),Tm(eE,e)}}function nE(t,e,n){t==="focusin"?(cd(),rs=e,_s=n,rs.attachEvent("onpropertychange",Gm)):t==="focusout"&&cd()}function rE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ya(_s)}function iE(t,e){if(t==="click")return Ya(e)}function sE(t,e){if(t==="input"||t==="change")return Ya(e)}function oE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ct=typeof Object.is=="function"?Object.is:oE;function Es(t,e){if(Ct(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Mu.call(e,i)||!Ct(t[i],e[i]))return!1}return!0}function fd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hd(t,e){var n=fd(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=fd(n)}}function Hm(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Hm(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Wm(){for(var t=window,e=ia();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ia(t.document)}return e}function Ef(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function aE(t){var e=Wm(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Hm(n.ownerDocument.documentElement,n)){if(r!==null&&Ef(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=hd(n,s);var o=hd(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var lE=on&&"documentMode"in document&&11>=document.documentMode,Nr=null,Zu=null,is=null,Ku=!1;function dd(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ku||Nr==null||Nr!==ia(r)||(r=Nr,"selectionStart"in r&&Ef(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),is&&Es(is,r)||(is=r,r=fa(Zu,"onSelect"),0<r.length&&(e=new yf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Nr)))}function mo(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Dr={animationend:mo("Animation","AnimationEnd"),animationiteration:mo("Animation","AnimationIteration"),animationstart:mo("Animation","AnimationStart"),transitionend:mo("Transition","TransitionEnd")},Nl={},Ym={};on&&(Ym=document.createElement("div").style,"AnimationEvent"in window||(delete Dr.animationend.animation,delete Dr.animationiteration.animation,delete Dr.animationstart.animation),"TransitionEvent"in window||delete Dr.transitionend.transition);function Xa(t){if(Nl[t])return Nl[t];if(!Dr[t])return t;var e=Dr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Ym)return Nl[t]=e[n];return t}var Xm=Xa("animationend"),$m=Xa("animationiteration"),qm=Xa("animationstart"),Zm=Xa("transitionend"),Km=new Map,pd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hn(t,e){Km.set(t,e),yr(e,[t])}for(var Dl=0;Dl<pd.length;Dl++){var Fl=pd[Dl],uE=Fl.toLowerCase(),cE=Fl[0].toUpperCase()+Fl.slice(1);Hn(uE,"on"+cE)}Hn(Xm,"onAnimationEnd");Hn($m,"onAnimationIteration");Hn(qm,"onAnimationStart");Hn("dblclick","onDoubleClick");Hn("focusin","onFocus");Hn("focusout","onBlur");Hn(Zm,"onTransitionEnd");ei("onMouseEnter",["mouseout","mouseover"]);ei("onMouseLeave",["mouseout","mouseover"]);ei("onPointerEnter",["pointerout","pointerover"]);ei("onPointerLeave",["pointerout","pointerover"]);yr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yr("onBeforeInput",["compositionend","keypress","textInput","paste"]);yr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ki="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ki));function gd(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,u1(r,e,void 0,t),t.currentTarget=null}function Qm(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;gd(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;gd(i,a,u),s=l}}}if(oa)throw t=Yu,oa=!1,Yu=null,t}function ne(t,e){var n=e[nc];n===void 0&&(n=e[nc]=new Set);var r=t+"__bubble";n.has(r)||(Jm(e,t,2,!1),n.add(r))}function Ul(t,e,n){var r=0;e&&(r|=4),Jm(n,t,r,e)}var yo="_reactListening"+Math.random().toString(36).slice(2);function ws(t){if(!t[yo]){t[yo]=!0,om.forEach(function(n){n!=="selectionchange"&&(fE.has(n)||Ul(n,!1,t),Ul(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[yo]||(e[yo]=!0,Ul("selectionchange",!1,e))}}function Jm(t,e,n,r){switch(Dm(e)){case 1:var i=A1;break;case 4:i=P1;break;default:i=gf}n=i.bind(null,e,n,t),i=void 0,!Wu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Bl(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=nr(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Tm(function(){var u=s,c=ff(n),f=[];e:{var h=Km.get(t);if(h!==void 0){var m=yf,E=t;switch(t){case"keypress":if(Vo(n)===0)break e;case"keydown":case"keyup":m=V1;break;case"focusin":E="focus",m=Il;break;case"focusout":E="blur",m=Il;break;case"beforeblur":case"afterblur":m=Il;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=rd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=C1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=H1;break;case Xm:case $m:case qm:m=I1;break;case Zm:m=Y1;break;case"scroll":m=x1;break;case"wheel":m=$1;break;case"copy":case"cut":case"paste":m=k1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=sd}var w=(e&4)!==0,b=!w&&t==="scroll",v=w?h!==null?h+"Capture":null:h;w=[];for(var g=u,_;g!==null;){_=g;var S=_.stateNode;if(_.tag===5&&S!==null&&(_=S,v!==null&&(S=gs(g,v),S!=null&&w.push(Ts(g,S,_)))),b)break;g=g.return}0<w.length&&(h=new m(h,E,null,n,c),f.push({event:h,listeners:w}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&n!==Gu&&(E=n.relatedTarget||n.fromElement)&&(nr(E)||E[an]))break e;if((m||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,m?(E=n.relatedTarget||n.toElement,m=u,E=E?nr(E):null,E!==null&&(b=vr(E),E!==b||E.tag!==5&&E.tag!==6)&&(E=null)):(m=null,E=u),m!==E)){if(w=rd,S="onMouseLeave",v="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(w=sd,S="onPointerLeave",v="onPointerEnter",g="pointer"),b=m==null?h:Fr(m),_=E==null?h:Fr(E),h=new w(S,g+"leave",m,n,c),h.target=b,h.relatedTarget=_,S=null,nr(c)===u&&(w=new w(v,g+"enter",E,n,c),w.target=_,w.relatedTarget=b,S=w),b=S,m&&E)t:{for(w=m,v=E,g=0,_=w;_;_=br(_))g++;for(_=0,S=v;S;S=br(S))_++;for(;0<g-_;)w=br(w),g--;for(;0<_-g;)v=br(v),_--;for(;g--;){if(w===v||v!==null&&w===v.alternate)break t;w=br(w),v=br(v)}w=null}else w=null;m!==null&&md(f,h,m,w,!1),E!==null&&b!==null&&md(f,b,E,w,!0)}}e:{if(h=u?Fr(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var P=tE;else if(ld(h))if(jm)P=sE;else{P=rE;var x=nE}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(P=iE);if(P&&(P=P(t,u))){Vm(f,P,n,c);break e}x&&x(t,h,u),t==="focusout"&&(x=h._wrapperState)&&x.controlled&&h.type==="number"&&Uu(h,"number",h.value)}switch(x=u?Fr(u):window,t){case"focusin":(ld(x)||x.contentEditable==="true")&&(Nr=x,Zu=u,is=null);break;case"focusout":is=Zu=Nr=null;break;case"mousedown":Ku=!0;break;case"contextmenu":case"mouseup":case"dragend":Ku=!1,dd(f,n,c);break;case"selectionchange":if(lE)break;case"keydown":case"keyup":dd(f,n,c)}var L;if(_f)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else kr?Bm(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(Um&&n.locale!=="ko"&&(kr||M!=="onCompositionStart"?M==="onCompositionEnd"&&kr&&(L=Fm()):(Ln=c,mf="value"in Ln?Ln.value:Ln.textContent,kr=!0)),x=fa(u,M),0<x.length&&(M=new id(M,t,null,n,c),f.push({event:M,listeners:x}),L?M.data=L:(L=zm(n),L!==null&&(M.data=L)))),(L=Z1?K1(t,n):Q1(t,n))&&(u=fa(u,"onBeforeInput"),0<u.length&&(c=new id("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:u}),c.data=L))}Qm(f,e)})}function Ts(t,e,n){return{instance:t,listener:e,currentTarget:n}}function fa(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=gs(t,n),s!=null&&r.unshift(Ts(t,s,i)),s=gs(t,e),s!=null&&r.push(Ts(t,s,i))),t=t.return}return r}function br(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function md(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=gs(n,s),l!=null&&o.unshift(Ts(n,l,a))):i||(l=gs(n,s),l!=null&&o.push(Ts(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var hE=/\r\n?/g,dE=/\u0000|\uFFFD/g;function yd(t){return(typeof t=="string"?t:""+t).replace(hE,`
`).replace(dE,"")}function vo(t,e,n){if(e=yd(e),yd(t)!==e&&n)throw Error(R(425))}function ha(){}var Qu=null,Ju=null;function ec(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var tc=typeof setTimeout=="function"?setTimeout:void 0,pE=typeof clearTimeout=="function"?clearTimeout:void 0,vd=typeof Promise=="function"?Promise:void 0,gE=typeof queueMicrotask=="function"?queueMicrotask:typeof vd<"u"?function(t){return vd.resolve(null).then(t).catch(mE)}:tc;function mE(t){setTimeout(function(){throw t})}function zl(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),vs(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);vs(e)}function Nn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function _d(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var wi=Math.random().toString(36).slice(2),Bt="__reactFiber$"+wi,Ss="__reactProps$"+wi,an="__reactContainer$"+wi,nc="__reactEvents$"+wi,yE="__reactListeners$"+wi,vE="__reactHandles$"+wi;function nr(t){var e=t[Bt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[an]||n[Bt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=_d(t);t!==null;){if(n=t[Bt])return n;t=_d(t)}return e}t=n,n=t.parentNode}return null}function Us(t){return t=t[Bt]||t[an],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Fr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(R(33))}function $a(t){return t[Ss]||null}var rc=[],Ur=-1;function Wn(t){return{current:t}}function re(t){0>Ur||(t.current=rc[Ur],rc[Ur]=null,Ur--)}function J(t,e){Ur++,rc[Ur]=t.current,t.current=e}var jn={},Ne=Wn(jn),Xe=Wn(!1),cr=jn;function ti(t,e){var n=t.type.contextTypes;if(!n)return jn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function $e(t){return t=t.childContextTypes,t!=null}function da(){re(Xe),re(Ne)}function Ed(t,e,n){if(Ne.current!==jn)throw Error(R(168));J(Ne,e),J(Xe,n)}function e0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(R(108,n1(t)||"Unknown",i));return fe({},n,r)}function pa(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||jn,cr=Ne.current,J(Ne,t),J(Xe,Xe.current),!0}function wd(t,e,n){var r=t.stateNode;if(!r)throw Error(R(169));n?(t=e0(t,e,cr),r.__reactInternalMemoizedMergedChildContext=t,re(Xe),re(Ne),J(Ne,t)):re(Xe),J(Xe,n)}var en=null,qa=!1,Vl=!1;function t0(t){en===null?en=[t]:en.push(t)}function _E(t){qa=!0,t0(t)}function Yn(){if(!Vl&&en!==null){Vl=!0;var t=0,e=q;try{var n=en;for(q=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}en=null,qa=!1}catch(i){throw en!==null&&(en=en.slice(t+1)),Pm(hf,Yn),i}finally{q=e,Vl=!1}}return null}var Br=[],zr=0,ga=null,ma=0,ht=[],dt=0,fr=null,nn=1,rn="";function Jn(t,e){Br[zr++]=ma,Br[zr++]=ga,ga=t,ma=e}function n0(t,e,n){ht[dt++]=nn,ht[dt++]=rn,ht[dt++]=fr,fr=t;var r=nn;t=rn;var i=32-Pt(r)-1;r&=~(1<<i),n+=1;var s=32-Pt(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,nn=1<<32-Pt(e)+i|n<<i|r,rn=s+t}else nn=1<<s|n<<i|r,rn=t}function wf(t){t.return!==null&&(Jn(t,1),n0(t,1,0))}function Tf(t){for(;t===ga;)ga=Br[--zr],Br[zr]=null,ma=Br[--zr],Br[zr]=null;for(;t===fr;)fr=ht[--dt],ht[dt]=null,rn=ht[--dt],ht[dt]=null,nn=ht[--dt],ht[dt]=null}var it=null,nt=null,ae=!1,bt=null;function r0(t,e){var n=pt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Td(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,it=t,nt=Nn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,it=t,nt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=fr!==null?{id:nn,overflow:rn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=pt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,it=t,nt=null,!0):!1;default:return!1}}function ic(t){return(t.mode&1)!==0&&(t.flags&128)===0}function sc(t){if(ae){var e=nt;if(e){var n=e;if(!Td(t,e)){if(ic(t))throw Error(R(418));e=Nn(n.nextSibling);var r=it;e&&Td(t,e)?r0(r,n):(t.flags=t.flags&-4097|2,ae=!1,it=t)}}else{if(ic(t))throw Error(R(418));t.flags=t.flags&-4097|2,ae=!1,it=t}}}function Sd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;it=t}function _o(t){if(t!==it)return!1;if(!ae)return Sd(t),ae=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ec(t.type,t.memoizedProps)),e&&(e=nt)){if(ic(t))throw i0(),Error(R(418));for(;e;)r0(t,e),e=Nn(e.nextSibling)}if(Sd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(R(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){nt=Nn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}nt=null}}else nt=it?Nn(t.stateNode.nextSibling):null;return!0}function i0(){for(var t=nt;t;)t=Nn(t.nextSibling)}function ni(){nt=it=null,ae=!1}function Sf(t){bt===null?bt=[t]:bt.push(t)}var EE=dn.ReactCurrentBatchConfig;function Tt(t,e){if(t&&t.defaultProps){e=fe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var ya=Wn(null),va=null,Vr=null,bf=null;function Af(){bf=Vr=va=null}function Pf(t){var e=ya.current;re(ya),t._currentValue=e}function oc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Zr(t,e){va=t,bf=Vr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ye=!0),t.firstContext=null)}function yt(t){var e=t._currentValue;if(bf!==t)if(t={context:t,memoizedValue:e,next:null},Vr===null){if(va===null)throw Error(R(308));Vr=t,va.dependencies={lanes:0,firstContext:t}}else Vr=Vr.next=t;return e}var rr=null;function xf(t){rr===null?rr=[t]:rr.push(t)}function s0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,xf(e)):(n.next=i.next,i.next=n),e.interleaved=n,ln(t,r)}function ln(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var bn=!1;function Lf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function o0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function sn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Dn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,X&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ln(t,n)}return i=r.interleaved,i===null?(e.next=e,xf(r)):(e.next=i.next,i.next=e),r.interleaved=e,ln(t,n)}function jo(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,df(t,n)}}function bd(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function _a(t,e,n,r){var i=t.updateQueue;bn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,c=u=l=null,a=s;do{var h=a.lane,m=a.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,w=a;switch(h=e,m=n,w.tag){case 1:if(E=w.payload,typeof E=="function"){f=E.call(m,f,h);break e}f=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=w.payload,h=typeof E=="function"?E.call(m,f,h):E,h==null)break e;f=fe({},f,h);break e;case 2:bn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else m={eventTime:m,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=m,l=f):c=c.next=m,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(c===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);dr|=o,t.lanes=o,t.memoizedState=f}}function Ad(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(R(191,i));i.call(r)}}}var a0=new sm.Component().refs;function ac(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:fe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Za={isMounted:function(t){return(t=t._reactInternals)?vr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ve(),i=Un(t),s=sn(r,i);s.payload=e,n!=null&&(s.callback=n),e=Dn(t,s,i),e!==null&&(xt(e,t,i,r),jo(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ve(),i=Un(t),s=sn(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Dn(t,s,i),e!==null&&(xt(e,t,i,r),jo(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ve(),r=Un(t),i=sn(n,r);i.tag=2,e!=null&&(i.callback=e),e=Dn(t,i,r),e!==null&&(xt(e,t,r,n),jo(e,t,r))}};function Pd(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Es(n,r)||!Es(i,s):!0}function l0(t,e,n){var r=!1,i=jn,s=e.contextType;return typeof s=="object"&&s!==null?s=yt(s):(i=$e(e)?cr:Ne.current,r=e.contextTypes,s=(r=r!=null)?ti(t,i):jn),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Za,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function xd(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Za.enqueueReplaceState(e,e.state,null)}function lc(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=a0,Lf(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=yt(s):(s=$e(e)?cr:Ne.current,i.context=ti(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ac(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Za.enqueueReplaceState(i,i.state,null),_a(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Bi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(R(309));var r=n.stateNode}if(!r)throw Error(R(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===a0&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(R(284));if(!n._owner)throw Error(R(290,t))}return t}function Eo(t,e){throw t=Object.prototype.toString.call(e),Error(R(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ld(t){var e=t._init;return e(t._payload)}function u0(t){function e(v,g){if(t){var _=v.deletions;_===null?(v.deletions=[g],v.flags|=16):_.push(g)}}function n(v,g){if(!t)return null;for(;g!==null;)e(v,g),g=g.sibling;return null}function r(v,g){for(v=new Map;g!==null;)g.key!==null?v.set(g.key,g):v.set(g.index,g),g=g.sibling;return v}function i(v,g){return v=Bn(v,g),v.index=0,v.sibling=null,v}function s(v,g,_){return v.index=_,t?(_=v.alternate,_!==null?(_=_.index,_<g?(v.flags|=2,g):_):(v.flags|=2,g)):(v.flags|=1048576,g)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,g,_,S){return g===null||g.tag!==6?(g=$l(_,v.mode,S),g.return=v,g):(g=i(g,_),g.return=v,g)}function l(v,g,_,S){var P=_.type;return P===Or?c(v,g,_.props.children,S,_.key):g!==null&&(g.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Sn&&Ld(P)===g.type)?(S=i(g,_.props),S.ref=Bi(v,g,_),S.return=v,S):(S=$o(_.type,_.key,_.props,null,v.mode,S),S.ref=Bi(v,g,_),S.return=v,S)}function u(v,g,_,S){return g===null||g.tag!==4||g.stateNode.containerInfo!==_.containerInfo||g.stateNode.implementation!==_.implementation?(g=ql(_,v.mode,S),g.return=v,g):(g=i(g,_.children||[]),g.return=v,g)}function c(v,g,_,S,P){return g===null||g.tag!==7?(g=ar(_,v.mode,S,P),g.return=v,g):(g=i(g,_),g.return=v,g)}function f(v,g,_){if(typeof g=="string"&&g!==""||typeof g=="number")return g=$l(""+g,v.mode,_),g.return=v,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case lo:return _=$o(g.type,g.key,g.props,null,v.mode,_),_.ref=Bi(v,null,g),_.return=v,_;case Ir:return g=ql(g,v.mode,_),g.return=v,g;case Sn:var S=g._init;return f(v,S(g._payload),_)}if(qi(g)||ki(g))return g=ar(g,v.mode,_,null),g.return=v,g;Eo(v,g)}return null}function h(v,g,_,S){var P=g!==null?g.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return P!==null?null:a(v,g,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case lo:return _.key===P?l(v,g,_,S):null;case Ir:return _.key===P?u(v,g,_,S):null;case Sn:return P=_._init,h(v,g,P(_._payload),S)}if(qi(_)||ki(_))return P!==null?null:c(v,g,_,S,null);Eo(v,_)}return null}function m(v,g,_,S,P){if(typeof S=="string"&&S!==""||typeof S=="number")return v=v.get(_)||null,a(g,v,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case lo:return v=v.get(S.key===null?_:S.key)||null,l(g,v,S,P);case Ir:return v=v.get(S.key===null?_:S.key)||null,u(g,v,S,P);case Sn:var x=S._init;return m(v,g,_,x(S._payload),P)}if(qi(S)||ki(S))return v=v.get(_)||null,c(g,v,S,P,null);Eo(g,S)}return null}function E(v,g,_,S){for(var P=null,x=null,L=g,M=g=0,k=null;L!==null&&M<_.length;M++){L.index>M?(k=L,L=null):k=L.sibling;var I=h(v,L,_[M],S);if(I===null){L===null&&(L=k);break}t&&L&&I.alternate===null&&e(v,L),g=s(I,g,M),x===null?P=I:x.sibling=I,x=I,L=k}if(M===_.length)return n(v,L),ae&&Jn(v,M),P;if(L===null){for(;M<_.length;M++)L=f(v,_[M],S),L!==null&&(g=s(L,g,M),x===null?P=L:x.sibling=L,x=L);return ae&&Jn(v,M),P}for(L=r(v,L);M<_.length;M++)k=m(L,v,M,_[M],S),k!==null&&(t&&k.alternate!==null&&L.delete(k.key===null?M:k.key),g=s(k,g,M),x===null?P=k:x.sibling=k,x=k);return t&&L.forEach(function(z){return e(v,z)}),ae&&Jn(v,M),P}function w(v,g,_,S){var P=ki(_);if(typeof P!="function")throw Error(R(150));if(_=P.call(_),_==null)throw Error(R(151));for(var x=P=null,L=g,M=g=0,k=null,I=_.next();L!==null&&!I.done;M++,I=_.next()){L.index>M?(k=L,L=null):k=L.sibling;var z=h(v,L,I.value,S);if(z===null){L===null&&(L=k);break}t&&L&&z.alternate===null&&e(v,L),g=s(z,g,M),x===null?P=z:x.sibling=z,x=z,L=k}if(I.done)return n(v,L),ae&&Jn(v,M),P;if(L===null){for(;!I.done;M++,I=_.next())I=f(v,I.value,S),I!==null&&(g=s(I,g,M),x===null?P=I:x.sibling=I,x=I);return ae&&Jn(v,M),P}for(L=r(v,L);!I.done;M++,I=_.next())I=m(L,v,M,I.value,S),I!==null&&(t&&I.alternate!==null&&L.delete(I.key===null?M:I.key),g=s(I,g,M),x===null?P=I:x.sibling=I,x=I);return t&&L.forEach(function(ee){return e(v,ee)}),ae&&Jn(v,M),P}function b(v,g,_,S){if(typeof _=="object"&&_!==null&&_.type===Or&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case lo:e:{for(var P=_.key,x=g;x!==null;){if(x.key===P){if(P=_.type,P===Or){if(x.tag===7){n(v,x.sibling),g=i(x,_.props.children),g.return=v,v=g;break e}}else if(x.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Sn&&Ld(P)===x.type){n(v,x.sibling),g=i(x,_.props),g.ref=Bi(v,x,_),g.return=v,v=g;break e}n(v,x);break}else e(v,x);x=x.sibling}_.type===Or?(g=ar(_.props.children,v.mode,S,_.key),g.return=v,v=g):(S=$o(_.type,_.key,_.props,null,v.mode,S),S.ref=Bi(v,g,_),S.return=v,v=S)}return o(v);case Ir:e:{for(x=_.key;g!==null;){if(g.key===x)if(g.tag===4&&g.stateNode.containerInfo===_.containerInfo&&g.stateNode.implementation===_.implementation){n(v,g.sibling),g=i(g,_.children||[]),g.return=v,v=g;break e}else{n(v,g);break}else e(v,g);g=g.sibling}g=ql(_,v.mode,S),g.return=v,v=g}return o(v);case Sn:return x=_._init,b(v,g,x(_._payload),S)}if(qi(_))return E(v,g,_,S);if(ki(_))return w(v,g,_,S);Eo(v,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,g!==null&&g.tag===6?(n(v,g.sibling),g=i(g,_),g.return=v,v=g):(n(v,g),g=$l(_,v.mode,S),g.return=v,v=g),o(v)):n(v,g)}return b}var ri=u0(!0),c0=u0(!1),Bs={},Ht=Wn(Bs),bs=Wn(Bs),As=Wn(Bs);function ir(t){if(t===Bs)throw Error(R(174));return t}function Cf(t,e){switch(J(As,e),J(bs,t),J(Ht,Bs),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=zu(e,t)}re(Ht),J(Ht,e)}function ii(){re(Ht),re(bs),re(As)}function f0(t){ir(As.current);var e=ir(Ht.current),n=zu(e,t.type);e!==n&&(J(bs,t),J(Ht,n))}function Rf(t){bs.current===t&&(re(Ht),re(bs))}var ue=Wn(0);function Ea(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jl=[];function Mf(){for(var t=0;t<jl.length;t++)jl[t]._workInProgressVersionPrimary=null;jl.length=0}var Go=dn.ReactCurrentDispatcher,Gl=dn.ReactCurrentBatchConfig,hr=0,ce=null,_e=null,Se=null,wa=!1,ss=!1,Ps=0,wE=0;function Me(){throw Error(R(321))}function If(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ct(t[n],e[n]))return!1;return!0}function Of(t,e,n,r,i,s){if(hr=s,ce=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Go.current=t===null||t.memoizedState===null?AE:PE,t=n(r,i),ss){s=0;do{if(ss=!1,Ps=0,25<=s)throw Error(R(301));s+=1,Se=_e=null,e.updateQueue=null,Go.current=xE,t=n(r,i)}while(ss)}if(Go.current=Ta,e=_e!==null&&_e.next!==null,hr=0,Se=_e=ce=null,wa=!1,e)throw Error(R(300));return t}function kf(){var t=Ps!==0;return Ps=0,t}function Ut(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Se===null?ce.memoizedState=Se=t:Se=Se.next=t,Se}function vt(){if(_e===null){var t=ce.alternate;t=t!==null?t.memoizedState:null}else t=_e.next;var e=Se===null?ce.memoizedState:Se.next;if(e!==null)Se=e,_e=t;else{if(t===null)throw Error(R(310));_e=t,t={memoizedState:_e.memoizedState,baseState:_e.baseState,baseQueue:_e.baseQueue,queue:_e.queue,next:null},Se===null?ce.memoizedState=Se=t:Se=Se.next=t}return Se}function xs(t,e){return typeof e=="function"?e(t):e}function Hl(t){var e=vt(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=_e,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((hr&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,ce.lanes|=c,dr|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Ct(r,e.memoizedState)||(Ye=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ce.lanes|=s,dr|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Wl(t){var e=vt(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ct(s,e.memoizedState)||(Ye=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function h0(){}function d0(t,e){var n=ce,r=vt(),i=e(),s=!Ct(r.memoizedState,i);if(s&&(r.memoizedState=i,Ye=!0),r=r.queue,Nf(m0.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Se!==null&&Se.memoizedState.tag&1){if(n.flags|=2048,Ls(9,g0.bind(null,n,r,i,e),void 0,null),Ae===null)throw Error(R(349));hr&30||p0(n,e,i)}return i}function p0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ce.updateQueue,e===null?(e={lastEffect:null,stores:null},ce.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function g0(t,e,n,r){e.value=n,e.getSnapshot=r,y0(e)&&v0(t)}function m0(t,e,n){return n(function(){y0(e)&&v0(t)})}function y0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ct(t,n)}catch{return!0}}function v0(t){var e=ln(t,1);e!==null&&xt(e,t,1,-1)}function Cd(t){var e=Ut();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:t},e.queue=t,t=t.dispatch=bE.bind(null,ce,t),[e.memoizedState,t]}function Ls(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ce.updateQueue,e===null?(e={lastEffect:null,stores:null},ce.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function _0(){return vt().memoizedState}function Ho(t,e,n,r){var i=Ut();ce.flags|=t,i.memoizedState=Ls(1|e,n,void 0,r===void 0?null:r)}function Ka(t,e,n,r){var i=vt();r=r===void 0?null:r;var s=void 0;if(_e!==null){var o=_e.memoizedState;if(s=o.destroy,r!==null&&If(r,o.deps)){i.memoizedState=Ls(e,n,s,r);return}}ce.flags|=t,i.memoizedState=Ls(1|e,n,s,r)}function Rd(t,e){return Ho(8390656,8,t,e)}function Nf(t,e){return Ka(2048,8,t,e)}function E0(t,e){return Ka(4,2,t,e)}function w0(t,e){return Ka(4,4,t,e)}function T0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function S0(t,e,n){return n=n!=null?n.concat([t]):null,Ka(4,4,T0.bind(null,e,t),n)}function Df(){}function b0(t,e){var n=vt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&If(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function A0(t,e){var n=vt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&If(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function P0(t,e,n){return hr&21?(Ct(n,e)||(n=Cm(),ce.lanes|=n,dr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ye=!0),t.memoizedState=n)}function TE(t,e){var n=q;q=n!==0&&4>n?n:4,t(!0);var r=Gl.transition;Gl.transition={};try{t(!1),e()}finally{q=n,Gl.transition=r}}function x0(){return vt().memoizedState}function SE(t,e,n){var r=Un(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},L0(t))C0(e,n);else if(n=s0(t,e,n,r),n!==null){var i=Ve();xt(n,t,r,i),R0(n,e,r)}}function bE(t,e,n){var r=Un(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(L0(t))C0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Ct(a,o)){var l=e.interleaved;l===null?(i.next=i,xf(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=s0(t,e,i,r),n!==null&&(i=Ve(),xt(n,t,r,i),R0(n,e,r))}}function L0(t){var e=t.alternate;return t===ce||e!==null&&e===ce}function C0(t,e){ss=wa=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function R0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,df(t,n)}}var Ta={readContext:yt,useCallback:Me,useContext:Me,useEffect:Me,useImperativeHandle:Me,useInsertionEffect:Me,useLayoutEffect:Me,useMemo:Me,useReducer:Me,useRef:Me,useState:Me,useDebugValue:Me,useDeferredValue:Me,useTransition:Me,useMutableSource:Me,useSyncExternalStore:Me,useId:Me,unstable_isNewReconciler:!1},AE={readContext:yt,useCallback:function(t,e){return Ut().memoizedState=[t,e===void 0?null:e],t},useContext:yt,useEffect:Rd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ho(4194308,4,T0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ho(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ho(4,2,t,e)},useMemo:function(t,e){var n=Ut();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ut();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=SE.bind(null,ce,t),[r.memoizedState,t]},useRef:function(t){var e=Ut();return t={current:t},e.memoizedState=t},useState:Cd,useDebugValue:Df,useDeferredValue:function(t){return Ut().memoizedState=t},useTransition:function(){var t=Cd(!1),e=t[0];return t=TE.bind(null,t[1]),Ut().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ce,i=Ut();if(ae){if(n===void 0)throw Error(R(407));n=n()}else{if(n=e(),Ae===null)throw Error(R(349));hr&30||p0(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Rd(m0.bind(null,r,s,t),[t]),r.flags|=2048,Ls(9,g0.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Ut(),e=Ae.identifierPrefix;if(ae){var n=rn,r=nn;n=(r&~(1<<32-Pt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ps++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=wE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},PE={readContext:yt,useCallback:b0,useContext:yt,useEffect:Nf,useImperativeHandle:S0,useInsertionEffect:E0,useLayoutEffect:w0,useMemo:A0,useReducer:Hl,useRef:_0,useState:function(){return Hl(xs)},useDebugValue:Df,useDeferredValue:function(t){var e=vt();return P0(e,_e.memoizedState,t)},useTransition:function(){var t=Hl(xs)[0],e=vt().memoizedState;return[t,e]},useMutableSource:h0,useSyncExternalStore:d0,useId:x0,unstable_isNewReconciler:!1},xE={readContext:yt,useCallback:b0,useContext:yt,useEffect:Nf,useImperativeHandle:S0,useInsertionEffect:E0,useLayoutEffect:w0,useMemo:A0,useReducer:Wl,useRef:_0,useState:function(){return Wl(xs)},useDebugValue:Df,useDeferredValue:function(t){var e=vt();return _e===null?e.memoizedState=t:P0(e,_e.memoizedState,t)},useTransition:function(){var t=Wl(xs)[0],e=vt().memoizedState;return[t,e]},useMutableSource:h0,useSyncExternalStore:d0,useId:x0,unstable_isNewReconciler:!1};function si(t,e){try{var n="",r=e;do n+=t1(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Yl(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function uc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var LE=typeof WeakMap=="function"?WeakMap:Map;function M0(t,e,n){n=sn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ba||(ba=!0,_c=r),uc(t,e)},n}function I0(t,e,n){n=sn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){uc(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){uc(t,e),typeof r!="function"&&(Fn===null?Fn=new Set([this]):Fn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Md(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new LE;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=jE.bind(null,t,e,n),e.then(t,t))}function Id(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Od(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=sn(-1,1),e.tag=2,Dn(n,e,1))),n.lanes|=1),t)}var CE=dn.ReactCurrentOwner,Ye=!1;function Fe(t,e,n,r){e.child=t===null?c0(e,null,n,r):ri(e,t.child,n,r)}function kd(t,e,n,r,i){n=n.render;var s=e.ref;return Zr(e,i),r=Of(t,e,n,r,s,i),n=kf(),t!==null&&!Ye?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,un(t,e,i)):(ae&&n&&wf(e),e.flags|=1,Fe(t,e,r,i),e.child)}function Nd(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Hf(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,O0(t,e,s,r,i)):(t=$o(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Es,n(o,r)&&t.ref===e.ref)return un(t,e,i)}return e.flags|=1,t=Bn(s,r),t.ref=e.ref,t.return=e,e.child=t}function O0(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Es(s,r)&&t.ref===e.ref)if(Ye=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Ye=!0);else return e.lanes=t.lanes,un(t,e,i)}return cc(t,e,n,r,i)}function k0(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},J(Gr,Je),Je|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,J(Gr,Je),Je|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,J(Gr,Je),Je|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,J(Gr,Je),Je|=r;return Fe(t,e,i,n),e.child}function N0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function cc(t,e,n,r,i){var s=$e(n)?cr:Ne.current;return s=ti(e,s),Zr(e,i),n=Of(t,e,n,r,s,i),r=kf(),t!==null&&!Ye?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,un(t,e,i)):(ae&&r&&wf(e),e.flags|=1,Fe(t,e,n,i),e.child)}function Dd(t,e,n,r,i){if($e(n)){var s=!0;pa(e)}else s=!1;if(Zr(e,i),e.stateNode===null)Wo(t,e),l0(e,n,r),lc(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=yt(u):(u=$e(n)?cr:Ne.current,u=ti(e,u));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&xd(e,o,r,u),bn=!1;var h=e.memoizedState;o.state=h,_a(e,r,o,i),l=e.memoizedState,a!==r||h!==l||Xe.current||bn?(typeof c=="function"&&(ac(e,n,c,r),l=e.memoizedState),(a=bn||Pd(e,n,a,r,h,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,o0(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Tt(e.type,a),o.props=u,f=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=yt(l):(l=$e(n)?cr:Ne.current,l=ti(e,l));var m=n.getDerivedStateFromProps;(c=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||h!==l)&&xd(e,o,r,l),bn=!1,h=e.memoizedState,o.state=h,_a(e,r,o,i);var E=e.memoizedState;a!==f||h!==E||Xe.current||bn?(typeof m=="function"&&(ac(e,n,m,r),E=e.memoizedState),(u=bn||Pd(e,n,u,r,h,E,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return fc(t,e,n,r,s,i)}function fc(t,e,n,r,i,s){N0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&wd(e,n,!1),un(t,e,s);r=e.stateNode,CE.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ri(e,t.child,null,s),e.child=ri(e,null,a,s)):Fe(t,e,a,s),e.memoizedState=r.state,i&&wd(e,n,!0),e.child}function D0(t){var e=t.stateNode;e.pendingContext?Ed(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ed(t,e.context,!1),Cf(t,e.containerInfo)}function Fd(t,e,n,r,i){return ni(),Sf(i),e.flags|=256,Fe(t,e,n,r),e.child}var hc={dehydrated:null,treeContext:null,retryLane:0};function dc(t){return{baseLanes:t,cachePool:null,transitions:null}}function F0(t,e,n){var r=e.pendingProps,i=ue.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),J(ue,i&1),t===null)return sc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=el(o,r,0,null),t=ar(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=dc(n),e.memoizedState=hc,t):Ff(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return RE(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Bn(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Bn(a,s):(s=ar(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?dc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=hc,r}return s=t.child,t=s.sibling,r=Bn(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ff(t,e){return e=el({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function wo(t,e,n,r){return r!==null&&Sf(r),ri(e,t.child,null,n),t=Ff(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function RE(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Yl(Error(R(422))),wo(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=el({mode:"visible",children:r.children},i,0,null),s=ar(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ri(e,t.child,null,o),e.child.memoizedState=dc(o),e.memoizedState=hc,s);if(!(e.mode&1))return wo(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(R(419)),r=Yl(s,r,void 0),wo(t,e,o,r)}if(a=(o&t.childLanes)!==0,Ye||a){if(r=Ae,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ln(t,i),xt(r,t,i,-1))}return Gf(),r=Yl(Error(R(421))),wo(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=GE.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,nt=Nn(i.nextSibling),it=e,ae=!0,bt=null,t!==null&&(ht[dt++]=nn,ht[dt++]=rn,ht[dt++]=fr,nn=t.id,rn=t.overflow,fr=e),e=Ff(e,r.children),e.flags|=4096,e)}function Ud(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),oc(t.return,e,n)}function Xl(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function U0(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Fe(t,e,r.children,n),r=ue.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ud(t,n,e);else if(t.tag===19)Ud(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(J(ue,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ea(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Xl(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ea(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Xl(e,!0,n,null,s);break;case"together":Xl(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Wo(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function un(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),dr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(R(153));if(e.child!==null){for(t=e.child,n=Bn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Bn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ME(t,e,n){switch(e.tag){case 3:D0(e),ni();break;case 5:f0(e);break;case 1:$e(e.type)&&pa(e);break;case 4:Cf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;J(ya,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(J(ue,ue.current&1),e.flags|=128,null):n&e.child.childLanes?F0(t,e,n):(J(ue,ue.current&1),t=un(t,e,n),t!==null?t.sibling:null);J(ue,ue.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return U0(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),J(ue,ue.current),r)break;return null;case 22:case 23:return e.lanes=0,k0(t,e,n)}return un(t,e,n)}var B0,pc,z0,V0;B0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};pc=function(){};z0=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ir(Ht.current);var s=null;switch(n){case"input":i=Du(t,i),r=Du(t,r),s=[];break;case"select":i=fe({},i,{value:void 0}),r=fe({},r,{value:void 0}),s=[];break;case"textarea":i=Bu(t,i),r=Bu(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ha)}Vu(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ds.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ds.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ne("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};V0=function(t,e,n,r){n!==r&&(e.flags|=4)};function zi(t,e){if(!ae)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ie(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function IE(t,e,n){var r=e.pendingProps;switch(Tf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ie(e),null;case 1:return $e(e.type)&&da(),Ie(e),null;case 3:return r=e.stateNode,ii(),re(Xe),re(Ne),Mf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(_o(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bt!==null&&(Tc(bt),bt=null))),pc(t,e),Ie(e),null;case 5:Rf(e);var i=ir(As.current);if(n=e.type,t!==null&&e.stateNode!=null)z0(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(R(166));return Ie(e),null}if(t=ir(Ht.current),_o(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Bt]=e,r[Ss]=s,t=(e.mode&1)!==0,n){case"dialog":ne("cancel",r),ne("close",r);break;case"iframe":case"object":case"embed":ne("load",r);break;case"video":case"audio":for(i=0;i<Ki.length;i++)ne(Ki[i],r);break;case"source":ne("error",r);break;case"img":case"image":case"link":ne("error",r),ne("load",r);break;case"details":ne("toggle",r);break;case"input":Xh(r,s),ne("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ne("invalid",r);break;case"textarea":qh(r,s),ne("invalid",r)}Vu(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&vo(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&vo(r.textContent,a,t),i=["children",""+a]):ds.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ne("scroll",r)}switch(n){case"input":uo(r),$h(r,s,!0);break;case"textarea":uo(r),Zh(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ha)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=pm(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Bt]=e,t[Ss]=r,B0(t,e,!1,!1),e.stateNode=t;e:{switch(o=ju(n,r),n){case"dialog":ne("cancel",t),ne("close",t),i=r;break;case"iframe":case"object":case"embed":ne("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ki.length;i++)ne(Ki[i],t);i=r;break;case"source":ne("error",t),i=r;break;case"img":case"image":case"link":ne("error",t),ne("load",t),i=r;break;case"details":ne("toggle",t),i=r;break;case"input":Xh(t,r),i=Du(t,r),ne("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=fe({},r,{value:void 0}),ne("invalid",t);break;case"textarea":qh(t,r),i=Bu(t,r),ne("invalid",t);break;default:i=r}Vu(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?ym(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&gm(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&ps(t,l):typeof l=="number"&&ps(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ds.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ne("scroll",t):l!=null&&af(t,s,l,o))}switch(n){case"input":uo(t),$h(t,r,!1);break;case"textarea":uo(t),Zh(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Vn(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Yr(t,!!r.multiple,s,!1):r.defaultValue!=null&&Yr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ha)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ie(e),null;case 6:if(t&&e.stateNode!=null)V0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(R(166));if(n=ir(As.current),ir(Ht.current),_o(e)){if(r=e.stateNode,n=e.memoizedProps,r[Bt]=e,(s=r.nodeValue!==n)&&(t=it,t!==null))switch(t.tag){case 3:vo(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&vo(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Bt]=e,e.stateNode=r}return Ie(e),null;case 13:if(re(ue),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ae&&nt!==null&&e.mode&1&&!(e.flags&128))i0(),ni(),e.flags|=98560,s=!1;else if(s=_o(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(R(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(R(317));s[Bt]=e}else ni(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ie(e),s=!1}else bt!==null&&(Tc(bt),bt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ue.current&1?Ee===0&&(Ee=3):Gf())),e.updateQueue!==null&&(e.flags|=4),Ie(e),null);case 4:return ii(),pc(t,e),t===null&&ws(e.stateNode.containerInfo),Ie(e),null;case 10:return Pf(e.type._context),Ie(e),null;case 17:return $e(e.type)&&da(),Ie(e),null;case 19:if(re(ue),s=e.memoizedState,s===null)return Ie(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)zi(s,!1);else{if(Ee!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ea(t),o!==null){for(e.flags|=128,zi(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return J(ue,ue.current&1|2),e.child}t=t.sibling}s.tail!==null&&pe()>oi&&(e.flags|=128,r=!0,zi(s,!1),e.lanes=4194304)}else{if(!r)if(t=Ea(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),zi(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ae)return Ie(e),null}else 2*pe()-s.renderingStartTime>oi&&n!==1073741824&&(e.flags|=128,r=!0,zi(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=pe(),e.sibling=null,n=ue.current,J(ue,r?n&1|2:n&1),e):(Ie(e),null);case 22:case 23:return jf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Je&1073741824&&(Ie(e),e.subtreeFlags&6&&(e.flags|=8192)):Ie(e),null;case 24:return null;case 25:return null}throw Error(R(156,e.tag))}function OE(t,e){switch(Tf(e),e.tag){case 1:return $e(e.type)&&da(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ii(),re(Xe),re(Ne),Mf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Rf(e),null;case 13:if(re(ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(R(340));ni()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return re(ue),null;case 4:return ii(),null;case 10:return Pf(e.type._context),null;case 22:case 23:return jf(),null;case 24:return null;default:return null}}var To=!1,ke=!1,kE=typeof WeakSet=="function"?WeakSet:Set,U=null;function jr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){de(t,e,r)}else n.current=null}function gc(t,e,n){try{n()}catch(r){de(t,e,r)}}var Bd=!1;function NE(t,e){if(Qu=ua,t=Wm(),Ef(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,f=t,h=null;t:for(;;){for(var m;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===t)break t;if(h===n&&++u===i&&(a=o),h===s&&++c===r&&(l=o),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ju={focusedElem:t,selectionRange:n},ua=!1,U=e;U!==null;)if(e=U,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,U=t;else for(;U!==null;){e=U;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var w=E.memoizedProps,b=E.memoizedState,v=e.stateNode,g=v.getSnapshotBeforeUpdate(e.elementType===e.type?w:Tt(e.type,w),b);v.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(S){de(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,U=t;break}U=e.return}return E=Bd,Bd=!1,E}function os(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&gc(e,n,s)}i=i.next}while(i!==r)}}function Qa(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function mc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function j0(t){var e=t.alternate;e!==null&&(t.alternate=null,j0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Bt],delete e[Ss],delete e[nc],delete e[yE],delete e[vE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function G0(t){return t.tag===5||t.tag===3||t.tag===4}function zd(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||G0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function yc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ha));else if(r!==4&&(t=t.child,t!==null))for(yc(t,e,n),t=t.sibling;t!==null;)yc(t,e,n),t=t.sibling}function vc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(vc(t,e,n),t=t.sibling;t!==null;)vc(t,e,n),t=t.sibling}var Le=null,St=!1;function yn(t,e,n){for(n=n.child;n!==null;)H0(t,e,n),n=n.sibling}function H0(t,e,n){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(Ha,n)}catch{}switch(n.tag){case 5:ke||jr(n,e);case 6:var r=Le,i=St;Le=null,yn(t,e,n),Le=r,St=i,Le!==null&&(St?(t=Le,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Le.removeChild(n.stateNode));break;case 18:Le!==null&&(St?(t=Le,n=n.stateNode,t.nodeType===8?zl(t.parentNode,n):t.nodeType===1&&zl(t,n),vs(t)):zl(Le,n.stateNode));break;case 4:r=Le,i=St,Le=n.stateNode.containerInfo,St=!0,yn(t,e,n),Le=r,St=i;break;case 0:case 11:case 14:case 15:if(!ke&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&gc(n,e,o),i=i.next}while(i!==r)}yn(t,e,n);break;case 1:if(!ke&&(jr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){de(n,e,a)}yn(t,e,n);break;case 21:yn(t,e,n);break;case 22:n.mode&1?(ke=(r=ke)||n.memoizedState!==null,yn(t,e,n),ke=r):yn(t,e,n);break;default:yn(t,e,n)}}function Vd(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new kE),e.forEach(function(r){var i=HE.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function wt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Le=a.stateNode,St=!1;break e;case 3:Le=a.stateNode.containerInfo,St=!0;break e;case 4:Le=a.stateNode.containerInfo,St=!0;break e}a=a.return}if(Le===null)throw Error(R(160));H0(s,o,i),Le=null,St=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){de(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)W0(e,t),e=e.sibling}function W0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(wt(e,t),kt(t),r&4){try{os(3,t,t.return),Qa(3,t)}catch(w){de(t,t.return,w)}try{os(5,t,t.return)}catch(w){de(t,t.return,w)}}break;case 1:wt(e,t),kt(t),r&512&&n!==null&&jr(n,n.return);break;case 5:if(wt(e,t),kt(t),r&512&&n!==null&&jr(n,n.return),t.flags&32){var i=t.stateNode;try{ps(i,"")}catch(w){de(t,t.return,w)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&hm(i,s),ju(a,o);var u=ju(a,s);for(o=0;o<l.length;o+=2){var c=l[o],f=l[o+1];c==="style"?ym(i,f):c==="dangerouslySetInnerHTML"?gm(i,f):c==="children"?ps(i,f):af(i,c,f,u)}switch(a){case"input":Fu(i,s);break;case"textarea":dm(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Yr(i,!!s.multiple,m,!1):h!==!!s.multiple&&(s.defaultValue!=null?Yr(i,!!s.multiple,s.defaultValue,!0):Yr(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ss]=s}catch(w){de(t,t.return,w)}}break;case 6:if(wt(e,t),kt(t),r&4){if(t.stateNode===null)throw Error(R(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(w){de(t,t.return,w)}}break;case 3:if(wt(e,t),kt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{vs(e.containerInfo)}catch(w){de(t,t.return,w)}break;case 4:wt(e,t),kt(t);break;case 13:wt(e,t),kt(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(zf=pe())),r&4&&Vd(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(ke=(u=ke)||c,wt(e,t),ke=u):wt(e,t),kt(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(U=t,c=t.child;c!==null;){for(f=U=c;U!==null;){switch(h=U,m=h.child,h.tag){case 0:case 11:case 14:case 15:os(4,h,h.return);break;case 1:jr(h,h.return);var E=h.stateNode;if(typeof E.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(w){de(r,n,w)}}break;case 5:jr(h,h.return);break;case 22:if(h.memoizedState!==null){Gd(f);continue}}m!==null?(m.return=h,U=m):Gd(f)}c=c.sibling}e:for(c=null,f=t;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=mm("display",o))}catch(w){de(t,t.return,w)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(w){de(t,t.return,w)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:wt(e,t),kt(t),r&4&&Vd(t);break;case 21:break;default:wt(e,t),kt(t)}}function kt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(G0(n)){var r=n;break e}n=n.return}throw Error(R(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ps(i,""),r.flags&=-33);var s=zd(t);vc(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=zd(t);yc(t,a,o);break;default:throw Error(R(161))}}catch(l){de(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function DE(t,e,n){U=t,Y0(t)}function Y0(t,e,n){for(var r=(t.mode&1)!==0;U!==null;){var i=U,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||To;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||ke;a=To;var u=ke;if(To=o,(ke=l)&&!u)for(U=i;U!==null;)o=U,l=o.child,o.tag===22&&o.memoizedState!==null?Hd(i):l!==null?(l.return=o,U=l):Hd(i);for(;s!==null;)U=s,Y0(s),s=s.sibling;U=i,To=a,ke=u}jd(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,U=s):jd(t)}}function jd(t){for(;U!==null;){var e=U;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ke||Qa(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ke)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Tt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Ad(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Ad(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&vs(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}ke||e.flags&512&&mc(e)}catch(h){de(e,e.return,h)}}if(e===t){U=null;break}if(n=e.sibling,n!==null){n.return=e.return,U=n;break}U=e.return}}function Gd(t){for(;U!==null;){var e=U;if(e===t){U=null;break}var n=e.sibling;if(n!==null){n.return=e.return,U=n;break}U=e.return}}function Hd(t){for(;U!==null;){var e=U;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Qa(4,e)}catch(l){de(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){de(e,i,l)}}var s=e.return;try{mc(e)}catch(l){de(e,s,l)}break;case 5:var o=e.return;try{mc(e)}catch(l){de(e,o,l)}}}catch(l){de(e,e.return,l)}if(e===t){U=null;break}var a=e.sibling;if(a!==null){a.return=e.return,U=a;break}U=e.return}}var FE=Math.ceil,Sa=dn.ReactCurrentDispatcher,Uf=dn.ReactCurrentOwner,gt=dn.ReactCurrentBatchConfig,X=0,Ae=null,ye=null,Ce=0,Je=0,Gr=Wn(0),Ee=0,Cs=null,dr=0,Ja=0,Bf=0,as=null,We=null,zf=0,oi=1/0,Jt=null,ba=!1,_c=null,Fn=null,So=!1,Cn=null,Aa=0,ls=0,Ec=null,Yo=-1,Xo=0;function Ve(){return X&6?pe():Yo!==-1?Yo:Yo=pe()}function Un(t){return t.mode&1?X&2&&Ce!==0?Ce&-Ce:EE.transition!==null?(Xo===0&&(Xo=Cm()),Xo):(t=q,t!==0||(t=window.event,t=t===void 0?16:Dm(t.type)),t):1}function xt(t,e,n,r){if(50<ls)throw ls=0,Ec=null,Error(R(185));Ds(t,n,r),(!(X&2)||t!==Ae)&&(t===Ae&&(!(X&2)&&(Ja|=n),Ee===4&&Pn(t,Ce)),qe(t,r),n===1&&X===0&&!(e.mode&1)&&(oi=pe()+500,qa&&Yn()))}function qe(t,e){var n=t.callbackNode;E1(t,e);var r=la(t,t===Ae?Ce:0);if(r===0)n!==null&&Jh(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Jh(n),e===1)t.tag===0?_E(Wd.bind(null,t)):t0(Wd.bind(null,t)),gE(function(){!(X&6)&&Yn()}),n=null;else{switch(Rm(r)){case 1:n=hf;break;case 4:n=xm;break;case 16:n=aa;break;case 536870912:n=Lm;break;default:n=aa}n=ey(n,X0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function X0(t,e){if(Yo=-1,Xo=0,X&6)throw Error(R(327));var n=t.callbackNode;if(Kr()&&t.callbackNode!==n)return null;var r=la(t,t===Ae?Ce:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Pa(t,r);else{e=r;var i=X;X|=2;var s=q0();(Ae!==t||Ce!==e)&&(Jt=null,oi=pe()+500,or(t,e));do try{zE();break}catch(a){$0(t,a)}while(1);Af(),Sa.current=s,X=i,ye!==null?e=0:(Ae=null,Ce=0,e=Ee)}if(e!==0){if(e===2&&(i=Xu(t),i!==0&&(r=i,e=wc(t,i))),e===1)throw n=Cs,or(t,0),Pn(t,r),qe(t,pe()),n;if(e===6)Pn(t,r);else{if(i=t.current.alternate,!(r&30)&&!UE(i)&&(e=Pa(t,r),e===2&&(s=Xu(t),s!==0&&(r=s,e=wc(t,s))),e===1))throw n=Cs,or(t,0),Pn(t,r),qe(t,pe()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(R(345));case 2:er(t,We,Jt);break;case 3:if(Pn(t,r),(r&130023424)===r&&(e=zf+500-pe(),10<e)){if(la(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Ve(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=tc(er.bind(null,t,We,Jt),e);break}er(t,We,Jt);break;case 4:if(Pn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Pt(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=pe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*FE(r/1960))-r,10<r){t.timeoutHandle=tc(er.bind(null,t,We,Jt),r);break}er(t,We,Jt);break;case 5:er(t,We,Jt);break;default:throw Error(R(329))}}}return qe(t,pe()),t.callbackNode===n?X0.bind(null,t):null}function wc(t,e){var n=as;return t.current.memoizedState.isDehydrated&&(or(t,e).flags|=256),t=Pa(t,e),t!==2&&(e=We,We=n,e!==null&&Tc(e)),t}function Tc(t){We===null?We=t:We.push.apply(We,t)}function UE(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ct(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pn(t,e){for(e&=~Bf,e&=~Ja,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Pt(e),r=1<<n;t[n]=-1,e&=~r}}function Wd(t){if(X&6)throw Error(R(327));Kr();var e=la(t,0);if(!(e&1))return qe(t,pe()),null;var n=Pa(t,e);if(t.tag!==0&&n===2){var r=Xu(t);r!==0&&(e=r,n=wc(t,r))}if(n===1)throw n=Cs,or(t,0),Pn(t,e),qe(t,pe()),n;if(n===6)throw Error(R(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,er(t,We,Jt),qe(t,pe()),null}function Vf(t,e){var n=X;X|=1;try{return t(e)}finally{X=n,X===0&&(oi=pe()+500,qa&&Yn())}}function pr(t){Cn!==null&&Cn.tag===0&&!(X&6)&&Kr();var e=X;X|=1;var n=gt.transition,r=q;try{if(gt.transition=null,q=1,t)return t()}finally{q=r,gt.transition=n,X=e,!(X&6)&&Yn()}}function jf(){Je=Gr.current,re(Gr)}function or(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,pE(n)),ye!==null)for(n=ye.return;n!==null;){var r=n;switch(Tf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&da();break;case 3:ii(),re(Xe),re(Ne),Mf();break;case 5:Rf(r);break;case 4:ii();break;case 13:re(ue);break;case 19:re(ue);break;case 10:Pf(r.type._context);break;case 22:case 23:jf()}n=n.return}if(Ae=t,ye=t=Bn(t.current,null),Ce=Je=e,Ee=0,Cs=null,Bf=Ja=dr=0,We=as=null,rr!==null){for(e=0;e<rr.length;e++)if(n=rr[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}rr=null}return t}function $0(t,e){do{var n=ye;try{if(Af(),Go.current=Ta,wa){for(var r=ce.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}wa=!1}if(hr=0,Se=_e=ce=null,ss=!1,Ps=0,Uf.current=null,n===null||n.return===null){Ee=1,Cs=e,ye=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Ce,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var m=Id(o);if(m!==null){m.flags&=-257,Od(m,o,a,s,e),m.mode&1&&Md(s,u,e),e=m,l=u;var E=e.updateQueue;if(E===null){var w=new Set;w.add(l),e.updateQueue=w}else E.add(l);break e}else{if(!(e&1)){Md(s,u,e),Gf();break e}l=Error(R(426))}}else if(ae&&a.mode&1){var b=Id(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),Od(b,o,a,s,e),Sf(si(l,a));break e}}s=l=si(l,a),Ee!==4&&(Ee=2),as===null?as=[s]:as.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=M0(s,l,e);bd(s,v);break e;case 1:a=l;var g=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof g.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Fn===null||!Fn.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=I0(s,a,e);bd(s,S);break e}}s=s.return}while(s!==null)}K0(n)}catch(P){e=P,ye===n&&n!==null&&(ye=n=n.return);continue}break}while(1)}function q0(){var t=Sa.current;return Sa.current=Ta,t===null?Ta:t}function Gf(){(Ee===0||Ee===3||Ee===2)&&(Ee=4),Ae===null||!(dr&268435455)&&!(Ja&268435455)||Pn(Ae,Ce)}function Pa(t,e){var n=X;X|=2;var r=q0();(Ae!==t||Ce!==e)&&(Jt=null,or(t,e));do try{BE();break}catch(i){$0(t,i)}while(1);if(Af(),X=n,Sa.current=r,ye!==null)throw Error(R(261));return Ae=null,Ce=0,Ee}function BE(){for(;ye!==null;)Z0(ye)}function zE(){for(;ye!==null&&!f1();)Z0(ye)}function Z0(t){var e=J0(t.alternate,t,Je);t.memoizedProps=t.pendingProps,e===null?K0(t):ye=e,Uf.current=null}function K0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=OE(n,e),n!==null){n.flags&=32767,ye=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ee=6,ye=null;return}}else if(n=IE(n,e,Je),n!==null){ye=n;return}if(e=e.sibling,e!==null){ye=e;return}ye=e=t}while(e!==null);Ee===0&&(Ee=5)}function er(t,e,n){var r=q,i=gt.transition;try{gt.transition=null,q=1,VE(t,e,n,r)}finally{gt.transition=i,q=r}return null}function VE(t,e,n,r){do Kr();while(Cn!==null);if(X&6)throw Error(R(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(R(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(w1(t,s),t===Ae&&(ye=Ae=null,Ce=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||So||(So=!0,ey(aa,function(){return Kr(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=gt.transition,gt.transition=null;var o=q;q=1;var a=X;X|=4,Uf.current=null,NE(t,n),W0(n,t),aE(Ju),ua=!!Qu,Ju=Qu=null,t.current=n,DE(n),h1(),X=a,q=o,gt.transition=s}else t.current=n;if(So&&(So=!1,Cn=t,Aa=i),s=t.pendingLanes,s===0&&(Fn=null),g1(n.stateNode),qe(t,pe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ba)throw ba=!1,t=_c,_c=null,t;return Aa&1&&t.tag!==0&&Kr(),s=t.pendingLanes,s&1?t===Ec?ls++:(ls=0,Ec=t):ls=0,Yn(),null}function Kr(){if(Cn!==null){var t=Rm(Aa),e=gt.transition,n=q;try{if(gt.transition=null,q=16>t?16:t,Cn===null)var r=!1;else{if(t=Cn,Cn=null,Aa=0,X&6)throw Error(R(331));var i=X;for(X|=4,U=t.current;U!==null;){var s=U,o=s.child;if(U.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(U=u;U!==null;){var c=U;switch(c.tag){case 0:case 11:case 15:os(8,c,s)}var f=c.child;if(f!==null)f.return=c,U=f;else for(;U!==null;){c=U;var h=c.sibling,m=c.return;if(j0(c),c===u){U=null;break}if(h!==null){h.return=m,U=h;break}U=m}}}var E=s.alternate;if(E!==null){var w=E.child;if(w!==null){E.child=null;do{var b=w.sibling;w.sibling=null,w=b}while(w!==null)}}U=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,U=o;else e:for(;U!==null;){if(s=U,s.flags&2048)switch(s.tag){case 0:case 11:case 15:os(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,U=v;break e}U=s.return}}var g=t.current;for(U=g;U!==null;){o=U;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,U=_;else e:for(o=g;U!==null;){if(a=U,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Qa(9,a)}}catch(P){de(a,a.return,P)}if(a===o){U=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,U=S;break e}U=a.return}}if(X=i,Yn(),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(Ha,t)}catch{}r=!0}return r}finally{q=n,gt.transition=e}}return!1}function Yd(t,e,n){e=si(n,e),e=M0(t,e,1),t=Dn(t,e,1),e=Ve(),t!==null&&(Ds(t,1,e),qe(t,e))}function de(t,e,n){if(t.tag===3)Yd(t,t,n);else for(;e!==null;){if(e.tag===3){Yd(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Fn===null||!Fn.has(r))){t=si(n,t),t=I0(e,t,1),e=Dn(e,t,1),t=Ve(),e!==null&&(Ds(e,1,t),qe(e,t));break}}e=e.return}}function jE(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ve(),t.pingedLanes|=t.suspendedLanes&n,Ae===t&&(Ce&n)===n&&(Ee===4||Ee===3&&(Ce&130023424)===Ce&&500>pe()-zf?or(t,0):Bf|=n),qe(t,e)}function Q0(t,e){e===0&&(t.mode&1?(e=ho,ho<<=1,!(ho&130023424)&&(ho=4194304)):e=1);var n=Ve();t=ln(t,e),t!==null&&(Ds(t,e,n),qe(t,n))}function GE(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Q0(t,n)}function HE(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(R(314))}r!==null&&r.delete(e),Q0(t,n)}var J0;J0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Xe.current)Ye=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ye=!1,ME(t,e,n);Ye=!!(t.flags&131072)}else Ye=!1,ae&&e.flags&1048576&&n0(e,ma,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Wo(t,e),t=e.pendingProps;var i=ti(e,Ne.current);Zr(e,n),i=Of(null,e,r,t,i,n);var s=kf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,$e(r)?(s=!0,pa(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Lf(e),i.updater=Za,e.stateNode=i,i._reactInternals=e,lc(e,r,t,n),e=fc(null,e,r,!0,s,n)):(e.tag=0,ae&&s&&wf(e),Fe(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Wo(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=YE(r),t=Tt(r,t),i){case 0:e=cc(null,e,r,t,n);break e;case 1:e=Dd(null,e,r,t,n);break e;case 11:e=kd(null,e,r,t,n);break e;case 14:e=Nd(null,e,r,Tt(r.type,t),n);break e}throw Error(R(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Tt(r,i),cc(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Tt(r,i),Dd(t,e,r,i,n);case 3:e:{if(D0(e),t===null)throw Error(R(387));r=e.pendingProps,s=e.memoizedState,i=s.element,o0(t,e),_a(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=si(Error(R(423)),e),e=Fd(t,e,r,n,i);break e}else if(r!==i){i=si(Error(R(424)),e),e=Fd(t,e,r,n,i);break e}else for(nt=Nn(e.stateNode.containerInfo.firstChild),it=e,ae=!0,bt=null,n=c0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ni(),r===i){e=un(t,e,n);break e}Fe(t,e,r,n)}e=e.child}return e;case 5:return f0(e),t===null&&sc(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,ec(r,i)?o=null:s!==null&&ec(r,s)&&(e.flags|=32),N0(t,e),Fe(t,e,o,n),e.child;case 6:return t===null&&sc(e),null;case 13:return F0(t,e,n);case 4:return Cf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ri(e,null,r,n):Fe(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Tt(r,i),kd(t,e,r,i,n);case 7:return Fe(t,e,e.pendingProps,n),e.child;case 8:return Fe(t,e,e.pendingProps.children,n),e.child;case 12:return Fe(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,J(ya,r._currentValue),r._currentValue=o,s!==null)if(Ct(s.value,o)){if(s.children===i.children&&!Xe.current){e=un(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=sn(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),oc(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(R(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),oc(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Fe(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Zr(e,n),i=yt(i),r=r(i),e.flags|=1,Fe(t,e,r,n),e.child;case 14:return r=e.type,i=Tt(r,e.pendingProps),i=Tt(r.type,i),Nd(t,e,r,i,n);case 15:return O0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Tt(r,i),Wo(t,e),e.tag=1,$e(r)?(t=!0,pa(e)):t=!1,Zr(e,n),l0(e,r,i),lc(e,r,i,n),fc(null,e,r,!0,t,n);case 19:return U0(t,e,n);case 22:return k0(t,e,n)}throw Error(R(156,e.tag))};function ey(t,e){return Pm(t,e)}function WE(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pt(t,e,n,r){return new WE(t,e,n,r)}function Hf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function YE(t){if(typeof t=="function")return Hf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===uf)return 11;if(t===cf)return 14}return 2}function Bn(t,e){var n=t.alternate;return n===null?(n=pt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function $o(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Hf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Or:return ar(n.children,i,s,e);case lf:o=8,i|=8;break;case Iu:return t=pt(12,n,e,i|2),t.elementType=Iu,t.lanes=s,t;case Ou:return t=pt(13,n,e,i),t.elementType=Ou,t.lanes=s,t;case ku:return t=pt(19,n,e,i),t.elementType=ku,t.lanes=s,t;case um:return el(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case am:o=10;break e;case lm:o=9;break e;case uf:o=11;break e;case cf:o=14;break e;case Sn:o=16,r=null;break e}throw Error(R(130,t==null?t:typeof t,""))}return e=pt(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ar(t,e,n,r){return t=pt(7,t,r,e),t.lanes=n,t}function el(t,e,n,r){return t=pt(22,t,r,e),t.elementType=um,t.lanes=n,t.stateNode={isHidden:!1},t}function $l(t,e,n){return t=pt(6,t,null,e),t.lanes=n,t}function ql(t,e,n){return e=pt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function XE(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cl(0),this.expirationTimes=Cl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cl(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Wf(t,e,n,r,i,s,o,a,l){return t=new XE(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=pt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lf(s),t}function $E(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ir,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function ty(t){if(!t)return jn;t=t._reactInternals;e:{if(vr(t)!==t||t.tag!==1)throw Error(R(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if($e(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(R(171))}if(t.tag===1){var n=t.type;if($e(n))return e0(t,n,e)}return e}function ny(t,e,n,r,i,s,o,a,l){return t=Wf(n,r,!0,t,i,s,o,a,l),t.context=ty(null),n=t.current,r=Ve(),i=Un(n),s=sn(r,i),s.callback=e??null,Dn(n,s,i),t.current.lanes=i,Ds(t,i,r),qe(t,r),t}function tl(t,e,n,r){var i=e.current,s=Ve(),o=Un(i);return n=ty(n),e.context===null?e.context=n:e.pendingContext=n,e=sn(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Dn(i,e,o),t!==null&&(xt(t,i,o,s),jo(t,i,o)),o}function xa(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Xd(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Yf(t,e){Xd(t,e),(t=t.alternate)&&Xd(t,e)}function qE(){return null}var ry=typeof reportError=="function"?reportError:function(t){console.error(t)};function Xf(t){this._internalRoot=t}nl.prototype.render=Xf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(R(409));tl(t,e,null,null)};nl.prototype.unmount=Xf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;pr(function(){tl(null,t,null,null)}),e[an]=null}};function nl(t){this._internalRoot=t}nl.prototype.unstable_scheduleHydration=function(t){if(t){var e=Om();t={blockedOn:null,target:t,priority:e};for(var n=0;n<An.length&&e!==0&&e<An[n].priority;n++);An.splice(n,0,t),n===0&&Nm(t)}};function $f(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function rl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function $d(){}function ZE(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=xa(o);s.call(u)}}var o=ny(e,r,t,0,null,!1,!1,"",$d);return t._reactRootContainer=o,t[an]=o.current,ws(t.nodeType===8?t.parentNode:t),pr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=xa(l);a.call(u)}}var l=Wf(t,0,!1,null,null,!1,!1,"",$d);return t._reactRootContainer=l,t[an]=l.current,ws(t.nodeType===8?t.parentNode:t),pr(function(){tl(e,l,n,r)}),l}function il(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=xa(o);a.call(l)}}tl(e,o,t,i)}else o=ZE(n,e,t,i,r);return xa(o)}Mm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Zi(e.pendingLanes);n!==0&&(df(e,n|1),qe(e,pe()),!(X&6)&&(oi=pe()+500,Yn()))}break;case 13:pr(function(){var r=ln(t,1);if(r!==null){var i=Ve();xt(r,t,1,i)}}),Yf(t,1)}};pf=function(t){if(t.tag===13){var e=ln(t,134217728);if(e!==null){var n=Ve();xt(e,t,134217728,n)}Yf(t,134217728)}};Im=function(t){if(t.tag===13){var e=Un(t),n=ln(t,e);if(n!==null){var r=Ve();xt(n,t,e,r)}Yf(t,e)}};Om=function(){return q};km=function(t,e){var n=q;try{return q=t,e()}finally{q=n}};Hu=function(t,e,n){switch(e){case"input":if(Fu(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=$a(r);if(!i)throw Error(R(90));fm(r),Fu(r,i)}}}break;case"textarea":dm(t,n);break;case"select":e=n.value,e!=null&&Yr(t,!!n.multiple,e,!1)}};Em=Vf;wm=pr;var KE={usingClientEntryPoint:!1,Events:[Us,Fr,$a,vm,_m,Vf]},Vi={findFiberByHostInstance:nr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},QE={bundleType:Vi.bundleType,version:Vi.version,rendererPackageName:Vi.rendererPackageName,rendererConfig:Vi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=bm(t),t===null?null:t.stateNode},findFiberByHostInstance:Vi.findFiberByHostInstance||qE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bo.isDisabled&&bo.supportsFiber)try{Ha=bo.inject(QE),Gt=bo}catch{}}at.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KE;at.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$f(e))throw Error(R(200));return $E(t,e,null,n)};at.createRoot=function(t,e){if(!$f(t))throw Error(R(299));var n=!1,r="",i=ry;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Wf(t,1,!1,null,null,n,!1,r,i),t[an]=e.current,ws(t.nodeType===8?t.parentNode:t),new Xf(e)};at.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(R(188)):(t=Object.keys(t).join(","),Error(R(268,t)));return t=bm(e),t=t===null?null:t.stateNode,t};at.flushSync=function(t){return pr(t)};at.hydrate=function(t,e,n){if(!rl(e))throw Error(R(200));return il(null,t,e,!0,n)};at.hydrateRoot=function(t,e,n){if(!$f(t))throw Error(R(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=ry;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=ny(e,null,t,1,n??null,i,!1,s,o),t[an]=e.current,ws(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new nl(e)};at.render=function(t,e,n){if(!rl(e))throw Error(R(200));return il(null,t,e,!1,n)};at.unmountComponentAtNode=function(t){if(!rl(t))throw Error(R(40));return t._reactRootContainer?(pr(function(){il(null,null,t,!1,function(){t._reactRootContainer=null,t[an]=null})}),!0):!1};at.unstable_batchedUpdates=Vf;at.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!rl(n))throw Error(R(200));if(t==null||t._reactInternals===void 0)throw Error(R(38));return il(t,e,n,!1,r)};at.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=at})(q_);var qd=hs;Cu.createRoot=qd.createRoot,Cu.hydrateRoot=qd.hydrateRoot;function La(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const qf=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),Zd=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Zd&&parseFloat(Zd[1]);const JE="3.3.2";function cn(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const qo=typeof process!="object"||String(process)!=="[object process]"||process.browser,ew=typeof window<"u"&&typeof window.orientation<"u",Kd=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Kd&&parseFloat(Kd[1]);function Rs(t){return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rs(t)}function tw(t,e){if(Rs(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Rs(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nw(t){var e=tw(t,"string");return Rs(e)==="symbol"?e:String(e)}function d(t,e,n){return e=nw(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class rw{constructor(e,n){d(this,"name",void 0),d(this,"workerThread",void 0),d(this,"isRunning",!0),d(this,"result",void 0),d(this,"_resolve",()=>{}),d(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){cn(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){cn(this.isRunning),this.isRunning=!1,this._reject(e)}}let Zl=class{terminate(){}};const Kl=new Map;function iw(t){cn(t.source&&!t.url||!t.source&&t.url);let e=Kl.get(t.source||t.url);return e||(t.url&&(e=sw(t.url),Kl.set(t.url,e)),t.source&&(e=iy(t.source),Kl.set(t.source,e))),cn(e),e}function sw(t){if(!t.startsWith("http"))return t;const e=ow(t);return iy(e)}function iy(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function ow(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function sy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(Qd(t))r.add(t);else if(Qd(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)sy(t[i],e,r)}}return n===void 0?Array.from(r):[]}function Qd(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const Ql=()=>{};class Sc{static isSupported(){return typeof Worker<"u"&&qo||typeof Zl<"u"&&!qo}constructor(e){d(this,"name",void 0),d(this,"source",void 0),d(this,"url",void 0),d(this,"terminated",!1),d(this,"worker",void 0),d(this,"onMessage",void 0),d(this,"onError",void 0),d(this,"_loadableURL","");const{name:n,source:r,url:i}=e;cn(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=Ql,this.onError=s=>console.log(s),this.worker=qo?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Ql,this.onError=Ql,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||sy(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=iw({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Zl(r,{eval:!1})}else if(this.source)e=new Zl(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class aw{static isSupported(){return Sc.isSupported()}constructor(e){d(this,"name","unnamed"),d(this,"source",void 0),d(this,"url",void 0),d(this,"maxConcurrency",1),d(this,"maxMobileConcurrency",1),d(this,"onDebug",()=>{}),d(this,"reuseWorkers",!0),d(this,"props",{}),d(this,"jobQueue",[]),d(this,"idleQueue",[]),d(this,"count",0),d(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,o,a)=>s.done(a),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,o)=>s.error(o);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new rw(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Sc({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return ew?this.maxMobileConcurrency:this.maxConcurrency}}const lw={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class tn{static isSupported(){return Sc.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return tn._workerFarm=tn._workerFarm||new tn({}),tn._workerFarm.setProps(e),tn._workerFarm}constructor(e){d(this,"props",void 0),d(this,"workerPools",new Map),this.props={...lw},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new aw({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}d(tn,"_workerFarm",void 0);const uw="latest";function cw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=uw);const o=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(r)}return cn(i),i}function fw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:JE;cn(t,"no worker provided");const n=t.version;return!(!e||!n)}function hw(t,e){return!tn.isSupported()||!qo&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function dw(t,e,n,r,i){const s=t.id,o=cw(t,n),l=tn.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const u=await l.startJob("process-on-worker",pw.bind(null,i));return u.postMessage("process",{input:e,options:n,context:r}),await(await u.result).result}async function pw(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:l})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function gw(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function mw(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),i=r.reduce((a,l)=>a+l.byteLength,0),s=new Uint8Array(i);let o=0;for(const a of r)s.set(a,o),o+=a.byteLength;return s.buffer}async function yw(t){const e=[];for await(const n of t)e.push(n);return mw(...e)}function Jd(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class ep{constructor(e,n){d(this,"name",void 0),d(this,"type",void 0),d(this,"sampleSize",1),d(this,"time",void 0),d(this,"count",void 0),d(this,"samples",void 0),d(this,"lastTiming",void 0),d(this,"lastSampleTime",void 0),d(this,"lastSampleCount",void 0),d(this,"_count",0),d(this,"_time",0),d(this,"_samples",0),d(this,"_startTime",0),d(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Jd(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Jd()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Zf{constructor(e){d(this,"id",void 0),d(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof ep?this.stats[n]=e:this.stats[n]=new ep(n,r)),this.stats[n]}}let vw="";const tp={};function _w(t){for(const e in tp)if(t.startsWith(e)){const n=tp[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(vw).concat(t)),t}function Ew(t){return t&&typeof t=="object"&&t.isBuffer}function oy(t){if(Ew(t))return(void 0)(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function ww(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}const Tw=t=>typeof t=="boolean",us=t=>typeof t=="function",zs=t=>t!==null&&typeof t=="object",np=t=>zs(t)&&t.constructor==={}.constructor,Sw=t=>t&&typeof t[Symbol.iterator]=="function",bw=t=>t&&typeof t[Symbol.asyncIterator]=="function",Ti=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Si=t=>typeof Blob<"u"&&t instanceof Blob,Aw=t=>t&&typeof t=="object"&&t.isBuffer,Pw=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||zs(t)&&us(t.tee)&&us(t.cancel)&&us(t.getReader),xw=t=>zs(t)&&us(t.read)&&us(t.pipe)&&Tw(t.readable),ay=t=>Pw(t)||xw(t),Lw=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Cw=/^([-\w.]+\/[-\w.+]+)/;function Rw(t){const e=Cw.exec(t);return e?e[1]:t}function rp(t){const e=Lw.exec(t);return e?e[1]:""}const Mw=/\?.*/;function sl(t){if(Ti(t)){const e=Jl(t.url||""),n=t.headers.get("content-type")||"";return{url:e,type:Rw(n)||rp(e)}}return Si(t)?{url:Jl(t.name||""),type:t.type||""}:typeof t=="string"?{url:Jl(t),type:rp(t)}:{url:"",type:""}}function Iw(t){return Ti(t)?t.headers["content-length"]||-1:Si(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function Jl(t){return t.replace(Mw,"")}async function ly(t){if(Ti(t))return t;const e={},n=Iw(t);n>=0&&(e["content-length"]=String(n));const{url:r,type:i}=sl(t);i&&(e["content-type"]=i);const s=await Nw(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function Ow(t){if(!t.ok){const e=await kw(t);throw new Error(e)}}async function kw(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function Nw(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r(s==null||(o=s.target)===null||o===void 0?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=Dw(n);return"data:base64,".concat(r)}return null}function Dw(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function ip(t,e){if(typeof t=="string"){t=_w(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await ly(t)}function uy(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function pn(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||uy()}const Zo={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Ao=Zo.window||Zo.self||Zo.global,ji=Zo.process||{},cy=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";pn();const eu=globalThis;function fy(t){if(!t&&!pn())return"Node";if(uy(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":eu.chrome?"Chrome":eu.safari?"Safari":eu.mozInnerScreenX?"Firefox":"Unknown"}function Fw(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class Uw{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";d(this,"storage",void 0),d(this,"id",void 0),d(this,"config",void 0),this.storage=Fw(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function Bw(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function zw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function tu(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Ca;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ca||(Ca={}));function sp(t){return typeof t=="string"?Ca[t.toUpperCase()]||Ca.WHITE:t}function Vw(t,e,n){return!pn&&typeof t=="string"&&(e&&(e=sp(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=sp(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function jw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function Ra(t,e){if(!t)throw new Error(e||"Assertion failed")}function Ar(){let t;if(pn&&"performance"in Ao){var e,n;t=Ao==null||(e=Ao.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in ji){var r;const i=ji==null||(r=ji.hrtime)===null||r===void 0?void 0:r.call(ji);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Pr={debug:pn&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Gw={enabled:!0,level:0};function ft(){}const op={},ap={once:!0};class Vs{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};d(this,"id",void 0),d(this,"VERSION",cy),d(this,"_startTs",Ar()),d(this,"_deltaTs",Ar()),d(this,"_storage",void 0),d(this,"userData",{}),d(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new Uw("__probe-".concat(this.id,"__"),Gw),this.timeStamp("".concat(this.id," started")),jw(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Ar()-this._startTs).toPrecision(10))}getDelta(){return Number((Ar()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Ra(e,n)}warn(e){return this._getLogFunction(0,e,Pr.warn,arguments,ap)}error(e){return this._getLogFunction(0,e,Pr.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Pr.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Pr.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Pr.debug||Pr.info,arguments,ap)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||ft,r&&[r],{tag:Xw(n)}):ft}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?pn?Yw({image:i,message:s,scale:o}):Ww():ft}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||ft)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=lp({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||ft)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=hy(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=lp({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,Ra(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Ar();const o=s.tag||s.message;if(s.once)if(!op[o])op[o]=Ar();else return ft;return n=Hw(this.id,s.message,s),r.bind(console,n,...s.args)}return ft}}d(Vs,"VERSION",cy);function hy(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Ra(Number.isFinite(e)&&e>=0),e}function lp(t){const{logLevel:e,message:n}=t;t.logLevel=hy(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return Ra(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function Hw(t,e,n){if(typeof e=="string"){const r=n.time?zw(Bw(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=Vw(e,n.color,n.background)}return e}function Ww(t){return console.warn("removed"),ft}function Yw(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=tu(s,n,r);console.log(...o)},s.src=e,ft}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...tu(e,n,r)),ft;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...tu(s,n,r)),s.src=e.toDataURL(),ft}return ft}function Xw(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const up=new Vs({id:"loaders.gl"});class $w{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class qw{constructor(){d(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const dy={fetch:null,mimeType:void 0,nothrow:!1,log:new qw,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:qf,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Zw={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function py(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const gy=()=>{const t=py();return t.globalOptions=t.globalOptions||{...dy},t.globalOptions};function Kw(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],Qw(t,n),eT(e,t,r)}function my(t,e){const n=gy(),r=t||n;return typeof r.fetch=="function"?r.fetch:zs(r.fetch)?i=>ip(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:ip}function Qw(t,e){cp(t,null,dy,Zw,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};cp(r,n.id,i,s,e)}}function cp(t,e,n,r,i){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const l=!e&&zs(t[a]),u=a==="baseUri"&&!e,c=a==="workerUrl"&&e;if(!(a in n)&&!u&&!c){if(a in r)up.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const f=Jw(a,i);up.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(f))()}}}}function Jw(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function eT(t,e,n){const i={...t.options||{}};return tT(i,n),i.log===null&&(i.log=new $w),fp(i,gy()),fp(i,e),i}function fp(t,e){for(const n in e)if(n in e){const r=e[n];np(r)&&np(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function tT(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function Kf(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function Qf(t){var e,n;La(t,"null loader"),La(Kf(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const yy=()=>{const t=py();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function nT(t){const e=yy();t=Array.isArray(t)?t:[t];for(const n of t){const r=Qf(n);e.find(i=>r===i)||e.unshift(r)}}function rT(){return yy()}const iT=new Vs({id:"loaders.gl"}),sT=/\.([^.]+)$/;async function oT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!vy(t))return null;let i=hp(t,e,{...n,nothrow:!0},r);if(i)return i;if(Si(t)&&(t=await t.slice(0,10).arrayBuffer(),i=hp(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(_y(t));return i}function hp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!vy(t))return null;if(e&&!Array.isArray(e))return Qf(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...rT()),lT(i);const s=aT(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(_y(t));return s}function aT(t,e,n,r){const{url:i,type:s}=sl(t),o=i||(r==null?void 0:r.url);let a=null,l="";if(n!=null&&n.mimeType&&(a=nu(e,n==null?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),a=a||uT(e,o),l=l||(a?"matched url ".concat(o):""),a=a||nu(e,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||fT(e,t),l=l||(a?"matched initial data ".concat(Ey(t)):""),a=a||nu(e,n==null?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""),l){var u;iT.log(1,"selectLoader selected ".concat((u=a)===null||u===void 0?void 0:u.name,": ").concat(l,"."))}return a}function vy(t){return!(t instanceof Response&&t.status===204)}function _y(t){const{url:e,type:n}=sl(t);let r="No valid loader found (";r+=e?"".concat(ww(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?Ey(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function lT(t){for(const e of t)Qf(e)}function uT(t,e){const n=e&&sT.exec(e),r=n&&n[1];return r?cT(t,r):null}function cT(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function nu(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function fT(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(hT(e,n))return n}else if(ArrayBuffer.isView(e)){if(dp(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&dp(e,0,n))return n;return null}function hT(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function dp(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>dT(t,e,n,i))}function dT(t,e,n,r){if(r instanceof ArrayBuffer)return gw(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=bc(t,e,r.length);return r===i;default:return!1}}function Ey(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?bc(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?bc(t,0,e):""}function bc(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const pT=256*1024;function*gT(t,e){const n=(e==null?void 0:e.chunkSize)||pT;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const mT=256*1024;function*yT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{chunkSize:n=mT}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}const vT=1024*1024;async function*_T(t,e){const n=(e==null?void 0:e.chunkSize)||vT;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function pp(t,e){return qf?ET(t,e):wT(t)}async function*ET(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield oy(o)}}catch{n.releaseLock()}}async function*wT(t,e){for await(const n of t)yield oy(n)}function TT(t,e){if(typeof t=="string")return gT(t,e);if(t instanceof ArrayBuffer)return yT(t,e);if(Si(t))return _T(t,e);if(ay(t))return pp(t,e);if(Ti(t))return pp(t.body,e);throw new Error("makeIterator")}const wy="Cannot convert supplied data type";function ST(t,e,n){if(e.text&&typeof t=="string")return t;if(Aw(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(wy)}async function bT(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return ST(t,e);if(Si(t)&&(t=await ly(t)),Ti(t)){const i=t;return await Ow(i),e.binary?await i.arrayBuffer():await i.text()}if(ay(t)&&(t=TT(t,n)),Sw(t)||bw(t))return yw(t);throw new Error(wy)}function AT(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(n)return n;const r={fetch:my(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}function PT(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function Jf(t,e,n,r){cn(!r||typeof r=="object"),e&&!Array.isArray(e)&&!Kf(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:i}=sl(t),o=PT(e,r),a=await oT(t,o,n);return a?(n=Kw(n,a,o,i),r=AT({url:i,parse:Jf,loaders:o},n,r),await xT(a,t,n,r)):null}async function xT(t,e,n,r){if(fw(t),Ti(e)){const i=e,{ok:s,redirected:o,status:a,statusText:l,type:u,url:c}=i,f=Object.fromEntries(i.headers.entries());r.response={headers:f,ok:s,redirected:o,status:a,statusText:l,type:u,url:c}}if(e=await bT(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(hw(t,n))return await dw(t,e,n,r,Jf);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw cn(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Ac(t,e,n,r){!Array.isArray(e)&&!Kf(e)&&(n=e,e=void 0);const i=my(n);let s=t;return typeof t=="string"&&(s=await i(t)),Si(t)&&(s=await i(t)),await Jf(s,e,n)}const LT="3.3.2",{_parseImageNode:CT}=globalThis,Pc=typeof Image<"u",xc=typeof ImageBitmap<"u",RT=!!CT,Lc=qf?!0:RT;function MT(t){switch(t){case"auto":return xc||Pc||Lc;case"imagebitmap":return xc;case"image":return Pc;case"data":return Lc;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function IT(){if(xc)return"imagebitmap";if(Pc)return"image";if(Lc)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function OT(t){const e=NT(t);if(!e)throw new Error("Not an image");return e}function kT(t){switch(OT(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function NT(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const DT=/^data:image\/svg\+xml/,FT=/\.svg((\?|#).*)?$/;function eh(t){return t&&(DT.test(t)||FT.test(t))}function UT(t,e){if(eh(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return Ty(t,e)}function Ty(t,e){if(eh(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Sy(t,e,n){const r=UT(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await BT(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function BT(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const zT={};let gp=!0;async function VT(t,e,n){let r;eh(n)?r=await Sy(t,e,n):r=Ty(t,n);const i=e&&e.imagebitmap;return await jT(r,i)}async function jT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((GT(e)||!gp)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),gp=!1}return await createImageBitmap(t)}function GT(t){for(const e in t||zT)return!1;return!0}const zt=!1,cs=!0;function by(t){const e=js(t);return HT(e)||XT(e)||WT(e)||YT(e)}function HT(t){const e=js(t);return e.byteLength>=24&&e.getUint32(0,zt)===2303741511?{mimeType:"image/png",width:e.getUint32(16,zt),height:e.getUint32(20,zt)}:null}function WT(t){const e=js(t);return e.byteLength>=10&&e.getUint32(0,zt)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,cs),height:e.getUint16(8,cs)}:null}function YT(t){const e=js(t);return e.byteLength>=14&&e.getUint16(0,zt)===16973&&e.getUint32(2,cs)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,cs),height:e.getUint32(22,cs)}:null}function XT(t){const e=js(t);if(!(e.byteLength>=3&&e.getUint16(0,zt)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=$T();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,zt);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,zt),width:e.getUint16(s+7,zt)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,zt)}return null}function $T(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function js(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function qT(t,e){const{mimeType:n}=by(t)||{},r=globalThis._parseImageNode;return La(r),await r(t,n)}async function ZT(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=KT(i);let a;switch(o){case"imagebitmap":a=await VT(t,e,s);break;case"image":a=await Sy(t,e,s);break;case"data":a=await qT(t);break;default:La(!1)}return i==="data"&&(a=kT(a)),a}function KT(t){switch(t){case"auto":case"data":return IT();default:return MT(t),t}}const QT=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],JT=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],eS={image:{type:"auto",decode:!0}},tS={id:"image",module:"images",name:"Images",version:LT,mimeTypes:JT,extensions:QT,parse:ZT,tests:[t=>!!by(new DataView(t))],options:eS},K=new Vs({id:"deck"});let Cc={};function nS(t){Cc=t}function Ue(t,e,n,r){K.level>0&&Cc[t]&&Cc[t].call(null,e,n,r)}function rS(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const iS={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:rS,parseTextSync:JSON.parse};function sS(){const t="8.9.7",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(K.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:K,_registerLoggers:nS},nT([iS,[tS,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const oS=sS(),$={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty($,"IDENTITY",{get:()=>(K.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Vt={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Rc={common:0,meters:1,pixels:2},mp={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},B=new Vs({id:"luma.gl"});function Be(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const aS="Invalid WebGLRenderingContext",lS="Requires WebGL2";function ol(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function H(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function uS(t){return H(t)?t:null}function al(t){return Be(ol(t),aS),t}function ze(t){return Be(H(t),lS),t}const Qi={};function cS(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function fS(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function hS(t,e){Qi[t]=!0,e!==void 0&&cS(e)}function dS(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Qi[r]=!0);while(r!==0);for(r in Qi)if(Qi[r])return delete Qi[r],parseInt(r,10);return 0}}const Gs=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Gs.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Gs.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const _r=function(e){const n=this;this.gl=e,dS(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=n.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,u,c){const f=n.currentVertexArrayObject;f.maxAttrib=Math.max(f.maxAttrib,s);const h=f.attribs[s];return h.buffer=n.currentArrayBuffer,h.size=o,h.type=a,h.normalized=l,h.stride=u,h.offset=c,h.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{fS("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};_r.prototype.VERTEX_ARRAY_BINDING_OES=34229;_r.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Gs(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};_r.prototype.createVertexArrayOES=function(){const e=new Gs(this);return this.vertexArrayObjects.push(e),e};_r.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};_r.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Gs&&e.hasBeenBound&&e.ext===this)};_r.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){hS(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const u=s.attribs[l],c=i?i.attribs[l]:null;if((!i||u.enabled!==c.enabled)&&(u.enabled?r.enableVertexAttribArray.call(n,l):r.disableVertexAttribArray.call(n,l)),u.enabled){let f=!1;(!i||u.buffer!==c.buffer)&&(o!==u.buffer&&(r.bindBuffer.call(n,34962,u.buffer),o=u.buffer),f=!0),(f||u.cached!==c.cached)&&r.vertexAttribPointer.call(n,l,u.size,u.type,u.normalized,u.stride,u.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function pS(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new _r(this)),this.__OESVertexArrayObject))}}const yp="OES_element_index",vp="WEBGL_draw_buffers",gS="EXT_disjoint_timer_query",mS="EXT_disjoint_timer_query_webgl2",yS="EXT_texture_filter_anisotropic",_p="WEBGL_debug_renderer_info",vS=35723,_S=4352,ES=36795,wS=34047,TS=37445,SS=37446,Q=t=>H(t)?void 0:0,bS={[3074]:t=>H(t)?void 0:36064,[vS]:t=>H(t)?void 0:_S,[35977]:Q,[32937]:Q,[ES]:(t,e)=>{const n=H(t)?t.getExtension(mS):t.getExtension(gS);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[TS]:(t,e)=>{const n=t.getExtension(_p);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[SS]:(t,e)=>{const n=t.getExtension(_p);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[wS]:(t,e)=>{const n=t.luma.extensions[yS];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:Q,[35071]:Q,[37447]:Q,[36063]:(t,e)=>{if(!H(t)){const n=t.getExtension(vp);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:Q,[35374]:Q,[35377]:Q,[34852]:t=>{if(!H(t)){const e=t.getExtension(vp);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(yp)?2147483647:65535,[33001]:t=>t.getExtension(yp)?16777216:65535,[33e3]:t=>16777216,[37157]:Q,[35373]:Q,[35657]:Q,[36183]:Q,[37137]:Q,[34045]:Q,[35978]:Q,[35979]:Q,[35968]:Q,[35376]:Q,[35375]:Q,[35659]:Q,[37154]:Q,[35371]:Q,[35658]:Q,[35076]:Q,[35077]:Q,[35380]:Q};function AS(t,e,n){const r=bS[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const PS="OES_vertex_array_object",Ay="ANGLE_instanced_arrays",xS="WEBGL_draw_buffers",LS="EXT_disjoint_timer_query",CS="EXT_texture_filter_anisotropic",RS="VertexArray requires WebGL2 or OES_vertex_array_object extension";function MS(t,e){return{webgl2:H(t),ext:t.getExtension(e)}}const Py={[PS]:{meta:{suffix:"OES"},createVertexArray:()=>{Be(!1,RS)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[Ay]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Be(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[xS]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Be(!1)}},[LS]:{meta:{suffix:"EXT"},createQuery:()=>{Be(!1)},deleteQuery:()=>{Be(!1)},beginQuery:()=>{Be(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},ru={readBuffer:(t,e,n)=>{H(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=MS(t,Ay);let o;switch(r){case 35069:o=i?void 0:!1;break;case 35070:o=!i&&!s?0:void 0;break}return o!==void 0?o:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!H(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!H(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[CS];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:AS,hint(t,e,n,r){return e(n,r)}};function IS(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(pS(t),OS(t),NS(t,Py),kS(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=IS;function OS(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function kS(t,e){let{target:n,target2:r}=e;Object.keys(ru).forEach(i=>{if(typeof ru[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},o=ru[i].bind(null,t,s);n[i]=o,r[i]=o}})}function NS(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&DS(t,{extension:n,target:t.luma,target2:t})}function DS(t,e){let{extension:n,target:r,target2:i}=e;const s=Py[n];Be(s);const{meta:o={}}=s,{suffix:a=""}=o,l=t.getExtension(n);for(const u of Object.keys(s)){const c="".concat(u).concat(a);let f=null;u==="meta"||typeof t[u]=="function"||(l&&typeof l[c]=="function"?f=function(){return l[c](...arguments)}:typeof s[u]=="function"&&(f=s[u].bind(r))),f&&(r[u]=f,i[u]=f)}}const th={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},vn=(t,e,n)=>e?t.enable(n):t.disable(n),Ep=(t,e,n)=>t.hint(n,e),Ze=(t,e,n)=>t.pixelStorei(n,e),FS=(t,e)=>{const n=H(t)?36009:36160;return t.bindFramebuffer(n,e)},US=(t,e)=>t.bindFramebuffer(36008,e);function Gi(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const BS={[3042]:vn,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:vn,[2885]:(t,e)=>t.cullFace(e),[2929]:vn,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:vn,[35723]:Ep,[36006]:FS,[2886]:(t,e)=>t.frontFace(e),[33170]:Ep,[2849]:(t,e)=>t.lineWidth(e),[32823]:vn,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:vn,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:vn,[3088]:(t,e)=>t.scissor(...e),[2960]:vn,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:Ze,[3317]:Ze,[37440]:Ze,[37441]:Ze,[37443]:Ze,[3330]:Ze,[3332]:Ze,[3331]:Ze,[36010]:US,[3314]:Ze,[32878]:Ze,[3316]:Ze,[3315]:Ze,[32877]:Ze,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Gi(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Gi(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Gi(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Gi(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=Gi(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function he(t,e,n){return e[t]!==void 0?e[t]:n[t]}const zS={blendEquation:(t,e,n)=>t.blendEquationSeparate(he(32777,e,n),he(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(he(32969,e,n),he(32968,e,n),he(32971,e,n),he(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(he(32824,e,n),he(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(he(32938,e,n),he(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,he(2962,e,n),he(2967,e,n),he(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,he(34816,e,n),he(36003,e,n),he(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,he(2964,e,n),he(2965,e,n),he(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,he(34817,e,n),he(34818,e,n),he(34819,e,n))},wp={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,r,i)=>t({[32773]:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,r,i)=>t({[32969]:e,[32968]:n,[32971]:r,[32970]:i}),clearColor:(t,e,n,r,i)=>t({[3106]:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,r,i)=>t({[3107]:[e,n,r,i]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,r,i)=>t({[3088]:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({[2962]:e,[2967]:n,[2963]:r,[34816]:e,[36003]:n,[36004]:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({[2964]:e,[2965]:n,[2966]:r,[34817]:e,[34818]:n,[34819]:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({[2978]:[e,n,r,i]})},Nt=(t,e)=>t.isEnabled(e),Tp={[3042]:Nt,[2884]:Nt,[2929]:Nt,[3024]:Nt,[32823]:Nt,[32926]:Nt,[32928]:Nt,[3089]:Nt,[2960]:Nt,[35977]:Nt};function xy(t){for(const e in t)return!1;return!0}function VS(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function Sp(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function jS(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:l,oldValue:u}=n(t.state._updateCache,...o);return l&&r(...o),u},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function GS(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class HS{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?YS(e):Object.assign({},th),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Be(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];fn(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Be(s!==void 0);const o=e[s],a=this.cache[s];VS(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function Ly(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Be(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new HS(t,{copyState:r}),GS(t);for(const s in wp){const o=wp[s];jS(t,s,o)}Sp(t,"getParameter"),Sp(t,"isEnabled")}return t.state.enable=n,t}function WS(t){t.state||Ly(t,{copyState:!1}),t.state.push()}function bp(t){Be(t.state),t.state.pop()}function fn(t,e){if(Be(ol(t),"setParameters requires a WebGL context"),xy(e))return;const n={};for(const i in e){const s=Number(i),o=BS[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=zS[i];s(t,e,r)}}function YS(t,e){if(e=e||th,typeof e=="number"){const i=e,s=Tp[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=Tp[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function XS(t){fn(t,th)}function Lt(t,e,n){if(xy(e))return n(t);const{nocatch:r=!0}=e;WS(t),fn(t,e);let i;if(r)i=n(t),bp(t);else try{i=n(t)}finally{bp(t)}return i}function ai(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function iu(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=ai(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return qS(e,r,i,s,n)}function $S(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function qS(t,e,n,r,i){const s=Ap(t[0],e,n);let o=Pp(t[1],e,r,i),a=Ap(t[0]+1,e,n);const l=a===n-1?a:a-1;a=Pp(t[1]+1,e,r,i);let u;return i?(a=a===0?a:a+1,u=o,o=a):u=a===r-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(u-o+1,1)}}function Ap(t,e,n){return Math.min(Math.round(t*e),n-1)}function Pp(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const nh=pn(),ZS=nh&&typeof document<"u",Cy={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function Ry(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(nh,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},Cy,t);const{width:e,height:n}=t;function r(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=r;let i;const{canvas:s}=t,o=eb({canvas:s,width:e,height:n,onError:r});return i=JS(o,t),i?(i=rh(i,t),tb(i),i):null}function rh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||nb(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},Cy,e);const{manageState:n,debug:r}=e;return n&&Ly(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return B.log(1,...s)()}}),nh&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),B.level=Math.max(B.level,1)):B.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function KS(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function QS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=$S(e.useDevicePixels);rb(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function JS(t,e){const{onError:n}=e;let r=null;const i=l=>r=l.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function eb(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(ZS&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function tb(t){const e=H(t)?"WebGL2":"WebGL1",n=KS(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";B.info(1,"".concat(e).concat(i," context ").concat(r))()}function nb(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function rb(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(B.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),l=Math.floor(i*o);t.canvas.width=a,t.canvas.height=l,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==l)&&(B.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*o),t.canvas.height=Math.floor(i*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}const fs="8.5.19",ib="set luma.log.level=1 (or higher) to trace rendering";class sb{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new Zf({id:e})),this.stats.get(e)}}const sr=new sb;if(globalThis.luma&&globalThis.luma.VERSION!==fs)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(fs));globalThis.luma||(pn()&&B.log(1,"luma.gl ".concat(fs," - ").concat(ib))(),globalThis.luma=globalThis.luma||{VERSION:fs,version:fs,log:B,stats:sr,globals:{modules:{},nodeIO:{}}});function ob(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function ab(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function N(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function su(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return N(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function zn(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const ou={};function Gn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";ou[t]=ou[t]||1;const e=ou[t]++;return"".concat(t,"-").concat(e)}function xp(t){return N(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function li(t){let e=!0;for(const n in t){e=!1;break}return e}function My(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(o=>{s.methodName||(s[o]=()=>{throw B.removed("Calling removed method ".concat(e,".").concat(o,": "),i)(),new Error(o)})})}const xr="Resource subclass must define virtual methods";let gn=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};al(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||Gn(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=su(this.gl,e),N(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=H(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const a=i.webgl1,l="webgl2"in i?i.webgl2:i.webgl1;return s?l:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=H(this.gl),o={},a=n||Object.keys(i);for(const l of a){const u=i[l];if(u&&(!("webgl2"in u)||s)&&(!("extension"in u)||this.gl.getExtension(u.extension))){const f=r?zn(this.gl,l):l;o[f]=this.getParameter(l,e),r&&u.type==="GLenum"&&(o[f]=zn(this.gl,o[f]))}}return o}setParameter(e,n){e=su(this.gl,e),N(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=H(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=su(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return My(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(xr)}_deleteHandle(){throw new Error(xr)}_bindHandle(e){throw new Error(xr)}_getOptsFromHandle(){throw new Error(xr)}_getParameter(e,n){throw new Error(xr)}_setParameter(e,n){throw new Error(xr)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=sr.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];sr.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=sr.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=sr.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const lb="Failed to deduce GL constant from typed array";function Mc(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(lb)}}function Ms(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function ub(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const o=n*i;s=s||new Uint8Array(o);for(let a=0;a<r/2;++a){const l=a*o,u=(r-a-1)*o;s.set(e.subarray(l,l+o)),e.copyWithin(l,u,u+o),e.set(s,u)}}function cb(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),o=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let l=0;l<i;l++)for(let u=0;u<4;u++)o[(a*i+l)*4+u]=e[(a*2*n+l*2)*4+u];return{data:o,width:i,height:s}}function Ic(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const u=r[a]?"".concat(t,".").concat(r[a]):"N/A";B.removed("".concat(t,".").concat(a),u)()}for(const a in i)if(a in e){const l=i[a];B.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))()}let o=null;for(const a in s)if(a in e){const l=s[a];B.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const fb={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},hb={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class tt{static getBytesPerElement(e){return Ms(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return N(e.size),Ms(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new tt(fb,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return tt.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return tt.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=Ic("Accessor",e,hb),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const Lp=10,Iy={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},db={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Iy},pb={removedProps:Iy};class Z extends gn{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/tt.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/tt.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=Ic("Buffer",e,db),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=Ic("Buffer",e,pb),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new tt(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;N(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),i!==0||s!==void 0?(ze(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(o,r,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:o}=this;return ze(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,r,i,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ze(this.gl);const s=Ms(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=r;let l,u;e?(u=e.length,l=u-a):(l=Math.min(o,i||o),u=a+l);const c=Math.min(o,l);return i=i||c,N(i<=c),e=e||new s(u),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(N(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(Lp,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;N(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,Lp),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=Mc(e);return N(s),this.setAccessor(new tt(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;N(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Ms(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new tt(this.accessor,{type:Mc(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return B.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return B.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return B.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return B.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new tt(this.accessor,e),this}}const ih={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},Oy={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},ky={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function gb(t,e){const n=ih[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=H(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function mb(t,e){const n=ih[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const yb=[9729,9728],Cp=globalThis.WebGLBuffer||function(){};class ui extends gn{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&gb(e,r),s=s&&(!i||mb(e,r))),s}constructor(e,n){const{id:r=Gn("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(g=>this.initialize(Object.assign({},e,{pixels:g,data:g}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:u={},textureUnit:c=void 0}=e;n||(n=i);let{width:f,height:h,dataFormat:m,type:E,compressed:w=!1,mipmaps:b=!0}=e;const{depth:v=0}=e;return{width:f,height:h,compressed:w,dataFormat:m,type:E}=this._deduceParameters({format:s,type:E,dataFormat:m,compressed:w,data:n,width:f,height:h}),this.width=f,this.height=h,this.depth=v,this.format=s,this.type=E,this.dataFormat=m,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),b&&this._isNPOT()&&(B.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),b=!1,this._updateForNPOT(l)),this.mipmaps=b,this.setImageData({data:n,width:f,height:h,depth:v,format:s,type:E,dataFormat:m,border:o,mipmaps:b,parameters:u,compressed:w}),b&&this.generateMipmap(),this.setParameters(l),a&&(this.data=n),r&&(this._video={video:n,parameters:l,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(B.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Lt(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:u=null,type:c=this.type,width:f=this.width,height:h=this.height,dataFormat:m=this.dataFormat,compressed:E=!1}=e;u||(u=r),{type:c,dataFormat:m,compressed:E,width:f,height:h}=this._deduceParameters({format:s,type:c,dataFormat:m,compressed:E,data:u,width:f,height:h});const{gl:w}=this;w.bindTexture(this.target,this.handle);let b=null;({data:u,dataType:b}=this._getDataType({data:u,compressed:E}));let v,g=0;if(Lt(this.gl,l,()=>{switch(b){case"null":w.texImage2D(n,i,s,f,h,o,m,c,u);break;case"typed-array":w.texImage2D(n,i,s,f,h,o,m,c,u,a);break;case"buffer":v=ze(w),v.bindBuffer(35052,u.handle||u),v.texImage2D(n,i,s,f,h,o,m,c,a),v.bindBuffer(35052,null);break;case"browser-object":H(w)?w.texImage2D(n,i,s,f,h,o,m,c,u):w.texImage2D(n,i,s,m,c,u);break;case"compressed":for(const[_,S]of u.entries())w.compressedTexImage2D(n,_,S.format,S.width,S.height,o,S.data),g+=S.levelSize;break;default:N(!1,"Unknown image data type")}}),b==="compressed")this._trackAllocatedMemory(g,"Texture");else if(u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const _=Oy[this.dataFormat]||4,S=ky[this.type]||1;this._trackAllocatedMemory(this.width*this.height*_*S,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:l=this.height,level:u=0,format:c=this.format,type:f=this.type,dataFormat:h=this.dataFormat,compressed:m=!1,offset:E=0,border:w=this.border,parameters:b={}}=e;if({type:f,dataFormat:h,compressed:m,width:a,height:l}=this._deduceParameters({format:c,type:f,dataFormat:h,compressed:m,data:i,width:a,height:l}),N(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const v=i;i=v.data,a=v.shape[0],l=v.shape[1]}i instanceof Z&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Lt(this.gl,b,()=>{if(m)this.gl.compressedTexSubImage2D(n,u,s,o,a,l,c,i);else if(i===null)this.gl.texSubImage2D(n,u,s,o,a,l,h,f,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,u,s,o,a,l,h,f,i,E);else if(i instanceof Cp){const v=ze(this.gl);v.bindBuffer(35052,i),v.texSubImage2D(n,u,s,o,a,l,h,f,E),v.bindBuffer(35052,null)}else H(this.gl)?ze(this.gl).texSubImage2D(n,u,s,o,a,l,h,f,i):this.gl.texSubImage2D(n,u,s,o,h,f,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return B.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof Z?{data:n.handle,dataType:"buffer"}:n instanceof Cp?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:o,type:a,compressed:l}=e;const u=ih[n];return o=o||u&&u.dataFormat,a=a||u&&u.types[0],l=l||u&&u.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:o,type:a,compressed:l,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},N(i,"Could not deduced texture size"),N(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),N(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:N(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return H(this.gl)||!this.width||!this.height?!1:!xp(this.width)||!xp(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:yb.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let vb="";function _b(t,e){return N(typeof t=="string"),t=vb+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class Rt extends ui{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return ui.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};al(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:_b(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const Oc=[34069,34070,34071,34072,34073,34074];class Ny extends ui{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};al(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:o=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:o})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:o=0,format:a=6408,type:l=5121}=e;const{gl:u}=this,c=i||s,f=await Promise.all(Oc.map(h=>{const m=c[h];return Promise.all(Array.isArray(m)?m:[m])}));this.bind(),Oc.forEach((h,m)=>{f[m].length>1&&this.opts.mipmaps!==!1&&B.warn("".concat(this.id," has mipmap and multiple LODs."))(),f[m].forEach((E,w)=>{n&&r?u.texImage2D(h,w,a,n,r,o,a,l,E):u.texImage2D(h,w,a,a,l,E)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:o,border:a=0,format:l=6408,type:u=5121}=e,{gl:c}=this,f=s||o;return this.bind(),f instanceof Promise?f.then(h=>this.setImageDataForFace(Object.assign({},e,{face:n,data:h,pixels:h}))):this.width||this.height?c.texImage2D(n,0,l,r,i,a,l,u,f):c.texImage2D(n,0,l,l,u,f),this}}Ny.FACES=Oc;class Eb extends ui{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return H(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ze(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:o=1,border:a=0,format:l,type:u=5121,offset:c=0,data:f,parameters:h={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Lt(this.gl,h,()=>{ArrayBuffer.isView(f)&&this.gl.texImage3D(this.target,n,r,i,s,o,a,l,u,f),f instanceof Z&&(this.gl.bindBuffer(35052,f.handle),this.gl.texImage3D(this.target,n,r,i,s,o,a,l,u,c))}),f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const m=Oy[this.dataFormat]||4,E=ky[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*m*E,"Texture")}return this.loaded=!0,this}}const Zn="EXT_color_buffer_float",Rp={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:Zn,bpp:2},[33327]:{gl2:Zn,bpp:4},[34842]:{gl2:Zn,bpp:8},[33326]:{gl2:Zn,bpp:4},[33328]:{gl2:Zn,bpp:8},[34836]:{gl2:Zn,bpp:16},[35898]:{gl2:Zn,bpp:4}};function wb(t,e,n){const r=n[e];if(!r)return!1;const i=H(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class Hr extends gn{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||wb(e,n,Rp)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return N(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&H(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Rp[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const Tb=256,Sb=1024,bb=16384,Mp=6144,Ip=6145,Op=6146,kp=34041,Dy="clear: bad arguments";function sh(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=bb,n!==!0&&(s.clearColor=n)),r&&(o|=Tb,r!==!0&&(s.clearDepth=r)),i&&(o|=Sb,r!==!0&&(s.clearStencil=r)),N(o!==0,Dy),Lt(t,s,()=>{t.clear(o)})}function Ab(t){let{framebuffer:e=null,buffer:n=Mp,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ze(t),Lt(t,{framebuffer:e},()=>{switch(n){case Mp:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case Ip:t.clearBufferfv(Ip,0,[i]);break;case Op:t.clearBufferiv(Op,0,[i]);break;case kp:const[s,o]=i;t.clearBufferfi(kp,0,s,o);break;default:N(!1,Dy)}})}function Pb(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return N(!1),0}}function ll(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:u}=e;const{framebuffer:c,deleteFramebuffer:f}=xb(t);N(c);const{gl:h,handle:m,attachments:E}=c;a=a||c.width,l=l||c.height,s===36064&&m===null&&(s=1028),N(E[s]),u=u||E[s].type,o=Lb(o,u,i,a,l),u=u||Mc(o);const w=h.bindFramebuffer(36160,m);return h.readPixels(n,r,a,l,i,u,o),h.bindFramebuffer(36160,w||null),f&&c.delete(),o}function Np(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=ll(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=cb({data:r,width:i,height:s}));ub({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),l=a.createImageData(i,s);return l.data.set(r),a.putImageData(l,0,0),o.toDataURL()}function xb(t){return t instanceof we?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:Ub(t),deleteFramebuffer:!0}}function Lb(t,e,n,r,i){if(t)return t;e=e||5121;const s=Ms(e,{clamped:!1}),o=Pb(n);return new s(r*i*o)}const oe={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function Cb(t){const e=new Rt(t,{format:6408,type:5126,dataFormat:6408}),n=new we(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const Fy={[oe.WEBGL2]:[!1,!0],[oe.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[oe.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[oe.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[oe.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[oe.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[oe.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[oe.FLOAT_BLEND]:["EXT_float_blend"],[oe.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[oe.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[oe.TEXTURE_FLOAT]:["OES_texture_float",!0],[oe.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[oe.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[oe.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[oe.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[oe.COLOR_ATTACHMENT_RGBA32F]:[Cb,"EXT_color_buffer_float"],[oe.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[oe.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[oe.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[oe.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[oe.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[oe.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},Rb=2;function Mb(t,e){return Uy(t,e)}function Uy(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>By(t,n))}function Ib(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Fy)t.luma.caps[e]===void 0&&(t.luma.caps[e]=By(t,e));return t.luma.caps}function By(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=Ob(t,e)),t.luma.caps[e]||B.log(Rb,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function Ob(t,e){const n=Fy[e];N(n,e);let r;const i=H(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:N(!1);return r}const Dp="Multiple render targets not supported";class we extends gn{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new we(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=ze(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=ze(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:o=!0,stencil:a=!1,check:l=!0,readBuffer:u=void 0,drawBuffers:c=void 0}=e;if(N(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const f in i){const h=i[f];(Array.isArray(h)?h[0]:h).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,o,a,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:u,drawBuffers:c}),i&&l&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,l=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,l||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return N(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&B.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(o=>{i[o]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){N(o!==void 0,"Misspelled framebuffer binding point?");const a=Number(o),l=i[a];let u=l;if(!u)this._unattach(a);else if(u instanceof Hr)this._attachRenderbuffer({attachment:a,renderbuffer:u});else if(Array.isArray(l)){const[c,f=0,h=0]=l;u=c,this._attachTexture({attachment:a,texture:c,layer:f,level:h})}else this._attachTexture({attachment:a,texture:u,layer:0,level:0});r&&u&&u.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(Nb(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&sh(this.gl,{color:n,depth:r,stencil:i}),s.forEach((a,l)=>{Ab(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return B.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return B.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return B.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return B.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return B.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return B.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:o}=e;const a=ze(this.gl),l=a.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&o===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,r,i,s,o),a.bindFramebuffer(36008,l),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=zn(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const o=n?zn(this.gl,s):s;i[o]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),o=e?zn(this.gl,s):s;r[o]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(Np(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>B.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=Np(this,{targetMaxHeight:100});return B.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let o=null;return e&&(o=o||{},o[36064]=new Rt(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(o[36064])),n&&r?(o=o||{},o[33306]=new Hr(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new Hr(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(o[36096])):r&&N(!1),o}_unattach(e){const n=this.attachments[e];n&&(n instanceof Hr?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:o}=this;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:ze(o).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const l=kb(i);o.framebufferTexture2D(36160,n,l,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:N(!1,"Illegal texture type")}o.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=uS(this.gl);n?n.readBuffer(e):N(e===36064||e===1029,Dp),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=ze(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):N(e.length===1&&(e[0]===36064||e[0]===1029),Dp)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=Ib(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function kb(t){return t<34069?t+34069:t}function Nb(t){return(we.STATUS||{})[t]||"Framebuffer error ".concat(t)}const Db=[36049,36048,33296,33298,33299,33300,33301,33302,33303];we.ATTACHMENT_PARAMETERS=Db;function Fb(t,e){N(t instanceof Rt||t instanceof Ny||t instanceof Eb);const n=t.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:l,border:u,mipmaps:c}=t,f=Object.assign({width:i,height:s,format:o,type:a,dataFormat:l,border:u,mipmaps:c},e);return new n(r,f)}function Ub(t,e){const{gl:n,width:r,height:i,id:s}=t;return new we(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{[36064]:t}}))}function Ko(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const Bb=35632,zb=35633;function Vb(t){switch(t){case Bb:return"fragment";case zb:return"vertex";default:return"unknown type"}}function jb(t,e,n,r){const i=t.split(/\r?\n/),s={},o={},a=r||Ko(e)||"(unnamed)",l="".concat(Vb(n)," shader ").concat(a);for(let c=0;c<i.length;c++){const f=i[c];if(f.length<=1)continue;const h=f.split(":"),m=h[0],E=parseInt(h[2],10);if(isNaN(E))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));m!=="WARNING"?s[E]=f:o[E]=f}const u=Gb(e);return{shaderName:l,errors:Fp(s,u),warnings:Fp(o,u)}}function Fp(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0,u=s.substring(o.join(":").length+1).trim();n+=zy("^^^ ".concat(a,": ").concat(u,`

`),l)}}return n}function Gb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,o)=>{const a=String(o+e),l=a.length;return zy(a,i-l)+n+s})}function zy(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function Vy(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const Hb="Shader: GLSL source code must be a JavaScript string";class Is extends gn{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return N(!1),"unknown"}}constructor(e,n){al(e),N(typeof n.source=="string",Hb);const r=Ko(n.source,null)||n.id||Gn("unnamed ".concat(Is.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=Ko(n,null);r&&(this.id=Gn(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Is.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Ko(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:o}=jb(r,this.source,this.shaderType,this.id);throw B.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),B.warn("GLSL compilation warnings in ".concat(i,`
`).concat(o))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class au extends Is{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class lu extends Is{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Wb={[5126]:te.bind(null,"uniform1fv",Ke,1,Oe),[35664]:te.bind(null,"uniform2fv",Ke,2,Oe),[35665]:te.bind(null,"uniform3fv",Ke,3,Oe),[35666]:te.bind(null,"uniform4fv",Ke,4,Oe),[5124]:te.bind(null,"uniform1iv",_n,1,Oe),[35667]:te.bind(null,"uniform2iv",_n,2,Oe),[35668]:te.bind(null,"uniform3iv",_n,3,Oe),[35669]:te.bind(null,"uniform4iv",_n,4,Oe),[35670]:te.bind(null,"uniform1iv",_n,1,Oe),[35671]:te.bind(null,"uniform2iv",_n,2,Oe),[35672]:te.bind(null,"uniform3iv",_n,3,Oe),[35673]:te.bind(null,"uniform4iv",_n,4,Oe),[35674]:te.bind(null,"uniformMatrix2fv",Ke,4,Qt),[35675]:te.bind(null,"uniformMatrix3fv",Ke,9,Qt),[35676]:te.bind(null,"uniformMatrix4fv",Ke,16,Qt),[35678]:xe,[35680]:xe,[5125]:te.bind(null,"uniform1uiv",Po,1,Oe),[36294]:te.bind(null,"uniform2uiv",Po,2,Oe),[36295]:te.bind(null,"uniform3uiv",Po,3,Oe),[36296]:te.bind(null,"uniform4uiv",Po,4,Oe),[35685]:te.bind(null,"uniformMatrix2x3fv",Ke,6,Qt),[35686]:te.bind(null,"uniformMatrix2x4fv",Ke,8,Qt),[35687]:te.bind(null,"uniformMatrix3x2fv",Ke,6,Qt),[35688]:te.bind(null,"uniformMatrix3x4fv",Ke,12,Qt),[35689]:te.bind(null,"uniformMatrix4x2fv",Ke,8,Qt),[35690]:te.bind(null,"uniformMatrix4x3fv",Ke,12,Qt),[35678]:xe,[35680]:xe,[35679]:xe,[35682]:xe,[36289]:xe,[36292]:xe,[36293]:xe,[36298]:xe,[36299]:xe,[36300]:xe,[36303]:xe,[36306]:xe,[36307]:xe,[36308]:xe,[36311]:xe},Yb={},Xb={},$b={},Up=[0];function oh(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(Up[0]=t,t=Up);const i=t.length;if(i%e&&B.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let o=0;o<i;o++)s[o]=t[o];return s}function Ke(t,e){return oh(t,e,Float32Array,Yb)}function _n(t,e){return oh(t,e,Int32Array,Xb)}function Po(t,e){return oh(t,e,Uint32Array,$b)}function Bp(t,e,n){const r=Wb[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function qb(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function Zb(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!Kb(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function Kb(t){return Array.isArray(t)||ArrayBuffer.isView(t)?Jb(t):isFinite(t)||t===!0||t===!1||t instanceof ui||t instanceof Hr?!0:t instanceof we?!!t.texture:!1}function Qb(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function Jb(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function xe(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function te(t,e,n,r){let i=null,s=null;return(o,a,l)=>{const u=e(l,n),c=u.length;let f=!1;if(i===null)i=new Float32Array(c),s=c,f=!0;else{N(s===c,"Uniform length cannot change.");for(let h=0;h<c;++h)if(u[h]!==i[h]){f=!0;break}}return f&&(r(o,t,a,u),i.set(u)),f}}function Oe(t,e,n,r){t[e](n,r)}function Qt(t,e,n,r){t[e](n,!1,r)}const eA=5120,tA=5121,nA=5122,rA=5123,zp=0,xo=1,iA=2,sA=3,Lo=4,oA=5,aA=6,ve=5126,lA=35664,uA=35665,cA=35666,Hi=5124,fA=35667,hA=35668,dA=35669,Wi=5125,pA=36294,gA=36295,mA=36296,yA=35670,vA=35671,_A=35672,EA=35673,wA=35674,TA=35675,SA=35676,bA=35685,AA=35686,PA=35687,xA=35688,LA=35689,CA=35690,kc={[ve]:[ve,1,"float"],[lA]:[ve,2,"vec2"],[uA]:[ve,3,"vec3"],[cA]:[ve,4,"vec4"],[Hi]:[Hi,1,"int"],[fA]:[Hi,2,"ivec2"],[hA]:[Hi,3,"ivec3"],[dA]:[Hi,4,"ivec4"],[Wi]:[Wi,1,"uint"],[pA]:[Wi,2,"uvec2"],[gA]:[Wi,3,"uvec3"],[mA]:[Wi,4,"uvec4"],[yA]:[ve,1,"bool"],[vA]:[ve,2,"bvec2"],[_A]:[ve,3,"bvec3"],[EA]:[ve,4,"bvec4"],[wA]:[ve,8,"mat2"],[bA]:[ve,8,"mat2x3"],[AA]:[ve,8,"mat2x4"],[TA]:[ve,12,"mat3"],[PA]:[ve,12,"mat3x2"],[xA]:[ve,12,"mat3x4"],[SA]:[ve,16,"mat4"],[LA]:[ve,16,"mat4x2"],[CA]:[ve,16,"mat4x3"]};function RA(t){switch(t){case zp:return zp;case xo:return xo;case sA:return xo;case iA:return xo;case Lo:return Lo;case oA:return Lo;case aA:return Lo;default:return N(!1),0}}function Vp(t){const e=kc[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function jy(t,e){switch(t){case eA:case tA:case nA:case rA:t=ve;break}for(const n in kc){const[r,i,s]=kc[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class MA{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getActiveAttrib(e.handle,i),l=n.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!H(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,o,a)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:o}=Vp(r),a={type:s,size:i*o};this._inferProperties(e,n,a);const l={location:e,name:n,accessor:new tt(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:o}=Vp(r),a=new tt({type:s,size:i*o}),l={location:e,name:n,accessor:a};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const jp=4,IA=35981,OA=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Gy extends gn{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",OA),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:o=IA}=e;return this.hash=n||"",this.vs=typeof r=="string"?new au(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new lu(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,N(this.vs instanceof au),N(this.fs instanceof lu),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(ze(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new MA(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:o,end:a,isIndexed:l=!1,indexType:u=5123,instanceCount:c=0,isInstanced:f=c>0,vertexArray:h=null,transformFeedback:m,framebuffer:E,parameters:w={},uniforms:b,samplers:v}=e;if((b||v)&&(B.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(b||{})),B.priority>=n){const g=E?E.id:"default",_="mode=".concat(zn(this.gl,r)," verts=").concat(i," ")+"instances=".concat(c," indexType=").concat(zn(this.gl,u)," ")+"isInstanced=".concat(f," isIndexed=").concat(l," ")+"Framebuffer=".concat(g);B.log(n,_)()}return N(h),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||f&&c===0?!1:(h.bindForDraw(i,c,()=>{if(E!==void 0&&(w=Object.assign({},w,{framebuffer:E})),m){const g=RA(r);m.begin(g)}this._bindTextures(),Lt(this.gl,w,()=>{l&&f?this.gl2.drawElementsInstanced(r,i,u,s,c):l&&H(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(r,o,a,i,u,s):l?this.gl.drawElements(r,i,u,s):f?this.gl2.drawArraysInstanced(r,s,i,c):this.gl.drawArrays(r,s,i)}),m&&m.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};B.priority>=2&&Zb(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,o=!1;if(s instanceof we&&(s=s.texture),s instanceof ui)if(o=this.uniforms[n]!==r,o){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=i;a.bind(l),s=l,this._textureUniforms[n]=a}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||o)&&Qb(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new au({handle:i});break;case 35632:r.fs=new lu({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Gn(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),B.time(jp,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),B.timeEnd(jp,"linkProgram for ".concat(this._getName()))(),e.debug||B.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=qb(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=Bp(e,s,r),r.size>1)for(let o=0;o<r.size;o++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(o,"]")),this._uniformSetters["".concat(i,"[").concat(o,"]")]=Bp(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const kA=34918,NA=34919,DA=35007,FA=36795,UA=35976,BA=35887,zA=36202;class Ma extends gn{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=H(e),i=Uy(e,oe.TIMER_QUERY);let s=r||i;for(const o of n)switch(o){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:N(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(DA)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?zA:BA)}beginTransformFeedbackQuery(){return this.begin(UA)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,NA);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(FA)}getResult(){return this.gl2.getQueryParameter(this.handle,kA)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Ma.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class Hy extends gn{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return H(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ze(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,li(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:o}=this._getBufferParams(n);return r<0?(this.unused[e]=i,B.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,o,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof Z?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let Co=null;function VA(t){return(!Co||Co.byteLength<t)&&(Co=new ArrayBuffer(t)),Co}function jA(t,e){const n=VA(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function GA(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)e[l++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return e}const HA="elements must be GL.ELEMENT_ARRAY_BUFFER";class Qe extends gn{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?H(e)||fy()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Qe(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Qe.MAX_ATTRIBUTES=Qe.MAX_ATTRIBUTES||e.getParameter(34921),Qe.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Qe._setConstantFloatArray(e,n,r);break;case Int32Array:Qe._setConstantIntArray(e,n,r);break;case Uint32Array:Qe._setConstantUintArray(e,n,r);break;default:N(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Qe.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return N(!e||e.target===34963,HA),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:o,offset:a,normalized:l,integer:u,divisor:c}=r,{gl:f,gl2:h}=this;return e=Number(e),this.bind(()=>{f.bindBuffer(34962,n.handle),u?(N(H(f)),h.vertexAttribIPointer(e,i,s,o,a)):f.vertexAttribPointer(e,i,s,l,o,a),f.enableVertexAttribArray(e),h.vertexAttribDivisor(e,c||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Qe.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new Z(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const a=jA(n.constructor,s);GA({target:a,source:r,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:N(!1)}}static _setConstantIntArray(e,n,r){switch(N(H(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:N(!1)}}static _setConstantUintArray(e,n,r){switch(N(H(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:N(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return N(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const WA="VertexArray: attributes must be Buffers or constants (i.e. typed array)",YA=/^(.+)__LOCATION_([0-9]+)$/,XA=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class $A{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Qe(e),My(this,"VertexArray","v6.0",XA),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Z(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Z&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof Z&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,B.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const u=this.accessors[o]||{},c=tt.resolve(l.accessor,u,r,i),{size:f,type:h}=c;return N(Number.isFinite(f)&&Number.isFinite(h)),{location:o,accessor:c}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=YA.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof Z)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof Z){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof Z){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(WA)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(Qe.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Qe.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,o=s>0;if(e.isInstanced=e.isInstanced||o,r instanceof Z){const a=r;if(o){const l=a.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return B.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function qA(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=",".concat(o%r===0?" ":"")),i+=Os(t[o],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function Os(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return qA(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function Gp(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;N(n);const s=".*_.*",o=".*Matrix",a=n._uniformSetters,l={},u=Object.keys(a).sort();let c=0;for(const m of u)!m.match(s)&&!m.match(o)&&uu({table:l,header:e,uniforms:r,uniformName:m,undefinedOnly:i})&&c++;for(const m of u)m.match(o)&&uu({table:l,header:e,uniforms:r,uniformName:m,undefinedOnly:i})&&c++;for(const m of u)l[m]||uu({table:l,header:e,uniforms:r,uniformName:m,undefinedOnly:i})&&c++;let f=0;const h={};if(!i)for(const m in r){const E=r[m];l[m]||(f++,h[m]={Type:"NOT USED: ".concat(E),[e]:Os(E)})}return{table:l,count:c,unusedTable:h,unusedCount:f}}function uu(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const o=r[i],a=ZA(o);return!s||!a?(e[i]={[n]:a?Os(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0):!1}function ZA(t){return t!=null}function KA(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=Hp(e,e.elements,null,n));const i=e.values;for(const s in i){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const l=e.accessors[o.location];l&&(a="".concat(s,": ").concat(QA(o.name,l))),r[a]=Hp(e,i[s],l,n)}}return r}function Hp(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",o=1,a=0,l=0,u,c,f;if(n&&(s=n.type,o=n.size,s=String(s).replace("Array",""),u=s.indexOf("nt")!==-1),e instanceof Z){const h=e,{data:m,changed:E}=h.getDebugData();c=E?"*":"",f=m,l=h.byteLength,a=l/m.BYTES_PER_ELEMENT/o;let w;if(n){const b=n.divisor>0;w="".concat(b?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(l," bytes ").concat(zn(i,s),")")}else u=!0,w="".concat(l," bytes");return{[r]:"".concat(c).concat(Os(f,{size:o,isInteger:u})),"Format ":w}}return f=e,o=e.length,s=String(e.constructor.name).replace("Array",""),u=s.indexOf("nt")!==-1,{[r]:"".concat(Os(f,{size:o,isInteger:u})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function QA(t,e){const{type:n,size:r}=e,i=jy(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function JA(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=Wp(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=Wp(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function Wp(t){const{type:e,size:n}=t.accessor,r=jy(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const Yp=pn()&&typeof document<"u";let eP=0;class tP{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=b=>Ry(b),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:l=null,glOptions:u={},debug:c=!1,createFramebuffer:f=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:m=!0,stats:E=sr.get("animation-loop-".concat(eP++))}=e;let{useDevicePixels:w=!0}=e;"useDevicePixelRatio"in e&&(B.deprecated("useDevicePixelRatio","useDevicePixels")(),w=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:u,debug:c,createFramebuffer:f},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=E,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:m,useDevicePixels:w}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return N(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Ma.isSupported(this.gl,["timers"])?new Ma(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return B.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Yp?new Promise((e,n)=>{if(Yp&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):ab(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):ob(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?rh(this.props.gl,e):this.onCreateContext(e),!ol(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");XS(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&QS(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new we(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Hs="vs",ah="fs";function st(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const cu={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function nP(t){const e={};for(const n in t){const r=t[n],i=rP(r);e[n]=i}return e}function rP(t){let e=Xp(t);return e==="object"?t?"type"in t?Object.assign({},t,cu[t.type]):"value"in t?(e=Xp(t.value),Object.assign({type:e},t,cu[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},cu[e])}function Xp(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const iP="vs",sP="fs";class $p{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:l=[],defines:u={},inject:c={},vertexShader:f,fragmentShader:h}=e;st(typeof n=="string"),this.name=n,this.vs=r||f,this.fs=i||h,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(l),this.defines=u,this.injections=oP(c),o&&(this.uniforms=nP(o))}getModuleSource(e){let n;switch(e){case iP:n=this.vs||"";break;case sP:n=this.fs||"";break;default:st(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&st(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function oP(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function aP(t){return lP(Yy(t))}function lP(t){const e={},n={};return Wy({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function Wy(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&Wy({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function Yy(t,e){return t.map(n=>(n instanceof $p||(st(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),st(n.name,"shader module has no name"),n=new $p(n),n.dependencies=Yy(n.dependencies)),n))}function uP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const cP=7936,fP=7937,hP=7938,dP=35724,lh={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},tr={};Object.keys(lh).forEach(t=>{tr[t]=t});function pP(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function gP(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||cP),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||fP);return{gpuVendor:mP(n,r),vendor:n,renderer:r,version:t.getParameter(hP),shadingLanguageVersion:t.getParameter(dP)}}function mP(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const fu={};function qp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=lh[e];if(st(r,e),!uP(n))return!0;if(e in fu)return fu[e];const i=r[0],s=n.behavior||"enable",o="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const l=t.getShaderParameter(a,35713);return t.deleteShader(a),fu[e]=l,l}function yP(t,e){const n=lh[e];st(n,e);const r=pP(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return st(i===!1||i===!0),i}function Ro(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>yP(t,n))}function vP(t){switch(gP(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function _P(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return Ro(t,tr.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),Ro(t,tr.GLSL_DERIVATIVES)&&qp(t,tr.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),Ro(t,tr.GLSL_FRAG_DATA)&&qp(t,tr.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),Ro(t,tr.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const EP=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,wP=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,TP={[Hs]:EP,[ah]:wP},Qo="__LUMA_INJECT_DECLARATIONS__",Zp=/void\s+main\s*\([^)]*\)\s*\{\n?/,Kp=/}\n?[^{}]*$/,hu=[];function Qp(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Hs;for(const s in n){const o=n[s];o.sort((l,u)=>l.order-u.order),hu.length=o.length;for(let l=0,u=o.length;l<u;++l)hu[l]=o[l].injection;const a="".concat(hu.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(Qo,a));break;case"vs:#main-start":i&&(t=t.replace(Zp,l=>l+a));break;case"vs:#main-end":i&&(t=t.replace(Kp,l=>a+l));break;case"fs:#decl":i||(t=t.replace(Qo,a));break;case"fs:#main-start":i||(t=t.replace(Zp,l=>l+a));break;case"fs:#main-end":i||(t=t.replace(Kp,l=>a+l));break;default:t=t.replace(s,l=>l+a)}}return t=t.replace(Qo,""),r&&(t=t.replace(/\}\s*$/,s=>s+TP[e])),t}function Nc(t){const e={};return st(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function ci(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const Xy=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],SP=[...Xy,[ci("attribute"),"in $1"],[ci("varying"),"out $1"]],bP=[...Xy,[ci("varying"),"in $1"]],$y=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],AP=[...$y,[ci("in"),"attribute $1"],[ci("out"),"varying $1"]],PP=[...$y,[ci("in"),"varying $1"]],Dc="gl_FragColor",Fc=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,xP=/void\s+main\s*\([^)]*\)\s*\{\n?/;function LP(t,e,n){switch(e){case 300:return n?Ia(t,SP):CP(t);case 100:return n?Ia(t,AP):RP(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Ia(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function CP(t){t=Ia(t,bP);const e=t.match(Fc);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(Dc,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(xP,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(Dc,"\\b"),"g"),n)}return t}function RP(t){t=Ia(t,PP);const e=t.match(Fc);if(e){const n=e[1];t=t.replace(Fc,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),Dc)}return t}const MP=`

`.concat(Qo,`

`),qy={[Hs]:"vertex",[ah]:"fragment"},IP=`precision highp float;

`;function OP(t,e){const{vs:n,fs:r}=e,i=aP(e.modules||[]);return{gl:t,vs:Jp(t,Object.assign({},e,{source:n,type:Hs,modules:i})),fs:Jp(t,Object.assign({},e,{source:r,type:ah,modules:i})),getUniforms:kP(i)}}function Jp(t,e){let{id:n,source:r,type:i,modules:s,defines:o={},hookFunctions:a=[],inject:l={},transpileToGLSL100:u=!1,prologue:c=!0,log:f}=e;st(typeof r=="string","shader source must be a string");const h=i===Hs,m=r.split(`
`);let E=100,w="",b=r;m[0].indexOf("#version ")===0?(E=300,w=m[0],b=m.slice(1).join(`
`)):w="#version ".concat(E);const v={};s.forEach(L=>{Object.assign(v,L.getDefines())}),Object.assign(v,o);let g=c?"".concat(w,`
`).concat(DP({id:n,source:r,type:i}),`
`).concat(NP({type:i}),`
`).concat(vP(t),`
`).concat(_P(t),`
`).concat(FP(v),`
`).concat(h?"":IP,`
`):"".concat(w,`
`);const _=BP(a),S={},P={},x={};for(const L in l){const M=typeof l[L]=="string"?{injection:l[L],order:0}:l[L],k=L.match(/^(v|f)s:(#)?([\w-]+)$/);if(k){const I=k[2],z=k[3];I?z==="decl"?P[L]=[M]:x[L]=[M]:S[L]=[M]}else x[L]=[M]}for(const L of s){f&&L.checkDeprecations(b,f);const M=L.getModuleSource(i,E);g+=M;const k=L.injections[i];for(const I in k){const z=I.match(/^(v|f)s:#([\w-]+)$/);if(z){const ie=z[2]==="decl"?P:x;ie[I]=ie[I]||[],ie[I].push(k[I])}else S[I]=S[I]||[],S[I].push(k[I])}}return g+=MP,g=Qp(g,i,P),g+=UP(_[i],S),g+=b,g=Qp(g,i,x),g=LP(g,u?100:E,h),g}function kP(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function NP(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(qy[e].toUpperCase(),`
`)}function DP(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(qy[r],`

`):""}function FP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function UP(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+="  ".concat(o.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function BP(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),o=n.replace(/\(.+/,"");e[i][o]=Object.assign(r,{signature:s})}),e}const zP="void main() {gl_FragColor = vec4(0);}",Zy=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,VP=`#version 300 es
`.concat(Zy);function Ky(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const o=s.split(";")[0];return{qualifier:r,type:i,name:o}}function Qy(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?VP:e>300?"#version ".concat(e,`
`).concat(Zy):zP;const s=HP(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function jP(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return st(!1),null}}function GP(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return st(!1),null}}function HP(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return st(!1),null}}const WP=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,YP={name:"fp32",vs:WP,fs:null};function eg(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const rt={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function XP(t,{precision:e=rt.precision}={}){return t=$P(t),"".concat(parseFloat(t.toPrecision(e)))}function fi(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Rn(t,e,n){return ZP(t,r=>Math.max(e,Math.min(n,r)))}function Oa(t,e,n){return fi(t)?t.map((r,i)=>Oa(r,e[i],n)):n*e+(1-n)*t}function ks(t,e,n){const r=rt.EPSILON;n&&(rt.EPSILON=n);try{if(t===e)return!0;if(fi(t)&&fi(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!ks(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=rt.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{rt.EPSILON=r}}function $P(t){return Math.round(t/rt.EPSILON)*rt.EPSILON}function qP(t){return t.clone?t.clone():new Array(t.length)}function ZP(t,e,n){if(fi(t)){const r=t;n=n||qP(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function KP(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class Jy extends KP(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:fi(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(rt)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+XP(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!ks(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(rt.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function QP(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function et(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function du(t,e,n=""){if(rt.debug&&!QP(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class JP extends Jy{get x(){return this[0]}set x(e){this[0]=et(e)}get y(){return this[1]}set y(e){this[1]=et(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return et(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return et(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return eg(e>=0&&e<this.ELEMENTS,"index is out of range"),et(this[e])}setComponent(e,n){return eg(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var Jo=1e-6,hi=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function ex(){var t=new hi(2);return hi!=Float32Array&&(t[0]=0,t[1]=0),t}function tg(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function tx(t,e){return t[0]=-e[0],t[1]=-e[1],t}function ev(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function nx(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){var t=ex();return function(e,n,r,i,s,o){var a,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function rx(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function tv(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function ix(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function sx(){var t=new hi(3);return hi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ox(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function ax(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function lx(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ux(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function nv(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function cx(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function fx(t,e,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],u=e[2],c=i*u-s*l,f=s*a-r*u,h=r*l-i*a,m=i*h-s*f,E=s*c-r*h,w=r*f-i*c,b=o*2;return c*=b,f*=b,h*=b,m*=2,E*=2,w*=2,t[0]=a+c+m,t[1]=l+f+E,t[2]=u+h+w,t}function hx(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function dx(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function px(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function gx(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt(n*n+r*r+i*i),u=Math.sqrt(s*s+o*o+a*a),c=l*u,f=c&&lx(t,e)/c;return Math.acos(Math.min(Math.max(f,-1),1))}var mx=ox;(function(){var t=sx();return function(e,n,r,i,s,o){var a,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const pu=[0,0,0];let Mo;class Wt extends JP{static get ZERO(){return Mo||(Mo=new Wt(0,0,0),Object.freeze(Mo)),Mo}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&fi(e)?this.copy(e):(rt.debug&&(et(e),et(n),et(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return rt.debug&&(et(e.x),et(e.y),et(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=et(e)}angle(e){return gx(this,e)}cross(e){return ux(this,this,e),this.check()}rotateX({radians:e,origin:n=pu}){return hx(this,this,n,e),this.check()}rotateY({radians:e,origin:n=pu}){return dx(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=pu}){return px(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return nv(this,this,e),this.check()}transformAsVector(e){return tv(this,this,e),this.check()}transformByMatrix3(e){return cx(this,this,e),this.check()}transformByMatrix2(e){return ix(this,this,e),this.check()}transformByQuaternion(e){return fx(this,this,e),this.check()}}class yx extends Jy{toString(){let e="[";if(rt.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=et(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function vx(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _x(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Uc(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],m=e[11],E=e[12],w=e[13],b=e[14],v=e[15],g=n*a-r*o,_=n*l-i*o,S=n*u-s*o,P=r*l-i*a,x=r*u-s*a,L=i*u-s*l,M=c*w-f*E,k=c*b-h*E,I=c*v-m*E,z=f*b-h*w,ee=f*v-m*w,ie=h*v-m*b,Y=g*ie-_*ee+S*z+P*I-x*k+L*M;return Y?(Y=1/Y,t[0]=(a*ie-l*ee+u*z)*Y,t[1]=(i*ee-r*ie-s*z)*Y,t[2]=(w*L-b*x+v*P)*Y,t[3]=(h*x-f*L-m*P)*Y,t[4]=(l*I-o*ie-u*k)*Y,t[5]=(n*ie-i*I+s*k)*Y,t[6]=(b*S-E*L-v*_)*Y,t[7]=(c*L-h*S+m*_)*Y,t[8]=(o*ee-a*I+u*M)*Y,t[9]=(r*I-n*ee-s*M)*Y,t[10]=(E*x-w*S+v*g)*Y,t[11]=(f*S-c*x-m*g)*Y,t[12]=(a*k-o*z-l*M)*Y,t[13]=(n*z-r*k+i*M)*Y,t[14]=(w*_-E*P-b*g)*Y,t[15]=(c*P-f*_+h*g)*Y,t):null}function Ex(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],f=t[10],h=t[11],m=t[12],E=t[13],w=t[14],b=t[15],v=e*o-n*s,g=e*a-r*s,_=e*l-i*s,S=n*a-r*o,P=n*l-i*o,x=r*l-i*a,L=u*E-c*m,M=u*w-f*m,k=u*b-h*m,I=c*w-f*E,z=c*b-h*E,ee=f*b-h*w;return v*ee-g*z+_*I+S*k-P*M+x*L}function lr(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],m=e[10],E=e[11],w=e[12],b=e[13],v=e[14],g=e[15],_=n[0],S=n[1],P=n[2],x=n[3];return t[0]=_*r+S*a+P*f+x*w,t[1]=_*i+S*l+P*h+x*b,t[2]=_*s+S*u+P*m+x*v,t[3]=_*o+S*c+P*E+x*g,_=n[4],S=n[5],P=n[6],x=n[7],t[4]=_*r+S*a+P*f+x*w,t[5]=_*i+S*l+P*h+x*b,t[6]=_*s+S*u+P*m+x*v,t[7]=_*o+S*c+P*E+x*g,_=n[8],S=n[9],P=n[10],x=n[11],t[8]=_*r+S*a+P*f+x*w,t[9]=_*i+S*l+P*h+x*b,t[10]=_*s+S*u+P*m+x*v,t[11]=_*o+S*c+P*E+x*g,_=n[12],S=n[13],P=n[14],x=n[15],t[12]=_*r+S*a+P*f+x*w,t[13]=_*i+S*l+P*h+x*b,t[14]=_*s+S*u+P*m+x*v,t[15]=_*o+S*c+P*E+x*g,t}function ka(t,e,n){var r=n[0],i=n[1],s=n[2],o,a,l,u,c,f,h,m,E,w,b,v;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],u=e[3],c=e[4],f=e[5],h=e[6],m=e[7],E=e[8],w=e[9],b=e[10],v=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=u,t[4]=c,t[5]=f,t[6]=h,t[7]=m,t[8]=E,t[9]=w,t[10]=b,t[11]=v,t[12]=o*r+c*i+E*s+e[12],t[13]=a*r+f*i+w*s+e[13],t[14]=l*r+h*i+b*s+e[14],t[15]=u*r+m*i+v*s+e[15]),t}function uh(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function wx(t,e,n,r){var i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o),l,u,c,f,h,m,E,w,b,v,g,_,S,P,x,L,M,k,I,z,ee,ie,Y,Xt;return a<Jo?null:(a=1/a,i*=a,s*=a,o*=a,l=Math.sin(n),u=Math.cos(n),c=1-u,f=e[0],h=e[1],m=e[2],E=e[3],w=e[4],b=e[5],v=e[6],g=e[7],_=e[8],S=e[9],P=e[10],x=e[11],L=i*i*c+u,M=s*i*c+o*l,k=o*i*c-s*l,I=i*s*c-o*l,z=s*s*c+u,ee=o*s*c+i*l,ie=i*o*c+s*l,Y=s*o*c-i*l,Xt=o*o*c+u,t[0]=f*L+w*M+_*k,t[1]=h*L+b*M+S*k,t[2]=m*L+v*M+P*k,t[3]=E*L+g*M+x*k,t[4]=f*I+w*z+_*ee,t[5]=h*I+b*z+S*ee,t[6]=m*I+v*z+P*ee,t[7]=E*I+g*z+x*ee,t[8]=f*ie+w*Y+_*Xt,t[9]=h*ie+b*Y+S*Xt,t[10]=m*ie+v*Y+P*Xt,t[11]=E*ie+g*Y+x*Xt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function rv(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+u*r,t[5]=o*i+c*r,t[6]=a*i+f*r,t[7]=l*i+h*r,t[8]=u*i-s*r,t[9]=c*i-o*r,t[10]=f*i-a*r,t[11]=h*i-l*r,t}function Tx(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],u=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-u*r,t[1]=o*i-c*r,t[2]=a*i-f*r,t[3]=l*i-h*r,t[8]=s*r+u*i,t[9]=o*r+c*i,t[10]=a*r+f*i,t[11]=l*r+h*i,t}function iv(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+u*r,t[1]=o*i+c*r,t[2]=a*i+f*r,t[3]=l*i+h*r,t[4]=u*i-s*r,t[5]=c*i-o*r,t[6]=f*i-a*r,t[7]=h*i-l*r,t}function Sx(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,u=n*o,c=r*o,f=r*a,h=i*o,m=i*a,E=i*l,w=s*o,b=s*a,v=s*l;return t[0]=1-f-E,t[1]=c+v,t[2]=h-b,t[3]=0,t[4]=c-v,t[5]=1-u-E,t[6]=m+w,t[7]=0,t[8]=h+b,t[9]=m-w,t[10]=1-u-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function bx(t,e,n,r,i,s,o){var a=1/(n-e),l=1/(i-r),u=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*u,t[15]=0,t}function Ax(t,e,n,r,i){var s=1/Math.tan(e/2),o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var Px=Ax;function xx(t,e,n,r,i,s,o){var a=1/(e-n),l=1/(r-i),u=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*u,t[15]=1,t}var Lx=xx;function Cx(t,e,n,r){var i,s,o,a,l,u,c,f,h,m,E=e[0],w=e[1],b=e[2],v=r[0],g=r[1],_=r[2],S=n[0],P=n[1],x=n[2];return Math.abs(E-S)<Jo&&Math.abs(w-P)<Jo&&Math.abs(b-x)<Jo?vx(t):(c=E-S,f=w-P,h=b-x,m=1/Math.hypot(c,f,h),c*=m,f*=m,h*=m,i=g*h-_*f,s=_*c-v*h,o=v*f-g*c,m=Math.hypot(i,s,o),m?(m=1/m,i*=m,s*=m,o*=m):(i=0,s=0,o=0),a=f*o-h*s,l=h*i-c*o,u=c*s-f*i,m=Math.hypot(a,l,u),m?(m=1/m,a*=m,l*=m,u*=m):(a=0,l=0,u=0),t[0]=i,t[1]=a,t[2]=c,t[3]=0,t[4]=s,t[5]=l,t[6]=f,t[7]=0,t[8]=o,t[9]=u,t[10]=h,t[11]=0,t[12]=-(i*E+s*w+o*b),t[13]=-(a*E+l*w+u*b),t[14]=-(c*E+f*w+h*b),t[15]=1,t)}function Rx(){var t=new hi(4);return hi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Mx(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Ws(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}(function(){var t=Rx();return function(e,n,r,i,s,o){var a,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var Bc;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Bc||(Bc={}));const Ix=45*Math.PI/180,Ox=1,gu=.1,mu=500,kx=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Yt extends yx{static get IDENTITY(){return Dx()}static get ZERO(){return Nx()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Bc}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,l,u,c,f,h,m,E,w,b){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=u,this[9]=c,this[10]=f,this[11]=h,this[12]=m,this[13]=E,this[14]=w,this[15]=b,this.check()}setRowMajor(e,n,r,i,s,o,a,l,u,c,f,h,m,E,w,b){return this[0]=e,this[1]=s,this[2]=u,this[3]=m,this[4]=n,this[5]=o,this[6]=c,this[7]=E,this[8]=r,this[9]=a,this[10]=f,this[11]=w,this[12]=i,this[13]=l,this[14]=h,this[15]=b,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(kx)}fromObject(e){return this.check()}fromQuaternion(e){return Sx(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=gu,far:a=mu}=e;return a===1/0?Fx(this,n,r,i,s,o):bx(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return Cx(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=gu,far:a=mu}=e;return Lx(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=Ix,aspect:r=Ox,focalDistance:i=1,near:s=gu,far:o=mu}=e;ng(n);const a=n/2,l=i*Math.tan(a),u=l*r;return this.ortho({left:-u,right:u,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return ng(n),Px(this,n,r,i,s),this.check()}determinant(){return Ex(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return _x(this,this),this.check()}invert(){return Uc(this,this),this.check()}multiplyLeft(e){return lr(this,e,this),this.check()}multiplyRight(e){return lr(this,this,e),this.check()}rotateX(e){return rv(this,this,e),this.check()}rotateY(e){return Tx(this,this,e),this.check()}rotateZ(e){return iv(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return wx(this,this,e,n),this.check()}scale(e){return uh(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return ka(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Ws(n||[-0,-0,-0,-0],e,this),du(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=nx(n||[-0,-0],e,this);break;case 3:i=nv(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return du(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=rx(n||[-0,-0],e,this);break;case 3:r=tv(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return du(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Io,Oo;function Nx(){return Io||(Io=new Yt([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Io)),Io}function Dx(){return Oo||(Oo=new Yt,Object.freeze(Oo)),Oo}function ng(t){if(t>Math.PI*2)throw Error("expected radians")}function Fx(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),l=(n+e)/(n-e),u=(i+r)/(i-r),c=-1,f=-1,h=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=u,t[10]=c,t[11]=f,t[12]=0,t[13]=0,t[14]=h,t[15]=0,t}const Ux=new Uint8Array([0,255,255,255]),Bx={pickingSelectedColor:null,pickingHighlightColor:Ux,pickingActive:!1,pickingAttribute:!1};function zx(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Bx;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const Vx=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,jx=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,Gx={name:"picking",vs:Vx,fs:jx,getUniforms:zx},Hx=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,Wx={name:"transform",vs:Hx,fs:null};class Ys{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Ys(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,u=this._getModuleList(e.modules),c=this._getHash(n),f=this._getHash(r),h=u.map(_=>this._getHash(_.name)).sort(),m=o.map(_=>this._getHash(_)),E=Object.keys(i).sort(),w=Object.keys(s).sort(),b=[],v=[];for(const _ of E)b.push(this._getHash(_)),b.push(this._getHash(i[_]));for(const _ of w)v.push(this._getHash(_)),v.push(this._getHash(s[_]));const g="".concat(c,"/").concat(f,"D").concat(b.join("/"),"M").concat(h.join("/"),"I").concat(v.join("/"),"V").concat(m.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(l?"T":"");if(!this._programCache[g]){const _=OP(this.gl,{vs:n,fs:r,modules:u,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[g]=new Gy(this.gl,{hash:g,vs:_.vs,fs:_.fs,varyings:o,bufferMode:a}),this._getUniforms[g]=_.getUniforms||(S=>{}),this._useCounts[g]=0}return this._useCounts[g]++,this._programCache[g]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;n[i++]=a,r[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;r[l]||(n[i++]=a,r[l]=!0)}return n.length=i,n}}const Yx={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Xx(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=$x(s,n);if(s==="indices")i=o;else if(o.constant)r[a]=o.value;else{const l=o.value,u={...o};delete u.value,r[a]=[new Z(t,l),u],qx(s,u)}}if(i){const s=i.value||i;N(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new Z(t,{data:s,target:34963}),o]}return r}function $x(t,e){const{attributeMap:n=Yx}=e||{};return n&&n[t]||t}function qx(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}N(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Lr=2,Zx=1e4,Kx="Model needs drawMode and vertexCount",rg=()=>{},Qx={};class sv{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Gn("model")}=n;N(ol(e)),this.id=r,this.gl=e,this.id=n.id||Gn("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Ys.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},N(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),Kx)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return N(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return N(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=Xx(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(li(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return sh(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let u;B.priority>=Lr&&(u=this._logDrawCallStart(Lr));const c=this.vertexArray.getDrawParams(),{isIndexed:f=c.isIndexed,indexType:h=c.indexType,indexOffset:m=c.indexOffset,vertexArrayInstanced:E=c.isInstanced}=this.props;E&&!this.isInstanced&&B.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:w,instanceCount:b}=this,{onBeforeRender:v=rg,onAfterRender:g=rg}=this.props;v(),this.program.setUniforms(this.uniforms);const _=this.program.draw(Object.assign(Qx,e,{logPriority:u,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:f,indexType:h,isInstanced:w,instanceCount:b,offset:f?m:0}));return g(),B.priority>=Lr&&this._logDrawCallEnd(u,l,r),_}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{[35977]:n})),i.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return B.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:u,transpileToGLSL100:c}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}N(n instanceof Gy,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new $A(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof Z&&n.delete()}}_setAnimationProps(e){this.animated&&N(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(li(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new Hy(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:Zx;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),B.group(Lr,">>> DRAWING MODEL ".concat(this.id),{collapsed:B.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=KA({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=Gp({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:u,count:c}=Gp({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});c>0&&B.log("MISSING UNIFORMS",Object.keys(u))(),l>0&&B.log("UNUSED UNIFORMS",Object.keys(a))();const f=JA(this.vertexArray.configuration);B.table(e,s)(),B.table(e,o)(),B.table(e+1,f)(),i&&i.log({logLevel:Lr,message:"Rendered to ".concat(i.id)}),B.groupEnd(Lr)()}}class Jx{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof Z?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&N(H(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const o=n[s],{byteLength:a,usage:l,accessor:u}=o;r[i]=this._createNewBuffer(i,{byteLength:a,usage:l,accessor:u})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new Hy(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],N(r[s]instanceof Z)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new Z(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const e2="transform_uSampler_",Na="transform_uSize_",ig="transform_position";function t2(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,o=Object.keys(n).length,a=null;const l={};let u=e,c={};if(o>0||r){const f=u.split(`
`),h=f.slice();if(f.forEach((m,E,w)=>{if(o>0){const b=o2(m,n);if(b){const{updatedLine:v,inject:g}=b;h[E]=v,c=Nc([c,g]),Object.assign(l,b.samplerTextureMap),o--}}r&&!a&&(a=s2(m,r))}),r){N(i);const m="".concat(Na).concat(r),E="uniform vec2 ".concat(m,`;
`),w="     vec2 ".concat(ig," = transform_getPos(").concat(m,`);
     gl_Position = vec4(`).concat(ig,`, 0, 1.);
`);c=Nc([c,{"vs:#decl":E,"vs:#main-start":w}])}u=h.join(`
`)}return{vs:u,targetTextureType:a,inject:c,samplerTextureMap:l}}function n2(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,o;n&&({width:s,height:o}=r,i["".concat(Na).concat(n)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),i["".concat(Na).concat(a)]=[s,o];return i}function r2(t){return Ky(t,["attribute","in"])}function i2(t){const e="".concat(e2).concat(t),n="".concat(Na).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function s2(t,e){const n=Ky(t,["varying","out"]);return n&&n.name===e?n.type:null}function o2(t,e){const n={},r=r2(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:l,uniformDeclerations:u}=i2(s),c=jP(i),f="  ".concat(i," ").concat(s," = transform_getInput(").concat(a,", ").concat(l,").").concat(c,`;
`);return n[a]=s,{updatedLine:o,inject:{"vs:#decl":u,"vs:#main-start":f},samplerTextureMap:n}}return null}const a2={[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},l2="transform_output";class u2{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let u=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const f in this.samplerTextureMap){const h=this.samplerTextureMap[f];a[f]=r[h]}this._setSourceTextureParameters();const c=n2({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,c)}return this.hasTargetTexture&&(u=!1,l.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:a,discard:u,parameters:l}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=ll(n);if(!e)return r;const i=r.constructor,s=GP(this.targetTextureType),o=new i(r.length*s/4);let a=0;for(let l=0;l<r.length;l+=4)for(let u=0;u<s;u++)o[a++]=r[l+u];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof Rt)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new Z(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{[36064]:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new we(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{[36064]:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(a2)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=Fb(e,{parameters:{[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},pixelStore:{[37440]:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=t2({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),u=Nc([e.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=l;const c=e._fs||Qy({version:Vy(i),input:this.targetTextureVarying,inputType:o,output:l2}),f=this.hasSourceTextures||this.targetTextureVarying?[Wx].concat(e.modules||[]):e.modules;return{vs:i,fs:c,modules:f,uniforms:s,inject:u}}}class ch{static isSupported(e){return H(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();N(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new sv(n,Object.assign({},e,{fs:e.fs||Qy({version:Vy(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){c2(n)&&(this.bufferTransform=new Jx(e,n)),f2(n)&&(this.textureTransform=new u2(e,n)),N(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function c2(t){return!!(!li(t.feedbackBuffers)||!li(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function f2(t){return!!(!li(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const sg={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class h2{static get DRAW_MODE(){return sg}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Gn("geometry"),drawMode:r=sg.TRIANGLES,attributes:i={},indices:s=null,vertexCount:o=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,N(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(N(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(r=Math.min(r,o.length/a))}return N(Number.isFinite(r)),r}}let d2=1,p2=1;class ov{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=d2++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=p2++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const g2=[255,255,255],m2=1;let y2=0;class v2{constructor(e={}){d(this,"id",void 0),d(this,"color",void 0),d(this,"intensity",void 0),d(this,"type","ambient");const{color:n=g2}=e,{intensity:r=m2}=e;this.id=e.id||"ambient-".concat(y2++),this.color=n,this.intensity=r}}const _2=[255,255,255],E2=1,w2=[0,0,-1];let T2=0;class og{constructor(e={}){d(this,"id",void 0),d(this,"color",void 0),d(this,"intensity",void 0),d(this,"type","directional"),d(this,"direction",void 0),d(this,"shadow",void 0);const{color:n=_2}=e,{intensity:r=E2}=e,{direction:i=w2}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(T2++),this.color=n,this.intensity=r,this.type="directional",this.direction=new Wt(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class S2{constructor(e,n={id:"pass"}){d(this,"id",void 0),d(this,"gl",void 0),d(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class fh extends S2{constructor(...e){super(...e),d(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return fn(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:l=!0}=e;e.pass=e.pass||"unknown";const u=this.gl;l&&A2(u,n),a&&(this._lastRenderIndex=-1);const c=[];for(const f of i){const h=s&&s[f.id];o==null||o(f);const m=this._getDrawLayerParams(f,e),E=f.subViewports||[f];for(const w of E){const b=this._drawLayersInViewport(u,{target:n,moduleParameters:r,viewport:w,view:h,pass:e.pass,layers:e.layers},m);c.push(b)}}return c}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,moduleParameters:l},u=!1){const c=[],f=av(this._lastRenderIndex+1),h={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},m={};for(let E=0;E<n.length;E++){const w=n[E],b=this._shouldDrawLayer(w,h,s,m),v={shouldDrawLayer:b};b&&!u&&(v.layerRenderIndex=f(w,b),v.moduleParameters=this._getModuleParameters(w,a,r,l),v.layerParameters=this.getLayerParameters(w,E,e)),c[E]=v}return c}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},l){const u=b2(e,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const f=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;Lt(e,{scissorTest:!0,scissor:u},()=>sh(e,f))}const c={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};fn(e,{viewport:u});for(let f=0;f<n.length;f++){const h=n[f],{shouldDrawLayer:m,layerRenderIndex:E,moduleParameters:w,layerParameters:b}=l[f];if(m&&h.props.pickable&&c.pickableCount++,h.isComposite)c.compositeCount++;else if(m){c.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,E),w.viewport=o;try{h._drawLayer({moduleParameters:w,uniforms:{layerIndex:E},parameters:b})}catch(v){h.raiseError(v,"drawing ".concat(h," to ").concat(i))}}}return c}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const o=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:ai(this.gl)});if(n)for(const l of n){var a;Object.assign(o,(a=l.getModuleParameters)===null||a===void 0?void 0:a.call(l,e))}return Object.assign(o,this.getModuleParameters(e,n),i)}}function av(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let u;if(l&&!(l in e)&&r(i.parent,!1),l in n){const c=n[l]=n[l]||av(e[l],e);u=c(i,s),n[a]=c}else Number.isFinite(o)?(u=o+(e[l]||0),n[a]=null):u=t;return s&&u>=t&&(t=u+1),e[a]=u,u};return r}function b2(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||ai(t),o=i?n.height:t.drawingBufferHeight,a=r;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}function A2(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;fn(t,{viewport:[0,0,n,r]}),t.clear(16640)}class P2 extends fh{constructor(e,n){super(e,n),d(this,"shadowMap",void 0),d(this,"depthBuffer",void 0),d(this,"fbo",void 0),this.shadowMap=new Rt(e,{width:1,height:1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.depthBuffer=new Hr(e,{format:33189,width:1,height:1}),this.fbo=new we(e,{id:"shadowmap",width:1,height:1,attachments:{[36064]:this.shadowMap,[36096]:this.depthBuffer}})}render(e){const n=this.fbo;Lt(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=ai(this.gl),s=r.width*i,o=r.height*i;(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const lv="#define SMOOTH_EDGE_RADIUS 0.5",x2=`
`.concat(lv,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),L2=`
`.concat(lv,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),C2={name:"geometry",vs:x2,fs:L2},R2=Object.keys($).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat($[t],";")).join(""),M2=Object.keys(Vt).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Vt[t],";")).join(""),I2=Object.keys(Rc).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Rc[t],";")).join(""),O2="".concat(R2,`
`).concat(M2,`
`).concat(I2,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function k2(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Xs(t){let e={},n;return r=>{for(const i in r)if(!k2(r[i],e[i])){n=t(r),e=r;break}return n}}const ag=[0,0,0,0],N2=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],uv=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],D2=[0,0,0],cv=[0,0,0],F2=Xs(z2);function fv(t,e,n=cv){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===$.LNGLAT_OFFSETS||e===$.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Vt.WEB_MERCATOR:(e===$.LNGLAT||e===$.CARTESIAN)&&(i=[0,0,0],s=!1);break;case Vt.WEB_MERCATOR_AUTO_OFFSET:e===$.LNGLAT?r=i:e===$.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case Vt.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case Vt.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function U2(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=ag,l=ag,u=t.cameraPosition;const{geospatialOrigin:c,shaderCoordinateOrigin:f,offsetMode:h}=fv(t,e,n);return h&&(l=t.projectPosition(c||f),u=[u[0]-l[0],u[1]-l[1],u[2]-l[2]],l[3]=1,a=Ws([],l,o),s=r||s,o=lr([],i,s),o=lr([],o,N2)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:u,shaderCoordinateOrigin:f,geospatialOrigin:c}}function B2({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=$.DEFAULT,coordinateOrigin:i=cv,autoWrapLongitude:s=!1}){r===$.DEFAULT&&(r=t.isGeospatial?$.LNGLAT:$.CARTESIAN);const o=F2({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||uv,o}function z2({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:u}=U2(t,n,r),c=t.getDistanceScales(),f=[t.width*e,t.height*e],h=Ws([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,m={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:f,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:D2,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:uv,project_uCameraPosition:a};if(u){const E=t.getDistanceScales(u);switch(n){case $.METER_OFFSETS:m.project_uCommonUnitsPerWorldUnit=E.unitsPerMeter,m.project_uCommonUnitsPerWorldUnit2=E.unitsPerMeter2;break;case $.LNGLAT:case $.LNGLAT_OFFSETS:t._pseudoMeters||(m.project_uCommonUnitsPerMeter=E.unitsPerMeter),m.project_uCommonUnitsPerWorldUnit=E.unitsPerDegree,m.project_uCommonUnitsPerWorldUnit2=E.unitsPerDegree2;break;case $.CARTESIAN:m.project_uCommonUnitsPerWorldUnit=[1,1,E.unitsPerMeter[2]],m.project_uCommonUnitsPerWorldUnit2=[0,0,E.unitsPerMeter2[2]];break}}return m}const V2={};function j2(t=V2){return"viewport"in t?B2(t):{}}const hh={name:"project",dependencies:[YP,C2],vs:O2,getUniforms:j2};function G2(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Qr(t,e){const n=Ws([],e,t);return Mx(n,n,1/n[3]),n}function lg(t,e){const n=t%e;return n<0?e+n:n}function zc(t,e,n){return t<e?e:t>n?n:t}function H2(t){return Math.log(t)*Math.LOG2E}const dh=Math.log2||H2;function hn(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const At=Math.PI,hv=At/4,mt=At/180,Vc=180/At,di=512,Da=4003e4,ko=85.051129,W2=1.5;function Y2(t){return dh(t)}function Fa(t){const[e,n]=t;hn(Number.isFinite(e)),hn(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*mt,i=n*mt,s=di*(r+At)/(2*At),o=di*(At+Math.log(Math.tan(hv+i*.5)))/(2*At);return[s,o]}function pi(t){const[e,n]=t,r=e/di*(2*At)-At,i=2*(Math.atan(Math.exp(n/di*(2*At)-At))-hv);return[r*Vc,i*Vc]}function X2(t){const{latitude:e}=t;hn(Number.isFinite(e));const n=Math.cos(e*mt);return Y2(Da*n)-9}function yu(t){const e=Math.cos(t*mt);return di/Da/e}function jc(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;hn(Number.isFinite(e)&&Number.isFinite(n));const i=di,s=Math.cos(e*mt),o=i/360,a=o/s,l=i/Da/s,u={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(r){const c=mt*Math.tan(e*mt)/s,f=o*c/2,h=i/Da*c,m=h/a*l;u.unitsPerDegree2=[0,f,h],u.unitsPerMeter2=[m,0,m]}return u}function dv(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:u}=jc({longitude:n,latitude:r,highPrecision:!0}),c=Fa(t);c[0]+=s*(l[0]+u[0]*o),c[1]+=o*(l[1]+u[1]*o);const f=pi(c),h=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[f[0],f[1],h]:f}function $2(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=G2();ka(a,a,[0,0,-i]),rv(a,a,-n*mt),iv(a,a,r*mt);const l=s/e;return uh(a,a,[l,l,l]),o&&ka(a,a,ax([],o)),a}function q2(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:u=1}=t;let{fovy:c=Ua(W2)}=t;r!==void 0&&(c=Ua(r));const f=c*mt,h=i*mt,m=pv(c);let E=m;o&&(E+=o[2]*a/Math.cos(h)/n);const w=f*(.5+(s?s[1]:0)/n),b=Math.sin(w)*E/Math.sin(zc(Math.PI/2-h-w,.01,Math.PI-.01)),v=Math.sin(h)*b+E,g=E*10,_=Math.min(v*u,g);return{fov:f,aspect:e/n,focalDistance:m,near:l,far:_}}function Ua(t){return 2*Math.atan(.5/t)*Vc}function pv(t){return .5/Math.tan(.5*t*mt)}function gv(t,e){const[n,r,i=0]=t;return hn(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Qr(e,[n,r,i,1])}function ph(t,e,n=0){const[r,i,s]=t;if(hn(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return Qr(e,[r,i,s,1]);const o=Qr(e,[r,i,0,1]),a=Qr(e,[r,i,1,1]),l=o[2],u=a[2],c=l===u?0:((n||0)-l)/(u-l);return ev([],o,a,c)}function Z2(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,l],[u,c]]=r,f=K2(t.padding),h=Fa([a,zc(c,-ko,ko)]),m=Fa([u,zc(l,-ko,ko)]),E=[Math.max(Math.abs(m[0]-h[0]),i),Math.max(Math.abs(m[1]-h[1]),i)],w=[e-f.left-f.right-Math.abs(o[0])*2,n-f.top-f.bottom-Math.abs(o[1])*2];hn(w[0]>0&&w[1]>0);const b=w[0]/E[0],v=w[1]/E[1],g=(f.right-f.left)/2/b,_=(f.top-f.bottom)/2/v,S=[(m[0]+h[0])/2+g,(m[1]+h[1])/2+_],P=pi(S),x=Math.min(s,dh(Math.abs(Math.min(b,v))));return hn(Number.isFinite(x)),{longitude:P[0],latitude:P[1],zoom:x}}function K2(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(hn(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const ug=Math.PI/180;function Q2(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let l,u;const c=t.fovy?.5*t.fovy*ug:Math.atan(.5/t.altitude),f=(90-t.pitch)*ug;return c>f-.01?(l=cg(t,0,e),u=cg(t,n,e)):(l=i([0,0],s),u=i([n,0],s)),[o,a,u,l]}function cg(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=Qr(r,[e,0,1,1]),s=Qr(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),l=ev([],i,s,a),u=pi(l);return u.push(n),u}const fg=512;function J2(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=lg(i+180,360)-180),(a<-180||a>180)&&(a=lg(a+180,360)-180);const l=dh(n/fg);if(o<=l)o=l,s=0;else{const u=n/2/Math.pow(2,o),c=pi([0,u])[1];if(s<c)s=c;else{const f=pi([0,fg-u])[1];s>f&&(s=f)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const eL=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,tL=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,nL=Xs(aL),rL=Xs(lL),iL=[0,0,0,1],sL=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function oL(t,e){const[n,r,i]=t,s=ph([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function aL({viewport:t,center:e}){return new Yt(t.viewProjectionMatrix).invert().transform(e)}function lL({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>oL(o,r));for(const o of e){const a=o.clone().translate(new Wt(t.center).negate()),l=s.map(c=>a.transform(c)),u=new Yt().ortho({left:Math.min(...l.map(c=>c[0])),right:Math.max(...l.map(c=>c[0])),bottom:Math.min(...l.map(c=>c[1])),top:Math.max(...l.map(c=>c[1])),near:Math.min(...l.map(c=>-c[2])),far:Math.max(...l.map(c=>-c[2]))});n.push(u.multiplyRight(o))}return n}function uL(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||iL,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=nL({viewport:t.viewport,center:e.project_uCenter}),s=[],o=rL({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const l=o[a],u=l.clone().translate(new Wt(t.viewport.center).negate());e.project_uCoordinateSystem===$.LNGLAT&&e.project_uProjectionMode===Vt.WEB_MERCATOR?(o[a]=u,s[a]=i):(o[a]=l.clone().multiplyRight(sL),s[a]=u.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return r}const vu={name:"shadow",dependencies:[hh],vs:eL,fs:tL,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?uL(t,e):{}},cL={color:[255,255,255],intensity:1},hg=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],fL=[0,0,0,200/255];class mv{constructor(e={}){d(this,"id","lighting-effect"),d(this,"props",void 0),d(this,"shadowColor",fL),d(this,"shadow",void 0),d(this,"ambientLight",void 0),d(this,"directionalLights",void 0),d(this,"pointLights",void 0),d(this,"shadowPasses",[]),d(this,"shadowMaps",[]),d(this,"dummyShadowMap",null),d(this,"programManager",void 0),d(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Ys.getDefaultProgramManager(e),vu&&this.programManager.addDefaultModule(vu)),this.dummyShadowMap||(this.dummyShadowMap=new Rt(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(vu),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Yt().lookAt({eye:new Wt(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new P2(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new v2(cL),this.directionalLights.push(new og(hg[0]),new og(hg[1])))}}class hL{constructor(e={}){d(this,"_pool",[]),d(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const u=i||e&&e.constructor||Float32Array,c=n*r+s;if(ArrayBuffer.isView(e)){if(c<=e.length)return e;if(c*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new u(e.buffer,0,c)}let f=1/0;l&&(f=l*r+s);const h=this._allocate(u,c,a,f);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(u=>u.byteLength>=a);if(l>=0){const u=new e(o.splice(l,1)[0],0,s);return r&&u.fill(0),u}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const gi=new hL;function Ji(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function dL(t){return[t[12],t[13],t[14]]}function pL(t){return{left:Cr(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Cr(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Cr(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Cr(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Cr(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Cr(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const dg=new Wt;function Cr(t,e,n,r){dg.set(t,e,n);const i=dg.len();return{distance:r/i,normal:new Wt(-t/i,-e/i,-n/i)}}function gL(t){return t-Math.fround(t)}let Yi;function _u(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Yi=gi.allocate(Yi,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let l=0;l<n;l++){const u=t[o++];Yi[a+l]=u,Yi[a+l+n]=gL(u)}a+=n*2}return Yi.subarray(0,s*n*2)}function mL(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const yL=Math.PI/180,vL=Ji(),pg=[0,0,0],_L={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function EL({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const l=t/e,u=n?new Yt().orthographic({fovy:r,aspect:l,focalDistance:i,near:o,far:a}):new Yt().perspective({fovy:r,aspect:l,near:o,far:a});if(s){const{left:c=0,right:f=0,top:h=0,bottom:m=0}=s,E=Rn((c+t-f)/2,0,t)-t/2,w=Rn((h+e-m)/2,0,e)-e/2;u[8]-=E*2/t,u[9]+=w*2/e}return u}class bi{constructor(e={}){d(this,"id",void 0),d(this,"x",void 0),d(this,"y",void 0),d(this,"width",void 0),d(this,"height",void 0),d(this,"padding",void 0),d(this,"isGeospatial",void 0),d(this,"zoom",void 0),d(this,"focalDistance",void 0),d(this,"position",void 0),d(this,"modelMatrix",void 0),d(this,"distanceScales",void 0),d(this,"scale",void 0),d(this,"center",void 0),d(this,"cameraPosition",void 0),d(this,"projectionMatrix",void 0),d(this,"viewMatrix",void 0),d(this,"viewMatrixUncentered",void 0),d(this,"viewMatrixInverse",void 0),d(this,"viewProjectionMatrix",void 0),d(this,"pixelProjectionMatrix",void 0),d(this,"pixelUnprojectionMatrix",void 0),d(this,"resolution",void 0),d(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||_L,this.focalDistance=e.focalDistance||1,this.position=e.position||pg,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Vt.WEB_MERCATOR:Vt.WEB_MERCATOR_AUTO_OFFSET:Vt.IDENTITY}equals(e){return e instanceof bi?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&ks(e.projectionMatrix,this.projectionMatrix)&&ks(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=gv(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,l=r&&r*this.distanceScales.unitsPerMeter[2],u=ph([i,a,o],this.pixelUnprojectionMatrix,l),[c,f,h]=this.unprojectPosition(u);return Number.isFinite(o)?[c,f,h]:Number.isFinite(r)?[c,f,r]:[c,f]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=Fa(e);return n[1]=Rn(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?pi(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?jc({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,pL(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=X2({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||jc({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=pg;if(s&&(a=o?new Yt(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([n,r,0]);this.center=new Wt(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=vL,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:u=null,focalDistance:c=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Yt().multiplyRight(n).translate(new Wt(this.center).negate()),this.projectionMatrix=r||EL({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*yL,focalDistance:c,padding:u,near:a,far:l});const f=Ji();lr(f,f,this.projectionMatrix),lr(f,f,this.viewMatrix),this.viewProjectionMatrix=f,this.viewMatrixInverse=Uc([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=dL(this.viewMatrixInverse);const h=Ji(),m=Ji();uh(h,h,[this.width/2,-this.height/2,1]),ka(h,h,[1,-1,0]),lr(m,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=m,this.pixelUnprojectionMatrix=Uc(Ji(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||K.warn("Pixel project matrix not invertible")()}}d(bi,"displayName","Viewport");class mi extends bi{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,orthographic:u=!1,projectionMatrix:c,repeat:f=!1,worldOffset:h=0,position:m,padding:E,legacyMeterSizes:w=!1}=e;let{width:b,height:v,altitude:g=1.5}=e;const _=Math.pow(2,i);b=b||1,v=v||1;let S,P=null;if(c)g=c[5]/2,S=Ua(g);else{e.fovy?(S=e.fovy,g=pv(S)):S=Ua(g);let L;if(E){const{top:M=0,bottom:k=0}=E;L=[0,Rn((M+v-k)/2,0,v)-v/2]}P=q2({width:b,height:v,scale:_,center:m&&[0,0,m[2]*yu(n)],offset:L,pitch:s,fovy:S,nearZMultiplier:a,farZMultiplier:l})}let x=$2({height:v,pitch:s,bearing:o,scale:_,altitude:g});h&&(x=new Yt().translate([512*h,0,0]).multiplyLeft(x)),super({...e,width:b,height:v,viewMatrix:x,longitude:r,latitude:n,zoom:i,...P,fovy:S,focalDistance:g}),d(this,"longitude",void 0),d(this,"latitude",void 0),d(this,"pitch",void 0),d(this,"bearing",void 0),d(this,"altitude",void 0),d(this,"fovy",void 0),d(this,"orthographic",void 0),d(this,"_subViewports",void 0),d(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=g,this.fovy=S,this.orthographic=u,this._subViewports=f?[]:null,this._pseudoMeters=w,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new mi({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*yu(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/yu(r);return[n,r,i]}addMetersToLngLat(e,n){return dv(e,n)}panByPosition(e,n){const r=ph(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=tg([],i,tx([],r)),o=tg([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const n=Q2(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=Z2({width:r,height:i,bounds:e,...n});return new mi({width:r,height:i,longitude:s,latitude:o,zoom:a})}}d(mi,"displayName","WebMercatorViewport");const gg=[0,0,0];function Eu(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof mi){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function wL(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===$.DEFAULT&&(i=e.isGeospatial?$.LNGLAT:$.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function yv(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,l=0]=t;switch(n&&([o,a,l]=Ws([],[o,a,l,1],n)),r){case $.LNGLAT:return Eu([o,a,l],e,s);case $.LNGLAT_OFFSETS:return Eu([o+i[0],a+i[1],l+(i[2]||0)],e,s);case $.METER_OFFSETS:return Eu(dv(i,[o,a,l]),e,s);case $.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],l+i[2]]:e.projectPosition([o,a,l])}}function TL(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=wL(e),{autoOffset:l=!0}=e,{geospatialOrigin:u=gg,shaderCoordinateOrigin:c=gg,offsetMode:f=!1}=l?fv(n,r,i):{},h=yv(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:f});if(f){const m=n.projectPosition(u||c);mx(h,h,m)}return h}const mg={blendFunc:[1,0,32771,0],blendEquation:32774};class vv extends fh{constructor(...e){super(...e),d(this,"pickZ",void 0),d(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:u,height:c},cullRect:f,effects:h,pass:m="picking",pickZ:E,moduleParameters:w}){const b=this.gl;this.pickZ=E;const v=this._resetColorEncoder(E),g=Lt(b,{scissorTest:!0,scissor:[a,l,u,c],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...mg,blend:!E},()=>super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:f,effects:h==null?void 0:h.filter(S=>S.useInPicking),pass:m,isPicking:!0,moduleParameters:w}));return this._colorEncoderState=null,{decodePickingColor:v&&bL.bind(null,v),stats:g}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:o}=e.props;return this._colorEncoderState?s&&o.includes("draw")&&(Object.assign(i,mg),i.blend=!0,i.blendColor=SL(this._colorEncoderState,e,r)):i.blend=!1,o.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function SL(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(K.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function bL(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Mr={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Ba=Symbol.for("component"),ur=Symbol.for("propTypes"),wu=Symbol.for("deprecatedProps"),Jr=Symbol.for("asyncPropDefaults"),gr=Symbol.for("asyncPropOriginal"),Mn=Symbol.for("asyncPropResolved");function _v(t,e=()=>!0){return Array.isArray(t)?Ev(t,e,[]):e(t)?[t]:[]}function Ev(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?Ev(i,e,n):e(i)&&n.push(i)}return n}function AL({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class PL{constructor(e,n,r){d(this,"id",void 0),d(this,"context",void 0),d(this,"isLoaded",void 0),d(this,"persistent",void 0),d(this,"_loadCount",0),d(this,"_subscribers",new Set),d(this,"_data",void 0),d(this,"_loader",void 0),d(this,"_error",void 0),d(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=Ac(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class xL{constructor({gl:e,protocol:n}){d(this,"protocol",void 0),d(this,"_context",void 0),d(this,"_resources",void 0),d(this,"_consumers",void 0),d(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new PL(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{},a=o[n]||{},l=a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),r&&(o[n]=a,a.onChange=i,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const LL=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,CL={name:"project32",dependencies:[hh],vs:LL},RL={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...Gx},ML=[hh],IL=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function OL(t){const e=Ys.getDefaultProgramManager(t);for(const n of ML)e.addDefaultModule(n);for(const n of IL)e.addShaderHook(n);return e}const kL="layerManager.setLayers",NL="layerManager.activateViewport";class DL{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){d(this,"layers",void 0),d(this,"context",void 0),d(this,"resourceManager",void 0),d(this,"_lastRenderedLayers",[]),d(this,"_needsRedraw",!1),d(this,"_needsUpdate",!1),d(this,"_nextLayers",null),d(this,"_debug",!1),d(this,"activateViewport",o=>{Ue(NL,this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new xL({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&OL(e),stats:r||new Zf({id:"deck.gl"}),viewport:i||new bi({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new ov,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Ue(kL,this,n,e),this._lastRenderedLayers=e;const r=_v(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?K.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&K.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Mr.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Mr.MATCHED,n!==e&&(e.lifecycle=Mr.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Mr.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Mr.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function jt(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!jt(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!jt(t[s],e[s],n-1))return!1;return!0}return!1}class FL{constructor(e){d(this,"width",void 0),d(this,"height",void 0),d(this,"views",void 0),d(this,"viewState",void 0),d(this,"controllers",void 0),d(this,"timeline",void 0),d(this,"_viewports",void 0),d(this,"_viewportMap",void 0),d(this,"_isUpdating",void 0),d(this,"_needsRedraw",void 0),d(this,"_needsUpdate",void 0),d(this,"_eventManager",void 0),d(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=_v(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!jt(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):K.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))===null||o===void 0?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return i||(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=n[s.id];const u=!!s.controller;u&&!l&&(r=!0),(r||!u)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const UL=/([0-9]+\.?[0-9]*)(%|px)/;function En(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=UL.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function wn(t,e){return t.relative?Math.round(t.position*e):t.position}function be(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class yi{constructor(e){d(this,"id",void 0),d(this,"viewportInstance",void 0),d(this,"_x",void 0),d(this,"_y",void 0),d(this,"_width",void 0),d(this,"_height",void 0),d(this,"_padding",void 0),d(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:l}=e||{};be(!l||l instanceof bi),this.viewportInstance=l,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=En(r),this._y=En(i),this._width=En(s),this._height=En(o),this._padding=a&&{left:En(a.left||0),right:En(a.right||0),top:En(a.top||0),bottom:En(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&jt(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:wn(this._x,e),y:wn(this._y,n),width:wn(this._width,e),height:wn(this._height,n)};return this._padding&&(r.padding={left:wn(this._padding.left,e),top:wn(this._padding.top,n),right:wn(this._padding.right,e),bottom:wn(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class $s{constructor(e){d(this,"_inProgress",void 0),d(this,"_handle",void 0),d(this,"_timeline",void 0),d(this,"time",void 0),d(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const yg=()=>{},Gc={BREAK:1,SNAP_TO_END:2,IGNORE:3},BL=t=>t,zL=Gc.BREAK;class VL{constructor(e){d(this,"getControllerState",void 0),d(this,"props",void 0),d(this,"propsInTransition",void 0),d(this,"transition",void 0),d(this,"onViewStateChange",void 0),d(this,"onStateChange",void 0),d(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:l}}=n,u=l(r/a),c=i.interpolateProps(s,o,u);this.propsInTransition=this.getControllerState({...this.props,...c}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new $s(e.timeline),this.onViewStateChange=e.onViewStateChange||yg,this.onStateChange=e.onStateChange||yg}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===Gc.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Gc.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const l={duration:o,easing:n.transitionEasing||BL,interpolator:s,interruption:n.transitionInterruption||zL,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class jL{constructor(e){d(this,"_propsToCompare",void 0),d(this,"_propsToExtract",void 0),d(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!ks(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];be(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const GL=["longitude","latitude","zoom","bearing","pitch"],HL=["longitude","latitude","zoom"];class wv extends jL{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:GL,required:HL},super(r.transitionProps),d(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),l=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(l),aroundPosition:l,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Oa(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Oa(e.around,n.around,r)))}return i}}const Tn={transitionDuration:0},WL=300,No=t=>1-(1-t)*(1-t),Rr={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Kn={};class YL{constructor(e){d(this,"props",void 0),d(this,"state",{}),d(this,"transitionManager",void 0),d(this,"eventManager",void 0),d(this,"onViewStateChange",void 0),d(this,"onStateChange",void 0),d(this,"makeViewport",void 0),d(this,"_controllerState",void 0),d(this,"_events",{}),d(this,"_interactionState",{isDragging:!1}),d(this,"_customEvents",[]),d(this,"_eventStartBlocked",null),d(this,"_panMove",!1),d(this,"invertPan",!1),d(this,"dragMode","rotate"),d(this,"inertia",0),d(this,"scrollZoom",!0),d(this,"dragPan",!0),d(this,"dragRotate",!0),d(this,"doubleClickZoom",!0),d(this,"touchZoom",!0),d(this,"touchRotate",!1),d(this,"keyboard",!0),this.transitionManager=new VL({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?WL:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:u=!0}=e,c=!!this.onViewStateChange;this.toggleEvents(Rr.WHEEL,c&&r),this.toggleEvents(Rr.PAN,c&&(i||s)),this.toggleEvents(Rr.PINCH,c&&(a||l)),this.toggleEvents(Rr.TRIPLE_PAN,c&&l),this.toggleEvents(Rr.DOUBLE_TAP,c&&o),this.toggleEvents(Rr.KEYBOARD,c&&u),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=u}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Tn,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Tn,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:No},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Tn,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:No},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Tn,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Tn,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:No},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Kn._startPinchRotation=e.rotation,Kn._lastPinchEvent=e,this.updateViewport(r,Tn,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Kn._startPinchRotation-r})}return this.updateViewport(n,Tn,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Kn._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Kn;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),l=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:No},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Kn._startPinchRotation=null,Kn._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let l;const u={};switch(e.srcEvent.code){case"Minus":l=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),u.isZooming=!0;break;case"Equal":l=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),u.isZooming=!0;break;case"ArrowLeft":n?(l=a.rotateLeft(s),u.isRotating=!0):(l=a.moveLeft(i),u.isPanning=!0);break;case"ArrowRight":n?(l=a.rotateRight(s),u.isRotating=!0):(l=a.moveRight(i),u.isPanning=!0);break;case"ArrowUp":n?(l=a.rotateUp(o),u.isRotating=!0):(l=a.moveUp(i),u.isPanning=!0);break;case"ArrowDown":n?(l=a.rotateDown(o),u.isRotating=!0):(l=a.moveDown(i),u.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),u),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Tn:e?{...n,transitionInterpolator:new wv({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class XL{constructor(e,n){d(this,"_viewportProps",void 0),d(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const vg=5,$L=1.2;class qL extends XL{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:u=1.5,position:c=[0,0,0],maxZoom:f=20,minZoom:h=0,maxPitch:m=60,minPitch:E=0,startPanLngLat:w,startZoomLngLat:b,startRotatePos:v,startBearing:g,startPitch:_,startZoom:S,normalize:P=!0}=e;be(Number.isFinite(s)),be(Number.isFinite(i)),be(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:l,altitude:u,maxZoom:f,minZoom:h,maxPitch:m,minPitch:E,normalize:P,position:c},{startPanLngLat:w,startZoomLngLat:b,startRotatePos:v,startBearing:g,startPitch:_,startZoom:S}),d(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=Rn(l,a,o);const u=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...u.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Rn(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Rn(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,J2(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],l=n[1],{width:u,height:c}=this.getViewportProps(),f=s/u;let h=0;o>0?Math.abs(c-l)>vg&&(h=o/(l-c)*$L):o<0&&l>vg&&(h=1-a/l),h=Rn(h,-1,1);const{minPitch:m,maxPitch:E}=this.getViewportProps(),w=i+180*f;let b=r;return h>0?b=r+h*(E-r):h<0&&(b=r-h*(m-r)),{pitch:b,bearing:w}}}class ZL extends YL{constructor(...e){super(...e),d(this,"ControllerState",qL),d(this,"transition",{transitionDuration:300,transitionInterpolator:new wv({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),d(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Tv extends yi{get ViewportType(){return mi}get ControllerType(){return ZL}}d(Tv,"displayName","MapView");const KL=new mv;function QL(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class JL{constructor(){d(this,"effects",void 0),d(this,"_resolvedEffects",[]),d(this,"_defaultEffects",[]),d(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>QL(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(jt(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof mv)||this._resolvedEffects.push(KL),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class e3 extends fh{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const t3="deckRenderer.renderLayers";class n3{constructor(e){d(this,"gl",void 0),d(this,"layerFilter",void 0),d(this,"drawPickingColors",void 0),d(this,"drawLayersPass",void 0),d(this,"pickLayersPass",void 0),d(this,"renderCount",void 0),d(this,"_needsRedraw",void 0),d(this,"renderBuffers",void 0),d(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new e3(e),this.pickLayersPass=new vv(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||we.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,Ue(t3,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new we(this.gl),new we(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const o=s.postRender(this.gl,i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const r3={pickedColor:null,pickedObjectIndex:-1};function i3({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:l,height:u}=s;let c=i*i,f=-1,h=0;for(let m=0;m<u;m++){const E=m+a-r,w=E*E;if(w>c)h+=4*l;else for(let b=0;b<l;b++){if(t[h+3]-1>=0){const g=b+o-n,_=g*g+w;_<=c&&(c=_,f=h)}h+=4}}if(f>=0){const m=t.slice(f,f+4),E=e(m);if(E){const w=Math.floor(f/4/l),b=f/4-w*l;return{...E,pickedColor:m,pickedX:o+b,pickedY:a+w}}K.error("Picked non-existent layer. Is picking buffer corrupt?")()}return r3}function s3({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):K.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function Sv({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=a3((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const l=[r-o.x,i-o.y];s!==void 0&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function o3(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if(r==="hover"){const f=n.index,h=n.layerId,m=o?o.props.id:null;if(m!==h||a!==f){if(m!==h){const E=i.find(w=>w.props.id===h);E&&l.unshift(E)}n.layerId=m,n.index=a,n.info=null}}const u=Sv(t),c=new Map;return c.set(null,u),l.forEach(f=>{let h={...u};f===o&&(h.color=s,h.index=a,h.picked=!0),h=bv({layer:f,info:h,mode:r});const m=h.layer;f===o&&r==="hover"&&(n.info=h),c.set(m.id,h),r==="hover"&&m.updateAutoHighlight(h)}),c}function bv({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function a3(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class l3{constructor(e){d(this,"gl",void 0),d(this,"pickingFBO",void 0),d(this,"depthFBO",void 0),d(this,"pickLayersPass",void 0),d(this,"layerFilter",void 0),d(this,"lastPickedInfo",void 0),d(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new vv(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find(h=>h.id===o):null,u=a&&i.find(h=>h.id===a)||i[0],c=u&&u.unproject([e-u.x,n-u.y]);return{...s,...{x:e,y:n,viewport:u,coordinate:c,layer:l}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new we(r),we.isSupported(r,{colorBufferFloat:!0}))){const i=new we(r);i.attach({[36064]:new Rt(r,{format:H(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:u,onViewportActive:c,effects:f}){const h=this._getPickable(e),m=ai(this.gl);if(!h)return{result:[],emptyInfo:Sv({viewports:r,x:i,y:s,pixelRatio:m})};this._resizeBuffer();const E=iu(this.gl,[i,s],!0),w=[E.x+Math.floor(E.width/2),E.y+Math.floor(E.height/2)],b=Math.round(o*m),{width:v,height:g}=this.pickingFBO,_=this._getPickingRect({deviceX:w[0],deviceY:w[1],deviceRadius:b,deviceWidth:v,deviceHeight:g}),S={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let P;const x=[],L=new Set;for(let M=0;M<a;M++){let k;if(_){const z=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:c,deviceRect:_,cullRect:S,effects:f,pass:"picking:".concat(l)});k=i3({...z,deviceX:w[0],deviceY:w[1],deviceRadius:b,deviceRect:_})}else k={pickedColor:null,pickedObjectIndex:-1};let I;if(k.pickedLayer&&u&&this.depthFBO){const{pickedColors:z}=this._drawAndSample({layers:[k.pickedLayer],views:n,viewports:r,onViewportActive:c,deviceRect:{x:k.pickedX,y:k.pickedY,width:1,height:1},cullRect:S,effects:f,pass:"picking:".concat(l,":z")},!0);z[3]&&(I=z[0])}k.pickedLayer&&M+1<a&&(L.add(k.pickedLayer),k.pickedLayer.disablePickingIndex(k.pickedObjectIndex)),P=o3({pickInfo:k,lastPickedInfo:this.lastPickedInfo,mode:l,layers:h,viewports:r,x:i,y:s,z:I,pixelRatio:m});for(const z of P.values())z.layer&&x.push(z);if(!k.pickedColor)break}for(const M of L)M.restorePickingColors();return{result:x,emptyInfo:P.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:u=null,onViewportActive:c,effects:f}){const h=this._getPickable(e);if(!h)return[];this._resizeBuffer();const m=ai(this.gl),E=iu(this.gl,[i,s],!0),w=E.x,b=E.y+E.height,v=iu(this.gl,[i+o,s+a],!0),g=v.x+v.width,_=v.y,S={x:w,y:_,width:g-w,height:b-_},P=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:c,deviceRect:S,cullRect:{x:i,y:s,width:o,height:a},effects:f,pass:"picking:".concat(l)}),x=s3(P),L=new Map,M=Number.isFinite(u);for(let k=0;k<x.length&&!(M&&u&&L.size>=u);k++){const I=x[k];let z={color:I.pickedColor,layer:null,index:I.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:m};z=bv({layer:I.pickedLayer,info:z,mode:l}),L.has(z.object)||L.set(z.object,z)}return Array.from(L.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l},u=!1){const c=u?this.depthFBO:this.pickingFBO,f={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:c,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:u,preRenderStats:{}};for(const g of a)g.useInPicking&&(f.preRenderStats[g.id]=g.preRender(this.gl,f));const{decodePickingColor:h}=this.pickLayersPass.render(f),{x:m,y:E,width:w,height:b}=s,v=new(u?Float32Array:Uint8Array)(w*b*4);return ll(c,{sourceX:m,sourceY:E,sourceWidth:w,sourceHeight:b,target:v}),{pickedColors:v,decodePickingColor:h}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),l=Math.min(i,e+r+1)-o,u=Math.min(s,n+r+1)-a;return l<=0||u<=0?null:{x:o,y:a,width:l,height:u}}}const u3={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class c3{constructor(e){d(this,"el",null),d(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,u3),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className),Object.assign(i.style,e.style);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}var mr={},f3={get exports(){return mr},set exports(t){mr=t}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",l=Math.round,u=Math.abs,c=Date.now;function f(p,y,T){return setTimeout(_(p,T),y)}function h(p,y,T){return Array.isArray(p)?(m(p,T[y],T),!0):!1}function m(p,y,T){var A;if(p)if(p.forEach)p.forEach(y,T);else if(p.length!==i)for(A=0;A<p.length;)y.call(T,p[A],A,p),A++;else for(A in p)p.hasOwnProperty(A)&&y.call(T,p[A],A,p)}function E(p,y,T){var A="DEPRECATED METHOD: "+y+`
`+T+` AT 
`;return function(){var C=new Error("get-stack-trace"),D=C&&C.stack?C.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",G=e.console&&(e.console.warn||e.console.log);return G&&G.call(e.console,A,D),p.apply(this,arguments)}}var w;typeof Object.assign!="function"?w=function(y){if(y===i||y===null)throw new TypeError("Cannot convert undefined or null to object");for(var T=Object(y),A=1;A<arguments.length;A++){var C=arguments[A];if(C!==i&&C!==null)for(var D in C)C.hasOwnProperty(D)&&(T[D]=C[D])}return T}:w=Object.assign;var b=E(function(y,T,A){for(var C=Object.keys(T),D=0;D<C.length;)(!A||A&&y[C[D]]===i)&&(y[C[D]]=T[C[D]]),D++;return y},"extend","Use `assign`."),v=E(function(y,T){return b(y,T,!0)},"merge","Use `assign`.");function g(p,y,T){var A=y.prototype,C;C=p.prototype=Object.create(A),C.constructor=p,C._super=A,T&&w(C,T)}function _(p,y){return function(){return p.apply(y,arguments)}}function S(p,y){return typeof p==a?p.apply(y&&y[0]||i,y):p}function P(p,y){return p===i?y:p}function x(p,y,T){m(I(y),function(A){p.addEventListener(A,T,!1)})}function L(p,y,T){m(I(y),function(A){p.removeEventListener(A,T,!1)})}function M(p,y){for(;p;){if(p==y)return!0;p=p.parentNode}return!1}function k(p,y){return p.indexOf(y)>-1}function I(p){return p.trim().split(/\s+/g)}function z(p,y,T){if(p.indexOf&&!T)return p.indexOf(y);for(var A=0;A<p.length;){if(T&&p[A][T]==y||!T&&p[A]===y)return A;A++}return-1}function ee(p){return Array.prototype.slice.call(p,0)}function ie(p,y,T){for(var A=[],C=[],D=0;D<p.length;){var G=y?p[D][y]:p[D];z(C,G)<0&&A.push(p[D]),C[D]=G,D++}return T&&(y?A=A.sort(function(Pe,De){return Pe[y]>De[y]}):A=A.sort()),A}function Y(p,y){for(var T,A,C=y[0].toUpperCase()+y.slice(1),D=0;D<s.length;){if(T=s[D],A=T?T+C:y,A in p)return A;D++}return i}var Xt=1;function Ai(){return Xt++}function wr(p){var y=p.ownerDocument||p;return y.defaultView||y.parentWindow||e}var F=/mobile|tablet|ip(ad|hone|od)|android/i,V="ontouchstart"in e,j=Y(e,"PointerEvent")!==i,le=V&&F.test(navigator.userAgent),se="touch",Tr="pen",_t="mouse",Pi="kinect",$t=25,ge=1,Xn=2,me=4,He=8,Zs=1,xi=2,Li=4,Ci=8,Ri=16,Mt=xi|Li,$n=Ci|Ri,Th=Mt|$n,Sh=["x","y"],Ks=["clientX","clientY"];function ut(p,y){var T=this;this.manager=p,this.callback=y,this.element=p.element,this.target=p.options.inputTarget,this.domHandler=function(A){S(p.options.enable,[p])&&T.handler(A)},this.init()}ut.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(wr(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&L(this.element,this.evEl,this.domHandler),this.evTarget&&L(this.target,this.evTarget,this.domHandler),this.evWin&&L(wr(this.element),this.evWin,this.domHandler)}};function Xv(p){var y,T=p.options.inputClass;return T?y=T:j?y=gl:le?y=eo:V?y=ml:y=Js,new y(p,$v)}function $v(p,y,T){var A=T.pointers.length,C=T.changedPointers.length,D=y&ge&&A-C===0,G=y&(me|He)&&A-C===0;T.isFirst=!!D,T.isFinal=!!G,D&&(p.session={}),T.eventType=y,qv(p,T),p.emit("hammer.input",T),p.recognize(T),p.session.prevInput=T}function qv(p,y){var T=p.session,A=y.pointers,C=A.length;T.firstInput||(T.firstInput=bh(y)),C>1&&!T.firstMultiple?T.firstMultiple=bh(y):C===1&&(T.firstMultiple=!1);var D=T.firstInput,G=T.firstMultiple,Te=G?G.center:D.center,Pe=y.center=Ah(A);y.timeStamp=c(),y.deltaTime=y.timeStamp-D.timeStamp,y.angle=pl(Te,Pe),y.distance=Qs(Te,Pe),Zv(T,y),y.offsetDirection=xh(y.deltaX,y.deltaY);var De=Ph(y.deltaTime,y.deltaX,y.deltaY);y.overallVelocityX=De.x,y.overallVelocityY=De.y,y.overallVelocity=u(De.x)>u(De.y)?De.x:De.y,y.scale=G?Jv(G.pointers,A):1,y.rotation=G?Qv(G.pointers,A):0,y.maxPointers=T.prevInput?y.pointers.length>T.prevInput.maxPointers?y.pointers.length:T.prevInput.maxPointers:y.pointers.length,Kv(T,y);var Ot=p.element;M(y.srcEvent.target,Ot)&&(Ot=y.srcEvent.target),y.target=Ot}function Zv(p,y){var T=y.center,A=p.offsetDelta||{},C=p.prevDelta||{},D=p.prevInput||{};(y.eventType===ge||D.eventType===me)&&(C=p.prevDelta={x:D.deltaX||0,y:D.deltaY||0},A=p.offsetDelta={x:T.x,y:T.y}),y.deltaX=C.x+(T.x-A.x),y.deltaY=C.y+(T.y-A.y)}function Kv(p,y){var T=p.lastInterval||y,A=y.timeStamp-T.timeStamp,C,D,G,Te;if(y.eventType!=He&&(A>$t||T.velocity===i)){var Pe=y.deltaX-T.deltaX,De=y.deltaY-T.deltaY,Ot=Ph(A,Pe,De);D=Ot.x,G=Ot.y,C=u(Ot.x)>u(Ot.y)?Ot.x:Ot.y,Te=xh(Pe,De),p.lastInterval=y}else C=T.velocity,D=T.velocityX,G=T.velocityY,Te=T.direction;y.velocity=C,y.velocityX=D,y.velocityY=G,y.direction=Te}function bh(p){for(var y=[],T=0;T<p.pointers.length;)y[T]={clientX:l(p.pointers[T].clientX),clientY:l(p.pointers[T].clientY)},T++;return{timeStamp:c(),pointers:y,center:Ah(y),deltaX:p.deltaX,deltaY:p.deltaY}}function Ah(p){var y=p.length;if(y===1)return{x:l(p[0].clientX),y:l(p[0].clientY)};for(var T=0,A=0,C=0;C<y;)T+=p[C].clientX,A+=p[C].clientY,C++;return{x:l(T/y),y:l(A/y)}}function Ph(p,y,T){return{x:y/p||0,y:T/p||0}}function xh(p,y){return p===y?Zs:u(p)>=u(y)?p<0?xi:Li:y<0?Ci:Ri}function Qs(p,y,T){T||(T=Sh);var A=y[T[0]]-p[T[0]],C=y[T[1]]-p[T[1]];return Math.sqrt(A*A+C*C)}function pl(p,y,T){T||(T=Sh);var A=y[T[0]]-p[T[0]],C=y[T[1]]-p[T[1]];return Math.atan2(C,A)*180/Math.PI}function Qv(p,y){return pl(y[1],y[0],Ks)+pl(p[1],p[0],Ks)}function Jv(p,y){return Qs(y[0],y[1],Ks)/Qs(p[0],p[1],Ks)}var e_={mousedown:ge,mousemove:Xn,mouseup:me},t_="mousedown",n_="mousemove mouseup";function Js(){this.evEl=t_,this.evWin=n_,this.pressed=!1,ut.apply(this,arguments)}g(Js,ut,{handler:function(y){var T=e_[y.type];T&ge&&y.button===0&&(this.pressed=!0),T&Xn&&y.which!==1&&(T=me),this.pressed&&(T&me&&(this.pressed=!1),this.callback(this.manager,T,{pointers:[y],changedPointers:[y],pointerType:_t,srcEvent:y}))}});var r_={pointerdown:ge,pointermove:Xn,pointerup:me,pointercancel:He,pointerout:He},i_={2:se,3:Tr,4:_t,5:Pi},Lh="pointerdown",Ch="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Lh="MSPointerDown",Ch="MSPointerMove MSPointerUp MSPointerCancel");function gl(){this.evEl=Lh,this.evWin=Ch,ut.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}g(gl,ut,{handler:function(y){var T=this.store,A=!1,C=y.type.toLowerCase().replace("ms",""),D=r_[C],G=i_[y.pointerType]||y.pointerType,Te=G==se,Pe=z(T,y.pointerId,"pointerId");D&ge&&(y.button===0||Te)?Pe<0&&(T.push(y),Pe=T.length-1):D&(me|He)&&(A=!0),!(Pe<0)&&(T[Pe]=y,this.callback(this.manager,D,{pointers:T,changedPointers:[y],pointerType:G,srcEvent:y}),A&&T.splice(Pe,1))}});var s_={touchstart:ge,touchmove:Xn,touchend:me,touchcancel:He},o_="touchstart",a_="touchstart touchmove touchend touchcancel";function Rh(){this.evTarget=o_,this.evWin=a_,this.started=!1,ut.apply(this,arguments)}g(Rh,ut,{handler:function(y){var T=s_[y.type];if(T===ge&&(this.started=!0),!!this.started){var A=l_.call(this,y,T);T&(me|He)&&A[0].length-A[1].length===0&&(this.started=!1),this.callback(this.manager,T,{pointers:A[0],changedPointers:A[1],pointerType:se,srcEvent:y})}}});function l_(p,y){var T=ee(p.touches),A=ee(p.changedTouches);return y&(me|He)&&(T=ie(T.concat(A),"identifier",!0)),[T,A]}var u_={touchstart:ge,touchmove:Xn,touchend:me,touchcancel:He},c_="touchstart touchmove touchend touchcancel";function eo(){this.evTarget=c_,this.targetIds={},ut.apply(this,arguments)}g(eo,ut,{handler:function(y){var T=u_[y.type],A=f_.call(this,y,T);A&&this.callback(this.manager,T,{pointers:A[0],changedPointers:A[1],pointerType:se,srcEvent:y})}});function f_(p,y){var T=ee(p.touches),A=this.targetIds;if(y&(ge|Xn)&&T.length===1)return A[T[0].identifier]=!0,[T,T];var C,D,G=ee(p.changedTouches),Te=[],Pe=this.target;if(D=T.filter(function(De){return M(De.target,Pe)}),y===ge)for(C=0;C<D.length;)A[D[C].identifier]=!0,C++;for(C=0;C<G.length;)A[G[C].identifier]&&Te.push(G[C]),y&(me|He)&&delete A[G[C].identifier],C++;if(Te.length)return[ie(D.concat(Te),"identifier",!0),Te]}var h_=2500,Mh=25;function ml(){ut.apply(this,arguments);var p=_(this.handler,this);this.touch=new eo(this.manager,p),this.mouse=new Js(this.manager,p),this.primaryTouch=null,this.lastTouches=[]}g(ml,ut,{handler:function(y,T,A){var C=A.pointerType==se,D=A.pointerType==_t;if(!(D&&A.sourceCapabilities&&A.sourceCapabilities.firesTouchEvents)){if(C)d_.call(this,T,A);else if(D&&p_.call(this,A))return;this.callback(y,T,A)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function d_(p,y){p&ge?(this.primaryTouch=y.changedPointers[0].identifier,Ih.call(this,y)):p&(me|He)&&Ih.call(this,y)}function Ih(p){var y=p.changedPointers[0];if(y.identifier===this.primaryTouch){var T={x:y.clientX,y:y.clientY};this.lastTouches.push(T);var A=this.lastTouches,C=function(){var D=A.indexOf(T);D>-1&&A.splice(D,1)};setTimeout(C,h_)}}function p_(p){for(var y=p.srcEvent.clientX,T=p.srcEvent.clientY,A=0;A<this.lastTouches.length;A++){var C=this.lastTouches[A],D=Math.abs(y-C.x),G=Math.abs(T-C.y);if(D<=Mh&&G<=Mh)return!0}return!1}var Oh=Y(o.style,"touchAction"),kh=Oh!==i,Nh="compute",Dh="auto",yl="manipulation",qn="none",Mi="pan-x",Ii="pan-y",to=m_();function vl(p,y){this.manager=p,this.set(y)}vl.prototype={set:function(p){p==Nh&&(p=this.compute()),kh&&this.manager.element.style&&to[p]&&(this.manager.element.style[Oh]=p),this.actions=p.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var p=[];return m(this.manager.recognizers,function(y){S(y.options.enable,[y])&&(p=p.concat(y.getTouchAction()))}),g_(p.join(" "))},preventDefaults:function(p){var y=p.srcEvent,T=p.offsetDirection;if(this.manager.session.prevented){y.preventDefault();return}var A=this.actions,C=k(A,qn)&&!to[qn],D=k(A,Ii)&&!to[Ii],G=k(A,Mi)&&!to[Mi];if(C){var Te=p.pointers.length===1,Pe=p.distance<2,De=p.deltaTime<250;if(Te&&Pe&&De)return}if(!(G&&D)&&(C||D&&T&Mt||G&&T&$n))return this.preventSrc(y)},preventSrc:function(p){this.manager.session.prevented=!0,p.preventDefault()}};function g_(p){if(k(p,qn))return qn;var y=k(p,Mi),T=k(p,Ii);return y&&T?qn:y||T?y?Mi:Ii:k(p,yl)?yl:Dh}function m_(){if(!kh)return!1;var p={},y=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(T){p[T]=y?e.CSS.supports("touch-action",T):!0}),p}var no=1,ct=2,Sr=4,mn=8,qt=mn,Oi=16,It=32;function Zt(p){this.options=w({},this.defaults,p||{}),this.id=Ai(),this.manager=null,this.options.enable=P(this.options.enable,!0),this.state=no,this.simultaneous={},this.requireFail=[]}Zt.prototype={defaults:{},set:function(p){return w(this.options,p),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(p){if(h(p,"recognizeWith",this))return this;var y=this.simultaneous;return p=ro(p,this),y[p.id]||(y[p.id]=p,p.recognizeWith(this)),this},dropRecognizeWith:function(p){return h(p,"dropRecognizeWith",this)?this:(p=ro(p,this),delete this.simultaneous[p.id],this)},requireFailure:function(p){if(h(p,"requireFailure",this))return this;var y=this.requireFail;return p=ro(p,this),z(y,p)===-1&&(y.push(p),p.requireFailure(this)),this},dropRequireFailure:function(p){if(h(p,"dropRequireFailure",this))return this;p=ro(p,this);var y=z(this.requireFail,p);return y>-1&&this.requireFail.splice(y,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(p){return!!this.simultaneous[p.id]},emit:function(p){var y=this,T=this.state;function A(C){y.manager.emit(C,p)}T<mn&&A(y.options.event+Fh(T)),A(y.options.event),p.additionalEvent&&A(p.additionalEvent),T>=mn&&A(y.options.event+Fh(T))},tryEmit:function(p){if(this.canEmit())return this.emit(p);this.state=It},canEmit:function(){for(var p=0;p<this.requireFail.length;){if(!(this.requireFail[p].state&(It|no)))return!1;p++}return!0},recognize:function(p){var y=w({},p);if(!S(this.options.enable,[this,y])){this.reset(),this.state=It;return}this.state&(qt|Oi|It)&&(this.state=no),this.state=this.process(y),this.state&(ct|Sr|mn|Oi)&&this.tryEmit(y)},process:function(p){},getTouchAction:function(){},reset:function(){}};function Fh(p){return p&Oi?"cancel":p&mn?"end":p&Sr?"move":p&ct?"start":""}function Uh(p){return p==Ri?"down":p==Ci?"up":p==xi?"left":p==Li?"right":""}function ro(p,y){var T=y.manager;return T?T.get(p):p}function Et(){Zt.apply(this,arguments)}g(Et,Zt,{defaults:{pointers:1},attrTest:function(p){var y=this.options.pointers;return y===0||p.pointers.length===y},process:function(p){var y=this.state,T=p.eventType,A=y&(ct|Sr),C=this.attrTest(p);return A&&(T&He||!C)?y|Oi:A||C?T&me?y|mn:y&ct?y|Sr:ct:It}});function io(){Et.apply(this,arguments),this.pX=null,this.pY=null}g(io,Et,{defaults:{event:"pan",threshold:10,pointers:1,direction:Th},getTouchAction:function(){var p=this.options.direction,y=[];return p&Mt&&y.push(Ii),p&$n&&y.push(Mi),y},directionTest:function(p){var y=this.options,T=!0,A=p.distance,C=p.direction,D=p.deltaX,G=p.deltaY;return C&y.direction||(y.direction&Mt?(C=D===0?Zs:D<0?xi:Li,T=D!=this.pX,A=Math.abs(p.deltaX)):(C=G===0?Zs:G<0?Ci:Ri,T=G!=this.pY,A=Math.abs(p.deltaY))),p.direction=C,T&&A>y.threshold&&C&y.direction},attrTest:function(p){return Et.prototype.attrTest.call(this,p)&&(this.state&ct||!(this.state&ct)&&this.directionTest(p))},emit:function(p){this.pX=p.deltaX,this.pY=p.deltaY;var y=Uh(p.direction);y&&(p.additionalEvent=this.options.event+y),this._super.emit.call(this,p)}});function _l(){Et.apply(this,arguments)}g(_l,Et,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[qn]},attrTest:function(p){return this._super.attrTest.call(this,p)&&(Math.abs(p.scale-1)>this.options.threshold||this.state&ct)},emit:function(p){if(p.scale!==1){var y=p.scale<1?"in":"out";p.additionalEvent=this.options.event+y}this._super.emit.call(this,p)}});function El(){Zt.apply(this,arguments),this._timer=null,this._input=null}g(El,Zt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Dh]},process:function(p){var y=this.options,T=p.pointers.length===y.pointers,A=p.distance<y.threshold,C=p.deltaTime>y.time;if(this._input=p,!A||!T||p.eventType&(me|He)&&!C)this.reset();else if(p.eventType&ge)this.reset(),this._timer=f(function(){this.state=qt,this.tryEmit()},y.time,this);else if(p.eventType&me)return qt;return It},reset:function(){clearTimeout(this._timer)},emit:function(p){this.state===qt&&(p&&p.eventType&me?this.manager.emit(this.options.event+"up",p):(this._input.timeStamp=c(),this.manager.emit(this.options.event,this._input)))}});function wl(){Et.apply(this,arguments)}g(wl,Et,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[qn]},attrTest:function(p){return this._super.attrTest.call(this,p)&&(Math.abs(p.rotation)>this.options.threshold||this.state&ct)}});function Tl(){Et.apply(this,arguments)}g(Tl,Et,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Mt|$n,pointers:1},getTouchAction:function(){return io.prototype.getTouchAction.call(this)},attrTest:function(p){var y=this.options.direction,T;return y&(Mt|$n)?T=p.overallVelocity:y&Mt?T=p.overallVelocityX:y&$n&&(T=p.overallVelocityY),this._super.attrTest.call(this,p)&&y&p.offsetDirection&&p.distance>this.options.threshold&&p.maxPointers==this.options.pointers&&u(T)>this.options.velocity&&p.eventType&me},emit:function(p){var y=Uh(p.offsetDirection);y&&this.manager.emit(this.options.event+y,p),this.manager.emit(this.options.event,p)}});function so(){Zt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}g(so,Zt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[yl]},process:function(p){var y=this.options,T=p.pointers.length===y.pointers,A=p.distance<y.threshold,C=p.deltaTime<y.time;if(this.reset(),p.eventType&ge&&this.count===0)return this.failTimeout();if(A&&C&&T){if(p.eventType!=me)return this.failTimeout();var D=this.pTime?p.timeStamp-this.pTime<y.interval:!0,G=!this.pCenter||Qs(this.pCenter,p.center)<y.posThreshold;this.pTime=p.timeStamp,this.pCenter=p.center,!G||!D?this.count=1:this.count+=1,this._input=p;var Te=this.count%y.taps;if(Te===0)return this.hasRequireFailures()?(this._timer=f(function(){this.state=qt,this.tryEmit()},y.interval,this),ct):qt}return It},failTimeout:function(){return this._timer=f(function(){this.state=It},this.options.interval,this),It},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==qt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Kt(p,y){return y=y||{},y.recognizers=P(y.recognizers,Kt.defaults.preset),new Sl(p,y)}Kt.VERSION="2.0.7",Kt.defaults={domEvents:!1,touchAction:Nh,enable:!0,inputTarget:null,inputClass:null,preset:[[wl,{enable:!1}],[_l,{enable:!1},["rotate"]],[Tl,{direction:Mt}],[io,{direction:Mt},["swipe"]],[so],[so,{event:"doubletap",taps:2},["tap"]],[El]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var y_=1,Bh=2;function Sl(p,y){this.options=w({},Kt.defaults,y||{}),this.options.inputTarget=this.options.inputTarget||p,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=p,this.input=Xv(this),this.touchAction=new vl(this,this.options.touchAction),zh(this,!0),m(this.options.recognizers,function(T){var A=this.add(new T[0](T[1]));T[2]&&A.recognizeWith(T[2]),T[3]&&A.requireFailure(T[3])},this)}Sl.prototype={set:function(p){return w(this.options,p),p.touchAction&&this.touchAction.update(),p.inputTarget&&(this.input.destroy(),this.input.target=p.inputTarget,this.input.init()),this},stop:function(p){this.session.stopped=p?Bh:y_},recognize:function(p){var y=this.session;if(!y.stopped){this.touchAction.preventDefaults(p);var T,A=this.recognizers,C=y.curRecognizer;(!C||C&&C.state&qt)&&(C=y.curRecognizer=null);for(var D=0;D<A.length;)T=A[D],y.stopped!==Bh&&(!C||T==C||T.canRecognizeWith(C))?T.recognize(p):T.reset(),!C&&T.state&(ct|Sr|mn)&&(C=y.curRecognizer=T),D++}},get:function(p){if(p instanceof Zt)return p;for(var y=this.recognizers,T=0;T<y.length;T++)if(y[T].options.event==p)return y[T];return null},add:function(p){if(h(p,"add",this))return this;var y=this.get(p.options.event);return y&&this.remove(y),this.recognizers.push(p),p.manager=this,this.touchAction.update(),p},remove:function(p){if(h(p,"remove",this))return this;if(p=this.get(p),p){var y=this.recognizers,T=z(y,p);T!==-1&&(y.splice(T,1),this.touchAction.update())}return this},on:function(p,y){if(p!==i&&y!==i){var T=this.handlers;return m(I(p),function(A){T[A]=T[A]||[],T[A].push(y)}),this}},off:function(p,y){if(p!==i){var T=this.handlers;return m(I(p),function(A){y?T[A]&&T[A].splice(z(T[A],y),1):delete T[A]}),this}},emit:function(p,y){this.options.domEvents&&v_(p,y);var T=this.handlers[p]&&this.handlers[p].slice();if(!(!T||!T.length)){y.type=p,y.preventDefault=function(){y.srcEvent.preventDefault()};for(var A=0;A<T.length;)T[A](y),A++}},destroy:function(){this.element&&zh(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function zh(p,y){var T=p.element;if(T.style){var A;m(p.options.cssProps,function(C,D){A=Y(T.style,D),y?(p.oldCssProps[A]=T.style[A],T.style[A]=C):T.style[A]=p.oldCssProps[A]||""}),y||(p.oldCssProps={})}}function v_(p,y){var T=n.createEvent("Event");T.initEvent(p,!0,!0),T.gesture=y,y.target.dispatchEvent(T)}w(Kt,{INPUT_START:ge,INPUT_MOVE:Xn,INPUT_END:me,INPUT_CANCEL:He,STATE_POSSIBLE:no,STATE_BEGAN:ct,STATE_CHANGED:Sr,STATE_ENDED:mn,STATE_RECOGNIZED:qt,STATE_CANCELLED:Oi,STATE_FAILED:It,DIRECTION_NONE:Zs,DIRECTION_LEFT:xi,DIRECTION_RIGHT:Li,DIRECTION_UP:Ci,DIRECTION_DOWN:Ri,DIRECTION_HORIZONTAL:Mt,DIRECTION_VERTICAL:$n,DIRECTION_ALL:Th,Manager:Sl,Input:ut,TouchAction:vl,TouchInput:eo,MouseInput:Js,PointerEventInput:gl,TouchMouseInput:ml,SingleTouchInput:Rh,Recognizer:Zt,AttrRecognizer:Et,Tap:so,Pan:io,Swipe:Tl,Pinch:_l,Rotate:wl,Press:El,on:x,off:L,each:m,merge:v,extend:b,assign:w,inherit:g,bindFn:_,prefixed:Y});var __=typeof e<"u"?e:typeof self<"u"?self:{};__.Hammer=Kt,typeof i=="function"&&i.amd?i(function(){return Kt}):t.exports?t.exports=Kt:e[r]=Kt})(window,document,"Hammer")})(f3);const h3=mr,Dt=T_({__proto__:null,default:h3},[mr]),Av=1,Pv=2,Hc=4,d3={mousedown:Av,mousemove:Pv,mouseup:Hc};function p3(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function g3(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(p3(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function m3(t){t.prototype.handler=function(n){let r=d3[n.type];r&Av&&n.button>=0&&(this.pressed=!0),r&Pv&&n.which===0&&(r=Hc),this.pressed&&(r&Hc&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}g3(mr.PointerEventInput);m3(mr.MouseInput);const y3=mr.Manager;class ul{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const v3=Dt?[[Dt.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Dt.Rotate,{enable:!1}],[Dt.Pinch,{enable:!1}],[Dt.Swipe,{enable:!1}],[Dt.Pan,{threshold:0,enable:!1}],[Dt.Press,{enable:!1}],[Dt.Tap,{event:"doubletap",taps:2,enable:!1}],[Dt.Tap,{event:"anytap",enable:!1}],[Dt.Tap,{enable:!1}]]:null,_g={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},_3={doubletap:["tap"]},E3={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},gh={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},w3={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Eg={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},T3=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Wr=typeof window<"u"?window:global;let Wc=!1;try{const t={get passive(){return Wc=!0,!0}};Wr.addEventListener("test",null,t),Wr.removeEventListener("test",null)}catch{Wc=!1}const S3=T3.indexOf("firefox")!==-1,{WHEEL_EVENTS:b3}=gh,wg="wheel",Tg=4.000244140625,A3=40,P3=.25;class x3 extends ul{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;Wr.WheelEvent&&(S3&&i.deltaMode===Wr.WheelEvent.DOM_DELTA_PIXEL&&(s/=Wr.devicePixelRatio),i.deltaMode===Wr.WheelEvent.DOM_DELTA_LINE&&(s*=A3)),s!==0&&s%Tg===0&&(s=Math.floor(s/Tg)),i.shiftKey&&s&&(s=s*P3),this.callback({type:wg,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(b3),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Wc?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===wg&&(this.options.enable=n)}}const{MOUSE_EVENTS:L3}=gh,Sg="pointermove",bg="pointerover",Ag="pointerout",Pg="pointerenter",xg="pointerleave";class C3 extends ul{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(L3),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Sg&&(this.enableMoveEvent=n),e===bg&&(this.enableOverEvent=n),e===Ag&&(this.enableOutEvent=n),e===Pg&&(this.enableEnterEvent=n),e===xg&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(bg,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(Ag,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(Pg,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(xg,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(Sg,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:R3}=gh,Lg="keydown",Cg="keyup";class M3 extends ul{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:Lg,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:Cg,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(R3),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Lg&&(this.enableDownEvent=n),e===Cg&&(this.enableUpEvent=n)}}const Rg="contextmenu";class I3 extends ul{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:Rg,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===Rg&&(this.options.enable=n)}}const Yc=1,za=2,Xc=4,O3={pointerdown:Yc,pointermove:za,pointerup:Xc,mousedown:Yc,mousemove:za,mouseup:Xc},k3=1,N3=2,D3=3,F3=0,U3=1,B3=2,z3=1,V3=2,j3=4;function G3(t){const e=O3[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,o=!1,a=!1;return e===Xc||e===za&&!Number.isFinite(n)?(s=i===k3,o=i===N3,a=i===D3):e===za?(s=!!(n&z3),o=!!(n&j3),a=!!(n&V3)):e===Yc&&(s=r===F3,o=r===U3,a=r===B3),{leftButton:s,middleButton:o,rightButton:a}}function H3(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const Tu={srcElement:"root",priority:0};class W3{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let l=Tu;typeof r=="string"||r&&r.addEventListener?l={...Tu,srcElement:r}:r&&(l={...Tu,...r});let u=a.get(l.srcElement);u||(u=[],a.set(l.srcElement,u));const c={type:e,handler:n,srcElement:l.srcElement,priority:l.priority};i&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let f=u.length-1;for(;f>=0&&!(u[f].priority>=c.priority);)f--;u.splice(f+1,0,c)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let l=0;l<r.length;l++){const{type:u,handler:c,once:f}=r[l];if(c({...e,type:u,stopPropagation:s,stopImmediatePropagation:o}),f&&a.push(r[l]),i)break}for(let l=0;l<a.length;l++){const{type:u,handler:c}=a[l];this.remove(u,c)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...G3(e),...H3(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const Y3={events:null,recognizers:null,recognizerOptions:{},Manager:y3,touchAction:"none",tabIndex:0};class X3{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=E3[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...Y3,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||v3}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(_g).forEach(i=>{const s=this.manager.get(i);s&&_g[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new x3(e,this._onOtherEvent,{enable:!1}),this.moveInput=new C3(e,this._onOtherEvent,{enable:!1}),this.keyInput=new M3(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new I3(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=_3[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const c in e)this._addEventHandler(c,e[c],r,i,s);return}const{manager:o,events:a}=this,l=Eg[e]||e;let u=a.get(l);u||(u=new W3(this),a.set(l,u),u.recognizerName=w3[l]||l,o&&o.on(l,u.handleEvent)),u.add(e,n,r,i,s),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=Eg[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of r.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function Qn(){}const $3=({isDragging:t})=>t?"grabbing":"grab",xv={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Qn,onResize:Qn,onViewStateChange:Qn,onInteractionStateChange:Qn,onBeforeRender:Qn,onAfterRender:Qn,onLoad:Qn,onError:t=>K.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:$3,getTooltip:null,debug:!1,drawPickingColors:!1};class cl{constructor(e){d(this,"props",void 0),d(this,"width",0),d(this,"height",0),d(this,"userData",{}),d(this,"canvas",null),d(this,"viewManager",null),d(this,"layerManager",null),d(this,"effectManager",null),d(this,"deckRenderer",null),d(this,"deckPicker",null),d(this,"eventManager",null),d(this,"tooltip",null),d(this,"metrics",void 0),d(this,"animationLoop",void 0),d(this,"stats",void 0),d(this,"viewState",void 0),d(this,"cursorState",void 0),d(this,"_needsRedraw",void 0),d(this,"_pickRequest",void 0),d(this,"_lastPointerDownInfo",null),d(this,"_metricsCounter",void 0),d(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),d(this,"_onEvent",n=>{const r=mp[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=o,l=a&&(a[r.handler]||a.props[r.handler]),u=this.props[r.handler];let c=!1;l&&(c=l.call(a,o,n)),!c&&u&&u(o,n)}),d(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...xv,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&K.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),fy()==="IE"&&K.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new Zf({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&gi.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a;if(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(i=this.deckRenderer)===null||i===void 0||i.finalize(),this.deckRenderer=null,(s=this.deckPicker)===null||s===void 0||s.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(a=this.tooltip)===null||a===void 0||a.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var l;(l=this.canvas.parentElement)===null||l===void 0||l.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&K.removed("onLayerHover","onHover")(),"onLayerClick"in e&&K.removed("onLayerClick","onClick")(),e.initialViewState&&!jt(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return be(this.viewManager),this.viewManager.views}getViewports(e){return be(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){be(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),be(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const n=e.clientWidth||e.width,r=e.clientHeight||e.height;if(n!==this.width||r!==this.height){var i;this.width=n,this.height=r,(i=this.viewManager)===null||i===void 0||i.setProps({width:n,height:r}),this.props.onResize({width:n,height:r})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:u,useDevicePixels:c}=e;return new tP({width:n,height:r,useDevicePixels:c,autoResizeViewport:!1,gl:i,onCreateContext:f=>Ry({...s,...f,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:f=>this._setGLContext(f.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:u,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Tv({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,o=!1;for(const a of r){var n;s=a,o=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,rh(e,{enable:!0,copyState:!0})),this.tooltip=new c3(this.canvas),fn(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new ov;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new X3(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in mp)this.eventManager.on(i,this._onEvent);this.viewManager=new FL({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new DL(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new JL,this.deckRenderer=new n3(e),this.deckPicker=new l3(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;fn(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),K.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=sr.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}d(cl,"defaultProps",xv);d(cl,"VERSION",oS);class Su{constructor(e,n){d(this,"opts",void 0),d(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const o=n.elementOffset||0;for(let a=0;a<i;++a)s[a]=r[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function q3(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function ea(t){return t.stride||t.size*t.bytesPerElement}function Lv(t,e){e.offset&&K.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=ea(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function Z3(t,e){const n=Lv(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class K3{constructor(e,n,r){d(this,"gl",void 0),d(this,"id",void 0),d(this,"size",void 0),d(this,"settings",void 0),d(this,"value",void 0),d(this,"doublePrecision",void 0),d(this,"_buffer",void 0),d(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a=5126:!i&&n.isIndexed?a=e&&Mb(e,oe.ELEMENT_INDEX_UINT32)?5125:5123:a=i||5126;let l=q3(i||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...n,defaultType:l,defaultValue:o,logicalType:i,type:a,size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new Z(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*ea(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),gi.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=Z3(this.getAccessor(),n||{});return r[e]=new Su(this,s.high),r["".concat(e,"64Low")]=i?new Su(this,s.low):new Float32Array(this.size),r}if(n){const r=Lv(this.getAccessor(),n);return{[e]:new Su(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let l=0;l<s;)for(let u=0;u<i;u++){const c=n[l++];c<o[u]&&(o[u]=c),c>a[u]&&(a[u]=c)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof Z?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const o=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),i.stride=ea(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=ea(i);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=_u(s,i));const l=s.byteLength+a+i.stride*2;o.byteLength<l&&o.reallocate(l),o.setAccessor(null),o.subData({data:s,offset:a}),i.type=r.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?_u(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=gi.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),n&&i&&o.subData({data:i instanceof Float64Array?_u(i,this):i,offset:a})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&K.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let o=s;for(;--o>=0;)n[r+o]=i[o];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const Mg=[],Ig=[];function Cv(t,e=0,n=1/0){let r=Mg;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(Ig.length=t.length,r=Ig):r=Mg,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function Rv(t){return t&&t[Symbol.asyncIterator]}function Mv(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,l=r?r/a:n,u=i?i/a:0,c=Math.floor((t.length-u)/l);return(f,{index:h,target:m})=>{if(!s){const v=h*l+u;for(let g=0;g<n;g++)m[g]=t[v+g];return m}const E=s[h],w=s[h+1]||c;let b;if(o){b=new Array(w-E);for(let v=E;v<w;v++){const g=v*l+u;m=new Array(n);for(let _=0;_<n;_++)m[_]=t[g+_];b[v-E]=m}}else if(l===n)b=t.subarray(E*n+u,w*n+u);else{b=new t.constructor((w-E)*n);let v=0;for(let g=E;g<w;g++){const _=g*l+u;for(let S=0;S<n;S++)b[v++]=t[_+S]}}return b}}const Q3=[],ta=[[0,1/0]];function J3(t,e){if(t===ta||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}function bu(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,l=o-r;if(a>l){n.set(e.subarray(0,l),r);return}if(n.set(e,r),!s)return;let u=a;for(;u<l;){const c=s(u,e);for(let f=0;f<i;f++)n[r+u]=c[f]||0,u++}}function eC({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return bu({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const l=r&&((c,f)=>r(c+a,f)),u=Math.min(i.length,s.length);for(let c=1;c<u;c++){const f=i[c]*n,h=s[c]*n;bu({source:t.subarray(o,f),target:e,start:a,end:h,size:n,getData:l}),o=f,a=h}return a<e.length&&bu({source:[],target:e,start:a,size:n,getData:l}),e}const tC={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Iv(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...tC[n],...e,...t,type:n}}function Ov(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function kv(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function Nv(t){t.push(t.shift())}function mh(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*o}function Dv({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,l=n.byteOffset,u=n.startIndices,c=i&&u,f=mh(n,e),h=n.isConstant;if(!c&&r>=f)return;const m=h?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!h){const v=s;s=(g,_)=>n.normalizeConstant(v(g,_))}const E=h?(v,g)=>s(m,g):(v,g)=>s(m.subarray(v,v+a),g),w=t.getData({length:r}),b=new Float32Array(f);eC({source:w,target:b,sourceStartIndices:i,targetStartIndices:u,size:a,getData:E}),t.byteLength<b.byteLength+l&&t.reallocate(b.byteLength+l),t.subData({data:b,offset:l})}class yh extends K3{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:ta}),d(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return Iv(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=J3(this.state.updateRanges,[r,i])}else this.state.updateRanges=ta}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Q3}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==ta),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[u,c]of s)o.call(i,this,{data:n,startRow:u,endRow:c,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[u,c]of s){const f=Number.isFinite(u)?this.getVertexOffset(u):0,h=Number.isFinite(c)?this.getVertexOffset(c):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:f,endOffset:h})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;be(ArrayBuffer.isView(o.value),"invalid ".concat(i.accessor));const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=Mv(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:u,size:c,startIndices:f}=e,{accessor:h,transform:m}=a,E=l.binaryAccessor||(typeof h=="function"?h:s[h]);be(typeof E=="function",'accessor "'.concat(h,'" is not a function'));let w=e.getVertexOffset(r);const{iterable:b,objectInfo:v}=Cv(n,r,i);for(const g of b){v.index++;let _=E(g,v);if(m&&(_=m.call(this,_)),f){const S=(v.index<f.length-1?f[v.index+1]:o)-f[v.index];if(_&&Array.isArray(_[0])){let P=w;for(const x of _)e._normalizeValue(x,u,P),P+=c}else _&&_.length>c?u.set(_,w):(e._normalizeValue(_,v.target,0),AL({target:u,source:v.target,start:w,count:S}));w+=S*c}else e._normalizeValue(_,u,w),w+=c}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class nC{constructor({gl:e,attribute:n,timeline:r}){d(this,"gl",void 0),d(this,"type","interpolation"),d(this,"attributeInTransition",void 0),d(this,"settings",void 0),d(this,"attribute",void 0),d(this,"transition",void 0),d(this,"currentStartIndices",void 0),d(this,"currentLength",void 0),d(this,"transform",void 0),d(this,"buffers",void 0),this.gl=e,this.transition=new $s(r),this.attribute=n,this.attributeInTransition=new yh(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=iC(e,n);const i={byteLength:0,usage:35050};this.buffers=[new Z(e,i),new Z(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;Nv(i);const o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)Dv({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=mh(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:Ov(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const rC=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function iC(t,e){const n=kv(e.size);return new ch(t,{vs:rC,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class sC{constructor({gl:e,attribute:n,timeline:r}){d(this,"gl",void 0),d(this,"type","spring"),d(this,"attributeInTransition",void 0),d(this,"settings",void 0),d(this,"attribute",void 0),d(this,"transition",void 0),d(this,"currentStartIndices",void 0),d(this,"currentLength",void 0),d(this,"texture",void 0),d(this,"framebuffer",void 0),d(this,"transform",void 0),d(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new $s(r),this.attribute=n,this.attributeInTransition=new yh(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=aC(e),this.framebuffer=lC(e,this.texture),this.transform=oC(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new Z(e,i),new Z(e,i),new Z(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)Dv({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=mh(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:Ov(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Nv(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),ll(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function oC(t,e,n){const r=kv(e.size);return new ch(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function aC(t){return new Rt(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function lC(t,e){return new we(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{[36064]:e}})}const uC={interpolation:nC,spring:sC};class cC{constructor(e,{id:n,timeline:r}){d(this,"id",void 0),d(this,"isSupported",void 0),d(this,"gl",void 0),d(this,"timeline",void 0),d(this,"transitions",void 0),d(this,"needsRedraw",void 0),d(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=ch.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){K.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const o=uC[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):(K.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const Og="attributeManager.invalidate",fC="attributeManager.updateStart",hC="attributeManager.updateEnd",dC="attribute.updateStart",pC="attribute.allocate",gC="attribute.updateEnd";class mC{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){d(this,"id",void 0),d(this,"gl",void 0),d(this,"attributes",void 0),d(this,"updateTriggers",void 0),d(this,"needsRedraw",void 0),d(this,"userData",void 0),d(this,"stats",void 0),d(this,"attributeTransitionManager",void 0),d(this,"mergeBoundsMemoized",Xs(mL)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new cC(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Ue(Og,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Ue(Og,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let l=!1;Ue(fC,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const u in this.attributes){const c=this.attributes[u],f=c.settings.accessor;c.startIndices=r,c.numInstances=n,s[u]&&K.removed("props.".concat(u),"data.attributes.".concat(u))(),c.setExternalBuffer(o[u])||c.setBinaryValue(typeof f=="string"?o[f]:void 0,e.startIndices)||typeof f=="string"&&!o[f]&&c.setConstantValue(s[f])||c.needsUpdate()&&(l=!0,this._updateAttribute({attribute:c,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||c.needsRedraw()}l&&Ue(hC,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new yh(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Ue(dC,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Ue(pC,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Ue(gC,n,r))}}class yC extends $s{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=Oa(n,r,o)}}const kg=1e-5;function Ng(t,e,n,r,i){const s=e-t,a=(n-e)*i,l=-s*r;return a+l+s+e}function vC(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=Ng(t[o],e[o],n[o],r,i);return s}return Ng(t,e,n,r,i)}function Dg(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class _C extends $s{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=vC(s,o,n,r,i);const l=Dg(a,n),u=Dg(a,o);l<kg&&u<kg&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const EC={interpolation:yC,spring:_C};class wC{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:u=l.settings.fromValue}=l;n=u,this.remove(e)}if(i=Iv(i),!i)return;const o=EC[i.type];if(!o){K.error("unsupported transition type '".concat(i.type,"'"))();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function TC(t){const e=t[ur];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function SC(t,e){const n=Fv({newProps:t,oldProps:e,propTypes:t[ur],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=AC(t,e);let i=!1;return r||(i=PC(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:xC(t,e),transitionsChanged:bC(t,e)}}function bC(t,e){if(!t.transitions)return!1;const n={},r=t[ur];let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&$c(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function Fv({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const o=$c(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const o=$c(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}}return!1}function $c(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function AC(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function PC(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&Fg(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&Fg(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function xC(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function Fg(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},Fv({oldProps:i,newProps:r,triggerName:n})}const LC="count(): argument not an object",CC="count(): argument not a container";function RC(t){if(!IC(t))throw new Error(LC);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(MC(t))return Object.keys(t).length;throw new Error(CC)}function MC(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function IC(t){return t!==null&&typeof t=="object"}function OC(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const kC={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071},qc={};function NC(t,e,n){if(e instanceof Rt)return e;e.constructor&&e.constructor.name!=="Object"&&(e={data:e});let r=null;e.compressed&&(r={[10241]:e.data.length>1?9985:9729});const i=new Rt(t,{...e,parameters:{...kC,...r,...n}});return qc[i.id]=!0,i}function DC(t){!t||!(t instanceof Rt)||qc[t.id]&&(t.delete(),delete qc[t.id])}const FC={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Zc(t)&&(t.length===3||t.length===4)},equal(t,e,n){return jt(t,e,1)}},accessor:{validate(t,e){const n=Va(t);return n==="function"||n===Va(e.value)},equal(t,e,n){return typeof e=="function"?!0:jt(t,e,1)}},array:{validate(t,e){return e.optional&&!t||Zc(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?jt(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?jt(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:NC(r.gl,t,{...e.parameters,...n.props.textureParameters})},release:t=>{DC(t)}}};function UC(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=BC(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function BC(t,e){switch(Va(e)){case"object":return Xi(t,e);case"array":return Xi(t,{type:"array",value:e,compare:!1});case"boolean":return Xi(t,{type:"boolean",value:e});case"number":return Xi(t,{type:"number",value:e});case"function":return Xi(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Xi(t,e){return"type"in e?{name:t,...FC[e.type],...e}:"value"in e?{name:t,type:Va(e.value),...e}:{name:t,type:"object",value:e}}function Zc(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Va(t){return Zc(t)?"array":t===null?"null":typeof t}function zC(t,e){let n;for(let s=e.length-1;s>=0;s--){const o=e[s];"extensions"in o&&(n=o.extensions)}const r=Kc(t.constructor,n),i=Object.create(r);i[Ba]=t,i[gr]={},i[Mn]={};for(let s=0;s<e.length;++s){const o=e[s];for(const a in o)i[a]=o[a]}return Object.freeze(i),i}const VC="_mergedDefaultProps";function Kc(t,e){let n=VC;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=Uv(t,n);return r||(t[n]=jC(t,e||[]))}function jC(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=Kc(r),s=Uv(t,"defaultProps")||{},o=UC(s),a=Object.assign(Object.create(null),i,o.defaultProps),l=Object.assign(Object.create(null),i==null?void 0:i[ur],o.propTypes),u=Object.assign(Object.create(null),i==null?void 0:i[wu],o.deprecatedProps);for(const c of e){const f=Kc(c.constructor);f&&(Object.assign(a,f),Object.assign(l,f[ur]),Object.assign(u,f[wu]))}return GC(a,t),WC(a,l),HC(a,u),a[ur]=l,a[wu]=u,e.length===0&&!vh(t,"_propTypes")&&(t._propTypes=l),a}function GC(t,e){const n=XC(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function HC(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])vh(this,s)||(this[s]=r);K.deprecated(i,e[n].join("/"))()}})}function WC(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=YC(o))}t[Jr]=n,t[gr]={},Object.defineProperties(t,r)}function YC(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||Rv(e)?this[gr][t]=e:this[Mn][t]=e},get(){if(this[Mn]){if(t in this[Mn])return this[Mn][t]||this[Jr][t];if(t in this[gr]){const e=this[Ba]&&this[Ba].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Jr][t]}}return this[Jr][t]}}}function vh(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Uv(t,e){return vh(t,e)&&t[e]}function XC(t){const e=t.componentName;return e||K.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let $C=0;class _h{constructor(...e){d(this,"id",void 0),d(this,"props",void 0),d(this,"count",void 0),this.props=zC(this,e),this.id=this.props.id,this.count=$C++}clone(e){const{props:n}=this,r={};for(const i in n[Jr])i in n[Mn]?r[i]=n[Mn][i]:i in n[gr]&&(r[i]=n[gr][i]);return new this.constructor({...n,...r,...e})}}d(_h,"componentName","Component");d(_h,"defaultProps",{});const qC=Object.freeze({});class ZC{constructor(e){d(this,"component",void 0),d(this,"onAsyncPropUpdated",void 0),d(this,"asyncProps",void 0),d(this,"oldProps",void 0),d(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||qC}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[Ba]||this.component;const n=e[Mn]||{},r=e[gr]||e,i=e[Jr]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(Rv(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){if(!this.component)return;const{dataTransform:l}=this.component.props;l?s=l(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[ur];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class KC extends ZC{constructor({attributeManager:e,layer:n}){super(n),d(this,"attributeManager",void 0),d(this,"needsRedraw",void 0),d(this,"needsUpdate",void 0),d(this,"subLayers",void 0),d(this,"usesPickingColorCache",void 0),d(this,"hasPickingBuffer",void 0),d(this,"changeFlags",void 0),d(this,"viewport",void 0),d(this,"uniformTransitions",void 0),d(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const QC="layer.changeFlag",JC="layer.initialize",eR="layer.update",tR="layer.finalize",nR="layer.matched",Ug=2**24-1,rR=Object.freeze([]),iR=Xs(({oldViewport:t,viewport:e})=>t.equals(e));let Ft=new Uint8ClampedArray(0);const sR={data:{type:"data",value:rR,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var a;i={...i,fetch:{...(a=i)===null||a===void 0?void 0:a.fetch,signal:s}}}let l=o.contains(t);return!l&&!i&&(o.add({resourceId:t,data:Ac(t,r),persistent:!1}),l=!0),l?o.subscribe({resourceId:t,onChange:u=>{var c;return(c=n.internalState)===null||c===void 0?void 0:c.reloadAsyncProp(e,u)},consumerId:n.id,requestId:e}):Ac(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:$.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class fl extends _h{constructor(...e){super(...e),d(this,"internalState",null),d(this,"lifecycle",Mr.NO_STATE),d(this,"context",void 0),d(this,"state",void 0),d(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){be(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=yv(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=gv(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return be(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){be(this.internalState);const r=this.internalState.viewport||this.context.viewport;return TL(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===$.DEFAULT||e===$.LNGLAT||e===$.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){be(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:RC(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=OC(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,o=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:l}=n.attributes,u=a||l;u&&(o&&u.constant&&(u.constant=!1,n.invalidate(u.id)),!u.value&&!o&&(u.constant=!0,u.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e.message="".concat(n,": ").concat(e.message)),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,o;(s=this.context)===null||s===void 0||(o=s.onError)===null||o===void 0||o.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!iR({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Ft.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>Ug&&K.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ft=gi.allocate(Ft,n,{size:3,copy:!0,maxCount:Math.max(n,Ug)});const i=Math.floor(Ft.length/3),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),Ft[o*3+0]=s[0],Ft[o*3+1]=s[1],Ft[o*3+2]=s[2]}e.value=Ft.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Ft.buffer&&(r.value=Ft.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){be(!this.internalState),be(Number.isFinite(this.props.coordinateSystem)),Ue(JC,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new KC({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(K.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new wC(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Ue(nR,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Ue(eR,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const c of this.props.extensions)c.updateState.call(this,a,c);const u=this.getModels()[0]!==l[0];this._postUpdate(a,u)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Ue(tR,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,l=a&&a(n)||[0,0];fn(s.gl,{polygonOffset:l}),Lt(s.gl,r,()=>{const u={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const c of this.props.extensions)c.draw.call(this,u,c);this.draw(u)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&Ue(QC,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=SC(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){TC(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new mC(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==l){const u={};o||(u.pickingSelectedColor=null),Array.isArray(l)&&(u.pickingHighlightColor=l),(n||a!==i.highlightedObjectIndex)&&(u.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(u)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}d(fl,"defaultProps",sR);d(fl,"layerName","Layer");class oR{constructor(e){d(this,"opts",void 0),d(this,"typedArrayManager",void 0),d(this,"indexStarts",[0]),d(this,"vertexStarts",[0]),d(this,"vertexCount",0),d(this,"instanceCount",0),d(this,"attributes",void 0),d(this,"_attributeDefs",void 0),d(this,"data",void 0),d(this,"getGeometry",void 0),d(this,"geometryBuffer",void 0),d(this,"buffers",void 0),d(this,"positionSize",void 0),d(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=gi,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:o,dataChanged:a,normalize:l=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(o==="XY"?2:3),this.buffers=r,this.normalize=l,s&&(be(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),l||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(a))for(const u of a)this._rebuildGeometry(u);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?Mv(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:o}=this;for(const a in s)if(a in i)o.release(r[a]),r[a]=null;else{const l=s[a];l.copy=n,r[a]=o.allocate(r[a],e,l)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:o,objectInfo:a}=Cv(i,n,r);for(const l of o){a.index++;const u=s?s(l,a):null;e(u,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:o}=this,{startRow:a=0,endRow:l=1/0}=e||{},u={};if(e||(n=[0],r=[0]),this.normalize||!o)this._forEachGeometry((f,h)=>{const m=f&&this.normalizeGeometry(f);u[h]=m,r[h+1]=r[h]+(m?this.getGeometrySize(m):0)},a,l),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof Z){const f=o.accessor.stride||this.positionSize*4;i=i||o.byteLength/f}else if(o.buffer){const f=o.stride||this.positionSize*4;i=i||o.buffer.byteLength/f}else if(o.value){const f=o.value,h=o.stride/f.BYTES_PER_ELEMENT||this.positionSize;i=i||f.length/h}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const c={};this._forEachGeometry((f,h)=>{const m=u[h]||f;c.vertexStart=r[h],c.indexStart=n[h];const E=h<r.length-1?r[h+1]:i;c.geometrySize=E-r[h],c.geometryIndex=h,this.updateGeometryAttributes(m,c)},a,l),this.vertexCount=n[n.length-1]}}const aR=typeof window<"u"?O.useLayoutEffect:O.useEffect,lR=aR;function ja(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const uR={position:"absolute",zIndex:-1};function Bv(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>Bv(n,e));if(hl(t)){if(cR(t))return e.style=uR,O.cloneElement(t,e);if(fR(t))return O.cloneElement(t,e)}return t}function hl(t){return t&&typeof t=="object"&&"type"in t||!1}function cR(t){const e=t.type,n=e&&e.defaultProps;return n&&n.mapStyle}function fR(t){const e=t.type;return e&&e.deckGLViewProps}function Qc(t){if(typeof t=="function")return O.createElement(yi,{},t);if(Array.isArray(t))return t.map(Qc);if(hl(t)){if(t.type===O.Fragment)return Qc(t.props.children);if(ja(t.type,yi))return t}return t}function hR({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return O.Children.forEach(Qc(t),o=>{if(hl(o)){const a=o.type;if(ja(a,fl)){const l=dR(a,o.props);i.push(l)}else r.push(o);if(ja(a,yi)&&a!==yi&&o.props.id){const l=new a(o.props);s[l.id]=l}}else o&&r.push(o)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(o=>{s[o.id]=o}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function dR(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function pR({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const o of t){let a=s,l=o;hl(o)&&ja(o.type,yi)&&(a=o.props.id||s,l=o.props.children);const u=r.getViewport(a),c=r.getViewState(a);if(u){c.padding=u.padding;const{x:f,y:h,width:m,height:E}=u;l=Bv(l,{x:f,y:h,width:m,height:E,viewport:u,viewState:c}),i[a]||(i[a]={viewport:u,children:[]}),i[a].children.push(l)}}return Object.keys(i).map(o=>{const{viewport:a,children:l}=i[o],{x:u,y:c,width:f,height:h}=a,m={position:"absolute",left:u,top:c,width:f,height:h},E="view-".concat(o),w=O.createElement("div",{key:E,id:E,style:m},...l);if(n){const b={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:v=>{v.viewId=o,e._onViewStateChange(v)}};return O.createElement(n,{key:E,value:b},w)}return w})}const gR={mixBlendMode:null};function mR({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in gR?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function yR(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function zv(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function vR(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():zv(t)}});return r}const Vv=O.forwardRef((t,e)=>{const[n,r]=O.useState(0),s=O.useRef({control:null,version:n,forceUpdate:()=>r(P=>P+1)}).current,o=O.useRef(null),a=O.useRef(null),l=O.useMemo(()=>hR(t),[t.layers,t.views,t.children]);let u=!0;const c=P=>{var x;return u&&t.viewState?(s.viewStateUpdateRequested=P,null):(s.viewStateUpdateRequested=null,(x=t.onViewStateChange)===null||x===void 0?void 0:x.call(t,P))},f=P=>{if(u)s.interactionStateUpdateRequested=P;else{var x;s.interactionStateUpdateRequested=null,(x=t.onInteractionStateChange)===null||x===void 0||x.call(t,P)}},h=O.useMemo(()=>{const P={...t,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:l.layers,views:l.views,onViewStateChange:c,onInteractionStateChange:f};return delete P._customRender,s.deck&&s.deck.setProps(P),P},[t]);O.useEffect(()=>{const P=t.Deck||cl;return s.deck=vR(s,P,{...h,parent:o.current,canvas:a.current}),()=>{var x;return(x=s.deck)===null||x===void 0?void 0:x.finalize()}},[]),lR(()=>{zv(s);const{viewStateUpdateRequested:P,interactionStateUpdateRequested:x}=s;P&&c(P),x&&f(x)}),O.useImperativeHandle(e,()=>yR(s),[]);const m=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:E,width:w,height:b,id:v,style:g}=t,{containerStyle:_,canvasStyle:S}=O.useMemo(()=>mR({width:w,height:b,style:g}),[w,b,g]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===m||s.version!==n){s.lastRenderedViewports=m,s.version=n;const P=pR({children:l.children,deck:s.deck,ContextProvider:E}),x=O.createElement("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:a,style:S});s.control=O.createElement("div",{id:"".concat(v||"deckgl","-wrapper"),ref:o,style:_},[x,P])}return u=!1,s.control});Vv.defaultProps=cl.defaultProps;const _R=Vv,ER="modulepreload",wR=function(t){return"/"+t},Bg={},TR=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=wR(s),s in Bg)return;Bg[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let c=i.length-1;c>=0;c--){const f=i[c];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":ER,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((c,f)=>{u.addEventListener("load",c),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())},SR=O.createContext(null);function bR(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function zg(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function Vg(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const AR=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function jg(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{const i=e[r.ref];let s=null;if("interactive"in r&&(s={...r},delete s.interactive),i){s=s||{...r},delete s.ref;for(const o of AR)o in i&&(s[o]=i[o])}return s||r});return{...t,layers:n}}function PR(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function xn(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!xn(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!xn(t[i],e[i]))return!1;return!0}return!1}const Gg={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Au={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Hg={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},xR=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],LR=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class vi{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[Hg[i.type]];s&&s(i)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[Gg[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[Au[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=vi.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n,r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:o}=e;return o&&(o.bounds?i.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):r._updateViewState(o,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i.triggerRepaint(),r}_initialize(e){const{props:n}=this,r={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||CR()||null,container:e,style:jg(n.mapStyle)},i=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),n.gl){const u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=u,n.gl)}const s=new this._MapClass(r);i.padding&&s.setPadding(i.padding),n.cursor&&(s.getCanvas().style.cursor=n.cursor),this._createShadowTransform(s);const o=s._render;s._render=u=>{this._inRender=!0,o.call(s,u),this._inRender=!1};const a=s._renderTaskQueue.run;s._renderTaskQueue.run=u=>{a.call(s._renderTaskQueue,u),this._onBeforeRepaint()},s.on("render",()=>this._onAfterRepaint());const l=s.fire;s.fire=this._fireEvent.bind(this,l),s.on("resize",()=>{this._renderTransform.resize(s.transform.width,s.transform.height)}),s.on("styledata",()=>this._updateStyleComponents(this.props,{})),s.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const u in Gg)s.on(u,this._onPointerEvent);for(const u in Au)s.on(u,this._onCameraEvent);for(const u in Hg)s.on(u,this._onEvent);this._map=s}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),vi.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=bR(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:o,bearing:a}=i,l=r.isMoving();l&&(i.cameraElevationReference="sea");const u=Vg(i,{...zg(r.transform),...e});if(l&&(i.cameraElevationReference="ground"),u&&n){const c=this._deferredEvents;c.move=!0,c.zoom||(c.zoom=s!==i.zoom),c.rotate||(c.rotate=a!==i.bearing),c.pitch||(c.pitch=o!==i.pitch)}return l||Vg(r.transform,e),u}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of xR)s in e&&!xn(e[s],n[s])&&(i=!0,r[`set${s[0].toUpperCase()}${s.slice(1)}`](e[s]));return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor),e.mapStyle!==n.mapStyle){const r={diff:e.styleDiffing};return"localIdeographFontFamily"in e&&(r.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(jg(e.mapStyle),r),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.style.loaded()&&("light"in e&&!xn(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&!xn(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&!xn(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){const r=this._map;let i=!1;for(const s of LR){const o=e[s];xn(o,n[s])||(i=!0,o?r[s].enable(o):r[s].disable())}return i}_queryRenderedFeatures(e){const n=this._map,{interactiveLayerIds:r=[]}=this.props;try{return n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),l=a.length>0;!l&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,l&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in Au&&(typeof n=="object"&&(n.viewState=zg(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=n}}}vi.savedMaps=[];function CR(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const RR=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function MR(t,e){if(!t)return null;const n=t.map,r={getMap:()=>n,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:i=>t.transform.locationPoint(e.LngLat.convert(i)),unproject:i=>t.transform.pointLocation(e.Point.convert(i)),queryTerrainElevation:(i,s)=>{const o=n.transform;n.transform=t.transform;const a=n.queryTerrainElevation(i,s);return n.transform=o,a}};for(const i of IR(n))!(i in r)&&!RR.includes(i)&&(r[i]=n[i].bind(n));return r}function IR(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const OR=typeof document<"u"?O.useLayoutEffect:O.useEffect,kR=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function NR(t,e){for(const n of kR)n in e&&(t[n]=e[n]);e.RTLTextPlugin&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(e.RTLTextPlugin,n=>{n&&console.error(n)},!1)}const dl=O.createContext(null),DR={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:t=>console.error(t.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},Eh=O.forwardRef((t,e)=>{const n=O.useContext(SR),[r,i]=O.useState(null),s=O.useRef(),{current:o}=O.useRef({mapLib:null,map:null});O.useEffect(()=>{const u=t.mapLib;let c=!0,f;return Promise.resolve(u||TR(()=>import("./mapbox-gl-9171811b.js").then(h=>h.m),[])).then(h=>{if(c){if(h.Map||(h=h.default),!h||!h.Map)throw new Error("Invalid mapLib");if(NR(h,t),h.supported(t))t.reuseMaps&&(f=vi.reuse(t,s.current)),f||(f=new vi(h.Map,t,s.current)),o.map=MR(f,h),o.mapLib=h,i(f),n==null||n.onMapMount(o.map,t.id);else throw new Error("Map is not supported by this browser")}}).catch(h=>{t.onError({type:"error",target:null,originalEvent:null,error:h})}),()=>{c=!1,f&&(n==null||n.onMapUnmount(t.id),t.reuseMaps?f.recycle():f.destroy())}},[]),OR(()=>{r&&r.setProps(t)}),O.useImperativeHandle(e,()=>o.map,[r]);const a=O.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),l={height:"100%"};return O.createElement("div",{id:t.id,ref:s,style:a},r&&O.createElement(dl.Provider,{value:o},O.createElement("div",{"mapboxgl-children":"",style:l},t.children)))});Eh.displayName="Map";Eh.defaultProps=DR;const FR=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Er(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!FR.test(r)?n[r]=`${i}px`:n[r]=i}}const UR={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function jv(t){const{map:e,mapLib:n}=O.useContext(dl),r=O.useRef({props:t});r.current.props=t;const i=O.useMemo(()=>{let s=!1;O.Children.forEach(t.children,l=>{l&&(s=!0)});const o={...t,element:s?document.createElement("div"):null},a=new n.Marker(o).setLngLat([t.longitude,t.latitude]);return a.getElement().addEventListener("click",l=>{var u,c;(c=(u=r.current.props).onClick)===null||c===void 0||c.call(u,{type:"click",target:a,originalEvent:l})}),a.on("dragstart",l=>{var u,c;const f=l;f.lngLat=i.getLngLat(),(c=(u=r.current.props).onDragStart)===null||c===void 0||c.call(u,f)}),a.on("drag",l=>{var u,c;const f=l;f.lngLat=i.getLngLat(),(c=(u=r.current.props).onDrag)===null||c===void 0||c.call(u,f)}),a.on("dragend",l=>{var u,c;const f=l;f.lngLat=i.getLngLat(),(c=(u=r.current.props).onDragEnd)===null||c===void 0||c.call(u,f)}),a},[]);return O.useEffect(()=>(i.addTo(e.getMap()),()=>{i.remove()}),[]),O.useEffect(()=>{Er(i.getElement(),t.style)},[t.style]),(i.getLngLat().lng!==t.longitude||i.getLngLat().lat!==t.latitude)&&i.setLngLat([t.longitude,t.latitude]),t.offset&&!PR(i.getOffset(),t.offset)&&i.setOffset(t.offset),i.isDraggable()!==t.draggable&&i.setDraggable(t.draggable),i.getRotation()!==t.rotation&&i.setRotation(t.rotation),i.getRotationAlignment()!==t.rotationAlignment&&i.setRotationAlignment(t.rotationAlignment),i.getPitchAlignment()!==t.pitchAlignment&&i.setPitchAlignment(t.pitchAlignment),i.getPopup()!==t.popup&&i.setPopup(t.popup),hs.createPortal(t.children,i.getElement())}jv.defaultProps=UR;O.memo(jv);function Wg(t){return new Set(t?t.trim().split(/\s+/):[])}function BR(t){const{map:e,mapLib:n}=O.useContext(dl),r=O.useMemo(()=>document.createElement("div"),[]),i=O.useRef({props:t});i.current.props=t;const s=O.useMemo(()=>{const o={...t},a=new n.Popup(o).setLngLat([t.longitude,t.latitude]);return a.once("open",l=>{var u,c;(c=(u=i.current.props).onOpen)===null||c===void 0||c.call(u,l)}),a},[]);if(O.useEffect(()=>{const o=a=>{var l,u;(u=(l=i.current.props).onClose)===null||u===void 0||u.call(l,a)};return s.on("close",o),s.setDOMContent(r).addTo(e.getMap()),()=>{s.off("close",o),s.isOpen()&&s.remove()}},[]),O.useEffect(()=>{Er(s.getElement(),t.style)},[t.style]),s.isOpen()&&((s.getLngLat().lng!==t.longitude||s.getLngLat().lat!==t.latitude)&&s.setLngLat([t.longitude,t.latitude]),t.offset&&!xn(s.options.offset,t.offset)&&s.setOffset(t.offset),(s.options.anchor!==t.anchor||s.options.maxWidth!==t.maxWidth)&&(s.options.anchor=t.anchor,s.setMaxWidth(t.maxWidth)),s.options.className!==t.className)){const o=Wg(s.options.className),a=Wg(t.className);for(const l of o)a.has(l)||s.removeClassName(l);for(const l of a)o.has(l)||s.addClassName(l);s.options.className=t.className}return hs.createPortal(t.children,r)}O.memo(BR);function qs(t,e,n,r){const i=O.useContext(dl),s=O.useMemo(()=>t(i),[]);return O.useEffect(()=>{const o=r||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,l=typeof n=="function"?n:typeof e=="function"?e:null,{map:u}=i;return u.hasControl(s)||(u.addControl(s,o==null?void 0:o.position),a&&a(i)),()=>{l&&l(i),u.hasControl(s)&&u.removeControl(s)}},[]),s}function zR(t){const e=qs(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return O.useEffect(()=>{Er(e._container,t.style)},[t.style]),null}O.memo(zR);function VR(t){const e=qs(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return O.useEffect(()=>{Er(e._controlContainer,t.style)},[t.style]),null}O.memo(VR);const Gv=O.forwardRef((t,e)=>{const n=O.useRef({props:t}),r=qs(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var l,u;(u=(l=n.current.props).onGeolocate)===null||u===void 0||u.call(l,a)}),s.on("error",a=>{var l,u;(u=(l=n.current.props).onError)===null||u===void 0||u.call(l,a)}),s.on("outofmaxbounds",a=>{var l,u;(u=(l=n.current.props).onOutOfMaxBounds)===null||u===void 0||u.call(l,a)}),s.on("trackuserlocationstart",a=>{var l,u;(u=(l=n.current.props).onTrackUserLocationStart)===null||u===void 0||u.call(l,a)}),s.on("trackuserlocationend",a=>{var l,u;(u=(l=n.current.props).onTrackUserLocationEnd)===null||u===void 0||u.call(l,a)}),s},{position:t.position});return n.current.props=t,O.useImperativeHandle(e,()=>({trigger:()=>r.trigger()}),[]),O.useEffect(()=>{Er(r._container,t.style)},[t.style]),null});Gv.displayName="GeolocateControl";O.memo(Gv);function jR(t){const e=qs(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return O.useEffect(()=>{Er(e._container,t.style)},[t.style]),null}O.memo(jR);const GR={unit:"metric",maxWidth:100};function Hv(t){const e=qs(({mapLib:n})=>new n.ScaleControl(t),{position:t.position});return(e.options.unit!==t.unit||e.options.maxWidth!==t.maxWidth)&&(e.options.maxWidth=t.maxWidth,e.setUnit(t.unit)),O.useEffect(()=>{Er(e._container,t.style)},[t.style]),null}Hv.defaultProps=GR;O.memo(Hv);function Do(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function Yg(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function Xg(t,e,n,r,i=[]){const s=r+e*n;for(let o=0;o<n;o++)i[o]=t[s+o];return i}function $g(t,e,n,r,i=[]){let s,o;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),o=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),o=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),o=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),o=0;else return null;for(let a=0;a<t.length;a++)i[a]=(o&1)===a?r[o]:s*(e[a]-t[a])+t[a];return i}function Pu(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function Wv(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=t.length}=e||{},l=(a-o)/n;let u=[];const c=[u],f=Xg(t,0,n,o);let h,m;const E=HR(f,i,s,[]),w=[];Do(u,f);for(let b=1;b<l;b++){for(h=Xg(t,b,n,o,h),m=Pu(h,E);m;){$g(f,h,m,E,w);const v=Pu(w,E);v&&($g(f,w,v,E,w),m=v),Do(u,w),Yg(f,w),WR(E,i,m),r&&u.length>n&&(u=[],c.push(u),Do(u,f)),m=Pu(h,E)}Do(u,h),Yg(f,h)}return r?c:c[0]}function HR(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function WR(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function YR(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},o=t.slice(r,i);XR(o,n,0,i-r);const a=Wv(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const l of a)$R(l,n);return a}function XR(t,e,n,r){let i=t[0],s;for(let o=n;o<r;o+=e){s=t[o];const a=s-i;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[o]=i=s}}function $R(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function qR(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let o=0;o<t.length;o++)for(let a=0;a<e;a++)i[o*e+a]=t[o][a]||0}else i=t;return n?Wv(i,{size:e,gridResolution:n}):r?YR(i,{size:e}):i}const ZR=1,KR=2,xu=4;class QR extends oR{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?qR(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(qg(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&qg(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:o}=n;r.fill(0,s,s+o),i?(r[s]=xu,r[s+o-2]=xu):(r[s]+=ZR,r[s+o-2]+=KR),r[s+o-1]=xu}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,o=new Array(3);for(let a=i,l=0;l<s;a++,l++)this.getPointOnPath(e,l,o),r[a*3]=o[0],r[a*3+1]=o[1],r[a*3+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function qg(t){return Array.isArray(t[0])}const JR=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,eM=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Yv=[0,0,0,255],tM={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:Yv},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Lu={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class wh extends fl{constructor(...e){super(...e),d(this,"state",void 0)}getShaders(){return super.getShaders({vs:JR,fs:eM,modules:[CL,RL]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Lu,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Lu,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Lu,defaultValue:Yv},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new QR({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,l=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:l.getPath,buffers:l,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else this._disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:l,widthMaxPixels:u}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Rc[o],widthScale:a,miterLimit:s,widthMinPixels:l,widthMaxPixels:u}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new sv(e,{...this.getShaders(),id:this.props.id,geometry:new h2({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}d(wh,"defaultProps",tM);d(wh,"layerName","PathLayer");const nM=6e-4,rM={dataTransform:{type:"accessor",value:(t,e)=>iM(t)},getTimestamps:{type:"accessor",value:t=>t.waypoints.map(e=>e.timestamp)},getPath:{type:"accessor",value:t=>t.waypoints.map(e=>e.coordinates)},getColor:{type:"accessor",value:[253,128,93]},widthMinPixels:{type:"number",value:4},capRounded:{type:"boolean",value:!0},alphaFloor:{type:"number",value:.3},wavelength:{type:"number",value:5},speed:{type:"number",value:30}};function iM(t){const e=[];return t.features.forEach(n=>{let r=[],i=[],s=[],o=0,a=0,l=0,u=0;i=n.geometry.coordinates,i.forEach((c,f,h)=>{f>0&&(s=h[f-1],o=c[0]-s[0],a=c[1]-s[1],l=Math.sqrt(o**2+a**2)/nM,u+=l),r.push({coordinates:c,timestamp:u})}),e.push({waypoints:r})}),e}class Jc extends wh{constructor(n){super(n);oo(this,"animate",()=>{this.animationid=window.requestAnimationFrame(this.animate),this.setState({currentTime:this.animationid})});this.state={currentTime:0}}getShaders(){const n=super.getShaders(),r=this.props.speed/200,i=this.props.wavelength.toFixed(1);return n.inject={"vs:#decl":`                attribute float instanceTimestamps;
                attribute float instanceNextTimestamps;
                varying float vTime;
            `,"vs:#main-end":`                vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
            `,"fs:#decl":`                uniform float currentTime;
                varying float vTime;
            `,"fs:DECKGL_FILTER_COLOR":`                // color.a = ((abs(5.0 - mod(vTime + currentTime*speed, 10.0)))/4.0)+0.3;
                color.a = ((abs(`+i+" - mod(vTime + currentTime*"+r+", "+(i*2).toFixed(1)+")))/"+(i-1).toFixed(1)+")+"+this.props.alphaFloor+`;
            `},n}initializeState(){return super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}}),this.animationid=window.requestAnimationFrame(this.animate),()=>window.cancelAnimationFrame(this.animationid)}draw(n){const{currentTime:r}=this.state;n.uniforms={...n.uniforms,currentTime:r},super.draw(n)}}oo(Jc,"layerName","PowerLineLayer"),oo(Jc,"defaultProps",rM);const sM="mapbox://styles/andrewcottam/clcsxyxcu002914qrsk95xyud",oM="pk.eyJ1IjoiYW5kcmV3Y290dGFtIiwiYSI6ImNsY3N4aHM5czB1YjkzbmxoNzN1NHk3aGYifQ.LzpyM7lJ5-f0vjshJoaNXg",aM={latitude:52.207,longitude:.315,zoom:8,minZoom:2,maxZoom:25};function lM({running:t}){return $_(_R,{initialViewState:aM,controller:!0,children:[ra(Jc,{data:"https://raw.githubusercontent.com/andrewcottam/general/master/pwr.geojson"}),ra(Eh,{mapStyle:sM,mapboxAccessToken:oM})]})}Cu.createRoot(document.getElementById("root")).render(ra(V_.StrictMode,{children:ra(lM,{running:!0})}));export{cM as c};
