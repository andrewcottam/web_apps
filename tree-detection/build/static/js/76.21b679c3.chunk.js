(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[76],{1103:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return Et}));var a=r(7),n=r.n(a),i=r(12),s=r(13),o=r(2),l=r(4),u=r(5),c=r(6),p=r(0),f=r(42),b=r(1),d=(r(19),r(14)),y=(r(15),r(10)),m=r(23),v=r(21),h=r(68),O=r(83),j=r(82),g=r(29),x=r(11),w=r(44),S=r(27),k=r(108),V=r(751),P=r(60),D=r(58),I=r(45),M=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).outSpatialReference=null,e.processExtent=null,e.processSpatialReference=null,e.returnFeatureCollection=!1,e.returnM=!1,e.returnZ=!1,e}return r}(P.a);Object(p.a)([Object(b.b)({type:I.a})],M.prototype,"outSpatialReference",void 0),Object(p.a)([Object(b.b)({type:D.a})],M.prototype,"processExtent",void 0),Object(p.a)([Object(b.b)({type:I.a})],M.prototype,"processSpatialReference",void 0),Object(p.a)([Object(b.b)({nonNullable:!0})],M.prototype,"returnFeatureCollection",void 0),Object(p.a)([Object(b.b)({nonNullable:!0})],M.prototype,"returnM",void 0),Object(p.a)([Object(b.b)({nonNullable:!0})],M.prototype,"returnZ",void 0),(M=Object(p.a)([Object(y.a)("esri/rest/geoprocessor/GPOptions")],M)).from=Object(d.m)(M);var L=M,G=r(696),T=r(666),F=r(26),N=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).extent=null,e.height=null,e.href=null,e.opacity=1,e.rotation=0,e.scale=null,e.visible=!0,e.width=null,e}return r}(F.a);Object(p.a)([Object(b.b)({type:D.a})],N.prototype,"extent",void 0),Object(p.a)([Object(b.b)()],N.prototype,"height",void 0),Object(p.a)([Object(b.b)()],N.prototype,"href",void 0),Object(p.a)([Object(b.b)()],N.prototype,"opacity",void 0),Object(p.a)([Object(b.b)()],N.prototype,"rotation",void 0),Object(p.a)([Object(b.b)()],N.prototype,"scale",void 0),Object(p.a)([Object(b.b)()],N.prototype,"visible",void 0),Object(p.a)([Object(b.b)()],N.prototype,"width",void 0);var R=N=Object(p.a)([Object(y.a)("esri.layer.support.MapImage")],N),J=r(80),E=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).itemId=null,a.url=null,a}return r}(F.a);Object(p.a)([Object(b.b)({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],E.prototype,"itemId",void 0),Object(p.a)([Object(b.b)({type:String,json:{write:!0}})],E.prototype,"url",void 0);var C=E=Object(p.a)([Object(y.a)("esri.rest.support.DataFile")],E),z=r(668),U=new f.a({esriMeters:"meters",esriFeet:"feet",esriKilometers:"kilometers",esriMiles:"miles",esriNauticalMiles:"nautical-miles",esriYards:"yards"},{ignoreUnknown:!1}),A=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).distance=0,a.units=null,a}return r}(F.a);Object(p.a)([Object(b.b)({json:{write:!0}})],A.prototype,"distance",void 0),Object(p.a)([Object(b.b)({json:{read:U.read,write:U.write}})],A.prototype,"units",void 0);var q=A=Object(p.a)([Object(y.a)("esri/rest/support/LinearUnit")],A),_=new f.a({GPBoolean:"boolean",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",GPField:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string","GPMultiValue:GPBoolean":"multi-value","GPMultiValue:GPDataFile":"multi-value","GPMultiValue:GPDate":"multi-value","GPMultiValue:GPDouble":"multi-value","GPMultiValue:GPFeatureRecordSetLayer":"multi-value","GPMultiValue:GPField":"multi-value","GPMultiValue:GPLinearUnit":"multi-value","GPMultiValue:GPLong":"multi-value","GPMultiValue:GPRasterData":"multi-value","GPMultiValue:GPRasterDataLayer":"multi-value","GPMultiValue:GPRecordSet":"multi-value","GPMultiValue:GPString":"multi-value"}),B=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).dataType=null,a.value=null,a}return r}(F.a);Object(p.a)([Object(b.b)({json:{read:_.read,write:_.write}})],B.prototype,"dataType",void 0),Object(p.a)([Object(b.b)()],B.prototype,"value",void 0);var K=B=Object(p.a)([Object(y.a)("esri.rest.support.ParameterValue")],B),W=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).format=null,a.itemId=null,a.url=null,a}return r}(F.a);Object(p.a)([Object(b.b)()],W.prototype,"format",void 0),Object(p.a)([Object(b.b)({json:{read:{source:"itemID"},write:{target:"itemID"}}})],W.prototype,"itemId",void 0),Object(p.a)([Object(b.b)()],W.prototype,"url",void 0);var Z=W=Object(p.a)([Object(y.a)("esri/rest/support/RasterData")],W);function Q(e,t,r,a,n){return $.apply(this,arguments)}function $(){return($=Object(i.a)(n.a.mark((function e(t,r,a,i,o){var l,u,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l={},u={},c=[],e.abrupt("return",(Y(i,c,l),Object(G.a)(c).then((function(e){var n=a.outSpatialReference,c=a.processExtent,p=a.processSpatialReference,f=a.returnFeatureCollection,b=a.returnM,d=a.returnZ,y=Object(J.c)(t).path;for(var m in l){var v=l[m];u[m]=e.slice(v[0],v[1])}var h=n?n.wkid||n:null,O=p?p.wkid||p:null,g="execute"===r?{returnFeatureCollection:f||void 0,returnM:b||void 0,returnZ:d||void 0}:null,x=X(Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},c?{context:{extent:c,outSR:h,processSR:O}}:{"env:outSR":h,"env:processSR":O}),i),g),{},{f:"json"}),null,u),w=Object(s.a)(Object(s.a)({},o),{},{query:x});return Object(j.default)("".concat(y,"/").concat(r),w)}))));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t,r){for(var a in e){var n=e[a];if(n&&"object"==typeof n&&n instanceof z.default){var i=n.features;r[a]=[t.length,t.length+i.length],i.forEach((function(e){t.push(e.geometry)}))}}}function H(e){var t=e.dataType,r=K.fromJSON(e);switch(t){case"GPBoolean":case"GPDouble":case"GPLong":case"GPString":case"GPMultiValue:GPBoolean":case"GPMultiValue:GPDouble":case"GPMultiValue:GPLong":case"GPMultiValue:GPString":return r;case"GPDate":r.value=new Date(r.value);break;case"GPDataFile":r.value=C.fromJSON(r.value);break;case"GPLinearUnit":r.value=q.fromJSON(r.value);break;case"GPFeatureRecordSetLayer":case"GPRecordSet":var a=e.value.url;r.value=a?C.fromJSON(r.value):z.default.fromJSON(r.value);break;case"GPRasterData":case"GPRasterDataLayer":var n=e.value.mapImage;r.value=n?R.fromJSON(n):Z.fromJSON(r.value);break;case"GPField":r.value=T.a.fromJSON(r.value);break;case"GPMultiValue:GPDate":var i=r.value;r.value=i.map((function(e){return new Date(e)}));break;case"GPMultiValue:GPDataFile":r.value=r.value.map((function(e){return C.fromJSON(e)}));break;case"GPMultiValue:GPLinearUnit":r.value=r.value.map((function(e){return q.fromJSON(e)}));break;case"GPMultiValue:GPFeatureRecordSetLayer":case"GPMultiValue:GPRecordSet":r.value=r.value.map((function(e){return z.default.fromJSON(e)}));break;case"GPMultiValue:GPRasterData":case"GPMultiValue:GPRasterDataLayer":r.value=r.value.map((function(e){return e?R.fromJSON(e):Z.fromJSON(r.value)}));break;case"GPMultiValue:GPField":r.value=r.value.map((function(e){return T.a.fromJSON(e)}))}return r}function X(e,t,r){for(var a in e){var n=e[a];Array.isArray(n)?e[a]=JSON.stringify(n.map((function(e){return X({item:e},!0).item}))):n instanceof Date&&(e[a]=n.getTime())}return Object(J.b)(e,t,r)}var ee=r(974);function te(e,t,r,a){return re.apply(this,arguments)}function re(){return(re=Object(i.a)(n.a.mark((function e(t,r,a,i){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(a=L.from(a||{}),Q(t,"execute",a,r,i).then((function(e){var t=e.data.results||[],r=e.data.messages||[];return{results:t.map(H),messages:r.map((function(e){return ee.a.fromJSON(e)}))}}))));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ae,ne=r(30),ie=new f.a({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"}),se=ae=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).jobId=null,r.jobStatus=null,r.messages=null,r.requestOptions=null,r.sourceUrl=null,r._timer=null,r}return Object(l.a)(a,[{key:"cancelJob",value:function(e){var t=this,r=this.jobId,a=this.sourceUrl,n=Object(J.c)(a).path,i=Object(s.a)(Object(s.a)(Object(s.a)({},this.requestOptions),e),{},{query:{f:"json"}});return this._clearTimer(),Object(j.default)("".concat(n,"/jobs/").concat(r,"/cancel"),i).then((function(e){var r=ae.fromJSON(e.data);return t.messages=r.messages,t.jobStatus=r.jobStatus,t}))}},{key:"destroy",value:function(){clearInterval(this._timer)}},{key:"checkJobStatus",value:function(e){var t=this,r=Object(J.c)(this.sourceUrl).path,a=Object(s.a)(Object(s.a)(Object(s.a)({},this.requestOptions),e),{},{query:{f:"json"}}),n="".concat(r,"/jobs/").concat(this.jobId);return Object(j.default)(n,a).then((function(e){var r=e.data,a=ae.fromJSON(r);return t.messages=a.messages,t.jobStatus=a.jobStatus,t}))}},{key:"fetchResultData",value:function(e,t,r){var a=t=L.from(t||{}),n=a.returnFeatureCollection,i=a.returnM,o=a.returnZ,l=a.outSpatialReference,u=Object(J.c)(this.sourceUrl).path,c=X({returnFeatureCollection:n,returnM:i,returnZ:o,outSR:l,returnType:"data",f:"json"},null),p=Object(s.a)(Object(s.a)(Object(s.a)({},this.requestOptions),r),{},{query:c}),f="".concat(u,"/jobs/").concat(this.jobId,"/results/").concat(e);return Object(j.default)(f,p).then((function(e){return H(e.data)}))}},{key:"fetchResultImage",value:function(e,t,r){var a=Object(J.c)(this.sourceUrl).path,n=X(Object(s.a)(Object(s.a)({},t.toJSON()),{},{f:"json"})),i=Object(s.a)(Object(s.a)(Object(s.a)({},this.requestOptions),r),{},{query:n}),o="".concat(a,"/jobs/").concat(this.jobId,"/results/").concat(e);return Object(j.default)(o,i).then((function(e){return H(e.data)}))}},{key:"fetchResultMapImageLayer",value:function(){var e=Object(i.a)(n.a.mark((function e(){var t,a,i,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(J.c)(this.sourceUrl),a=t.path,i=a.indexOf("/GPServer/"),s="".concat(a.substring(0,i),"/MapServer/jobs/").concat(this.jobId),e.next=4,Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(53)]).then(r.bind(null,1012));case 4:return e.t0=e.sent.default,e.t1={url:s},e.abrupt("return",new e.t0(e.t1));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"waitForJobCompletion",value:function(){var e=Object(i.a)(n.a.mark((function e(){var t,r,a,i,s,o=this,l=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=t.interval,a=void 0===r?1e3:r,i=t.signal,s=t.statusCallback,e.abrupt("return",new Promise((function(e,t){Object(ne.q)(i,(function(){o._clearTimer(),t(Object(ne.e)())})),o._clearTimer();var r=setInterval((function(){o._timer||t(Object(ne.e)()),o.checkJobStatus(o.requestOptions).then((function(r){var a=r.jobStatus;switch(o.jobStatus=a,a){case"job-succeeded":o._clearTimer(),e(o);break;case"job-submitted":case"job-executing":case"job-waiting":case"job-new":s&&s(o);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-timed-out":case"job-failed":o._clearTimer(),t(o)}}))}),a);o._timer=r})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_clearTimer",value:function(){this._timer&&(clearInterval(this._timer),this._timer=null)}}]),a}(F.a);Object(p.a)([Object(b.b)()],se.prototype,"jobId",void 0),Object(p.a)([Object(b.b)({json:{read:ie.read}})],se.prototype,"jobStatus",void 0),Object(p.a)([Object(b.b)({type:[ee.a]})],se.prototype,"messages",void 0),Object(p.a)([Object(b.b)()],se.prototype,"requestOptions",void 0),Object(p.a)([Object(b.b)({json:{write:!0}})],se.prototype,"sourceUrl",void 0);var oe=se=ae=Object(p.a)([Object(y.a)("esri.rest.support.JobInfo")],se);function le(e,t,r,a){return ue.apply(this,arguments)}function ue(){return(ue=Object(i.a)(n.a.mark((function e(t,r,a,i){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(a=L.from(a||{}),Q(t,"submitJob",a,r,i).then((function(e){var r=oe.fromJSON(e.data);return r.sourceUrl=t,r}))));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ce=new f.a({PDF:"pdf",PNG32:"png32",PNG8:"png8",JPG:"jpg",GIF:"gif",EPS:"eps",SVG:"svg",SVGZ:"svgz"}),pe=(ce.fromJSON.bind(ce),ce.toJSON.bind(ce)),fe=new f.a({MAP_ONLY:"map-only","A3 Landscape":"a3-landscape","A3 Portrait":"a3-portrait","A4 Landscape":"a4-landscape","A4 Portrait":"a4-portrait","Letter ANSI A Landscape":"letter-ansi-a-landscape","Letter ANSI A Portrait":"letter-ansi-a-portrait","Tabloid ANSI B Landscape":"tabloid-ansi-b-landscape","Tabloid ANSI B Portrait":"tabloid-ansi-b-portrait"}),be=(fe.fromJSON.bind(fe),fe.toJSON.bind(fe)),de="simple-marker",ye="simple-line";function me(e,t){var r=t.graphic,a=t.renderer,n=t.symbol,i=n.type;if("text"!==i&&"shield-label-symbol"!==i&&"visualVariables"in a&&a.visualVariables){var s=a.getVisualVariablesForType("size"),o=a.getVisualVariablesForType("color"),l=a.getVisualVariablesForType("opacity"),u=a.getVisualVariablesForType("rotation"),c=s[0],p=o[0],f=l[0],b=u[0];if(c){var d=i===de?n.style:null,y=Object(V.e)(c,r,{shape:d});null!=y&&(i===de?e.size=Object(w.c)(y):"picture-marker"===i?(e.width=Object(w.c)(y),e.height=Object(w.c)(y)):i===ye?e.width=Object(w.c)(y):e.outline&&(e.outline.width=Object(w.c)(y)))}if(p){var m=Object(V.b)(p,r);(m&&i===de||i===ye||"simple-fill"===i)&&(e.color=m?m.toJSON():void 0)}if(f){var v=Object(V.c)(f,r);null!=v&&e.color&&(e.color[3]=Math.round(255*v))}b&&(e.angle=-Object(V.d)(a,r))}}function ve(e){var t,r,a,n,i,s,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,l=e.canvas.width,u=e.canvas.height,c=e.getImageData(0,0,l,u).data;e:for(r=u;r--;)for(t=l;t--;)if(c[4*(l*r+t)+3]>o){s=r;break e}if(!s)return null;e:for(t=l;t--;)for(r=s+1;r--;)if(c[4*(l*r+t)+3]>o){i=t;break e}e:for(t=0;t<=i;++t)for(r=s+1;r--;)if(c[4*(l*r+t)+3]>o){a=t;break e}e:for(r=0;r<=s;++r)for(t=a;t<=i;++t)if(c[4*(l*r+t)+3]>o){n=r;break e}return{x:a,y:n,width:i-a,height:s-n}}function he(e,t){var r=e.allLayerViews.items;if(t===e.scale)return r.filter((function(e){return!e.suspended}));var a,n=new Array,i=Object(v.a)(r);try{for(i.s();!(a=i.n()).done;){var s=a.value;ke(s.parent)&&!n.includes(s.parent)||!s.visible||t&&"isVisibleAtScale"in s&&!s.isVisibleAtScale(t)||n.push(s)}}catch(o){i.e(o)}finally{i.f()}return n}function Oe(e){return e&&"bing-maps"===e.type}function je(e){return e&&"csv"===e.type}function ge(e){return e&&"feature"===e.type}function xe(e){return e&&"geojson"===e.type}function we(e){return e&&"graphics"===e.type}function Se(e){return e&&"group"===e.type}function ke(e){return e&&"esri.views.2d.layers.GroupLayerView2D"===e.declaredClass}function Ve(e){return e&&"imagery"===e.type}function Pe(e){return e&&"kml"===e.type}function De(e){return e&&"map-image"===e.type}function Ie(e){return e&&"map-notes"===e.type}function Me(e){return e&&"open-street-map"===e.type}function Le(e){return e&&"stream"===e.type}function Ge(e){return e&&"tile"===e.type}function Te(e){return e&&"vector-tile"===e.type}function Fe(e){return e&&"web-tile"===e.type}function Ne(e){return e&&"wms"===e.type}function Re(e){return e&&"wmts"===e.type}var Je=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).attributionVisible=!0,a.exportOptions={width:800,height:1100,dpi:96},a.forceFeatureAttributes=!1,a.format="png32",a.label=null,a.layout="map-only",a.layoutOptions=null,a.outScale=0,a.scalePreserved=!0,a.showLabels=!0,a}return r}(P.a);Object(p.a)([Object(b.b)()],Je.prototype,"attributionVisible",void 0),Object(p.a)([Object(b.b)()],Je.prototype,"exportOptions",void 0),Object(p.a)([Object(b.b)()],Je.prototype,"forceFeatureAttributes",void 0),Object(p.a)([Object(b.b)()],Je.prototype,"format",void 0),Object(p.a)([Object(b.b)()],Je.prototype,"label",void 0),Object(p.a)([Object(b.b)()],Je.prototype,"layout",void 0),Object(p.a)([Object(b.b)()],Je.prototype,"layoutOptions",void 0),Object(p.a)([Object(b.b)()],Je.prototype,"outScale",void 0),Object(p.a)([Object(b.b)()],Je.prototype,"scalePreserved",void 0),Object(p.a)([Object(b.b)()],Je.prototype,"showLabels",void 0);var Ee=Je=Object(p.a)([Object(y.a)("esri.rest.support.PrintTemplate")],Je),Ce=r(398),ze=r(832),Ue={Feet:"ft",Kilometers:"km",Meters:"m",Miles:"mi"},Ae=new f.a({esriFeet:"Feet",esriKilometers:"Kilometers",esriMeters:"Meters",esriMiles:"Miles"}),qe=new f.a({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),_e=new Map;function Be(){return(Be=Object(i.a)(n.a.mark((function e(t,r,a){var i,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=$e(t),s=_e.get(i),e.abrupt("return",Promise.resolve().then((function(){return s?{data:s.gpMetadata}:(s={gpServerUrl:i,is11xService:!1,legendLayerNameMap:[],legendLayers:[]},Object(j.default)(i,{query:{f:"json"}}))})).then((function(e){return s.gpMetadata=e.data,s.cimVersion=s.gpMetadata.cimVersion,s.is11xService=!!s.cimVersion,_e.set(i,s),Ke(r,s)})).then((function(e){var n,i=Tt(s),o=function(e){return"sync"===i?e.results&&e.results[0]&&e.results[0].value:n.fetchResultData("Output_File",null,a).then((function(e){return e.value}))};return"async"===i?le(t,e,null,a).then((function(e){return n=e,e.waitForJobCompletion({interval:r.updateDelay}).then(o)})):te(t,e,null,a).then(o)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ke(e,t){return We.apply(this,arguments)}function We(){return(We=Object(i.a)(n.a.mark((function e(t,r){var a,i,s,o,l,u,c,p,f,b,d,y,m,v,h,O,j;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||{is11xService:!1,legendLayerNameMap:[],legendLayers:[]},null==(a=t.template||new Ee).showLabels&&(a.showLabels=!0),i=a.exportOptions,o=be(a.layout),i&&(s={dpi:i.dpi},("map_only"===o.toLowerCase()||""===o)&&(l=i.width,u=i.height,s.outputSize=[l,u])),(c=a.layoutOptions)&&("Miles"===c.scalebarUnit||"Kilometers"===c.scalebarUnit?(f="Kilometers",b="Miles"):"Meters"!==c.scalebarUnit&&"Feet"!==c.scalebarUnit||(f="Meters",b="Feet"),p={titleText:c.titleText,authorText:c.authorText,copyrightText:c.copyrightText,customTextElements:c.customTextElements,scaleBarOptions:{metricUnit:Ae.toJSON(f),metricLabel:Ue[f],nonMetricUnit:Ae.toJSON(b),nonMetricLabel:Ue[b]}}),d=null,c&&c.legendLayers&&(d=c.legendLayers.map((function(e){r.legendLayerNameMap[e.layerId]=e.title;var t={id:e.layerId};return e.subLayerIds&&(t.subLayerIds=e.subLayerIds),t}))),e.next=12,Ze(t,a,r);case 12:return(y=e.sent).operationalLayers&&(m=new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),v=/[\u0600-\u06FF]/,h=function(e){var t=e.text,r=e.font,a=r&&r.family&&r.family.toLowerCase();t&&r&&("arial"===a||"arial unicode ms"===a)&&(r.family=m.test(t)?"Arial Unicode MS":"Arial","normal"!==r.style&&v.test(t)&&(r.family="Arial Unicode MS"))},O=function(){throw new g.a("print-task:cim-symbol-unsupported","CIMSymbol is not supported by a print service published from ArcMap")},y.operationalLayers.forEach((function(e){var t,a,n;null!=(t=e.featureCollection)&&t.layers?e.featureCollection.layers.forEach((function(e){var t,a,n,i;if(null!=(t=e.layerDefinition)&&null!=(a=t.drawingInfo)&&null!=(n=a.renderer)&&n.symbol){var s=e.layerDefinition.drawingInfo.renderer;"esriTS"===s.symbol.type?h(s.symbol):"CIMSymbolReference"!==s.symbol.type||r.is11xService||O()}null!=(i=e.featureSet)&&i.features&&e.featureSet.features.forEach((function(e){e.symbol&&("esriTS"===e.symbol.type?h(e.symbol):"CIMSymbolReference"!==e.symbol.type||r.is11xService||O())}))})):!r.is11xService&&null!=(a=e.layerDefinition)&&null!=(n=a.drawingInfo)&&n.renderer&&JSON.stringify(e.layerDefinition.drawingInfo.renderer).includes('"type":"CIMSymbolReference"')&&O()}))),t.outSpatialReference&&(y.mapOptions.spatialReference=t.outSpatialReference.toJSON()),Object.assign(y,{exportOptions:s,layoutOptions:p||{}}),Object.assign(y.layoutOptions,{legendOptions:{operationalLayers:null!=d?d:r.legendLayers.slice()}}),r.legendLayers.length=0,_e.set(r.gpServerUrl,r),j={Web_Map_as_JSON:JSON.stringify(y),Format:pe(a.format),Layout_Template:o},e.abrupt("return",(t.extraParameters&&Object.assign(j,t.extraParameters),j));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ze(e,t,r){return Qe.apply(this,arguments)}function Qe(){return(Qe=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o,l,u,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.view,s=i.spatialReference,e.next=4,Ye(i,r,a);case 4:return e.t0=e.sent,o={operationalLayers:e.t0},l=a.ssExtent||t.extent||i.extent,s&&s.isWrappable&&(l=l.clone()._normalize(!0),s=l.spatialReference),o.mapOptions={extent:l&&l.toJSON(),spatialReference:s&&s.toJSON(),showAttribution:r.attributionVisible},a.ssExtent=null,i.background&&(o.background=i.background.toJSON()),i.rotation&&(o.mapOptions.rotation=-i.rotation),r.scalePreserved&&(o.mapOptions.scale=r.outScale||i.scale),i.timeExtent&&(u=Object(x.j)(i.timeExtent.start)?i.timeExtent.start.getTime():null,c=Object(x.j)(i.timeExtent.end)?i.timeExtent.end.getTime():null,o.mapOptions.time=[u,c]),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $e(e){var t=e,r=t.lastIndexOf("/GPServer/");return r>0&&(t=t.slice(0,r+9)),t}function Ye(e,t,r){return He.apply(this,arguments)}function He(){return(He=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o,l,u,c,p,f,b,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],s={layerView:null,printTemplate:r,view:t},o=0,r.scalePreserved&&(o=r.outScale||t.scale),l=he(t,o),u=Object(v.a)(l),e.prev=5,u.s();case 7:if((c=u.n()).done){e.next=116;break}if(p=c.value,(f=p.layer).loaded&&!Se(f)){e.next=12;break}return e.abrupt("continue",114);case 12:if(b=void 0,s.layerView=p,!Oe(f)){e.next=18;break}e.t0=Xe(f),e.next=112;break;case 18:if(!je(f)){e.next=24;break}return e.next=21,et(f,s,a);case 21:e.t1=e.sent,e.next=111;break;case 24:if(!ge(f)){e.next=30;break}return e.next=27,nt(f,s,a);case 27:e.t2=e.sent,e.next=110;break;case 30:if(!xe(f)){e.next=36;break}return e.next=33,st(f,s,a);case 33:e.t3=e.sent,e.next=109;break;case 36:if(!we(f)){e.next=42;break}return e.next=39,lt(f,s,a);case 39:e.t4=e.sent,e.next=108;break;case 42:if(!Ve(f)){e.next=46;break}e.t5=ct(f,a),e.next=107;break;case 46:if(!Pe(f)){e.next=52;break}return e.next=49,pt(f,s,a);case 49:e.t6=e.sent,e.next=106;break;case 52:if(!De(f)){e.next=56;break}e.t7=bt(f,s,a),e.next=105;break;case 56:if(!Ie(f)){e.next=62;break}return e.next=59,dt(s,a);case 59:e.t8=e.sent,e.next=104;break;case 62:if(!Me(f)){e.next=66;break}e.t9={type:"OpenStreetMap"},e.next=103;break;case 66:if(!Le(f)){e.next=72;break}return e.next=69,ht(f,s,a);case 69:e.t10=e.sent,e.next=102;break;case 72:if(!Ge(f)){e.next=76;break}e.t11=jt(f),e.next=101;break;case 76:if(!Te(f)){e.next=82;break}return e.next=79,gt(f,s,a);case 79:e.t12=e.sent,e.next=100;break;case 82:if(!Fe(f)){e.next=86;break}e.t13=wt(f),e.next=99;break;case 86:if(!Ne(f)){e.next=90;break}e.t14=St(f),e.next=98;break;case 90:if(!Re(f)){e.next=94;break}e.t15=kt(f),e.next=97;break;case 94:return e.next=96,mt(f,s,a);case 96:e.t15=e.sent;case 97:e.t14=e.t15;case 98:e.t13=e.t14;case 99:e.t12=e.t13;case 100:e.t11=e.t12;case 101:e.t10=e.t11;case 102:e.t9=e.t10;case 103:e.t8=e.t9;case 104:e.t7=e.t8;case 105:e.t6=e.t7;case 106:e.t5=e.t6;case 107:e.t4=e.t5;case 108:e.t3=e.t4;case 109:e.t2=e.t3;case 110:e.t1=e.t2;case 111:e.t0=e.t1;case 112:(b=e.t0)&&(Array.isArray(b)?i.push.apply(i,Object(m.a)(b)):(b.id=f.id,b.title=a.legendLayerNameMap[f.id]||f.title,b.opacity=f.opacity,b.minScale=f.minScale||0,b.maxScale=f.maxScale||0,i.push(b)));case 114:e.next=7;break;case 116:e.next=121;break;case 118:e.prev=118,e.t16=e.catch(5),u.e(e.t16);case 121:return e.prev=121,u.f(),e.finish(121);case 124:if(o&&i.forEach((function(e){e.minScale=0,e.maxScale=0})),!t.graphics||!t.graphics.length){e.next=129;break}return e.next=127,rt(null,t.graphics,r,a);case 127:(d=e.sent)&&i.push(d);case 129:return e.abrupt("return",i);case 130:case"end":return e.stop()}}),e,null,[[5,118,121,124]])})))).apply(this,arguments)}function Xe(e){return{culture:e.culture,key:e.key,type:"BingMaps"+("aerial"===e.style?"Aerial":"hybrid"===e.style?"Hybrid":"Road")}}function et(e,t,r){return tt.apply(this,arguments)}function tt(){return(tt=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.legendLayers&&a.legendLayers.push({id:t.id}),i=r.layerView,s=r.printTemplate,a.is11xService&&!i.filter){e.next=11;break}return e.t0=rt,e.t1=t,e.next=7,Lt(i);case 7:return e.t2=e.sent,e.t3=s,e.t4=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 11:return e.abrupt("return",(o={type:"CSV"},t.write(o,{origin:"web-map"}),delete o.popupInfo,delete o.layerType,o.showLabels=s.showLabels&&t.labelsVisible,o));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rt(e,t,r,a){return at.apply(this,arguments)}function at(){return(at=Object(i.a)(n.a.mark((function e(t,r,a,i){var s,o,l,u,c,p,f,b,d,y,m,h,O,j,g,x,w,S,V,P,D,I,M,L,G,T,F;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}},l={layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}},u={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}},c={layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}},(p={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}).layerDefinition.name="textLayer",delete p.layerDefinition.drawingInfo,t&&("esri.layers.FeatureLayer"===t.declaredClass||"esri.layers.StreamLayer"===t.declaredClass?o.layerDefinition.name=l.layerDefinition.name=u.layerDefinition.name=c.layerDefinition.name=i.legendLayerNameMap[t.id]||t.get("arcgisProps.title")||t.title:"esri.layers.GraphicsLayer"===t.declaredClass&&(r=t.graphics.items),t.renderer&&(f=t.renderer.toJSON(),o.layerDefinition.drawingInfo.renderer=f,l.layerDefinition.drawingInfo.renderer=f,u.layerDefinition.drawingInfo.renderer=f,c.layerDefinition.drawingInfo.renderer=f),a.showLabels&&t.labelsVisible&&"function"==typeof t.write&&(y=null==(b=t.write({},{origin:"web-map"}).layerDefinition)||null==(d=b.drawingInfo)?void 0:d.labelingInfo)&&(s=!0,o.layerDefinition.drawingInfo.labelingInfo=y,l.layerDefinition.drawingInfo.labelingInfo=y,u.layerDefinition.drawingInfo.labelingInfo=y,c.layerDefinition.drawingInfo.labelingInfo=y)),null!=t&&t.renderer||s||(delete o.layerDefinition.drawingInfo,delete l.layerDefinition.drawingInfo,delete u.layerDefinition.drawingInfo,delete c.layerDefinition.drawingInfo),h=null==t?void 0:t.fieldsIndex,O=null==t?void 0:t.renderer,!h){e.next=12;break}if(!O||"function"!=typeof O.collectRequiredFields){e.next=10;break}return j=new Set,e.next=9,O.collectRequiredFields(j,h);case 9:m=Array.from(j);case 10:g=h.fields.map((function(e){return e.toJSON()})),o.layerDefinition.fields=g,l.layerDefinition.fields=g,u.layerDefinition.fields=g,c.layerDefinition.fields=g;case 12:x=r&&r.length,S=0;case 14:if(!(S<x)){e.next=46;break}if(!1!==(V=r[S]||r.getItemAt(S)).visible&&V.geometry){e.next=18;break}return e.abrupt("continue",43);case 18:if((w=V.toJSON()).hasOwnProperty("popupTemplate")&&delete w.popupTemplate,w.geometry&&w.geometry.z&&delete w.geometry.z,!w.symbol||!w.symbol.outline||"esriCLS"!==w.symbol.outline.type||i.is11xService){e.next=20;break}return e.abrupt("continue",43);case 20:if(!i.is11xService&&w.symbol&&w.symbol.outline&&w.symbol.outline.color&&w.symbol.outline.color[3]&&(w.symbol.outline.color[3]=255),P=t&&t.renderer&&("valueExpression"in t.renderer&&t.renderer.valueExpression||"hasVisualVariables"in t.renderer&&t.renderer.hasVisualVariables()),w.symbol||!t||!t.renderer||!P||i.is11xService){e.next=30;break}return D=t.renderer,e.next=26,D.getSymbolAsync(V);case 26:if(I=e.sent){e.next=29;break}return e.abrupt("continue",43);case 29:w.symbol=I.toJSON(),"hasVisualVariables"in D&&D.hasVisualVariables()&&me(w.symbol,{renderer:D,graphic:V,symbol:I});case 30:if(e.t0=w.symbol,!e.t0){e.next=40;break}if(w.symbol.angle||delete w.symbol.angle,!Ft(w.symbol)){e.next=39;break}return e.next=36,Pt(w.symbol,i);case 36:w.symbol=e.sent,e.next=40;break;case 39:w.symbol.text&&delete w.attributes;case 40:if(a&&a.forceFeatureAttributes||!m||!m.length){e.next=42;break}!function(){var e={};m.forEach((function(t){w.attributes&&w.attributes.hasOwnProperty(t)&&(e[t]=w.attributes[t])})),w.attributes=e}();case 42:"polygon"===V.geometry.type?o.featureSet.features.push(w):"polyline"===V.geometry.type?l.featureSet.features.push(w):"point"===V.geometry.type?w.symbol&&w.symbol.text?p.featureSet.features.push(w):u.featureSet.features.push(w):"multipoint"===V.geometry.type?c.featureSet.features.push(w):"extent"===V.geometry.type&&(w.geometry=k.a.fromExtent(V.geometry).toJSON(),o.featureSet.features.push(w));case 43:S++,e.next=14;break;case 46:M=[o,l,c,u,p].filter((function(e){return e.featureSet.features.length>0})),L=Object(v.a)(M),e.prev=48,L.s();case 50:if((G=L.n()).done){e.next=61;break}if(T=G.value,F=T.featureSet.features.every((function(e){return e.symbol})),!F||a&&a.forceFeatureAttributes||T.featureSet.features.forEach((function(e){delete e.attributes})),F&&delete T.layerDefinition.drawingInfo,e.t1=T.layerDefinition.drawingInfo&&T.layerDefinition.drawingInfo.renderer,!e.t1){e.next=59;break}return e.next=59,It(T.layerDefinition.drawingInfo.renderer,i);case 59:e.next=50;break;case 61:e.next=66;break;case 63:e.prev=63,e.t2=e.catch(48),L.e(e.t2);case 66:return e.prev=66,L.f(),e.finish(66);case 69:return e.abrupt("return",M.length?{featureCollection:{layers:M},showLabels:s}:null);case 70:case"end":return e.stop()}}),e,null,[[48,63,66,69]])})))).apply(this,arguments)}function nt(e,t,r){return it.apply(this,arguments)}function it(){return(it=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o,l,u,c,p,f,b,d,y,m,v,h,O,j;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.legendLayers&&a.legendLayers.push({id:t.id}),l=t.renderer,!(t.featureReduction||l&&"dot-density"===l.type&&(!a.is11xService||parseFloat(a.cimVersion)<2.6))){e.next=4;break}return e.abrupt("return",mt(t,r,a));case 4:if(u=r.layerView,c=r.printTemplate,p=r.view,f=l&&("valueExpression"in l&&l.valueExpression||"hasVisualVariables"in l&&l.hasVisualVariables()),b="feature-layer"!==(null==(i=t.source)?void 0:i.type)&&"ogc-feature"!==(null==(s=t.source)?void 0:s.type),!(!a.is11xService&&f||t.featureReduction||u.filter||b)&&l&&(!("field"in l)||null==l.field||"string"==typeof l.field&&t.getField(l.field))){e.next=14;break}return e.next=8,Lt(u);case 8:return d=e.sent,e.next=11,rt(t,d,c,a);case 11:o=e.sent,e.next=29;break;case 14:if((o={id:(j=t.write()).id,title:j.title,opacity:j.opacity,minScale:j.minScale,maxScale:j.maxScale,url:j.url,layerType:j.layerType,customParameters:j.customParameters,layerDefinition:j.layerDefinition}).showLabels=c.showLabels&&t.labelsVisible,Vt(o,t),e.t0=null!=(y=o.layerDefinition)&&null!=(m=y.drawingInfo)&&m.renderer,!e.t0){e.next=24;break}return delete o.layerDefinition.minScale,delete o.layerDefinition.maxScale,e.next=23,It(o.layerDefinition.drawingInfo.renderer,a);case 23:e.t0="visualVariables"in l&&l.visualVariables&&l.visualVariables[0];case 24:if(!e.t0){e.next=27;break}"size"===(v=l.visualVariables[0]).type&&v.maxSize&&"number"!=typeof v.maxSize&&v.minSize&&"number"!=typeof v.minSize&&(h=Object(V.f)(v,p.scale),o.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=h.minSize,o.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=h.maxSize);case 27:(O=Object(ze.b)(u))&&(o.layerDefinition||(o.layerDefinition={}),o.layerDefinition.definitionExpression=o.layerDefinition.definitionExpression?"(".concat(o.layerDefinition.definitionExpression,") AND (").concat(O,")"):O);case 29:return e.abrupt("return",o);case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function st(e,t,r){return ot.apply(this,arguments)}function ot(){return(ot=Object(i.a)(n.a.mark((function e(t,r,a){var i,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.layerView,s=r.printTemplate,a.legendLayers&&a.legendLayers.push({id:t.id}),e.t0=rt,e.t1=t,e.next=6,Lt(i);case 6:return e.t2=e.sent,e.t3=s,e.t4=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lt(e,t,r){return ut.apply(this,arguments)}function ut(){return(ut=Object(i.a)(n.a.mark((function e(t,r,a){var i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.printTemplate,e.abrupt("return",rt(t,null,i,a));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ct(e,t){t.legendLayers&&t.legendLayers.push({id:e.id});var r,a={layerType:(r=e.write()).layerType,customParameters:r.customParameters};if(a.bandIds=e.bandIds,a.compressionQuality=e.compressionQuality,a.format=e.format,a.interpolation=e.interpolation,(e.mosaicRule||e.definitionExpression)&&(a.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.renderingRule||e.renderer)if(t.is11xService)e.renderingRule&&(a.renderingRule=e.renderingRule.toJSON()),e.renderer&&(a.layerDefinition=a.layerDefinition||{},a.layerDefinition.drawingInfo=a.layerDefinition.drawingInfo||{},a.layerDefinition.drawingInfo.renderer=e.renderer.toJSON());else{var n=e.exportImageServiceParameters.combineRendererWithRenderingRule();n&&(a.renderingRule=n.toJSON())}return Vt(a,e),a}function pt(e,t,r){return ft.apply(this,arguments)}function ft(){return(ft=Object(i.a)(n.a.mark((function e(t,r,a){var i,o,l,u,c,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.printTemplate,!a.is11xService){e.next=4;break}return o={type:"kml"},e.abrupt("return",(t.write(o,{origin:"web-map"}),delete o.layerType,o.url=Object(S.C)(t.url),o));case 4:return l=[],(u=r.layerView).allVisibleMapImages.forEach((function(e,r){var a={id:"".concat(t.id,"_image").concat(r),type:"image",title:t.id,minScale:t.minScale||0,maxScale:t.maxScale||0,opacity:t.opacity,extent:e.extent};"data:image/png;base64,"===e.href.substr(0,22)?a.imageData=e.href.substr(22):a.url=e.href,l.push(a)})),c=[].concat(Object(m.a)(u.allVisiblePoints.items),Object(m.a)(u.allVisiblePolylines.items),Object(m.a)(u.allVisiblePolygons.items)),e.t0=s.a,e.t1={id:t.id},e.next=11,rt(null,c,i,a);case 11:return e.t2=e.sent,p=(0,e.t0)(e.t1,e.t2),e.abrupt("return",(l.push(p),l));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bt(e,t,r){var a,n,i=t.view,s={id:e.id,subLayerIds:[]},o=[],l=i.scale;return e.sublayers&&e.sublayers.forEach((function e(t){var r=0===l,a=0===t.minScale||l<=t.minScale,n=0===t.maxScale||l>=t.maxScale;if(t.visible&&(r||a&&n))if(t.sublayers)t.sublayers.forEach(e);else{var i=t.toExportImageJSON(),u={id:t.id,name:t.title,layerDefinition:{drawingInfo:i.drawingInfo,definitionExpression:i.definitionExpression,source:i.source}};o.unshift(u),s.subLayerIds.push(t.id)}})),o.length&&(o=o.map((function(e){return{id:e.id,name:e.name,layerDefinition:e.layerDefinition}})),(a={layerType:(n=e.write()).layerType,customParameters:n.customParameters}).layers=o,a.visibleLayers=e.capabilities.exportMap.supportsDynamicLayers?void 0:s.subLayerIds,Vt(a,e),r.legendLayers.push(s)),a}function dt(e,t){return yt.apply(this,arguments)}function yt(){return(yt=Object(i.a)(n.a.mark((function e(t,r){var a,i,s,o,l,u,c,p,f,b,d,y;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.layerView,i=t.printTemplate,s=[],o=a.layer,!Object(x.j)(o.featureCollections)){e.next=24;break}l=Object(v.a)(o.featureCollections),e.prev=4,l.s();case 6:if((u=l.n()).done){e.next=14;break}return c=u.value,e.next=10,rt(c,c.source,i,r);case 10:(p=e.sent)&&s.push.apply(s,Object(m.a)(p.featureCollection.layers));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),l.e(e.t0);case 19:return e.prev=19,l.f(),e.finish(19);case 22:e.next=44;break;case 24:if(!Object(x.j)(o.sublayers)){e.next=44;break}f=Object(v.a)(o.sublayers),e.prev=26,f.s();case 28:if((b=f.n()).done){e.next=36;break}return d=b.value,e.next=32,rt(null,d.graphics,i,r);case 32:(y=e.sent)&&s.push.apply(s,Object(m.a)(y.featureCollection.layers));case 34:e.next=28;break;case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(26),f.e(e.t1);case 41:return e.prev=41,f.f(),e.finish(41);case 44:return e.abrupt("return",{featureCollection:{layers:s}});case 45:case"end":return e.stop()}}),e,null,[[4,16,19,22],[26,38,41,44]])})))).apply(this,arguments)}function mt(e,t,r){return vt.apply(this,arguments)}function vt(){return(vt=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o,l,u,c,p,f,b,d,y,m,v;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.printTemplate,s=r.view,o={type:"image"},l={format:"png",ignoreBackground:!0,layers:[t],rotation:0},u=a.ssExtent||s.extent.clone(),c=96,p=!0,f=!0,i.exportOptions&&((b=i.exportOptions).dpi>0&&(c=b.dpi),b.width>0&&(p=b.width%2==s.width%2),b.height>0&&(f=b.height%2==s.height%2)),"map-only"!==i.layout||!i.scalePreserved||i.outScale&&i.outScale!==s.scale||96!==c||p&&f||(l.area={x:0,y:0,width:s.width,height:s.height},p||(l.area.width-=1),f||(l.area.height-=1),a.ssExtent)||(d=s.toMap(Object(w.a)(l.area.width,l.area.height)),u.ymin=d.y,u.xmax=d.x,a.ssExtent=u),o.extent=u.clone()._normalize(!0).toJSON(),e.next=8,s.takeScreenshot(l);case 8:return y=e.sent,m=Object(S.i)(y.dataUrl),v=m.data,e.abrupt("return",(o.imageData=v,o));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ht(e,t,r){return Ot.apply(this,arguments)}function Ot(){return(Ot=Object(i.a)(n.a.mark((function e(t,r,a){var i,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.layerView,s=r.printTemplate,a.legendLayers&&a.legendLayers.push({id:t.id}),e.t0=rt,e.t1=t,e.next=6,Lt(i);case 6:return e.t2=e.sent,e.t3=s,e.t4=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jt(e){var t,r={layerType:(t=e.write()).layerType,customParameters:t.customParameters};return Vt(r,e),r}function gt(e,t,r){return xt.apply(this,arguments)}function xt(){return(xt=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.is11xService&&t.serviceUrl&&t.styleUrl)){e.next=5;break}if(i=O.b&&O.b.findCredential(t.styleUrl),s=O.b&&O.b.findCredential(t.serviceUrl),(i||s)&&"2.1.0"===a.cimVersion){e.next=5;break}return o={type:"VectorTileLayer"},e.abrupt("return",(o.styleUrl=Object(S.C)(t.styleUrl),i&&(o.token=i.token),s&&s.token!==o.token&&(o.additionalTokens=[{url:t.serviceUrl,token:s.token}]),o));case 5:return e.abrupt("return",mt(t,r,a));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wt(e){var t={type:"WebTiledLayer",urlTemplate:e.urlTemplate.replace(/\${/g,"{"),credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(t.subDomains=e.subDomains),t}function St(e){var t,r=[];return e.sublayers&&e.sublayers.forEach((function e(t){t.visible&&(t.sublayers?t.sublayers.forEach(e):t.name&&r.unshift(t.name))})),r.length&&(t={type:"wms",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:r,url:Object(S.C)(e.url),version:e.version}),t}function kt(e){var t=e.activeLayer;return{type:"wmts",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:Object(S.C)(e.url)}}function Vt(e,t){if(t.url)if(e.url=Object(S.C)(e.url||t.url),"apiKey"in t&&t.apiKey)e.token=t.apiKey;else if(h.a.apiKey&&Object(Ce.a)(t.url))e.token=h.a.apiKey;else{var r,a;e.token=null==(r=O.b)||null==(a=r.findCredential(t.url))?void 0:a.token}}function Pt(e,t){return Dt.apply(this,arguments)}function Dt(){return(Dt=Object(i.a)(n.a.mark((function e(t,r){var a,i,s,o,l,u,c,p,f,b,d,y,m,v,h;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.canvas||(r.canvas=document.createElement("canvas")),a=1024,r.canvas.width=a,r.canvas.height=a,i=r.canvas.getContext("2d"),!t.path){e.next=20;break}if((u=new Path2D(t.path)).closePath(),i.fillStyle=Array.isArray(t.color)?"rgba(".concat(t.color[0],",").concat(t.color[1],",").concat(t.color[2],",").concat(t.color[3]/255,")"):"rgb(0,0,0)",i.fill(u),c=ve(i)){e.next=10;break}return e.abrupt("return",null);case 10:i.clearRect(0,0,a,a),p=Object(w.b)(t.size)/Math.max(c.width,c.height),i.scale(p,p),b=(f=a/p)/2-c.width/2-c.x,d=f/2-c.height/2-c.y,i.translate(b,d),Array.isArray(t.color)&&i.fill(u),null!=(l=t.outline)&&l.width&&Array.isArray(t.outline.color)&&(y=t.outline,i.lineWidth=Object(w.b)(y.width)/p,i.lineJoin="round",i.strokeStyle="rgba(".concat(y.color[0],",").concat(y.color[1],",").concat(y.color[2],",").concat(y.color[3]/255,")"),i.stroke(u),c.width+=i.lineWidth,c.height+=i.lineWidth),c.width*=p,c.height*=p,m=i.getImageData(a/2-c.width/2,a/2-c.height/2,Math.ceil(c.width),Math.ceil(c.height)),s=m.width,o=m.height,i.canvas.width=s,i.canvas.height=o,i.putImageData(m,0,0),e.next=25;break;case 20:return v="image/svg+xml"===t.contentType?"data:image/svg+xml;base64,"+t.imageData:t.url,e.next=23,Object(j.default)(v,{responseType:"image"});case 23:h=e.sent.data,s=Object(w.b)(t.width),o=Object(w.b)(t.height),i.canvas.width=s,i.canvas.height=o,i.drawImage(h,0,0,i.canvas.width,i.canvas.height);case 25:return e.abrupt("return",{type:"esriPMS",imageData:i.canvas.toDataURL("image/png").substr(22),angle:t.angle,contentType:"image/png",height:p(o),width:p(s),xoffset:t.xoffset,yoffset:t.yoffset});case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function It(e,t){return Mt.apply(this,arguments)}function Mt(){return(Mt=Object(i.a)(n.a.mark((function e(t,r){var a,i,s,o,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("simple"!==(a=t.type)||!Ft(t.symbol)){e.next=7;break}return e.next=4,Pt(t.symbol,r);case 4:t.symbol=e.sent,e.next=35;break;case 7:if("uniqueValue"!==a&&"classBreaks"!==a){e.next=35;break}if(e.t0=Ft(t.defaultSymbol),!e.t0){e.next=13;break}return e.next=12,Pt(t.defaultSymbol,r);case 12:t.defaultSymbol=e.sent;case 13:if(!(i=t["uniqueValue"===a?"uniqueValueInfos":"classBreakInfos"])){e.next=35;break}s=Object(v.a)(i),e.prev=16,s.s();case 18:if((o=s.n()).done){e.next=27;break}if(l=o.value,e.t1=Ft(l.symbol),!e.t1){e.next=25;break}return e.next=24,Pt(l.symbol,r);case 24:l.symbol=e.sent;case 25:e.next=18;break;case 27:e.next=32;break;case 29:e.prev=29,e.t2=e.catch(16),s.e(e.t2);case 32:return e.prev=32,s.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[16,29,32,35]])})))).apply(this,arguments)}function Lt(e){return Gt.apply(this,arguments)}function Gt(){return(Gt=Object(i.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.queryFeatures(t.createQuery()).then((function(e){return e.features})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tt(e){return e.gpMetadata&&e.gpMetadata.executionType?qe.fromJSON(e.gpMetadata.executionType):"sync"}function Ft(e){return e&&(e.path||"image/svg+xml"===e.contentType||e.url&&e.url.endsWith(".svg"))}var Nt=r(340),Rt=new f.a({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),Jt=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(o.a)(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n)))._gpMetadata=null,e.updateDelay=1e3,e}return Object(l.a)(r,[{key:"mode",get:function(){return this._gpMetadata&&this._gpMetadata.executionType?Rt.fromJSON(this._gpMetadata.executionType):"sync"}},{key:"execute",value:function(e,t){return e&&(e.updateDelay=this.updateDelay),function(e,t,r){return Be.apply(this,arguments)}(this.url,e,Object(s.a)(Object(s.a)({},this.requestOptions),t))}},{key:"_getGpPrintParams",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=$e(this.url),a=_e.get(r),e.abrupt("return",Ke(t,a));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(Nt.a);Object(p.a)([Object(b.b)()],Jt.prototype,"_gpMetadata",void 0),Object(p.a)([Object(b.b)({readOnly:!0})],Jt.prototype,"mode",null),Object(p.a)([Object(b.b)()],Jt.prototype,"updateDelay",void 0);var Et=Jt=Object(p.a)([Object(y.a)("esri.tasks.PrintTask")],Jt)},683:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r(135),n=r(70),i={inches:Object(a.b)(1,"meters","inches"),feet:Object(a.b)(1,"meters","feet"),"us-feet":Object(a.b)(1,"meters","us-feet"),yards:Object(a.b)(1,"meters","yards"),miles:Object(a.b)(1,"meters","miles"),"nautical-miles":Object(a.b)(1,"meters","nautical-miles"),millimeters:Object(a.b)(1,"meters","millimeters"),centimeters:Object(a.b)(1,"meters","centimeters"),decimeters:Object(a.b)(1,"meters","decimeters"),meters:Object(a.b)(1,"meters","meters"),kilometers:Object(a.b)(1,"meters","kilometers"),"decimal-degrees":1/Object(a.i)(1,"meters",n.a.radius)}},694:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));r(19);function a(e){}},704:function(e,t,r){"use strict";function a(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function n(e){return null!=e&&!isNaN(e)&&isFinite(e)}function i(e){return e.valueExpression?"expression":e.field&&"string"==typeof e.field?"field":"unknown"}function s(e,t){var r=t||i(e),a=e.valueUnit||"unknown";return"unknown"===r?"constant":e.stops?"stops":null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?"clamped-linear":"unknown"===a?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?"proportional":"additive":"identity":"real-world-size"}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return n}))},751:function(e,t,r){"use strict";r.d(t,"a",(function(){return S})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return x})),r.d(t,"g",(function(){return y}));var a=r(21),n=r(22),i=r(46),s=r(210),o=r(694),l=r(15),u=r(11),c=r(683),p=r(704),f=l.a.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),b=new s.a,d=Math.PI,y=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function m(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"color"===e.type}))[0]:e;if(a)if("esri.renderers.visualVariables.ColorVariable"===a.declaredClass){var n="number"==typeof t,s=n?null:t,o=s&&s.attributes,l=n?t:null,c=a.field,p=a.cache,b=p.ipData,d=p.hasExpression,y=a.cache.compiledFunc;if(!c&&!d){var m=a.stops;return m&&m[0]&&m[0].color}if("number"!=typeof l)if(d){if(!Object(u.j)(r)||!Object(u.j)(r.arcade))return void f.error("Use of arcade expressions requires an arcade context");var v={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},h=r.arcade.arcadeUtils,O=h.getViewInfo(v),j=h.createExecContext(s,O);if(!y){var g=h.createSyntaxTree(a.valueExpression);y=h.createFunction(g),a.cache.compiledFunc=y}l=h.executeFunction(y,j)}else o&&(l=o[c]);var x=a.normalizationField,S=o?parseFloat(o[x]):void 0;if(null!=l&&(!x||n||!isNaN(S)&&0!==S)){isNaN(S)||n||(l/=S);var k=w(l,b);if(k){var V=k[0],P=k[1],D=V===P?a.stops[V].color:i.a.blendColors(a.stops[V].color,a.stops[P].color,k[2],Object(u.j)(r)?r.color:void 0);return new i.a(D)}}}else f.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable")}function v(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"opacity"===e.type}))[0]:e;if(a)if("esri.renderers.visualVariables.OpacityVariable"===a.declaredClass){var n="number"==typeof t,i=n?null:t,s=i&&i.attributes,o=n?t:null,l=a.field,c=a.cache,p=c.ipData,b=c.hasExpression,d=a.cache.compiledFunc;if(!l&&!b){var y=a.stops;return y&&y[0]&&y[0].opacity}if("number"!=typeof o)if(b){if(Object(u.i)(r)||Object(u.i)(r.arcade))return void f.error("Use of arcade expressions requires an arcade context");var m={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,h=v.getViewInfo(m),O=v.createExecContext(i,h);if(!d){var j=v.createSyntaxTree(a.valueExpression);d=v.createFunction(j),a.cache.compiledFunc=d}o=v.executeFunction(d,O)}else s&&(o=s[l]);var g=a.normalizationField,x=s?parseFloat(s[g]):void 0;if(null!=o&&(!g||n||!isNaN(x)&&0!==x)){isNaN(x)||n||(o/=x);var S=w(o,p);if(S){var k=S[0],V=S[1];if(k===V)return a.stops[k].opacity;var P=a.stops[k].opacity;return P+(a.stops[V].opacity-P)*S[2]}}}else f.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable")}function h(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"rotation"===e.type}))[0]:e;if(a){if("esri.renderers.visualVariables.RotationVariable"===a.declaredClass){var n=a.axis||"heading",i="heading"===n&&"arithmetic"===a.rotationType?90:0,s="heading"===n&&"arithmetic"===a.rotationType?-1:1,o="number"==typeof t?null:t,l=o&&o.attributes,c=a.field,p=a.cache.hasExpression,b=a.cache.compiledFunc,d=0;if(!c&&!p)return d;if(p){if(Object(u.i)(r)||Object(u.i)(r.arcade))return void f.error("Use of arcade expressions requires an arcade context");var y={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},m=r.arcade.arcadeUtils,v=m.getViewInfo(y),h=m.createExecContext(o,v);if(!b){var O=m.createSyntaxTree(a.valueExpression);b=m.createFunction(O),a.cache.compiledFunc=b}d=m.executeFunction(b,h)}else l&&(d=l[c]||0);return d="number"!=typeof d||isNaN(d)?null:i+s*d}f.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable")}}function O(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"size"===e.type}))[0]:e;if(a){if("esri.renderers.visualVariables.SizeVariable"===a.declaredClass){var i=function(e,t,r,a,i){switch(t.transformationType){case"additive":return function(e,t,r,a){return e+(j(t.minSize,r,a)||t.minDataValue)}(e,t,r,a);case"constant":return function(e,t,r){var a=e.stops,n=a&&a.length&&a[0].size;return null==n&&(n=e.minSize),j(n,t,r)}(t,r,a);case"clamped-linear":return function(e,t,r,a){var n=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),i=j(t.minSize,r,a),s=j(t.maxSize,r,a),o=Object(u.j)(a)?a.shape:void 0;if(e<=t.minDataValue)return i;if(e>=t.maxDataValue)return s;if("area"===t.scaleBy&&o){var l="circle"===o,c=l?d*Math.pow(i/2,2):i*i,p=c+n*((l?d*Math.pow(s/2,2):s*s)-c);return l?2*Math.sqrt(p/d):Math.sqrt(p)}return i+n*(s-i)}(e,t,r,a);case"proportional":return function(e,t,r,a){var n=Object(u.j)(a)?a.shape:void 0,i=e/t.minDataValue,s=j(t.minSize,r,a),o=j(t.maxSize,r,a);return g("circle"===n?2*Math.sqrt(i*Math.pow(s/2,2)):"square"===n||"diamond"===n||"image"===n?Math.sqrt(i*Math.pow(s,2)):i*s,s,o)}(e,t,r,a);case"stops":return function(e,t,r,a,i){var s=w(e,i),o=Object(n.a)(s,3),l=o[0],u=o[1],c=o[2];if(l===u)return j(t.stops[l].size,r,a);var p=j(t.stops[l].size,r,a);return p+(j(t.stops[u].size,r,a)-p)*c}(e,t,r,a,i);case"real-world-size":return function(e,t,r,a){var n=(Object(u.j)(a)&&a.resolution?a.resolution:1)*c.a[t.valueUnit],i=j(t.minSize,r,a),s=j(t.maxSize,r,a),o=t.valueRepresentation;return g("area"===o?2*Math.sqrt(e/d)/n:"radius"===o||"distance"===o?2*e/n:e/n,i,s)}(e,t,r,a);case"identity":return e;case"unknown":return null}}(function(e,t,r){var a="number"==typeof t,n=a?null:t,i=n&&n.attributes,s=a?t:null,o=e.cache.isScaleDriven,l=e.cache.compiledFunc;if(o){var c=Object(u.j)(r)?r.scale:void 0,b=Object(u.j)(r)?r.view:void 0;s=null==c||"3d"===b?function(e){var t=null,r=null,a=e.stops;return a?(t=a[0].value,r=a[a.length-1].value):(t=e.minDataValue||0,r=e.maxDataValue||0),(t+r)/2}(e):c}else if(!a)switch(e.inputValueType){case"expression":if(Object(u.i)(r)||Object(u.i)(r.arcade))return void f.error("Use of arcade expressions requires an arcade context");var d={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},y=r.arcade.arcadeUtils,m=y.getViewInfo(d),v=y.createExecContext(n,m);if(!l){var h=y.createSyntaxTree(e.valueExpression);l=y.createFunction(h),e.cache.compiledFunc=l}s=y.executeFunction(l,v);break;case"field":i&&(s=i[e.field]);break;case"unknown":s=null}if(!Object(p.d)(s))return null;if(a||!e.normalizationField)return s;var O=i?parseFloat(i[e.normalizationField]):null;return Object(p.d)(O)&&0!==O?s/O:null}(a,t,r),a,t,r,a.cache.ipData);return null==i||isNaN(i)?0:i}f.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable")}}function j(e,t,r){return null==e?null:Object(p.c)(e)?O(e,t,r):Object(p.d)(e)?e:null}function g(e,t,r){return Object(p.d)(r)&&e>r?r:Object(p.d)(t)&&e<t?t:e}function x(e,t,r){if(!(e.cache.isScaleDriven&&"3d"===r||t))return null;var a={scale:t,view:r},n=j(e.minSize,b,a),i=j(e.maxSize,b,a);if(null!=n||null!=i){if(n>i){var s=i;i=n,n=s}return{minSize:n,maxSize:i}}}function w(e,t){if(t){var r=0,a=t.length-1;return t.some((function(t,n){return e<t?(a=n,!0):(r=n,!1)})),[r,a,(e-t[r])/(t[a]-t[r])]}}function S(e,t,r){var n,i=["proportional","proportional","proportional"],s=Object(a.a)(e);try{for(s.s();!(n=s.n()).done;){var l=n.value,u=l.useSymbolValue?"symbol-value":O(l,t,r);switch(l.axis){case"width":i[0]=u;break;case"depth":i[1]=u;break;case"height":i[2]=u;break;case"width-and-depth":i[0]=u,i[1]=u;break;case"all":case void 0:case null:i[0]=u,i[1]=u,i[2]=u;break;default:Object(o.a)(l.axis)}}}catch(c){s.e(c)}finally{s.f()}return i}},832:function(e,t,r){"use strict";function a(e){var t,r=e.layer;return"floorInfo"in r&&null!=(t=r.floorInfo)&&t.floorField&&"floors"in e.view?s(e.view.floors,r.floorInfo.floorField):null}function n(e,t){var r;return"floorInfo"in t&&null!=(r=t.floorInfo)&&r.floorField?s(e,t.floorInfo.floorField):null}function i(e,t){var r=t.definitionExpression;return e?r?"(".concat(r,") AND (").concat(e,")"):e:r}function s(e,t){if(null==e||!e.length)return null;var r=e.filter((function(e){return""!==e})).map((function(e){return"'".concat(e,"'")}));return r.push("''"),"".concat(t," IN (").concat(r.join(","),") OR ").concat(t," IS NULL")}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return n}))}}]);
//# sourceMappingURL=76.21b679c3.chunk.js.map