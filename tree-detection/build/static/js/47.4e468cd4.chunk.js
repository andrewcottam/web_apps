(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[47,4,7,115],{1008:function(e,t,r){"use strict";r.d(t,"a",(function(){return N})),r.d(t,"b",(function(){return G})),r.d(t,"c",(function(){return U})),r.d(t,"d",(function(){return B})),r.d(t,"e",(function(){return K}));var n=r(23),a=r(13),i=r(46),o=(r(870),r(11)),s=(r(135),r(666)),l=r(785),u=r(1007),c=(r(890),r(816)),f=r(980),h=(r(924),r(2)),p=r(4),d=r(5),m=r(6),v=r(0),b=r(42),g=r(1),y=(r(19),r(14),r(15),r(10)),w=r(26),O=r(844),j=r(72),x=new b.a({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"}),I=function(e){Object(d.a)(r,e);var t=Object(m.a)(r);function r(){var e;return Object(h.a)(this,r),(e=t.apply(this,arguments)).baseSymbol=null,e.colorRamp=null,e.type=null,e}return r}(w.a);Object(v.a)([Object(g.b)({type:j.a,json:{write:!0}})],I.prototype,"baseSymbol",void 0),Object(v.a)([Object(g.b)({types:O.b,json:{read:{reader:O.a},write:!0}})],I.prototype,"colorRamp",void 0),Object(v.a)([Object(g.b)({json:{read:x.read,write:x.write}})],I.prototype,"type",void 0);var k=I=Object(v.a)([Object(y.a)("esri.rest.support.ClassificationDefinition")],I),M=new b.a({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),S=new b.a({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),T=function(e){Object(d.a)(r,e);var t=Object(m.a)(r);function r(){var e;return Object(h.a)(this,r),(e=t.apply(this,arguments)).breakCount=null,e.classificationField=null,e.classificationMethod=null,e.normalizationField=null,e.normalizationType=null,e.type="class-breaks-definition",e}return Object(p.a)(r,[{key:"standardDeviationInterval",set:function(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}},{key:"definedInterval",set:function(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}}]),r}(k);Object(v.a)([Object(g.b)({json:{write:!0}})],T.prototype,"breakCount",void 0),Object(v.a)([Object(g.b)({json:{write:!0}})],T.prototype,"classificationField",void 0),Object(v.a)([Object(g.b)({type:String,json:{read:M.read,write:M.write}})],T.prototype,"classificationMethod",void 0),Object(v.a)([Object(g.b)({json:{write:!0}})],T.prototype,"normalizationField",void 0),Object(v.a)([Object(g.b)({json:{read:S.read,write:S.write}})],T.prototype,"normalizationType",void 0),Object(v.a)([Object(g.b)({value:null,json:{write:!0}})],T.prototype,"standardDeviationInterval",null),Object(v.a)([Object(g.b)({value:null,json:{write:!0}})],T.prototype,"definedInterval",null),Object(v.a)([Object(g.b)()],T.prototype,"type",void 0);T=Object(v.a)([Object(y.a)("esri.rest.support.ClassBreaksDefinition")],T);var C=r(978),A=r(826),_=r(701),P=r(830),D=(r(825),r(700),r(829)),R=C.a.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),E=C.a.fromJSON(c.a[0]),L=new Set(["scientific","standard-time","vector-uv","vector-magdir","vector-u","vector-v","vector-magnitude","vector-direction"]);function N(e,t){var r=e.attributeTable,a=e.colormap;if(q(e)){var s=function(e){if(!q(e))return null;var t;if(Object(o.j)(e.statistics)&&e.statistics.length){var r="vector-uv"===e.dataType,a=e.statistics[0],i=a.min,s=a.max;t=[{type:"size",field:"Magnitude",minSize:10,maxSize:40,minDataValue:r?Math.min(Math.abs(i),Math.abs(s)):i,maxDataValue:r?Math.max(Math.abs(i),Math.abs(s)):s}]}var l=Object(o.j)(e.multidimensionalInfo)?X.get(e.multidimensionalInfo.variables[0].unit):null,u=new D.a({visualVariables:t,inputUnit:l});return u.visualVariables=[].concat(Object(n.a)(u.sizeVariables),Object(n.a)(u.rotationVariables)),u}(e);if(Object(o.j)(s))return s}if(Object(o.j)(a)){var l=function(e){if(!J(e))return null;var t,r=e.attributeTable,n=e.colormap;if(Object(o.j)(r)){var a=H(r,"value"),i=F(r);"string"===i.type&&(t={},r.features.forEach((function(e){var r=e.attributes;t[r[a.name]]=i?r[i.name]:r[a.name]})))}return P.a.createFromColormap(Object(o.q)(n),t)}(e);if(Object(o.j)(l))return l}if(Object(o.j)(r)){var h=function(e,t,r,n){if(!V(e,t))return null;var a=e.attributeTable,s=e.statistics,l=F(a,t),h=H(a,"red"),p=H(a,"green"),d=H(a,"blue"),m=new u.a,v=[],b=new Set,g=!!(h&&p&&d);if(Object(o.j)(a))a.features.forEach((function(e){var t=e.attributes[l.name];if(!b.has(e.attributes[l.name])&&null!=t){b.add(t);var r=g&&("single"===h.type||"double"===h.type)&&("single"===p.type||"double"===p.type)&&("single"===d.type||"double"===d.type)&&!a.features.some((function(e){return e.attributes[h.name]>1||e.attributes[p.name]>1||e.attributes[d.name]>1})),n=r?255:1;v.push(new f.a({value:e.attributes[l.name],label:e.attributes[l.name]+"",symbol:{type:"simple-fill",style:"solid",outline:null,color:new i.a(g?[e.attributes[h.name]*n,e.attributes[p.name]*n,e.attributes[d.name]*n,1]:[0,0,0,0])}}))}}));else if(null!=s&&s[0])for(var y=s[0].min;y<=s[0].max;y++)v.push(new f.a({value:y,label:y.toString(),symbol:{type:"simple-fill",style:"solid",outline:null,color:new i.a([0,0,0,0])}}));if(v.sort((function(e,t){return e.value&&"string"==typeof e.value.valueOf()?0:e.value>t.value?1:-1})),!g){var w=Object(c.b)(E,v.length);v.forEach((function(e,t){return e.symbol.color=new i.a(w[t].slice(1,4))})),m.colorRamp=E}if(r||n){var O=r||Object(c.b)(n,v.length).map((function(e){return e.slice(1)}));v.forEach((function(e,t){return e.symbol.color=new i.a(O[t])})),m.colorRamp=n}return new _.a({field:l.name,uniqueValueInfos:v,authoringInfo:m})}(e);if(Object(o.j)(h))return h}return function(e,t){var r,n,a,i,s=(e=z(e,null==t?void 0:t.variableName)).bandCount,l=t||{},u=l.bandIds,c=l.stretchType;null!=(r=u)&&r.some((function(e){return e>=s}))&&(u=null);var f,h=Object(o.q)(e.statistics),p=Object(o.q)(e.histograms);s>1?(u=null!=(f=u)&&f.length?u:G(e),h=null==h?null:u.map((function(e){return h[e]})),p=null==p?null:u.map((function(e){return p[e]}))):u=[0],null==c&&(c=function(e){var t="percent-clip",r=e.pixelType,n=e.dataType,a=e.histograms,i=e.statistics;return"u8"!==r||"processed"!==n&&Object(o.j)(a)&&Object(o.j)(i)?"u8"===r||"elevation"===n||L.has(n)?t="min-max":Object(o.j)(a)?t="percent-clip":Object(o.j)(i)&&(t="min-max",t="min-max"):t="none",t}(e));var d=!1;switch(c){case"none":d=!1;break;case"percent-clip":d=!(null!=(n=p)&&n.length);break;default:d=!(null!=(a=h)&&a.length)}var m=e.dataType,v=1===(null==(i=u)?void 0:i.length)&&L.has(m)?R:null,b=new A.a({stretchType:c,dynamicRangeAdjustment:d,colorRamp:v,outputMin:0,outputMax:255,gamma:1===u.length?[1]:[1,1,1],useGamma:!1});return"percent-clip"===c?b.maxPercent=b.minPercent=.25:"standard-deviation"===c&&(b.numberOfStandardDeviations=2),!d&&(Object(o.j)(e.multidimensionalInfo)||null!=t&&t.includeStatisticsInStretch)&&("percent-clip"===c?b.histograms=p:"min-max"!==c&&"standard-deviation"!==c||(b.statistics=h)),b}(e,t)}function B(e){var t=["raster-stretch"];return J(e)&&t.push("raster-colormap"),V(e)&&t.push("unique-value"),W(e)&&t.push("class-breaks"),Z(e)&&t.push("raster-shaded-relief"),q(e)&&t.push("vector-field"),t}function U(e,t,r){var n=["nearest","bilinear","cubic","majority"].find((function(e){return e===(null==r?void 0:r.toLowerCase())}));return"Map"===t?null!=n?n:"bilinear":"standard-time"===e.dataType?null!=n?n:"nearest":"thematic"===e.dataType||e.attributeTable||e.colormap?"nearest"===n||"majority"===n?n:"nearest":null!=n?n:"bilinear"}function z(e,t){if(null==t)return e;var r=Object(o.q)(e.statistics),n=Object(o.q)(e.histograms),i=e.multidimensionalInfo;if(t&&Object(o.j)(i)){var s=i.variables.find((function(e){return e.name===t})),u=s.statistics,c=s.histograms;null!=u&&u.length&&(r=u),null!=c&&c.length&&(n=c)}return l.a.fromJSON(Object(a.a)(Object(a.a)({},e.toJSON()),{},{statistics:r,histograms:n}))}function G(e){var t=e.bandCount;if(1===t)return null;if(2===t)return[0];var r,n=e.keyProperties&&e.keyProperties.BandProperties;if(n&&n.length===t){var a=function(e){for(var t={},r=0;r<e.length;r++){var n,a=e[r],i=null==(n=a.BandName)?void 0:n.toLowerCase();if("red"===i)t.red=r;else if("green"===i)t.green=r;else if("blue"===i)t.blue=r;else if("nearinfrared"===i||"nearinfrared_1"===i||"nir"===i)t.nir=r;else if(a.WavelengthMax&&a.WavelengthMin){var o=a.WavelengthMin,s=a.WavelengthMax;null==t.blue&&o>=410&&o<=480&&s>=480&&s<=540?t.blue=r:null==t.green&&o>=490&&o<=560&&s>=560&&s<=610?t.green=r:null==t.red&&o>=595&&o<=670&&s>=660&&s<=730?t.red=r:null==t.nir&&o>=700&&o<=860&&s>=800&&s<=950&&(t.nir=r)}}return t}(n),i=a.red,o=a.green,s=a.blue,l=a.nir;null!=i&&null!=o&&null!=s?r=[i,o,s]:null!=l&&null!=i&&null!=o&&(r=[l,i,o])}return!r&&t>=3&&(r=[0,1,2]),r}function F(e,t){var r;return Object(o.j)(e)?(r=t?e.fields.find((function(e){return t.toLowerCase()===e.name.toLowerCase()})):e.fields.find((function(e){return"string"===e.type&&e.name.toLowerCase().indexOf("class")>-1})),r||((r=e.fields.find((function(e){return"string"===e.type})))||(r=H(e,"value")))):r=new s.a({name:"value"}),r}function H(e,t){return Object(o.j)(e)?e.fields.find((function(e){return e.name.toLowerCase()===t})):null}function V(e,t){var r=e.attributeTable,n=e.bandCount;return!(Object(o.j)(r)||!function(e){var t,r,n;return["u8","s8"].indexOf(e.pixelType)>-1&&null!=(null==(t=e.statistics)||null==(r=t[0])?void 0:r.min)&&null!=(null==(n=e.statistics[0])?void 0:n.max)&&1===e.bandCount}(e))||!(!Object(o.j)(r)||n>1)&&(!t||null!=r.fields.find((function(e){return e.name.toLowerCase()===t.toLowerCase()})))}function J(e){var t=e.bandCount,r=e.colormap;return Object(o.j)(r)&&r.length&&1===t}function Z(e){return"elevation"===e.dataType}function W(e){var t=e.attributeTable;return 1===e.bandCount&&(Object(o.j)(t)||Object(o.j)(e.histograms))}function q(e){var t=e.dataType;return"vector-uv"===t||"vector-magdir"===t}var X=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);function Y(e){var t;return{color:null==(t=e.symbolLayers[0].material)?void 0:t.color,type:"esriSFS",style:"esriSFSSolid"}}function K(e){if("uniqueValue"===e.type){var t,r=e.uniqueValueInfos,n=r[0].symbol;return null!=n&&null!=(t=n.symbolLayers)&&t.length&&(e.uniqueValueInfos=r.map((function(e){return{value:e.value,label:e.label,symbol:e.symbol?Y(e.symbol):null}}))),e}if("classBreaks"===e.type){var a,i=e.classBreakInfos,o=i[0].symbol;return null!=o&&null!=(a=o.symbolLayers)&&a.length&&(e.classBreakInfos=i.map((function(e){return{classMinValue:e.classMinValue,classMaxValue:e.classMaxValue,label:e.label,symbol:e.symbol?Y(e.symbol):null}}))),e}return e}},1047:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return Et}));var n=r(7),a=r.n(n),i=r(12),o=r(13),s=r(2),l=r(4),u=r(77),c=r(65),f=r(5),h=r(6),p=r(0),d=r(214),m=r(870),v=r(29),b=r(11),g=r(677),y=r(30),w=r(1),O=(r(19),r(14)),j=r(15),x=r(31),I=r(57),k=r(10),M=r(682),S=r(730),T=r(721),C=(r(114),r(82)),A=r(61),_=r(53),P=r(676),D=r(671),R=r(937),E=r(994),L=r(743),N=r(837),B=r(1008),U=r(910),z=r(58),G=r(45),F=j.a.getLogger("esri.layers.mixins.ImageryTileMixin"),H=r(709),V=r(699),J=r(697),Z=r(716),W=r(666),q=r(901),X=r(785),Y=r(815),K=r(22),Q=r(23),$=r(26),ee=r(242),te=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;Object(s.a)(this,e),this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=t,this._interval=Math.min(t,r)}return Object(l.a)(e,[{key:"decreaseRefCount",value:function(e,t){var r=e+"/"+t,n=this._cachedBlocks;if(n.has(r)){var a=n.get(r);return a.refCount--,a.refCount<=0&&(n.delete(r),a.controller&&a.controller.abort()),a.refCount}return 0}},{key:"getBlock",value:function(e,t){var r=e+"/"+t,n=this._cachedBlocks;if(n.has(r)){var a=n.get(r);return a.ts=Date.now(),a.refCount++,n.delete(r),n.set(r,a),a.block}return null}},{key:"putBlock",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=this._cachedBlocks,i=e+"/"+t;if(a.has(i)){var o=a.get(i);o.ts=Date.now(),o.refCount++}else a.set(i,{block:r,ts:Date.now(),refCount:1,controller:n});this.trim(),this.updateTimer()}},{key:"deleteBlock",value:function(e,t){var r=this._cachedBlocks,n=e+"/"+t;r.has(n)&&r.delete(n)}},{key:"updateMaxSize",value:function(e){this._size=e,this.trim()}},{key:"empty",value:function(){this._cachedBlocks.clear(),this.clearTimer()}},{key:"getCurrentSize",value:function(){return this._cachedBlocks.size}},{key:"updateTimer",value:function(){var e=this;if(null==this._timer){var t=this._cachedBlocks;this._timer=setInterval((function(){for(var r=Array.from(t),n=Date.now(),a=0;a<r.length&&r[a][1].ts<=n-e._duration;a++)t.delete(r[a][0]);0===t.size&&e.clearTimer()}),this._interval)}}},{key:"trim",value:function(){var e=this._cachedBlocks;if(!(-1===this._size||this._size>=e.size))for(var t=Array.from(e),r=0;r<t.length-this._size;r++)e.delete(t[r][0])}},{key:"clearTimer",value:function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}}]),e}(),re=r(135),ne=r(750),ae=r(71),ie=r(48),oe=5e-4,se=function(e,t){var r=(e.isWGS84||e.isWebMercator)&&(t.isWGS84||t.isWebMercator);return!(e.equals(t)||r)},le=function(e,t){var r=(e[0]+e[4]+e[4*t.cols]+e[4*t.cols+4])/4,n=(e[1]+e[5]+e[4*t.rows+1]+e[4*t.rows+5])/4;return[Math.abs(r-e[2*t.rows+2]),Math.abs(n-e[2*t.rows+3])]},ue={3395:20037508.342789244,3410:17334193.943686873,3832:3339584.723798206,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,8858:7396237.374497803,8859:2465412.4581659334,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53025:7276828.3848298555,53031:10384677.558821043,53034:20015086.79602057,53036:7389443.187332862,53037:2463147.729110953,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54025:7311399.09166516,54031:10396310.810074743,54034:20037508.342789244,54050:808820.9223376509,54053:1920897.3915568967,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244,102038:4297258.582585486,102299:5013965.117483125};function ce(){return fe.apply(this,arguments)}function fe(){return(fe=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(ne.e)()&&Object(ne.f)()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,Object(ne.g)();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e.spatialReference.equals(t))return e;var a=se(e.spatialReference,t);if(a&&!Object(ne.e)())throw new v.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");var i=r.center,o=new z.a({xmin:i.x-e.x/2,xmax:i.x+e.x/2,ymin:i.y-e.y/2,ymax:i.y+e.y/2,spatialReference:e.spatialReference}),s=a?Object(ne.h)(o,t,n):Object(ae.d)(o,t);return Object(b.i)(s)?null:{x:s.xmax-s.xmin,y:s.ymax-s.ymin}}function pe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01;return Object(re.d)(e)?t/Object(re.d)(e):0}function de(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=e.spatialReference;if(a.equals(t))return e;var i=Object(ae.d)(e,t);if(Object(b.i)(i)){if(!Object(ne.e)())throw new v.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");i=Object(ne.h)(e,t,r)}if(n&&t.isGeographic){var o=ye(a,!0),s=Object(K.a)(o,2),l=s[0],u=s[1],c=pe(a);c&&null!=l&&null!=u&&(Math.abs(e.x-l)<c&&Math.abs(180-i.x)<oe?i.x-=360:Math.abs(e.x-u)<c&&Math.abs(180+i.x)<oe&&(i.x+=360))}return i}function me(e){var t=ge(e[0].spatialReference);if(e.length<2||!Object(b.j)(t))return e[0];for(var r=e[0],n=r.xmin,a=r.xmax,i=r.ymin,o=r.ymax,s=1;s<e.length;s++){var l=e[s];a=l.xmax+t*s,i=Math.min(i,l.ymin),o=Math.max(o,l.ymax)}return new z.a({xmin:n,xmax:a,ymin:i,ymax:o,spatialReference:e[0].spatialReference})}function ve(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e.spatialReference.equals(t))return e;var a=Oe(e),i=ge(e.spatialReference,!0);return Object(b.j)(i)&&0!==a?me(e.clone().normalize().map((function(e){return be(e,t,r,n)}))):be(e,t,r,n)}function be(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=e.spatialReference;if(a.equals(t))return e;if(se(a,t)&&!Object(ne.e)())throw new v.a("rasterprojectionhelper-projectExtent","projection engine is not loaded");var i=Object(ae.d)(e,t);Object(b.i)(i)&&(i=Object(ne.h)(e,t,r));var o=ye(a,!0),s=Object(K.a)(o,2),l=s[0],u=s[1];if(i&&n&&a.isWebMercator&&t.isGeographic&&null!=l&&null!=u){var c=.001,f=1e3;if(Math.abs(e.xmin-l)<c&&Math.abs(u-e.xmax)>f&&Math.abs(180-i.xmax)<oe){i.xmin=-180;var h=[];h.push(new ie.a(e.xmax,e.ymin,a)),h.push(new ie.a(e.xmax,(e.ymin+e.ymax)/2,a)),h.push(new ie.a(e.xmax,e.ymax,a));var p=h.map((function(e){return de(e,t,r)})).filter((function(e){return!isNaN(null==e?void 0:e.x)})).map((function(e){return e.x}));i.xmax=Math.max.apply(null,p)}if(Math.abs(e.xmax-u)<c&&Math.abs(l-e.xmin)>f&&Math.abs(180+i.xmin)<oe){i.xmax=180;var d=[];d.push(new ie.a(e.xmin,e.ymin,a)),d.push(new ie.a(e.xmin,(e.ymin+e.ymax)/2,a)),d.push(new ie.a(e.xmin,e.ymax,a));var m=d.map((function(e){return de(e,t,r)})).filter((function(e){return!isNaN(null==e?void 0:e.x)})).map((function(e){return e.x}));i.xmin=Math.min.apply(null,m)}}var g=ye(t,!0),y=Object(K.a)(g,2);l=y[0],u=y[1];var w=pe(t);return w&&null!=l&&null!=u&&(Math.abs(i.xmin-l)<w&&(i.xmin=l),Math.abs(i.xmax-u)<w&&(i.xmax=u)),i}function ge(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*r:e.wkid&&e.isGeographic?360:2*ue[e.wkid]||null}function ye(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=ge(e,t);return Object(b.j)(n)&&(r.push(-n/2),r.push(n/2)),r}function we(e,t,r,n){var a=(e-t)/r;return a-Math.floor(a)!=0?a=Math.floor(a):n&&(a-=1),a}function Oe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=ge(e.spatialReference);if(!Object(b.j)(r))return 0;var n=t?0:-r/2;return we(e.xmax,n,r,!0)-we(e.xmin,n,r,!1)}function je(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[32,32];if(se(e.spatialReference,t.spatialReference)&&!Object(ne.e)())throw new v.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");if(!(e&&t&&r))return null;var s=e.xmin,l=e.ymin,u=e.xmax,c=e.ymax,f=e.spatialReference,h=t.spatialReference,p=ge(h);i=i||"gcs-shift"===(null==a?void 0:a.type);for(var d,m={x:o[0]*r.x,y:o[1]*r.y},g={cols:Math.ceil((u-s)/m.x-.1/o[0])+1,rows:Math.ceil((c-l)/m.y-.1/o[1])+1},y=m.x,w=m.y,O=[],j=!1,x=0;x<g.cols;x++){for(var I=[],k=0;k<g.rows;k++){var M=de(new ie.a({x:s+y*x,y:c-w*k,spatialReference:f}),h,n);a&&(M=a.inverseTransform(M)),I.push(M),x>0&&i&&M&&d[k]&&Object(b.j)(p)&&M.x<d[k].x&&(M.x+=p),M?(O.push((M.x-t.xmin)/(t.xmax-t.xmin)),O.push((t.ymax-M.y)/(t.ymax-t.ymin))):(O.push(NaN),O.push(NaN),j=!0)}d=I}for(var S=le(O,g),T=new Float32Array((g.cols-1)*(g.rows-1)*2*6),C=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),A=new Float32Array([-1,1,0,0,-1,1,1,0,0]),_=0;_<g.cols-1;_++){for(var P=0;P<g.rows-1;P++){for(var D=_*g.rows*2+2*P,R=O[D],E=O[D+1],L=O[D+2],N=O[D+3],B=O[D+=2*g.rows],U=O[D+1],z=O[D+2],G=O[D+3],F=0,H=12*(P*(g.cols-1)+_),V=0;V<3;V++)T[H++]=C[F++]*R+C[F++]*L+C[F++]*z;F=0;for(var J=0;J<3;J++)T[H++]=C[F++]*E+C[F++]*N+C[F++]*G;F=0;for(var Z=0;Z<3;Z++)T[H++]=A[F++]*R+A[F++]*B+A[F++]*z;F=0;for(var W=0;W<3;W++)T[H++]=A[F++]*E+A[F++]*U+A[F++]*G}if(j)for(var q=0;q<T.length;q++)isNaN(T[q])&&(T[q]=-1)}return{offsets:O,error:S,coefficients:T,spacing:o,size:[g.cols-1,g.rows-1]}}function xe(e){var t=e.clone().normalize();return 1===t.length?t[0]:me(t)}function Ie(e,t,r){var n,a=t.storageInfo,i=t.pixelSize,o=!1,s=a.pyramidResolutions;if(Object(b.j)(s)&&s.length){var l=(e.x+e.y)/2,u=s[s.length-1],c=(u.x+u.y)/2,f=(i.x+i.y)/2;if(l<=f)n=0;else if(l>=c)n=s.length,o=l/c>8;else for(var h,p=f,d=1;d<=s.length;d++){if(l<=(h=(s[d-1].x+s[d-1].y)/2)){l===h?n=d:"down"===r?(n=d-1,o=l/p>8):n="up"===r||l-p>h-l||l/p>2?d:d-1;break}p=h}var m=0===n?i:s[n-1];return{pyramidLevel:n,pyramidResolution:new ie.a({x:m.x,y:m.y,spatialReference:t.spatialReference}),excessiveReading:o}}var v=Math.log(e.x/i.x)/Math.LN2,g=Math.log(e.y/i.y)/Math.LN2,y=t.storageInfo.maximumPyramidLevel||0;(n="down"===r?Math.floor(Math.min(v,g)):"up"===r?Math.ceil(Math.max(v,g)):Math.round((v+g)/2))<0?n=0:n>y&&(o=n>y+3,n=y);var w=Math.pow(2,n);return{pyramidLevel:n,pyramidResolution:new ie.a({x:w*t.nativePixelSize.x,y:w*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:o}}var ke=new Map,Me=new te;function Se(e,t){return null==t?e:"".concat(e,"?sliceId=").concat(t)}function Te(e,t,r){if(!ke.has(e))return null==t?Me.getBlock(e,r):null;var n=ke.get(e);if(null==n[t]){for(var a=0;a<n.length;a++)if(n[a]&&n[a].cache.has(r)){var i=n[a].cache.get(r);return i.refCount++,i.block}return Me.getBlock(e,r)}var o=n[t].cache;if(o.has(r)){var s=o.get(r);return s.refCount++,s.block}for(var l=0;l<n.length;l++)if(l!==t&&n[l]&&n[l]&&n[l].cache.has(r)){var u=n[l].cache.get(r);return u.refCount++,o.set(r,u),u.block}return null}function Ce(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(ke.has(e)){var i=ke.get(e);if(null!=i[t]){var o={refCount:1,block:n,isResolved:!1,isRejected:!1,controller:a};n.then((function(){return o.isResolved=!0})).catch((function(){return o.isRejected=!0})),i[t].cache.set(r,o)}else Me.putBlock(e,r,n,a)}else null==t&&Me.putBlock(e,r,n,a)}var Ae=r(878),_e=r(764),Pe=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).rasterJobHandler=null,e.datasetName=null,e.datasetFormat=null,e.rasterInfo=null,e.ioConfig={sampling:"closest"},e}return Object(l.a)(r,[{key:"init",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ce(),this.addResolvingPromise(t),e.next=4,this.when();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"normalizeCtorArgs",value:function(e){return e&&e.ioConfig&&(e=Object(o.a)(Object(o.a)({},e),{},{ioConfig:Object(o.a)({resolution:null,bandIds:null,sampling:"closest",tileInfo:L.a.create()},e.ioConfig)})),e}},{key:"url",set:function(e){this._set("url",Object(P.g)(e,j.a.getLogger(this.declaredClass)))}},{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.a("BaseRaster:open-not-implemented","open() is not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchTile",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n){var i,o,s,l,u=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>3&&void 0!==u[3]?u[3]:{},o=i.tileInfo,s=o.lodAt(t),l=this.getTileExtent({x:s.resolution,y:s.resolution},r,n,o.origin,o.spatialReference,o.size),e.abrupt("return",(i=this._getRequestOptionsWithSliceId(i),this.fetchPixels(l,o.size[0],o.size[1],i)));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"identify",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l,u,c,f,h,p,d,m,v,g,y,w,O,j,x,I=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=I.length>1&&void 0!==I[1]?I[1]:{},r=this._getRequestOptionsWithSliceId(r),n=this.rasterInfo,i=n.spatialReference,o=n.extent,s=r.datumTransformation,l=de(t,i,s),o.intersects(l)){e.next=6;break}return e.abrupt("return",{location:l,value:null});case 6:if(!Object(b.j)(this.rasterInfo.transform)){e.next=11;break}if(u=this.rasterInfo.transform.inverseTransform(l),this.rasterInfo.nativeExtent.intersects(u)){e.next=10;break}return e.abrupt("return",{location:u,value:null});case 10:l=u;case 11:if(c=0,!r.srcResolution){e.next=16;break}c=Ie(r.srcResolution,this.rasterInfo,this.ioConfig.sampling).pyramidLevel,e.next=21;break;case 16:return e.next=18,this.computeBestPyramidLevelForLocation(t,r);case 18:if(null!=(c=e.sent)){e.next=21;break}return e.abrupt("return",{location:l,value:null});case 21:if(null!==(f=this.identifyPixelLocation(l,c,null))){e.next=24;break}return e.abrupt("return",{location:l,value:null});case 24:return h=f.row,p=f.col,d=f.rowOffset,m=f.colOffset,v=Se(this.url,r.sliceId),g="".concat(c,"/").concat(h,"/").concat(p),y=Te(v,null,g),Object(b.i)(y)&&(y=this.fetchRawTile(c,h,p,r),Ce(v,null,g,y)),e.next=29,y;case 29:if(w=e.sent,!Object(b.i)(w)&&w.pixels&&0!==w.pixels.length){e.next=32;break}return e.abrupt("return",{location:l,value:null});case 32:if(O=d*this.rasterInfo.storageInfo.blockHeight+m,j=!w.mask||w.mask[O]?w.pixels.map((function(e){return e[O]})):null,"vector-magdir"!==(x=this.rasterInfo.dataType)&&"vector-uv"!==x||!((null==j?void 0:j.length)>1)){e.next=35;break}return e.abrupt("return",{location:l,value:j,magdirValue:"vector-magdir"===x?[j[0],j[1]]:Object(N.e)([j[0],j[1]]),pyramidLevel:c});case 35:return e.abrupt("return",{location:l,value:j,pyramidLevel:c});case 36:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchPixels",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n){var i,o,s,l,u,c,f,h,p,d,m,v,g,y,w,O,j,x,I,k,M,S,T,C,A,_,P,D,R,E=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=E.length>3&&void 0!==E[3]?E[3]:{},t=xe(t),o=Oe(t),s=this.rasterInfo.spatialReference,l=!t.spatialReference.equals(s),u=i.datumTransformation,c=new ie.a({x:(t.xmax-t.xmin)/r,y:(t.ymax-t.ymin)/n,spatialReference:t.spatialReference}),f=i.srcResolution||(l?he(c,s,t,u):c)){e.next=5;break}return e.abrupt("return",null);case 5:if(h=Ie(f,this.rasterInfo,this.ioConfig.sampling),p=h.pyramidLevel,d=h.pyramidResolution,!h.excessiveReading){e.next=8;break}return e.abrupt("return",null);case 8:if(m=this.rasterInfo.storageInfo,v=l?ve(t,s,u):t,(g=Object(b.q)(this.rasterInfo.transform))&&(v=g.inverseTransform(v)),null!=v){e.next=13;break}return e.abrupt("return",null);case 13:if(y={x:Math.floor((v.xmin-m.origin.x)/d.x+.1),y:Math.floor((m.origin.y-v.ymax)/d.y+.1)},w=Math.ceil((v.xmax-v.xmin)/d.x-.1),O=Math.ceil((v.ymax-v.ymin)/d.y-.1),!(w/r>8||O/n>8||o>=2)){e.next=16;break}return e.abrupt("return",null);case 16:return e.next=18,this.fetchRawPixels(p,y,{width:w,height:O,wrapCount:o},i);case 18:if(j=e.sent){e.next=21;break}return e.abrupt("return",null);case 21:if(x=p>0?m.pyramidBlockWidth:m.blockWidth,I=p>0?m.pyramidBlockHeight:m.blockHeight,k=x===w&&I===O&&y.x%x==0&&y.y%I==0,l||!k||1!==j.pixelBlocks.length||x!==r||I!==n||f.x!==c.x||f.y!==c.y){e.next=24;break}return e.abrupt("return",{extent:t,srcExtent:v,pixelBlock:j.pixelBlocks[0]});case 24:if(M=je(t,j.extent,c,u,g,o>0),T=!i.requestRawData,C={rows:M.spacing[0],cols:M.spacing[1]},A=Object(b.q)(this._getRasterTileAlignmentInfo(p,j.extent.xmin)),_=j.pixelBlocks,P=j.mosaicSize,D=j.isPartiallyFilled,!this.rasterJobHandler){e.next=32;break}return e.next=29,this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:_,srcMosaicSize:P,destDimension:T?{width:r,height:n}:null,coefs:T?M.coefficients:null,sampleSpacing:T?C:null,interpolation:i.interpolation,alignmentInfo:A},i);case 29:S=e.sent,e.next=34;break;case 32:R=Object(_e.k)(_,P,null,null,A),S=T?Object(_e.a)(R,{width:r,height:n},M.coefficients,C,i.interpolation):R;case 34:return e.abrupt("return",i.requestRawData?{srcExtent:v,pixelBlock:S,transformGrid:M,extent:t,isPartiallyFilled:D}:{srcExtent:v,extent:t,pixelBlock:S});case 35:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"fetchRawPixels",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n,i){var o,s,l,u,c,f,h,p,d,m,v,g,y,w,O,j,x,I,k,M,S,T,C,A,_,P,D,R,E,L,N,B,U,G=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.rasterInfo.storageInfo,s=o.origin,l=o.blockBoundary,u=this.getBlockWidthHeight(t),c=u.blockWidth,f=u.blockHeight,h=r.x,p=r.y,d=n.width,m=n.height,v=n.wrapCount,g=Object(b.q)(this._getRasterTileAlignmentInfo(t,0)),i.buffer&&(h-=i.buffer.cols,p-=i.buffer.rows,d+=2*i.buffer.cols,m+=2*i.buffer.rows),y=Math.floor(h/c),w=Math.floor(p/f),O=Math.floor((h+d-1)/c),j=Math.floor((p+m-1)/f),x=l[t]){e.next=7;break}return e.abrupt("return",null);case 7:if(I=x.minRow,k=x.minCol,M=x.maxCol,S=x.maxRow,!(j<I||O<k||w>S||y>M)){e.next=10;break}return e.abrupt("return",null);case 10:for(T=new Array,C=!1,A=null==this.ioConfig.allowPartialFill?i.allowPartialFill:this.ioConfig.allowPartialFill,_=w;_<=j;_++)for(P=y;P<=O;P++)D=0===v||null==g||P<g.worldColumnCountFromOrigin?P:P%g.worldColumnCountFromOrigin-g.originColumnOffset,_>=I&&D>=k&&S>=_&&M>=D?function(){var e=G._fetchRawTile(t,_,D,i);A?T.push(new Promise((function(t){e.then((function(e){return t(e)})).catch((function(){C=!0,t(null)}))}))):T.push(e)}():T.push(null);if(0!==T.length){e.next=16;break}return e.abrupt("return",null);case 16:return e.next=18,Promise.all(T);case 18:return R=e.sent,E={height:(j-w+1)*f,width:(O-y+1)*c},L=this.rasterInfo.spatialReference,N=this.getPyramidPixelSize(t),B=N.x,U=N.y,e.abrupt("return",{extent:new z.a({xmin:s.x+y*c*B,xmax:s.x+(O+1)*c*B,ymin:s.y-(j+1)*f*U,ymax:s.y-w*f*U,spatialReference:L}),pixelBlocks:R,mosaicSize:E,isPartiallyFilled:C});case 25:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(e,t,r,n){throw new v.a("BaseRaster:read-not-implemented","fetchRawTile() is not implemented")}},{key:"computeExtent",value:function(e){return ve(this.rasterInfo.extent,e)}},{key:"decodePixelBlock",value:function(e,t){return!this.rasterJobHandler||t.useCanvas?Object(Ae.a)(e,t):this.rasterJobHandler.decode({data:e,options:t})}},{key:"request",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n){var i,s,l,u,c,f,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=this.ioConfig.customFetchParameters,u=r.range,c=r.query,f=r.headers,n=null!=(i=null!=(s=n)?s:r.retryCount)?i:this.ioConfig.retryCount,h=u?{Range:"bytes=".concat(u.from,"-").concat(u.to)}:null,e.prev=3,e.next=6,Object(C.default)(t,Object(o.a)(Object(o.a)({},r),{},{query:Object(o.a)(Object(o.a)({},c),l),headers:Object(o.a)(Object(o.a)({},f),h)}));case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(n>0)){e.next=13;break}return e.abrupt("return",(n--,this.request(t,r,n)));case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getSliceIndex",value:function(e){var t=this,r=this.rasterInfo.multidimensionalInfo;if(!Object(b.j)(r)||null==e||!e.length)return null;for(var n=0,a=e[0].variableName,i=function(i){var o=r.variables[i],s=o.dimensions;if(o.name!==a)return n+=s.map((function(e){return t._getDimensionValuesCount(e)})).reduce((function(e,t){return e+t})),"break";for(var l=s.map((function(e){return t._getDimensionValuesCount(e)})),u=s.length,c=function(r){var a=e.filter((function(e){return e.dimensionName===s[r].name}))[0];if(null==a)return{v:{v:null}};var i=Array.isArray(a.values[0])?a.values[0][0]:a.values[0],o=t._getIndexFromDimensions(i,s[r]);if(-1===o)return{v:{v:null}};l.shift(),n+=r===u-1?o:o*l.reduce((function(e,t){return e+t}))},f=0;f<u;f++){var h=c(f);if("object"===typeof h)return h.v}},o=0;o<r.variables.length;o++){var s=i(o);if("break"===s)break;if("object"===typeof s)return s.v}return n}},{key:"updateTileInfo",value:function(){var e=this.rasterInfo,t=e.storageInfo,r=e.spatialReference,n=e.extent,a=e.pixelSize;if(!t.tileInfo){for(var i=[],o=t.maximumPyramidLevel||0,s=Math.max(a.x,a.y),l=1/.0254*96*s,u=0;u<=o;u++)i.push({level:o-u,resolution:s,scale:l}),s*=2,l*=2;var c=new ie.a({x:n.xmin,y:n.ymax,spatialReference:r});t.tileInfo=new L.a({origin:c,size:[t.blockWidth,t.blockHeight],spatialReference:r,lods:i}),t.isVirtualTileInfo=!0}}},{key:"createRemoteDatasetStorageInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:512,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512,n=arguments.length>3?arguments[3]:void 0,a=e.width,i=e.height,o=e.nativeExtent,s=e.pixelSize,l=e.spatialReference,u=new ie.a({x:o.xmin,y:o.ymax,spatialReference:l});null==n&&(n=Math.max(0,Math.round(Math.log(Math.max(a,i))/Math.LN2-8)));var c=this.computeBlockBoundary(o,512,512,{x:o.xmin,y:o.ymax},[s],n);e.storageInfo=new Y.a({blockWidth:t,blockHeight:r,pyramidBlockWidth:t,pyramidBlockHeight:r,origin:u,firstPyramidLevel:1,maximumPyramidLevel:n,blockBoundary:c})}},{key:"computeBestPyramidLevelForLocation",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"computeBlockBoundary",value:function(e,t,r,n,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2;if(1===a.length&&i>0)for(var s=(a=Object(Q.a)(a))[0],l=s.x,u=s.y,c=0;c<i;c++)l*=o,u*=o,a.push({x:l,y:u});for(var f=[],h=n.x,p=n.y,d=0;d<a.length;d++){var m=a[d],v=m.x,b=m.y;f.push({minCol:Math.floor((e.xmin-h+.1*v)/t/v),maxCol:Math.floor((e.xmax-h-.1*v)/t/v),minRow:Math.floor((p-e.ymax+.1*b)/r/b),maxRow:Math.floor((p-e.ymin-.1*b)/r/b)})}return f}},{key:"getPyramidPixelSize",value:function(e){var t=this.rasterInfo.nativePixelSize,r=this.rasterInfo.storageInfo,n=r.pyramidResolutions,a=r.pyramidScalingFactor;if(0===e)return t;if(Object(b.j)(n)&&n.length)return n[e-1];var i=Math.pow(a,e);return{x:t.x*i,y:t.y*i}}},{key:"identifyPixelLocation",value:function(e,t,r){var n=this.rasterInfo,a=n.spatialReference,i=n.nativeExtent,o=this.rasterInfo.storageInfo,s=o.blockWidth,l=o.blockHeight,u=o.maximumPyramidLevel,c=o.origin,f=de(e,a,r);if(!i.intersects(f))return null;if(t<0||t>u)return null;var h=this.getPyramidPixelSize(t),p=h.x,d=h.y,m=(c.y-f.y)/d/l,v=(f.x-c.x)/p/s,b=Math.min(l-1,Math.floor((m-Math.floor(m))*l)),g=Math.min(s-1,Math.floor((v-Math.floor(v))*s));return{pyramidLevel:t,row:Math.floor(m),col:Math.floor(v),rowOffset:b,colOffset:g,srcLocation:f}}},{key:"getTileExtent",value:function(e,t,r,n,a,i){var o=Object(K.a)(i,2),s=o[0],l=o[1],u=n.x+r*s*e.x,c=u+s*e.x,f=n.y-t*l*e.y,h=f-l*e.y;return new z.a({xmin:u,xmax:c,ymin:h,ymax:f,spatialReference:a})}},{key:"getBlockWidthHeight",value:function(e){return{blockWidth:e>0?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:e>0?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight}}},{key:"isBlockOutside",value:function(e,t,r){var n=this.rasterInfo.storageInfo.blockBoundary[e];return!n||n.maxRow<t||n.maxCol<r||n.minRow>t||n.minCol>r}},{key:"_fetchRawTile",value:function(e,t,r,n){var a=this.rasterInfo.storageInfo.blockBoundary[e];if(!a)return Promise.resolve(null);var i=a.minRow,s=a.minCol,l=a.maxCol,u=a.maxRow;if(t<i||r<s||t>u||r>l)return Promise.resolve(null);var c=Se(this.url,n.sliceId),f="".concat(e,"/").concat(t,"/").concat(r),h=Te(c,n.registryId,f);if(Object(b.i)(h)){var p=Object(y.d)();h=this.fetchRawTile(e,t,r,Object(o.a)(Object(o.a)({},n),{},{signal:p.signal})),Ce(c,n.registryId,f,h,p),h.catch((function(){return function(e,t,r){if(ke.has(e)){var n=ke.get(e);null!=n[t]?n[t].cache.delete(r):Me.deleteBlock(e,r)}else null==t&&Me.deleteBlock(e,r)}(c,n.registryId,f)}))}return n.signal&&Object(y.q)(n,(function(){!function(e,t,r){if(!ke.has(e))return null==t?Me.decreaseRefCount(e,r):0;var n=ke.get(e);if(null==n[t])return Me.decreaseRefCount(e,r);var a=n[t].cache;if(a.has(r)){var i=a.get(r);if(i.refCount--,0===i.refCount){a.delete(r);for(var o=0;o<n.length;o++)n[o]&&n[o].cache.has(r)&&n[o].cache.delete(r);i.controller&&i.controller.abort()}return i.refCount}}(c,n.registryId,f)})),h}},{key:"_getIndexFromDimensions",value:function(e,t){var r=t.extent,n=t.interval,a=t.unit,i=t.values;if(null!=i&&i.length)return Array.isArray(i[0])?i.findIndex((function(t){return t[0]<=e&&t[1]>=e})):i.indexOf(e);if(e>r[1])return-1;var o=r[0],s=-1;if("ISO8601"===a){var l;switch((null==(l=t.intervalUnit)?void 0:l.toLowerCase())||"seconds"){case"seconds":s=Math.round((e-o)/1e3/n);break;case"minutes":s=Math.round((e-o)/6e4/n);break;case"hours":s=Math.round((e-o)/36e5/n);break;case"days":s=Math.round((e-o)/864e5/n);break;case"years":s=Math.round((new Date(e).getUTCFullYear()-new Date(o).getUTCFullYear())/n);break;case"decades":s=Math.round((new Date(e).getUTCFullYear()-new Date(o).getUTCFullYear())/10/n)}return s}return Math.round((e-o)/n)}},{key:"_getDimensionValuesCount",value:function(e){var t=e.extent,r=e.interval,n=e.unit,a=e.values,i=(null==a?void 0:a.length)||0;if(i)return i;var o=t[0];if(0===i&&"ISO8601"===n){var s;switch((null==(s=e.intervalUnit)?void 0:s.toLowerCase())||"seconds"){case"seconds":i=Math.round((t[1]-t[0])/1e3/r);break;case"minutes":i=Math.round((t[1]-t[0])/6e4/r);break;case"hours":i=Math.round((t[1]-t[0])/36e5/r);break;case"days":i=Math.round((t[1]-t[0])/864e5/r);break;case"years":i=Math.round((new Date(t[1]).getUTCFullYear()-new Date(o).getUTCFullYear())/r);break;case"decades":i=Math.round((new Date(t[1]).getUTCFullYear()-new Date(o).getUTCFullYear())/10/r)}return i}return Math.round((t[1]-t[0])/r)}},{key:"_getRasterTileAlignmentInfo",value:function(e,t){return null==this._rasterTileAlighmentInfo&&(this._rasterTileAlighmentInfo=function(e){var t=e.storageInfo.origin.x,r=ge(e.spatialReference,!0);if(!Object(b.j)(r))return{originX:t,halfWorldWidth:null,pyramidsInfo:null};for(var n=r/2,a=e.nativePixelSize,i=e.storageInfo,o=e.extent,s=i.maximumPyramidLevel,l=i.blockWidth,u=i.pyramidScalingFactor,c=a.x,f=[],h=Object(b.j)(e.transform)&&"gcs-shift"===e.transform.type,p=t+n,d=h?r-t:n-t,m=0;m<=s;m++){var v=(o.xmax-t)/c/l,g=v-Math.floor(v)==0?v:Math.ceil(v),y=(r/2-t)/c/l,w=y-Math.floor(y)==0?y:Math.ceil(y),O=Math.floor(p/c/l),j=Math.round(p/c)%l,x=(l-Math.round(d/c)%l)%l;f.push({resolutionX:c,blockWidth:l,datsetColumnCount:g,worldColumnCountFromOrigin:w,leftMargin:j,rightPadding:x,originColumnOffset:O}),c*=u}return{originX:t,halfWorldWidth:n,pyramidsInfo:f,hasGCSSShiftTransform:h}}(this.rasterInfo)),Object(b.j)(this._rasterTileAlighmentInfo.pyramidsInfo)?Object(o.a)({startX:t,halfWorldWidth:this._rasterTileAlighmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlighmentInfo.hasGCSSShiftTransform},this._rasterTileAlighmentInfo.pyramidsInfo[e]):null}},{key:"_getRequestOptionsWithSliceId",value:function(e){var t;return null!=(t=e.multidimensionalDefinition)&&t.length&&Object(b.j)(this.rasterInfo.multidimensionalInfo)&&null==e.sliceId&&(e=Object(o.a)(Object(o.a)({},e),{},{sliceId:this.getSliceIndex(e.multidimensionalDefinition)||0})),e}}]),r}(Object(ee.b)($.a));Object(p.a)([Object(w.b)()],Pe.prototype,"_rasterTileAlighmentInfo",void 0),Object(p.a)([Object(w.b)(D.n)],Pe.prototype,"url",null),Object(p.a)([Object(w.b)({type:String,json:{write:!0}})],Pe.prototype,"datasetName",void 0),Object(p.a)([Object(w.b)({type:String,json:{write:!0}})],Pe.prototype,"datasetFormat",void 0),Object(p.a)([Object(w.b)()],Pe.prototype,"rasterInfo",void 0),Object(p.a)([Object(w.b)()],Pe.prototype,"ioConfig",void 0),Object(p.a)([Object(w.b)()],Pe.prototype,"sourceJSON",void 0);var De=Pe=Object(p.a)([Object(k.a)("esri.layers.support.rasterDatasets.BaseRaster")],Pe),Re=r(866);function Ee(e){var t=e.fields,r=e.records,n=t.some((function(e){return"oid"===e.name.toLowerCase()}))?"OBJECTID":"OID",a=[{name:n,type:"esriFieldTypeOID",alias:"OID"}].concat(t.map((function(e){return{name:e.name,type:"esriFieldType"+e.typeName,alias:e.name}}))),i=a.map((function(e){return e.name})),o=[],s=0,l=0;return r.forEach((function(e){var t={};for(t[n]=s++,l=1;l<i.length;l++)t[i[l]]=e[l-1];o.push({attributes:t})})),{displayFieldName:"",fields:a,features:o}}var Le=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"supportedVersions",get:function(){return[5]}},{key:"parse",value:function(e){var t=new DataView(e),r=3&t.getUint8(0);if(3!==r)return{header:{version:r},recordSet:null};var n,a=t.getUint32(4,!0),i=t.getUint16(8,!0),o=t.getUint16(10,!0),s={version:r,recordCount:a,headerByteCount:i,recordByteCount:o},l=32,u=[],c=[];if(3===r){for(;13!==t.getUint8(l);)n=String.fromCharCode(t.getUint8(l+11)).trim(),u.push({name:Object(Re.a)(new Uint8Array(e,l,11)),type:n,typeName:["String","Date","Double","Boolean","String","Integer"][["C","D","F","L","M","N"].indexOf(n)],length:t.getUint8(l+16)}),l+=32;if(l+=1,u.length>0)for(var f=function(){var r=[];32===t.getUint8(l)?(l+=1,u.forEach((function(t){if("C"===t.type)r.push(Object(Re.a)(new Uint8Array(e,l,t.length)).trim());else if("N"===t.type)r.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(e,l,t.length)).trim(),10));else if("F"===t.type)r.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(e,l,t.length)).trim()));else if("D"===t.type){var n=String.fromCharCode.apply(null,new Uint8Array(e,l,t.length)).trim();r.push(new Date(parseInt(n.substring(0,4),10),parseInt(n.substring(4,6),10)-1,parseInt(n.substring(6,8),10)))}l+=t.length})),c.push(r)):l+=o};c.length<a&&e.byteLength-l>o;)f()}return{header:s,fields:u,records:c,recordSet:Ee({fields:u,records:c})}}}]),e}(),Ne=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).affectsPixelSize=!1,e}return Object(l.a)(r,[{key:"forwardTransform",value:function(e){return e}},{key:"inverseTransform",value:function(e){return e}}]),r}($.a);Object(p.a)([Object(w.b)()],Ne.prototype,"affectsPixelSize",void 0),Object(p.a)([Object(w.b)({json:{write:!0}})],Ne.prototype,"spatialReference",void 0);var Be=Ne=Object(p.a)([Object(k.a)("esri.layers.support.rasterTransforms.BaseRasterTransform")],Ne),Ue=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).type="identity",e}return r}(Be);Object(p.a)([Object(x.a)({IdentityXform:"identity"})],Ue.prototype,"type",void 0);var ze=Ue=Object(p.a)([Object(k.a)("esri.layers.support.rasterTransforms.IdentityTransform")],Ue),Ge=r(43);function Fe(e,t,r){var n=t.x,a=t.y;if(r<2)return{x:e[0]+n*e[2]+a*e[4],y:e[1]+n*e[3]+a*e[5]};if(2===r){var i=n*n,o=a*a,s=n*a;return{x:e[0]+n*e[2]+a*e[4]+i*e[6]+s*e[8]+o*e[10],y:e[1]+n*e[3]+a*e[5]+i*e[7]+s*e[9]+o*e[11]}}var l=n*n,u=a*a,c=n*a,f=l*n,h=l*a,p=n*u,d=a*u;return{x:e[0]+n*e[2]+a*e[4]+l*e[6]+c*e[8]+u*e[10]+f*e[12]+h*e[14]+p*e[16]+d*e[18],y:e[1]+n*e[3]+a*e[5]+l*e[7]+c*e[9]+u*e[11]+f*e[13]+h*e[15]+p*e[17]+d*e[19]}}function He(e,t,r){var n=t.xmin,a=t.ymin,i=t.xmax,o=t.ymax,s=t.spatialReference,l=[];if(r<2)l.push({x:n,y:o}),l.push({x:i,y:o}),l.push({x:n,y:a}),l.push({x:i,y:a});else{for(var u=10,c=0;c<u;c++)l.push({x:n,y:a+(o-a)*c/(u-1)}),l.push({x:i,y:a+(o-a)*c/(u-1)});u=8;for(var f=1;f<=u;f++)l.push({x:n+(i-n)*f/u,y:a}),l.push({x:n+(i-n)*f/u,y:o})}l=l.map((function(t){return Fe(e,t,r)}));var h=l.map((function(e){return e.x})),p=l.map((function(e){return e.y}));return new z.a({xmin:Math.min.apply(null,h),xmax:Math.max.apply(null,h),ymin:Math.min.apply(null,p),ymax:Math.max.apply(null,p),spatialReference:s})}var Ve=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).polynomialOrder=1,e.type="polynomial",e}return Object(l.a)(r,[{key:"readForwardCoefficients",value:function(e,t){var r=t.coeffX,n=t.coeffY;if(null==r||!r.length||null==n||!n.length||r.length!==n.length)return null;for(var a=[],i=0;i<r.length;i++)a.push(r[i]),a.push(n[i]);return a}},{key:"writeForwardCoefficients",value:function(e,t,r){for(var n=[],a=[],i=0;i<(null==e?void 0:e.length);i++)i%2==0?n.push(e[i]):a.push(e[i]);t.coeffX=n,t.coeffY=a}},{key:"inverseCoefficients",get:function(){var e=this._get("inverseCoefficients"),t=this._get("forwardCoefficients");return!e&&t&&this.polynomialOrder<2&&(e=function(e){var t=Object(K.a)(e,6),r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],l=a*s-o*i,u=o*i-a*s;return[(o*n-r*s)/l,(a*n-r*i)/u,s/l,i/u,-o/l,-a/u]}(t)),e},set:function(e){this._set("inverseCoefficients",e)}},{key:"readInverseCoefficients",value:function(e,t){var r=t.inverseCoeffX,n=t.inverseCoeffY;if(null==r||!r.length||null==n||!n.length||r.length!==n.length)return null;for(var a=[],i=0;i<r.length;i++)a.push(r[i]),a.push(n[i]);return a}},{key:"writeInverseCoefficients",value:function(e,t,r){for(var n=[],a=[],i=0;i<(null==e?void 0:e.length);i++)i%2==0?n.push(e[i]):a.push(e[i]);t.inverseCoeffX=n,t.inverseCoeffY=a}},{key:"forwardTransform",value:function(e){if("point"===e.type){var t=Fe(this.forwardCoefficients,e,this.polynomialOrder);return new ie.a({x:t.x,y:t.y,spatialReference:e.spatialReference})}return He(this.forwardCoefficients,e,this.polynomialOrder)}},{key:"inverseTransform",value:function(e){if("point"===e.type){var t=Fe(this.inverseCoefficients,e,this.polynomialOrder);return new ie.a({x:t.x,y:t.y,spatialReference:e.spatialReference})}return He(this.inverseCoefficients,e,this.polynomialOrder)}}]),r}(Be);Object(p.a)([Object(w.b)({json:{write:!0}})],Ve.prototype,"polynomialOrder",void 0),Object(p.a)([Object(w.b)()],Ve.prototype,"forwardCoefficients",void 0),Object(p.a)([Object(I.a)("forwardCoefficients",["coeffX","coeffY"])],Ve.prototype,"readForwardCoefficients",null),Object(p.a)([Object(Ge.a)("forwardCoefficients")],Ve.prototype,"writeForwardCoefficients",null),Object(p.a)([Object(w.b)({json:{write:!0}})],Ve.prototype,"inverseCoefficients",null),Object(p.a)([Object(I.a)("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],Ve.prototype,"readInverseCoefficients",null),Object(p.a)([Object(Ge.a)("inverseCoefficients")],Ve.prototype,"writeInverseCoefficients",null),Object(p.a)([Object(w.b)()],Ve.prototype,"affectsPixelSize",void 0),Object(p.a)([Object(x.a)({PolynomialXform:"polynomial"})],Ve.prototype,"type",void 0);var Je=Ve=Object(p.a)([Object(k.a)("esri.layers.support.rasterTransforms.PolynomialTransform")],Ve),Ze={PolynomialXform:Je,IdentityXform:ze},We=Object.keys(Ze);var qe=r(668),Xe=new Map;Xe.set("int16","esriFieldTypeSmallInteger"),Xe.set("int32","esriFieldTypeInteger"),Xe.set("int64","esriFieldTypeInteger"),Xe.set("float32","esriFieldTypeSingle"),Xe.set("float64","esriFieldTypeDouble"),Xe.set("text","esriFieldTypeString");var Ye=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).storageInfo=null,e.datasetFormat="CRF",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return e.next=4,this.request(this.url+"/conf.json",{signal:null==t?void 0:t.signal});case 4:if(r=e.sent,n=r.data,this._validateHeader(n)){e.next=8;break}throw new v.a("cloudraster:open","Invalid or unsupported conf.json.");case 8:if(this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1),i=this._parseHeader(n),o=i.storageInfo,"thematic"!==(s=i.rasterInfo).dataType){e.next=15;break}return e.next=13,this._fetchAuxiliaryInformation();case 13:l=e.sent,s.attributeTable=l;case 15:this._set("storageInfo",o),this._set("rasterInfo",s),this.ioConfig.retryCount=this.ioConfig.retryCount||0;case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n){var i,o,s,l,u,c,f,h,p=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=p.length>3&&void 0!==p[3]?p[3]:{},!((o=this.rasterInfo.storageInfo.maximumPyramidLevel-t)<0)){e.next=4;break}return e.abrupt("return",null);case 4:return s=this._buildCacheFilePath(o,r,n,i.multidimensionalDefinition),l=this._getIndexRecordFromBundle(r,n),e.next=8,this.request(s,{range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer",signal:i.signal});case 8:if(u=e.sent){e.next=11;break}return e.abrupt("return",null);case 11:if(c=new Uint8Array(u.data),0!==(f=this._getTileEndAndContentType(c,l)).recordSize){e.next=14;break}return e.abrupt("return",null);case 14:return e.next=16,this.request(s,{range:{from:f.position,to:f.position+f.recordSize},responseType:"array-buffer",signal:i.signal});case 16:return h=e.sent,e.abrupt("return",h?this.decodePixelBlock(h.data,{width:this.rasterInfo.storageInfo.tileInfo.size[0],height:this.rasterInfo.storageInfo.tileInfo.size[1],planes:null,pixelType:null}):null);case 18:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_validateHeader",value:function(e){return e&&"RasterInfo"===e.type&&!["origin","extent","geodataXform","LODInfos","blockWidth","blockHeight","bandCount","pixelType","pixelSizeX","pixelSizeY","format","packetSize"].some((function(t){return!e[t]}))}},{key:"_parseHeader",value:function(e){var t,r,n=["u1","u2","u4","u8","s8","u16","s16","u32","s32","f32","f64"][e.pixelType],a=e.bandCount,i=e.histograms,o=e.colormap,s=e.blockWidth,l=e.blockHeight,u=e.firstPyramidLevel,c=e.maximumPyramidLevel,f=e.statistics&&e.statistics.map((function(e){return{min:e.min,max:e.max,avg:e.mean,stddev:e.standardDeviation,median:e.median,mode:e.mode}})),h=e.extent.spatialReference,p=null==(t=e.geodataXform)?void 0:t.spatialReference,d=new G.a(null!=h&&h.wkid||null!=h&&h.wkt?h:p),m=new z.a({xmin:e.extent.xmin,ymin:e.extent.ymin,xmax:e.extent.xmax,ymax:e.extent.ymax,spatialReference:d}),v=new ie.a({x:e.pixelSizeX,y:e.pixelSizeY,spatialReference:d}),b=Math.round((m.xmax-m.xmin)/v.x),g=Math.round((m.ymax-m.ymin)/v.y),y=this._parseTransform(e.geodataXform),w=y?m:null;y&&(m=y.forwardTransform(m),v.x=(m.xmax-m.xmin)/b,v.y=(m.ymax-m.ymin)/g);var O,j,x,I,k=null!=(r=e.properties)?r:{},M=e.format.toLowerCase().replace("cache/",""),S=new ie.a(e.origin.x,e.origin.y,d);if(o&&o.colors)for(O=[],j=0;j<o.colors.length;j++)x=o.colors[j],I=o.values?o.values[j]:j,O.push([I,255&x,x<<16>>>24,x<<8>>>24,x>>>24]);var T=e.LODInfos,C=[];for(j=0;j<T.levels.length;j++)C.push({level:T.levels[j],resolution:T.resolutions[j],scale:96/.0254*T.resolutions[j]});var A=new L.a({dpi:96,lods:C,format:M,origin:S,size:[s,l],spatialReference:d}),_={recordSize:8,packetSize:e.packetSize,headerSize:e.packetSize*e.packetSize*8+64},P=[{maxCol:Math.ceil(b/s)-1,maxRow:Math.ceil(g/l)-1,minCol:0,minRow:0}],D=2;if(c>0)for(j=0;j<c;j++)P.push({maxCol:Math.ceil(b/D/s)-1,maxRow:Math.ceil(g/D/l)-1,minCol:0,minRow:0}),D*=2;var R=e.mdInfo;return{storageInfo:_,rasterInfo:new X.a({width:b,height:g,pixelType:n,bandCount:a,extent:m,nativeExtent:w,transform:y,spatialReference:d,pixelSize:v,keyProperties:k,statistics:f,histograms:i,multidimensionalInfo:R,colormap:O,storageInfo:new Y.a({blockWidth:s,blockHeight:l,pyramidBlockWidth:s,pyramidBlockHeight:l,origin:S,tileInfo:A,firstPyramidLevel:u,maximumPyramidLevel:c,blockBoundary:P})})}}},{key:"_parseTransform",value:function(e){var t,r;if(!function(e){var t=null==e?void 0:e.type;return!e||We.includes(t)}(e))throw new v.a("cloudraster:open","the data contains unsupported geodata transform types");var n=function(e){if(!(null==e?void 0:e.type))return null;var t=Ze[null==e?void 0:e.type];if(t){var r=new t;return r.read(e),r}return null}(e);if("identity"===n.type)return null;if("polynomial"!==n.type||null==(t=n.forwardCoefficients)||!t.length||null==(r=n.inverseCoefficients)||!r.length)throw new v.a("cloudraster:open","the data contains unsupported geodata transforms - both forward and inverse coefficients are required currently");return n}},{key:"_fetchAuxiliaryInformation",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.request(this.url+"/conf.vat.json",{signal:t}).then((function(e){return e.data})).catch((function(){return null})),n=this.request(this.url+"/conf.vat.dbf",{responseType:"array-buffer",signal:t}).then((function(e){return e.data})).catch((function(){return null})),e.next=4,Promise.all([r,n]);case 4:return(i=e.sent)[0]&&(s=i[0].fields,l=i[0].values,s&&l&&(s=s.map((function(e){return{type:"OID"===e.name?"esriFieldTypeOID":Xe.get(e.type),name:e.name,alias:e.alias||e.name}})),u=l.map((function(e){return{attributes:e}})),s&&l&&(o={fields:s,features:u}))),!o&&i[1]&&(o=Le.parse(i[1]).recordSet),e.abrupt("return",qe.default.fromJSON(o));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_buildCacheFilePath",value:function(e,t,r,n){var a=this.storageInfo.packetSize,i=Math.floor(t/a)*a,o=Math.floor(r/a)*a,s="R"+this._toHexString4(i)+"C"+this._toHexString4(o),l="L";l+=e>=10?e.toString():"0"+e.toString();var u=this.rasterInfo.multidimensionalInfo,c=null==n?void 0:n[0];if(!Object(b.j)(u)||!c)return"".concat(this.url,"/_alllayers/").concat(l,"/").concat(s,".bundle");for(var f=u.variables.filter((function(e){return e.name===c.variableName}))[0].dimensions[0].values.indexOf(c.values[0]).toString(16),h=4-f.length,p=0;p<h;p++)f="0"+f;return f="S"+f,"".concat(this.url,"/_alllayers/").concat(c.variableName,"/").concat(f,"/").concat(l,"/").concat(s,".bundle")}},{key:"_getIndexRecordFromBundle",value:function(e,t){var r=this.storageInfo.packetSize,n=r*(e%r)+t%r;if(n<0)throw"Invalid level / row / col";return 20+n*this.storageInfo.recordSize+44}},{key:"_getTileEndAndContentType",value:function(e,t){var r,n=e.subarray(t,t+8),a=0;for(r=0;r<5;r++)a|=(255&n[r])<<8*r;var i=0xffffffffff&a;for(a=0,r=5;r<8;r++)a|=(255&n[r])<<8*(r-5);return{position:i,recordSize:0xffffffffff&a}}},{key:"_toHexString4",value:function(e){var t=e.toString(16);if(4!==t.length)for(var r=4-t.length;r-- >0;)t="0"+t;return t}}]),r}(De);Object(p.a)([Object(w.b)({readOnly:!0})],Ye.prototype,"storageInfo",void 0),Object(p.a)([Object(w.b)({type:String,json:{write:!0}})],Ye.prototype,"datasetFormat",void 0);var Ke=Ye=Object(p.a)([Object(k.a)("esri.layers.support.rasterDatasets.CloudRaster")],Ye),Qe=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).datasetFormat="MEMORY",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l,u,c,f,h,p,d,m,v,b,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return n=this.data,i=n.pixelBlock,o=n.statistics,s=n.histograms,l=n.name,u=n.keyProperties,c=n.nativeExtent,f=n.transform,h=i.width,p=i.height,d=i.pixelType,m=this.data.extent||new z.a({xmin:-.5,ymin:.5,xmax:h-.5,ymax:p-.5,spatialReference:new G.a({wkid:3857})}),v=null!=(r=this.data.isPseudoSpatialReference)?r:!this.data.extent,b={x:m.width/h,y:m.height/p},g=new X.a({width:h,height:p,pixelType:d,extent:m,nativeExtent:c,transform:f,pixelSize:b,spatialReference:m.spatialReference,bandCount:3,keyProperties:u||{},statistics:o,isPseudoSpatialReference:v,histograms:s}),this.createRemoteDatasetStorageInfo(g,512,512),this._set("rasterInfo",g),this.updateTileInfo(),e.next=8,this._buildInMemoryRaster(i,{width:512,height:512},t);case 8:this.datasetName=l,this.url="/InMemory/"+l;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(e,t,r){var n=this._pixelBlockTiles.get("".concat(e,"/").concat(t,"/").concat(r));return Promise.resolve(n)}},{key:"_buildInMemoryRaster",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n){var i,o,s,l,u,c,f,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.rasterInfo.storageInfo.maximumPyramidLevel,o=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:t,tileSize:r,maximumPyramidLevel:i},n):Promise.resolve(Object(_e.n)(t,r,i)),s=Object(b.j)(this.rasterInfo.statistics),l=Object(b.j)(this.rasterInfo.histograms),u=s&&l?Promise.resolve({statistics:null,histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:t},n):Promise.resolve(Object(_e.g)(t)),e.next=7,Object(y.j)([o,u]);case 7:if((c=e.sent)[0].value||!c[1].value){e.next=10;break}throw new v.a("inmemory-raster:open","failed to build in memory raster");case 10:this._pixelBlockTiles=c[0].value,s||(this.rasterInfo.statistics=null==(f=c[1].value)?void 0:f.statistics),l&&(this.rasterInfo.histograms=null==(h=c[1].value)?void 0:h.histograms);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(De);Object(p.a)([Object(w.b)({type:String,json:{write:!0}})],Qe.prototype,"datasetFormat",void 0),Object(p.a)([Object(w.b)()],Qe.prototype,"data",void 0);var $e=Qe=Object(p.a)([Object(k.a)("esri.layers.support.rasterDatasets.InMemoryRaster")],Qe);function et(e,t){if(!e||!t)return[];var r=t;t.indexOf("/")>-1?(r=t.slice(0,t.indexOf("/")),t=t.slice(t.indexOf("/")+1)):t="";var n=[];if(t){for(var a=et(e,r),i=0;i<a.length;i++)et(a[i],t).forEach((function(e){return n.push(e)}));return n}var o=e.getElementsByTagNameNS("*",r);if(!o||0===o.length)return[];for(var s=0;s<o.length;s++)n.push(o[s]||o.item[s]);return n}function tt(e,t){if(!e||!t)return null;var r=t;t.indexOf("/")>-1?(r=t.slice(0,t.indexOf("/")),t=t.slice(t.indexOf("/")+1)):t="";var n=et(e,r);return n.length>0?t?tt(n[0],t):n[0]:null}function rt(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=r?tt(e,r):e;return n?(t=n.textContent||n.nodeValue)?t.trim():null:null}function nt(e,t){return function(e,t){for(var r,n=et(e,t),a=[],i=0;i<n.length;i++)(r=n[i].textContent||n[i].nodeValue)&&""!==(r=r.trim())&&a.push(r);return a}(e,t).map((function(e){return Number(e)}))}function at(e,t){var r=rt(e,t);return Number(r)}function it(e,t){var r,n=null==e||null==(r=e.nodeName)?void 0:r.toLowerCase(),a=t.toLowerCase();return n.slice(n.lastIndexOf(":")+1)===a}function ot(e,t){if(!e||!t)return null;for(var r=[],n=0;n<e.length;n++)r.push(e[n]),r.push(t[n]);return r}function st(e){if(!e)return null;var t=Number(e);if(!isNaN(t)&&0!==t)return new G.a({wkid:t});if((e=String(e)).startsWith("COMPD_CS")){if(!e.includes("VERTCS")||!e.includes("GEOGCS")&&!e.startsWith("PROJCS"))return null;var r=e.indexOf("VERTCS"),n=e.indexOf("PROJCS"),a=n>-1?n:e.indexOf("GEOGCS");if(-1===a)return null;var i=e.slice(a,e.lastIndexOf("]",r)+1).trim(),o=e.slice(a,e.lastIndexOf("]")).trim();t=lt(i);var s=new G.a(t?{wkid:t}:{wkt:i}),l=lt(o);return l&&(s.vcsWkid=l),s}return e.startsWith("GEOGCS")||e.startsWith("PROJCS")?(t=lt(e),new G.a(0!==t?{wkid:t}:{wkt:e})):null}function lt(e){var t=e.replace(/\]/g,"[").replace(/\"/g,"").split("[").map((function(e){return e.trim()})).filter((function(e){return""!==e})),r=t[t.length-1].split(",");if("EPSG"===r[0]&&e.endsWith('"]]')){var n=Number(r[1]);if(!isNaN(n)&&0!==n)return n}return 0}function ut(e){var t;if("pamdataset"!==(null==e||null==(t=e.documentElement.tagName)?void 0:t.toLowerCase()))return{};var r={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};e.documentElement.childNodes.forEach((function(e){if(1===e.nodeType)if(it(e,"SRS")){if(!r.spatialReference){var t=rt(e);r.spatialReference=st(t)}}else if(it(e,"Metadata"))if("xml:ESRI"===e.getAttribute("domain")){var n=function(e){var t,r=tt(e,"GeodataXform"),n=st(at(r,"SpatialReference/WKID")||rt(r,"SpatialReference/WKT"));if("typens:PolynomialXform"!==r.getAttribute("xsi:type"))return{spatialReference:n,transform:null};var a=null!=(t=at(r,"PolynomialOrder"))?t:1,i=nt(r,"CoeffX/Double"),o=nt(r,"CoeffY/Double"),s=nt(r,"InverseCoeffX/Double"),l=nt(r,"InverseCoeffY/Double"),u=ot(i,o),c=ot(s,l);return{spatialReference:n,transform:new Je({spatialReference:n,polynomialOrder:a,forwardCoefficients:u,inverseCoefficients:c})}}(e),a=n.spatialReference,i=n.transform;r.transform=i,r.spatialReference||(r.spatialReference=a)}else et(e,"MDI").forEach((function(e){return r.metadata[e.getAttribute("key")]=rt(e)}));else if(it(e,"PAMRasterBand")){var o=function(e){var t,r,n,a,i,o=at(e,"NoDataValue"),s=tt(e,"Histograms/HistItem"),l=at(s,"HistMin"),u=at(s,"HistMax"),c=at(s,"BucketCount"),f=null==(t=rt(s,"HistCounts"))?void 0:t.split("|").map((function(e){return Number(e)}));et(e,"Metadata/MDI").forEach((function(e){var t,o=Number(null!=(t=e.textContent)?t:e.nodeValue);switch(e.getAttribute("key").toUpperCase()){case"STATISTICS_MINIMUM":r=o;break;case"STATISTICS_MAXIMUM":n=o;break;case"STATISTICS_MEAN":a=o;break;case"STATISTICS_STDDEV":i=o}}));var h=at(e,"Metadata/SourceBandIndex");return{noDataValue:o,histogram:null!=f&&f.length&&null!=r&&null!=n?{min:l,max:u,size:c||f.length,counts:f}:null,sourceBandIndex:h,statistics:null!=r&&null!=n?{min:r,max:n,avg:a,stddev:i}:null}}(e);null!=o.sourceBandIndex&&null==r.rasterBands[o.sourceBandIndex]?r.rasterBands[o.sourceBandIndex]=o:r.rasterBands.push(o)}}));var n=r.rasterBands;if(n){var a=!!n[0].statistics;r.statistics=a?n.map((function(e){return e.statistics})):null;var i=!!n[0].histogram;r.histograms=i?n.map((function(e){return e.histogram})):null}return r}var ct=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){return Object(s.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l,u,c,f,h,p,d,m;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return e.next=4,this._fetchData(t);case 4:return r=e.sent,e.next=7,this._fetchAuxiliaryData(t);case 7:return n=e.sent,i=n.spatialReference,o=n.statistics,s=n.histograms,l=n.transform,(u=!i)&&(i=new G.a({wkid:3857})),null!=s&&s.length&&null==o&&(o=Object(_e.f)(s)),c=r.width,f=r.height,h=new z.a({xmin:-.5,ymin:.5-f,xmax:c-.5,ymax:.5,spatialReference:i}),p=l?l.forwardTransform(h):h,!0,l&&(d=l.forwardCoefficients,d&&0===d[1]&&0===d[2]&&(l=null,h=p)),m=new $e({data:{extent:p,nativeExtent:h,transform:l,pixelBlock:r,statistics:o,histograms:s,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:u}}),e.next=22,m.open();case 22:this._set("rasterInfo",m.rasterInfo),this._inMemoryRaster=m;case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this._inMemoryRaster.fetchRawTile(e,t,r,n)}},{key:"_fetchData",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request(this.url,{responseType:"array-buffer",signal:null==t?void 0:t.signal});case 2:if(r=e.sent,n=r.data,"JPG"===(i=Object(Ae.b)(n).toUpperCase())||"PNG"===i||"GIF"===i||"BMP"===i){e.next=7;break}throw new v.a("image-aux-raster:open","the data is not a supported format");case 7:return this._set("datasetFormat",i),e.next=10,this.decodePixelBlock(n,{format:"jpg",width:1,height:1,useCanvas:!0});case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchAuxiliaryData",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l,u,c,f,h,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(b.q)(null==t?void 0:t.signal),o=null!=(r=this.ioConfig.skipExtensions)?r:[],s=o.indexOf("aux.xml")>-1?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:i}),l=this.datasetFormat,u="JPG"===l?"jgw":"PNG"===l?"pgw":"BMP"===l?"bpw":null,c=o.indexOf(u)>-1?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+u,{responseType:"text",signal:i}),e.next=8,Object(y.j)([s,c]);case 8:if(f=e.sent,null==i||!i.aborted){e.next=11;break}throw Object(y.e)();case 11:return(h=ut(null==(n=f[0].value)?void 0:n.data)).transform||(p=f[1].value?f[1].value.data.split("\n").slice(0,6).map((function(e){return Number(e)})):null,h.transform=6===(null==p?void 0:p.length)?new Je({forwardCoefficients:[p[4],p[5],p[0],-p[1],p[2],-p[3]]}):null),e.abrupt("return",h);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(De);Object(p.a)([Object(w.b)({type:String,json:{write:!0}})],ct.prototype,"datasetFormat",void 0);var ft=ct=Object(p.a)([Object(k.a)("esri.layers.support.rasterDatasets.ImageAuxRaster")],ct),ht=r(27),pt=r(856),dt=r(840),mt=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).type="gcs-shift",e.tolerance=1e-8,e}return Object(l.a)(r,[{key:"forwardTransform",value:function(e){return"point"===(e=e.clone()).type?(e.x>180+this.tolerance&&(e.x-=360),e):(e.xmin>=180-this.tolerance?(e.xmax-=360,e.xmin-=360):e.xmax>180+this.tolerance&&(e.xmin=-180,e.xmax=180),e)}},{key:"inverseTransform",value:function(e){return"point"===(e=e.clone()).type?(e.x<-this.tolerance&&(e.x+=360),e):(e.xmin<-this.tolerance&&(e.xmin+=360,e.xmax+=360),e)}}]),r}(Be);Object(p.a)([Object(x.a)({GCSShiftXform:"gcs-shift"})],mt.prototype,"type",void 0),Object(p.a)([Object(w.b)()],mt.prototype,"tolerance",void 0);var vt=mt=Object(p.a)([Object(k.a)("esri.layers.support.rasterTransforms.GCSShiftTransform")],mt),bt=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._levelOffset=0,e._slices=null,e._tilemapCache=null,e.datasetFormat="RasterTileServer",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l,u,c,f,h,p,d,m,g,y,w,O,j,x,I,k,M;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:if(r=t&&t.signal,!this.sourceJSON){e.next=7;break}e.t0={data:this.sourceJSON},e.next=10;break;case 7:return e.next=9,this.request(this.url,{query:{f:"json"},signal:r});case 9:e.t0=e.sent;case 10:if((n=e.t0).ssl&&(this.url=this.url.replace(/^http:/i,"https:")),i=n.data,this.sourceJSON=i,i){e.next=15;break}throw new v.a("imageserverraster:open","cannot initialize tiled image service, missing service info");case 15:if(i.tileInfo){e.next=17;break}throw new v.a("imageserverraster:open","use ImageryLayer to open non-tiled image services");case 17:return this._fixScaleInServiceInfo(),o=["jpg","jpeg","png","png8","png24","png32","mixed"],this.tileType=i.cacheType,null==this.tileType&&(o.indexOf(i.tileInfo.format.toLowerCase())>-1?this.tileType="Map":"lerc"===i.tileInfo.format.toLowerCase()?this.tileType="Elevation":this.tileType="Raster"),this.datasetName=i.name.slice(i.name.indexOf("/")+1),e.next=22,this._fetchRasterInfo({signal:r});case 22:if(s=e.sent,Object(b.j)(s)){e.next=25;break}throw new v.a("image-server-raster:open","cannot initialize image service");case 25:l="Map"===this.tileType?Object(pt.a)(i.tileInfo,i):L.a.fromJSON(i.tileInfo),u=s.extent,c=s.pixelSize,f=.5/s.width*c.x,d=l.lodAt(Math.max.apply(null,l.lods.map((function(e){return e.level})))),"Map"!==this.tileType&&0!==i.maxScale&&("Raster"===this.tileType?(h=l.lods.filter((function(e){return e.resolution===c.x}))[0],h||(h=l.lods[l.lods.length-1])):(h=l.lods.filter((function(e){return Math.abs(e.scale-i.maxScale)<f}))[0],h||(h=l.lods.filter((function(e){return e.scale>i.maxScale})).sort((function(e,t){return e.scale>t.scale?1:-1}))[0])),c.x=c.y=h.resolution,s.width=Math.ceil((u.xmax-u.xmin)/c.x-.1),s.height=Math.ceil((u.ymax-u.ymin)/c.y-.1)),h||(h=d),m=l.lodAt(Math.min.apply(null,l.lods.map((function(e){return e.level})))),"Map"===this.tileType?this._levelOffset=l.lods[0].level:0!==i.minScale&&"Elevation"===this.tileType&&(p=l.lods.filter((function(e){return Math.abs(e.scale-i.minScale)<f}))[0],this._levelOffset=p.level-m.level),p||(p=m),g=Math.max(c.x,c.y),(Math.abs(c.x-c.y)>f||!l.lods.some((function(e){return Math.abs(e.resolution-g)<f})))&&(c.x=c.y=h.resolution,s.width=Math.ceil((u.xmax-u.xmin)/c.x-.1),s.height=Math.ceil((u.ymax-u.ymin)/c.y-.1)),y=h.level-p.level,w=Object(K.a)(l.size,2),O=w[0],j=w[1],x=[],l.lods.forEach((function(e){e.level>=p.level&&e.level<=h.level&&x.push({x:e.resolution,y:e.resolution})})),x.sort((function(e,t){return e.x-t.x})),I=this.computeBlockBoundary(u,O,j,l.origin,x,y),k=x.length>1?x.slice(1):null,s.storageInfo=new Y.a({blockWidth:l.size[0],blockHeight:l.size[1],pyramidBlockWidth:l.size[0],pyramidBlockHeight:l.size[1],pyramidResolutions:k,compression:l.format,origin:l.origin,firstPyramidLevel:1,maximumPyramidLevel:y,tileInfo:l,blockBoundary:I}),this._fixGCSShift(s),this._set("rasterInfo",s),i.capabilities.toLowerCase().indexOf("tilemap")>-1&&(M={tileInfo:s.storageInfo.tileInfo,parsedUrl:Object(ht.J)(this.url),url:this.url,tileServers:[],type:"tile"},this._tilemapCache=new dt.a({layer:M}));case 37:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n){var i,o,s,l,u,c,f,h,p,d,m,v,b,g,y,w,O,j,x,I,k,M,S,T,C,A=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=A.length>3&&void 0!==A[3]?A[3]:{},o=this.rasterInfo,s=o.storageInfo,l=o.extent,u=s.maximumPyramidLevel-t+this._levelOffset,c="".concat(this.url,"/tile/").concat(u,"/").concat(r,"/").concat(n),f=this._slices?{sliceId:i.sliceId||0}:null,e.next=9,this.request(c,{query:f,responseType:"array-buffer",signal:i.signal});case 9:if(h=e.sent,p=h.data){e.next=13;break}return e.abrupt("return",null);case 13:return e.next=15,this.decodePixelBlock(p,{width:s.tileInfo.size[0],height:s.tileInfo.size[1],planes:null,pixelType:null,isPoint:"Elevation"===this.tileType});case 15:if(d=e.sent,m=s.blockBoundary[t],!("jpg"!==s.compression||n>m.minCol&&n<m.maxCol&&r>m.minRow&&r<m.maxRow)){e.next=19;break}return e.abrupt("return",d);case 19:return v=s.origin,b=s.blockWidth,g=s.blockHeight,y=this.getPyramidPixelSize(t),w=y.x,O=y.y,j=Math.round((l.xmin-v.x)/w)%b,x=Math.round((l.xmax-v.x)/w)%b,I=Math.round((v.y-l.ymax)/O)%g,k=Math.round((v.y-l.ymin)/O)%g,M=n===m.minCol?j:0,S=r===m.minRow?I:0,T=n===m.maxCol?x:b,C=r===m.maxRow?k:g,e.abrupt("return",(Object(_e.m)(d,{x:M,y:S},{width:T-M,height:C-S}),d));case 21:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getSliceIndex",value:function(e){if(null==e||!e.length||!this._slices)return null;for(var t=e,r=0;r<this._slices.length;r++){var n=this._slices[r].multidimensionalDefinition;if(n.length===t.length&&!n.some((function(e){var r=t.filter((function(t){return e.variableName===t.variableName&&t.dimensionName===e.dimensionName}))[0];return!r||(Array.isArray(e.values[0])?e.values[0][0]:e.values[0])!==(Array.isArray(r.values[0])?r.values[0][0]:r.values[0])})))return r}return null}},{key:"fetchVariableStatisticsHistograms",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r){var n,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.request(this.url+"/statistics",{query:{variable:t,f:"json"},signal:r}).then((function(e){var t;return null==(t=e.data)?void 0:t.statistics})),i=this.request(this.url+"/histograms",{query:{variable:t,f:"json"},signal:r}).then((function(e){var t;return null==(t=e.data)?void 0:t.histograms})),e.next=4,Promise.all([n,i]);case 4:return o=e.sent,e.abrupt("return",(o[0]&&o[0].forEach((function(e){e.avg=e.mean,e.stddev=e.standardDeviation})),{statistics:o[0]||null,histograms:o[1]||null}));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"computeBestPyramidLevelForLocation",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l,u=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:{},this._tilemapCache){e.next=3;break}return e.abrupt("return",0);case 3:if(null!==(n=this.identifyPixelLocation(t,0,Object(b.q)(r.datumTransformation)))){e.next=6;break}return e.abrupt("return",null);case 6:i=0,o=this.rasterInfo.storageInfo.maximumPyramidLevel,s=o-i+this._levelOffset,l=n.srcLocation;case 10:if(!(s>=0)){e.next=25;break}return e.prev=11,e.next=14,this._tilemapCache.fetchAvailability(s,n.row,n.col,r);case 14:if(e.t0=e.sent,"available"!==e.t0){e.next=17;break}return e.abrupt("break",25);case 17:e.next=21;break;case 19:e.prev=19,e.t1=e.catch(11);case 21:if(s--,i++,null!==(n=this.identifyPixelLocation(l,i,Object(b.q)(r.datumTransformation)))){e.next=23;break}return e.abrupt("return",null);case 23:e.next=10;break;case 25:return e.abrupt("return",-1===s||null==n?null:i);case 26:case"end":return e.stop()}}),e,this,[[11,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchRasterInfo",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l,u,c,f,h,p,d,m=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.sourceJSON,n=Math.ceil((r.extent.xmax-r.extent.xmin)/r.pixelSizeX-.1),i=Math.ceil((r.extent.ymax-r.extent.ymin)/r.pixelSizeY-.1),o=G.a.fromJSON(r.spatialReference||r.extent.spatialReference),"Map"!==this.tileType){e.next=3;break}return e.abrupt("return",new X.a({width:n,height:i,bandCount:3,extent:z.a.fromJSON(r.extent),spatialReference:o,pixelSize:new ie.a({x:r.pixelSizeX,y:r.pixelSizeY,spatialReference:o}),pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}}));case 3:return s=t.slice,l=t.signal,u=!!r.hasRasterAttributeTable&&this.request(this.url+"/rasterAttributeTable",{query:{slice:s,f:"json"},signal:l}).then((function(e){return qe.default.fromJSON(e.data)})).catch((function(){return null})),c=!!r.hasColormap&&this.request(this.url+"/colormap",{query:{slice:s,f:"json"},signal:l}).then((function(e){var t;return null==(t=e.data)?void 0:t.colormap})),f=!!r.hasHistograms&&this.request(this.url+"/histograms",{query:{slice:s,f:"json"},signal:l}).then((function(e){var t;return null==(t=e.data)?void 0:t.histograms})),h=this.request(this.url+"/keyProperties",{query:{f:"json"},signal:l}).then((function(e){return e.data})).catch((function(){})),p=!!r.hasMultidimensions&&this._fetchMultidimensionalInfo(),d=!!r.hasMultidimensions&&this.request(this.url+"/slices",{query:{f:"json"},signal:l}).then((function(e){return e.data&&e.data.slices})).catch((function(){})),e.abrupt("return",Promise.all([u,c,f,h,p,d]).then((function(e){var t=null;if(r.minValues&&r.minValues.length===r.bandCount){t=[];for(var a=0;a<r.minValues.length;a++)t.push({min:r.minValues[a],max:r.maxValues[a],avg:r.meanValues[a],stddev:r.stdvValues[a]})}return m._slices=e[5]||null,new X.a({width:n,height:i,bandCount:r.bandCount,extent:z.a.fromJSON(r.extent),spatialReference:o,pixelSize:new ie.a({x:r.pixelSizeX,y:r.pixelSizeY,spatialReference:o}),pixelType:r.pixelType.toLowerCase(),statistics:t,attributeTable:e[0]||null,colormap:e[1]||null,histograms:e[2]||null,keyProperties:e[3]||{},multidimensionalInfo:e[4]||null})})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchMultidimensionalInfo",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request(this.url+"/multidimensionalInfo",{query:{f:"json"},signal:t}).then((function(e){var t;return null==(t=e.data)?void 0:t.multidimensionalInfo}));case 2:return n=e.sent,e.abrupt("return",(null!=(r=n.variables)&&r.length&&n.variables.forEach((function(e){var t;null!=(t=e.statistics)&&t.length&&e.statistics.forEach((function(e){e.avg=e.mean,e.stddev=e.standardDeviation}))})),n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fixScaleInServiceInfo",value:function(){var e=this.sourceJSON;e.minScale&&e.minScale<0&&(e.minScale=0),e.maxScale&&e.maxScale<0&&(e.maxScale=0)}},{key:"_fixGCSShift",value:function(e){var t=e.extent,r=e.spatialReference;0===t.xmin&&360===t.xmax&&r.wkid&&r.isGeographic&&(e.nativeExtent=e.extent,e.transform=new vt,e.extent=e.transform.forwardTransform(t))}}]),r}(De);Object(p.a)([Object(w.b)({type:String,json:{write:!0}})],bt.prototype,"datasetFormat",void 0),Object(p.a)([Object(w.b)()],bt.prototype,"tileType",void 0);var gt=bt=Object(p.a)([Object(k.a)("esri.layers.support.rasterDatasets.ImageServerRaster")],bt),yt=r(760),wt=r(823),Ot=new Map;Ot.set("Int8","s8"),Ot.set("UInt8","u8"),Ot.set("Int16","s16"),Ot.set("UInt16","u16"),Ot.set("Int32","s32"),Ot.set("UInt32","u32"),Ot.set("Float32","f32"),Ot.set("Float64","f32"),Ot.set("Double64","f32");var jt=new Map;jt.set("lerc",".lrc"),jt.set("none",".til"),jt.set("deflate",".pzp"),jt.set("jpeg",".jzp");var xt=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._files=null,e._storageIndex=null,e.datasetFormat="MRF",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l,u,c,f,h,p,d,m,v,g,y,w,O,j,x,I,k,M,S;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1),n=t?Object(b.q)(t.signal):null,e.next=6,this.request(this.url,{responseType:"xml",signal:n});case 6:if(i=e.sent,o=this._parseHeader(i.data),s=o.rasterInfo,l=o.files,-1!==(null==(r=this.ioConfig.skipExtensions)?void 0:r.indexOf("aux.xml"))){e.next=15;break}return e.next=13,this._fetchAuxiliaryData(t);case 13:null!=(u=e.sent)&&(s.statistics=null!=(c=u.statistics)?c:s.statistics,s.histograms=u.histograms,u.histograms&&!Object(b.j)(s.statistics)&&(s.statistics=Object(_e.f)(u.histograms)));case 15:return this._set("rasterInfo",s),this._files=l,e.next=18,this.request(l.index,{responseType:"array-buffer",signal:n});case 18:for(f=e.sent,this._storageIndex=this._parseIndex(f.data),d=0,m=-1,v=this.rasterInfo.storageInfo,g=v.blockWidth,y=v.blockHeight,w=v.compression,O=this.rasterInfo.storageInfo.pyramidScalingFactor,j=this.rasterInfo,x=j.width,I=j.height,k=j.bandCount,M=[],S="none"===w?1:k;d<this._storageIndex.length;)m++,h=Math.ceil(x/g/Math.pow(O,m)),p=Math.ceil(I/y/Math.pow(O,m)),d+=h*p*S*4,M.push({maxRow:p,maxCol:h,minCol:0,minRow:0});this.rasterInfo.storageInfo.blockBoundary=M,m>0&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=m),this.updateTileInfo();case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n){var i,o,s,l,u,c,f,h,p,d,m,v,b,g,y,w,O,j,x,I,k,M,S,T,C,A,_,P,D=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=D.length>3&&void 0!==D[3]?D[3]:{},o=this.rasterInfo.storageInfo,s=o.blockWidth,l=o.blockHeight,u=o.blockBoundary,c=o.compression,!(!(f=u[t])||f.maxRow<r||f.maxCol<n||f.minRow>r||f.minCol>n)){e.next=4;break}return e.abrupt("return",null);case 4:if(h=this.rasterInfo,p=h.bandCount,d=h.pixelType,m=this._getTileLocation(t,r,n),v=m.ranges,b=m.actualTileWidth,g=m.actualTileHeight,v&&0!==v.length){e.next=7;break}return e.abrupt("return",null);case 7:if(0!==v[0].from||0!==v[0].to){e.next=10;break}return y=new Uint8Array(s*l),e.abrupt("return",new yt.a({width:s,height:l,pixels:null,mask:y,validPixelCount:0}));case 10:for(w=this.ioConfig.bandIds,O="none"===c?1:p,j=[],x=0,x=0;x<O;x++)(!w||w.indexOf[x]>-1)&&j.push(this.request(this._files.data,{range:{from:v[x].from,to:v[x].to},responseType:"array-buffer",signal:i.signal}));return e.next=15,Promise.all(j);case 15:for(I=e.sent,k=I.map((function(e){return e.data.byteLength})).reduce((function(e,t){return e+t})),M=new Uint8Array(k),S=0,x=0;x<O;x++)M.set(new Uint8Array(I[x].data),S),S+=I[x].data.byteLength;return T="lerc"===this.rasterInfo.storageInfo.compression?"lerc":"bip",e.next=23,this.decodePixelBlock(M.buffer,{width:s,height:l,format:T,pixelType:d});case 23:if(C=e.sent,A=0,_=0,b!==s||g!==l)if(P=C.mask)for(x=0;x<l;x++)if(_=x*s,x<g)for(A=b;A<s;A++)P[_+A]=0;else for(A=0;A<s;A++)P[_+A]=0;else for(P=new Uint8Array(s*l),C.mask=P,x=0;x<g;x++)for(_=x*s,A=0;A<b;A++)P[_+A]=1;return e.abrupt("return",C);case 27:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_parseIndex",value:function(e){if(e.byteLength%16>0)throw"invalid array buffer must be multiples of 16";var t,r,n,a,i,o;if(wt.a){for(r=new Uint8Array(e),a=new ArrayBuffer(e.byteLength),n=new Uint8Array(a),i=0;i<e.byteLength/4;i++)for(o=0;o<4;o++)n[4*i+o]=r[4*i+3-o];t=new Uint32Array(a)}else t=new Uint32Array(e);return t}},{key:"_getTileLocation",value:function(e,t,r){var n,a,i,o=this.rasterInfo.storageInfo,s=o.blockWidth,l=o.blockHeight,u=o.pyramidScalingFactor,c=o.compression,f=this.rasterInfo,h=f.width,p=f.height,d=f.bandCount,m="none"===c?1:d,v=0,b=0;for(i=0;i<e;i++)b=Math.pow(u,i),v+=(n=Math.ceil(h/s/b))*(a=Math.ceil(p/l/b));b=Math.pow(u,e),n=Math.ceil(h/s/b),a=Math.ceil(p/l/b),v+=t*n+r,v*=4*m;for(var g=this._storageIndex.subarray(v,v+4*m),y=0,w=0,O=[],j=0;j<m;j++)w=(y=g[4*j+0]*Math.pow(2,32)+g[4*j+1])+g[4*j+2]*Math.pow(2,32)+g[4*j+3],O.push({from:y,to:w});return{ranges:O,actualTileWidth:r<n-1?s:Math.ceil(h/b)-s*(n-1),actualTileHeight:t<a-1?l:Math.ceil(p/b)-l*(a-1)}}},{key:"_parseHeader",value:function(e){var t=tt(e,"MRF_META/Raster");if(!t)throw new v.a("mrf:open","not a valid MRF format");var r=tt(t,"Size"),n=parseInt(r.getAttribute("x"),10),a=parseInt(r.getAttribute("y"),10),i=parseInt(r.getAttribute("c"),10),o=(rt(t,"Compression")||"none").toLowerCase();if(!o||-1===["none","lerc"].indexOf(o))throw new v.a("mrf:open","currently does not support compression "+o);var s=rt(t,"DataType")||"UInt8",l=Ot.get(s);if(null==l)throw new v.a("mrf:open","currently does not support pixel type "+s);var u,c,f=tt(t,"PageSize"),h=parseInt(f.getAttribute("x"),10),p=parseInt(f.getAttribute("y"),10),d=tt(t,"DataValues");if(d&&(null!=(c=d.getAttribute("NoData"))&&(u=c.trim().split(" ").map((function(e){return parseFloat(e)})))),tt(e,"MRF_META/CachedSource"))throw new v.a("mrf:open","currently does not support MRF referencing other data files");var m=tt(e,"MRF_META/GeoTags"),b=tt(m,"BoundingBox");if(null==b)throw new v.a("mrf:open","missing node MRF_META/GeoTags/BoundingBox");var g,y=parseFloat(b.getAttribute("minx")),w=parseFloat(b.getAttribute("miny")),O=parseFloat(b.getAttribute("maxx")),j=parseFloat(b.getAttribute("maxy")),x=rt(m,"Projection")||"",I=rt(e,"datafile"),k=rt(e,"IndexFile");if("LOCAL_CS[]"!==x)if(x.toLowerCase().startsWith("epsg:")){var M=Number(x.slice(5));isNaN(M)||0===M||(g=new G.a({wkid:M}))}else g=st(x);var S=new z.a(y,w,O,j);S.spatialReference=g;var T=tt(e,"MRF_META/Rsets"),C=parseInt(T&&T.getAttribute("scale")||"2",10),A=new Y.a({origin:new ie.a({x:S.xmin,y:S.ymax,spatialReference:g}),blockWidth:h,blockHeight:p,pyramidBlockWidth:h,pyramidBlockHeight:p,compression:o,pyramidScalingFactor:C}),_=new ie.a({x:(O-y)/n,y:(j-w)/a,spatialReference:g});return{rasterInfo:new X.a({width:n,height:a,extent:S,spatialReference:g,bandCount:i,pixelType:l,pixelSize:_,noDataValue:u,storageInfo:A}),files:{mrf:this.url,index:k||this.url.replace(".mrf",".idx"),data:I||this.url.replace(".mrf",jt.get(o))}}}},{key:"_fetchAuxiliaryData",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request(this.url+".aux.xml",{responseType:"xml",signal:null==t?void 0:t.signal});case 3:return r=e.sent,n=r.data,e.abrupt("return",ut(n));case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(De);Object(p.a)([Object(w.b)()],xt.prototype,"_files",void 0),Object(p.a)([Object(w.b)()],xt.prototype,"_storageIndex",void 0),Object(p.a)([Object(w.b)({type:String,json:{write:!0}})],xt.prototype,"datasetFormat",void 0);var It=xt=Object(p.a)([Object(k.a)("esri.layers.support.rasterIO.MRFRaster")],xt),kt=r(880),Mt=r(867),St=function(e,t){var r=e.get(t);return r&&r.values},Tt=function(e,t){var r=e.get(t);return r&&r.values[0]},Ct=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._files=null,e._headerInfo=null,e._bufferSize=1048576,e.datasetFormat="TIFF",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,s,l,u,c,f,h,p,d,m,g,y,w,O,j,x,I,k,M,S,T,C,A,_,P,D,R,E,L,N,B,U,F,H,V,J;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return s=t?Object(b.q)(t.signal):null,e.next=5,this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:s});case 5:if(l=e.sent,u=l.data){e.next=9;break}throw new v.a("tiffraster:open","failed to open url "+this.url);case 9:return this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1),c=Object(kt.h)(u),f=c.littleEndian,h=c.firstIFD,p=c.isBigTiff,d=[],e.next=13,this.readIFDs(d,u,f,h,0,p?8:4,s);case 13:if(m=Object(kt.f)(d),g=m.width,y=m.height,w=m.tileWidth,O=m.tileHeight,j=m.planes,x=m.pixelType,I=m.compression,k=m.firstPyramidLevel,M=m.maximumPyramidLevel,S=m.pyramidBlockWidth,T=m.pyramidBlockHeight,C=m.tileBoundary,A=m.affine,_=m.metadata,P=(null==(r=m.extent.spatialReference)?void 0:r.wkt)||(null==(n=m.extent.spatialReference)?void 0:n.wkid),D=st(P),R=!1,null==D&&(R=!0,D=new G.a({wkid:3857})),E=new z.a(Object(o.a)(Object(o.a)({},m.extent),{},{spatialReference:D})),L=new ie.a(E?{x:E.xmin,y:E.ymax,spatialReference:D}:{x:0,y:0}),N=new Y.a({blockWidth:w,blockHeight:O,pyramidBlockWidth:S,pyramidBlockHeight:T,compression:I,origin:L,firstPyramidLevel:k,maximumPyramidLevel:M,blockBoundary:C}),B=new ie.a({x:(E.xmax-E.xmin)/g,y:(E.ymax-E.ymin)/y,spatialReference:D}),U=_?{BandProperties:_.bandProperties,DataType:_.dataType}:{},F=new X.a({width:g,height:y,bandCount:j,pixelType:x,compression:I,pixelSize:B,storageInfo:N,spatialReference:D,isPseudoSpatialReference:R,keyProperties:U,extent:E,statistics:_?_.statistics:null}),null!=A&&A.length&&(F.nativeExtent=new z.a({xmin:-.5,ymin:.5-y,xmax:g-.5,ymax:.5,spatialReference:D}),F.transform=new Je({polynomialOrder:1,forwardCoefficients:[A[2]+A[0]/2,A[5]-A[3]/2,A[0],A[3],-A[1],-A[4]]}),F.extent=F.transform.forwardTransform(F.nativeExtent),F.pixelSize=new ie.a({x:(E.xmax-E.xmin)/g,y:(E.ymax-E.ymin)/y,spatialReference:D}),N.origin.x=-.5,N.origin.y=.5),null!=(i=this.ioConfig.skipExtensions)&&i.includes("aux.xml")){e.next=22;break}return e.next=20,this._fetchAuxiliaryData(t);case 20:null!=(H=e.sent)&&(F.statistics=null!=(V=H.statistics)?V:F.statistics,F.histograms=H.histograms,H.histograms&&!Object(b.j)(F.statistics)&&(F.statistics=Object(_e.f)(H.histograms)),H.transform&&!A&&(F.transform=H.transform,F.nativeExtent=F.extent,J=F.transform.forwardTransform(F.nativeExtent),F.pixelSize=new ie.a({x:(J.xmax-J.xmin)/g,y:(J.ymax-J.ymin)/y,spatialReference:D}),F.extent=J),F.spatialReference||(F.spatialReference=H.spatialReference));case 22:if(this._set("rasterInfo",F),this._headerInfo=Object(o.a)({littleEndian:f,isBigTiff:p,ifds:d},m),this._headerInfo.isSupported){e.next=24;break}throw new v.a("tiffraster:open","this tiff is not supported: "+this._headerInfo.message);case 24:this.updateTileInfo();case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n){var i,o,s,l,u,c,f,h,p,d,m,v,b,g,y,w,O,j,x,I,k,M,S,T,C,A=this,_=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=_.length>3&&void 0!==_[3]?_[3]:{},null!=(o=this._headerInfo)&&o.isSupported&&!this.isBlockOutside(t,r,n)){e.next=3;break}return e.abrupt("return",null);case 3:if(s=this.getTileLocation(t,r,n)){e.next=6;break}return e.abrupt("return",null);case 6:return l=s.ranges,u=s.actualTileWidth,c=s.actualTileHeight,f=s.ifd,h=l.map((function(e){return A.request(A.url,{range:e,responseType:"array-buffer",signal:i.signal})})),e.next=13,Promise.all(h);case 13:if(p=e.sent,d=p.map((function(e){return e.data.byteLength})).reduce((function(e,t){return e+t})),m=1===p.length?p[0].data:new ArrayBuffer(d),v=[0],b=[0],p.length>1)for(g=new Uint8Array(m),y=0,w=0;y<p.length;y++)O=p[y].data,g.set(new Uint8Array(O),w),v[y]=w,w+=O.byteLength,b[y]=O.byteLength;return j=this.getBlockWidthHeight(t),x=j.blockWidth,I=j.blockHeight,e.next=24,this.decodePixelBlock(m,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:f,offsets:v,sizes:b},width:x,height:I,planes:null,pixelType:null});case 24:if(k=e.sent,u!==x||c!==I)if(C=k.mask)for(M=0;M<I;M++)if(T=M*x,M<c)for(S=u;S<x;S++)C[T+S]=0;else for(S=0;S<x;S++)C[T+S]=0;else for(C=new Uint8Array(x*I),k.mask=C,M=0;M<c;M++)for(T=M*x,S=0;S<u;S++)C[T+S]=1;return e.abrupt("return",k);case 27:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"readIFDs",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n,i,o){var s,l,u,c=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=c.length>5&&void 0!==c[5]?c[5]:4,l=c.length>6?c[6]:void 0,i){e.next=4;break}return e.abrupt("return",null);case 4:if(!(i>=r.byteLength||i<0)){e.next=10;break}return e.next=7,this.request(this.url,{range:{from:i+o,to:i+o+this._bufferSize},responseType:"array-buffer",signal:l});case 7:r=e.sent.data,o=i+o,i=0;case 10:return e.next=12,this.readIFD(r,n,i,o,Mt.a.TIFF_TAGS,s,l);case 12:if(u=e.sent,t.push(u.ifd),u.nextIFD){e.next=15;break}return e.abrupt("return",null);case 15:return e.next=17,this.readIFDs(t,r,n,u.nextIFD-o,o,s,l);case 17:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"readIFD",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n,i){var o,s,l,u,c,f,h,p,d,m,v,b,g,y,w=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=w.length>4&&void 0!==w[4]?w[4]:Mt.a.TIFF_TAGS,s=w.length>5&&void 0!==w[5]?w[5]:4,l=w.length>6?w[6]:void 0,t){e.next=5;break}return e.abrupt("return",null);case 5:if(!(u=Object(kt.c)(t,r,n,i,o,s)).success){e.next=25;break}if(c=[],u.ifd.forEach((function(e){e.values||c.push(e)})),!(c.length>0)){e.next=16;break}if(f=c.map((function(e){return e.offlineOffsetSize})),h=Math.min.apply(null,f.map((function(e){return e[0]}))),!(Math.min.apply(null,f.map((function(e){return e[0]+e[1]})))-h<=this._bufferSize)){e.next=16;break}return e.next=13,this.request(this.url,{range:{from:h,to:h+this._bufferSize},responseType:"array-buffer",signal:l});case 13:p=e.sent,d=p.data,t=d,i=h,c.forEach((function(e){return Object(kt.d)(t,r,e,i)}));case 16:if(!u.ifd.has("GEOKEYDIRECTORY")){e.next=24;break}if(m=u.ifd.get("GEOKEYDIRECTORY"),!((v=m.values)&&v.length>4)){e.next=24;break}return b=v[0]+"."+v[1]+"."+v[2],e.next=22,this.readIFD(t,r,m.valueOffset+6-i,i,Mt.a.GEO_KEYS,2,l);case 22:g=e.sent,m.data=g.ifd,m.data&&m.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[b]});case 24:return e.abrupt("return",u);case 25:if(!u.requiredBufferSize||u.requiredBufferSize===t.byteLength){e.next=30;break}return e.next=28,this.request(this.url,{range:{from:i,to:i+u.requiredBufferSize+4},responseType:"array-buffer",signal:l});case 28:return y=e.sent,e.abrupt("return",(t=y.data).byteLength<u.requiredBufferSize?null:this.readIFD(t,r,0,i,Mt.a.TIFF_TAGS,4,l));case 30:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"getTileLocation",value:function(e,t,r){var n=this.rasterInfo.storageInfo,a=n.firstPyramidLevel,i=n.blockBoundary,o=0===e?0:e-(a-1),s=this._headerInfo.ifds[o];if(!s)return null;var l=Object(kt.g)(s,this._headerInfo),u=St(s,"TILEOFFSETS");if(void 0===u)return null;var c=St(s,"TILEBYTECOUNTS"),f=i[o],h=f.minRow,p=f.minCol,d=f.maxRow,m=f.maxCol;if(t>d||r>m||t<h||r<p)return null;var v=Tt(s,"IMAGEWIDTH"),b=Tt(s,"IMAGELENGTH"),g=Tt(s,"TILEWIDTH"),y=Tt(s,"TILELENGTH"),w=l?this.rasterInfo.bandCount:1,O=w*t*(m+1)+r,j=[{from:u[O],to:u[O+w-1]+c[O+w-1]-1}];if(l){for(var x=!0,I=0;I<w;I++)if(u[O+I]+c[O+I]!==u[O+I+1]){x=!1;break}if(!x)for(var k=0;k<w;k++)j[k]={from:u[O+k],to:u[O+k]+c[O+k]-1}}var M=u[O],S=c[O];return null==M||null==S?null:{ranges:j,ifd:s,actualTileWidth:r===m?v%g:g,actualTileHeight:t===d?b%y:y}}},{key:"_fetchAuxiliaryData",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request(this.url+".aux.xml",{responseType:"xml",signal:null==t?void 0:t.signal});case 3:return r=e.sent,n=r.data,e.abrupt("return",ut(n));case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(De);Object(p.a)([Object(w.b)()],Ct.prototype,"_files",void 0),Object(p.a)([Object(w.b)()],Ct.prototype,"_headerInfo",void 0),Object(p.a)([Object(w.b)()],Ct.prototype,"_bufferSize",void 0),Object(p.a)([Object(w.b)({type:String,json:{write:!0}})],Ct.prototype,"datasetFormat",void 0);var At=Ct=Object(p.a)([Object(k.a)("esri.layers.support.rasterDatasets.TIFFRaster")],Ct),_t=new Map;_t.set("CRF",{desc:"Cloud Raster Format",constructor:Ke}),_t.set("MRF",{desc:"Meta Raster Format",constructor:It}),_t.set("TIFF",{desc:"GeoTIFF",constructor:At}),_t.set("RasterTileServer",{desc:"Raster Tile Server",constructor:gt}),_t.set("JPG",{desc:"JPG Raster Format",constructor:ft}),_t.set("PNG",{desc:"PNG Raster Format",constructor:ft}),_t.set("GIF",{desc:"GIF Raster Format",constructor:ft}),_t.set("BMP",{desc:"BMP Raster Format",constructor:ft});var Pt=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"supportedFormats",get:function(){var e=new Set;return _t.forEach((function(t,r){return e.add(r)})),e}},{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l,u,c,f,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,n=t.ioConfig,i=t.sourceJSON,null==(o=t.datasetFormat)&&r.lastIndexOf(".")&&(o=r.slice(r.lastIndexOf(".")+1).toUpperCase()),"OVR"===o||"TIF"===o?o="TIFF":"JPG"!==o&&"JPEG"!==o&&"JFIF"!==o||(o="JPG"),r.toLowerCase().indexOf("/imageserver")>-1&&-1===r.toLowerCase().indexOf("/wcsserver")&&(o="RasterTileServer"),s={url:r,sourceJSON:i,datasetFormat:o,ioConfig:n||{bandIds:null,sampling:null}},!this.supportedFormats.has(o)){e.next=10;break}return l=_t.get(o).constructor,u=new l(s),e.next=9,u.open({signal:t.signal});case 9:return e.abrupt("return",u);case 10:if(!o){e.next=12;break}throw new v.a("rasterfactory:open","not a supported format "+o);case 12:return c=Array.from(_t.keys()),f=0,h=function e(){return(o=c[f++])?(l=_t.get(o).constructor,(u=new l(s)).open({signal:t.signal}).then((function(){return u})).catch((function(){return e()}))):null},e.abrupt("return",h());case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(e,t,r){_t.has(e.toUpperCase())||_t.set(e.toUpperCase(),{desc:t,constructor:r})}}]),e}(),Dt=r(755),Rt=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;Object(s.a)(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).bandIds=null,e.interpolation=null,e.legendEnabled=!0,e.isReference=null,e.listMode="show",e.sourceJSON=null,e.version=null,e.title=null,e.type="imagery-tile",e.operationalLayerType="ArcGISTiledImageServiceLayer",e.popupEnabled=!0,e.popupTemplate=null,e.fields=null,e}return Object(l.a)(r,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?Object(o.a)({url:e},t):e}},{key:"load",value:function(e){var t=this,r=Object(b.j)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},e).catch(y.u).then((function(){return t._openRaster(r)}))),Promise.resolve(this)}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"rasterFields",get:function(){var e,t,r=[new W.a({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"})],n=null==(e=this.rasterInfo)||null==(t=e.attributeTable)?void 0:t.fields;if(n){var a=n.filter((function(e){return"oid"!==e.type&&"value"!==e.name.toLowerCase()})).map((function(e){var t=e.clone();return t.name="Raster."+e.name,t}));r=r.concat(a)}var i=this.rasterInfo.dataType;if(("vector-magdir"===i||"vector-uv"===i)&&Object(b.j)(this.rasterInfo.multidimensionalInfo)){var o,s=null==(o=this.rasterInfo.multidimensionalInfo.variables[0].unit)?void 0:o.trim(),l="Magnitude"+(s?" (".concat(s,")"):"");r.push(new W.a({name:"Raster.Magnitude",alias:l,domain:null,editable:!1,type:"double"})),r.push(new W.a({name:"Raster.Direction",alias:"Direction (\xb0)",domain:null,editable:!1,type:"double"}))}return r}},{key:"renderer",set:function(e){this._set("renderer",e),this.updateRenderer()}},{key:"readRenderer",value:function(e,t,r){var n=t&&t.layerDefinition&&t.layerDefinition.drawingInfo&&t.layerDefinition.drawingInfo.renderer,a=Object(m.b)(n,r)||void 0;if(null!=a)return a}},{key:"createPopupTemplate",value:function(e){return Object(Dt.a)({fields:this.rasterFields,title:this.title},e)}},{key:"write",value:function(e,t){var n=this.raster;if(this.loaded?"RasterTileServer"===n.datasetFormat&&("Raster"===n.tileType||"Map"===n.tileType):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return Object(u.a)(Object(c.a)(r.prototype),"write",this).call(this,e,t);if(t&&t.messages){var a="".concat(t.origin,"/").concat(t.layerContainerType||"operational-layers");t.messages.push(new v.a("layer:unsupported","Layers (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' are not supported in the context of '").concat(a,"'"),{layer:this}))}return null}},{key:"_openRaster",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.raster){e.next=8;break}if(e.t0=this.raster.rasterInfo,e.t0){e.next=5;break}return e.next=5,this.raster.open();case 5:this.url=this.raster.url,e.next=11;break;case 8:return e.next=10,Pt.open({url:this.url,sourceJSON:this.sourceJSON,ioConfig:Object(o.a)(Object(o.a)({sampling:"closest"},this.ioConfig),{},{customFetchParameters:this.customParameters}),signal:t});case 10:this.raster=e.sent;case 11:if(this.raster.rasterInfo){e.next=14;break}throw new v.a("imagery-tile-layer:load","cannot load resources on "+this.url);case 14:this.sourceJSON=this.sourceJSON||this.raster.sourceJSON,null!=this.sourceJSON&&(this._set("version",this.sourceJSON.currentVersion),this._set("copyright",this.sourceJSON.copyrightText)),null==this.title&&(this.title=this.raster.datasetName),"Map"===this.raster.tileType&&(this.popupEnabled=!1),this._configDefaultSettings(),this.watch("customParameters",(function(e){return r.raster.ioConfig.customFetchParameters=e}));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(Object(S.a)(Object(Z.a)(Object(H.a)(Object(V.a)(Object(T.a)(function(e){var t=function(e){Object(f.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},e.bandIds=null,e.copyright=null,e.fullExtent=null,e.interpolation="nearest",e.raster=null,e.rasterInfo=null,e.sourceJSON=null,e.spatialReference=null,e.tileInfo=null,e.symbolizer=null,e}return Object(l.a)(r,[{key:"multidimensionalDefinition",set:function(e){this.raster&&(this._sliceId=this.raster.getSliceIndex(e)),this._set("multidimensionalDefinition",e)}},{key:"url",set:function(e){this._set("url",Object(P.g)(e,F))}},{key:"renderer",set:function(e){this._set("renderer",e),this.updateRenderer()}},{key:"convertVectorFieldData",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r){var n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(b.i)(t)){e.next=2;break}return e.abrupt("return",null);case 2:return n=this._rasterJobHandler.instance,i=this.rasterInfo.dataType,e.abrupt("return",n?n.convertVectorFieldData({pixelBlock:t,dataType:i},r):Object(N.a)(t,i));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateRenderer",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loaded){e.next=2;break}return e.abrupt("return");case 2:if(JSON.stringify(this._cachedRendererJson)!==JSON.stringify(this.renderer)){e.next=4;break}return e.abrupt("return");case 4:if(t=this._rasterJobHandler.instance,e.t0=t,!e.t0){e.next=12;break}return this.symbolizer.rendererJSON=Object(B.e)(this.renderer.toJSON()),this.symbolizer.bind(),e.next=11,t.updateSymbolizer(this.symbolizer);case 11:this._cachedRendererJson=this.renderer.toJSON();case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"applyRenderer",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r){var n,i,s,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t&&t.pixelBlock,Object(b.j)(n)&&n.pixels&&n.pixels.length>0){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this.updateRenderer();case 5:if(s=this._rasterJobHandler.instance,l=this.bandIds,!s){e.next=12;break}return e.next=9,s.symbolize(Object(o.a)(Object(o.a)({},t),{},{simpleStretchParams:r,bandIds:l}));case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=this.symbolizer.symbolize(Object(o.a)(Object(o.a)({},t),{},{simpleStretchParams:r,bandIds:l}));case 13:return i=e.t0,e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTileUrl",value:function(e,t,r){return"RasterTileServer"===this.raster.datasetFormat?"".concat(this.url,"/tile/").concat(e,"/").concat(t,"/").concat(r):""}},{key:"getCompatibleTileInfo",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.loaded)return null;if(r&&e.equals(this.spatialReference))return this.tileInfo;var n=Object(_.e)(e);return L.a.create({size:256,spatialReference:e,origin:n?{x:n.origin[0],y:n.origin[1]}:{x:t.xmin,y:t.ymax}})}},{key:"getCompatibleFullExtent",value:function(e){return this.loaded?(this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(e)||(this._compatibleFullExtent=this.raster.computeExtent(e)),this._compatibleFullExtent):null}},{key:"fetchTile",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n){var i,s,l,u,c=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=c.length>3&&void 0!==c[3]?c[3]:{}).requestAsImageElement){e.next=4;break}return s=this.getTileUrl(t,r,n),e.abrupt("return",Object(C.default)(s,{responseType:"image",query:Object(o.a)(Object(o.a)({sliceId:this._sliceId},this.refreshParameters),this.raster.ioConfig.customFetchParameters),signal:i.signal}).then((function(e){return e.data})));case 4:return e.next=6,this._initJobHandler();case 6:return l="raster-shaded-relief"===this.renderer.type?{cols:1,rows:1}:null,this.multidimensionalDefinition&&(u=this._sliceId,i=Object(o.a)({multidimensionalDefinition:this.multidimensionalDefinition,sliceId:u,buffer:l},i)),e.abrupt("return",this.raster.fetchTile(t,r,n,i));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"fetchPixels",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r,n,i){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initJobHandler();case 2:if(!this.multidimensionalDefinition){e.next=5;break}s=this._sliceId,i=Object(o.a)({multidimensionalDefinition:this.multidimensionalDefinition,sliceId:s},i);case 5:return e.abrupt("return",this.raster.fetchPixels(t,r,n,i));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"identify",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.multidimensionalDefinition&&!t.multidimensionalDefinition&&(t=Object(o.a)(Object(o.a)({},t),{},{multidimensionalDefinition:this.multidimensionalDefinition})),this.raster.identify(e,t)}},{key:"increaseRasterJobHandlerUsage",value:function(){this._rasterJobHandler.refCount++}},{key:"decreaseRasterJobHandlerUsage",value:function(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}},{key:"hasStandardTime",value:function(){var e,t=this.rasterInfo.multidimensionalInfo;if(!Object(b.j)(t)||"standard-time"!==this.rasterInfo.dataType)return!1;var r=null==(e=this.multidimensionalDefinition[0])?void 0:e.variableName;return t.variables.some((function(e){return e.name===r&&e.dimensions.some((function(e){return"StdTime"===e.name}))}))}},{key:"getStandardTimeValue",value:function(e){return new Date(24*(e-25569)*3600*1e3).toString()}},{key:"_configDefaultSettings",value:function(){this._configDefaultInterpolation(),this._configDefaultSlice(),this._configDefaultRenderer()}},{key:"_initJobHandler",value:function(){var e=this;if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;var t=new E.a;return this._rasterJobHandler.connectionPromise=t.initialize().then((function(){e._rasterJobHandler.instance=t,e.raster.rasterJobHandler=t,e.renderer&&e.updateRenderer()})).catch((function(){return null})),this._rasterJobHandler.connectionPromise}},{key:"_shutdownJobHandler",value:function(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0,this.raster.rasterJobHandler=null}},{key:"_configDefaultInterpolation",value:function(){if(null==this.interpolation){var e,t=Object(B.c)(this.rasterInfo,this.raster.tileType,null==(e=this.sourceJSON)?void 0:e.defaultResamplingMethod);this._set("interpolation",t)}}},{key:"_configDefaultSlice",value:function(){var e=this.raster.rasterInfo.multidimensionalInfo;if(Object(b.j)(e)){if(!this.multidimensionalDefinition){var t=e.variables[0],r=[];t.dimensions.forEach((function(e){r.push(new R.a({variableName:t.name,dimensionName:e.name,values:e.hasRegularIntervals?e.extent[0]:e.values[0],isSlice:!0}))})),this.multidimensionalDefinition=r}this._sliceId=this.raster.getSliceIndex(this.multidimensionalDefinition)}}},{key:"_configDefaultRenderer",value:function(){var e,t,r=this.raster.rasterInfo;this.bandIds||(this.bandIds=Object(B.b)(r)),this.renderer||(this.renderer=Object(B.a)(r,{bandIds:this.bandIds,variableName:null==(e=this.multidimensionalDefinition)||null==(t=e[0])?void 0:t.variableName})),this.symbolizer?(this.symbolizer.rendererJSON=Object(B.e)(this.renderer.toJSON()),this.symbolizer.rasterInfo=r):this.symbolizer=new U.a({rendererJSON:this.renderer.toJSON(),rasterInfo:r}),this.symbolizer.bind()||F.warn("imagery-tile-mixin","The given renderer is not supported by the layer.")}}]),r}(e);return Object(p.a)([Object(w.b)()],t.prototype,"_cachedRendererJson",void 0),Object(p.a)([Object(w.b)()],t.prototype,"_sliceId",void 0),Object(p.a)([Object(w.b)()],t.prototype,"_compatibleFullExtent",void 0),Object(p.a)([Object(w.b)()],t.prototype,"_rasterJobHandler",void 0),Object(p.a)([Object(w.b)()],t.prototype,"bandIds",void 0),Object(p.a)([Object(w.b)()],t.prototype,"copyright",void 0),Object(p.a)([Object(w.b)({type:z.a}),Object(A.a)("rasterInfo.extent")],t.prototype,"fullExtent",void 0),Object(p.a)([Object(w.b)()],t.prototype,"interpolation",void 0),Object(p.a)([Object(w.b)()],t.prototype,"ioConfig",void 0),Object(p.a)([Object(w.b)({type:[R.a]})],t.prototype,"multidimensionalDefinition",null),Object(p.a)([Object(w.b)()],t.prototype,"raster",void 0),Object(p.a)([Object(w.b)({readOnly:!0}),Object(A.a)("raster.rasterInfo")],t.prototype,"rasterInfo",void 0),Object(p.a)([Object(w.b)()],t.prototype,"sourceJSON",void 0),Object(p.a)([Object(w.b)({type:G.a}),Object(A.a)("rasterInfo.spatialReference")],t.prototype,"spatialReference",void 0),Object(p.a)([Object(w.b)({type:L.a}),Object(A.a)("rasterInfo.storageInfo.tileInfo")],t.prototype,"tileInfo",void 0),Object(p.a)([Object(w.b)(D.n)],t.prototype,"url",null),Object(p.a)([Object(w.b)({types:m.a})],t.prototype,"renderer",null),Object(p.a)([Object(w.b)()],t.prototype,"symbolizer",void 0),t=Object(p.a)([Object(k.a)("esri.layers.ImageryTileMixin")],t),t}(Object(J.a)(Object(g.a)(M.a)))))))));Object(p.a)([Object(w.b)({type:[O.a],json:{write:{overridePolicy:function(){var e;return{enabled:!this.loaded||"Raster"===this.raster.tileType||"0,1,2"!==(null==(e=this.bandIds)?void 0:e.join(","))}}}}})],Rt.prototype,"bandIds",void 0),Object(p.a)([Object(w.b)({json:{write:{overridePolicy:function(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"bilinear"!==this.interpolation}}}}}),Object(x.a)(q.a)],Rt.prototype,"interpolation",void 0),Object(p.a)([Object(w.b)({json:{write:!0}})],Rt.prototype,"multidimensionalDefinition",void 0),Object(p.a)([Object(w.b)(D.e)],Rt.prototype,"legendEnabled",void 0),Object(p.a)([Object(w.b)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],Rt.prototype,"isReference",void 0),Object(p.a)([Object(w.b)({type:["show","hide"]})],Rt.prototype,"listMode",void 0),Object(p.a)([Object(w.b)()],Rt.prototype,"sourceJSON",void 0),Object(p.a)([Object(w.b)({readOnly:!0})],Rt.prototype,"version",void 0),Object(p.a)([Object(w.b)()],Rt.prototype,"title",void 0),Object(p.a)([Object(w.b)({readOnly:!0,json:{read:!1}})],Rt.prototype,"type",void 0),Object(p.a)([Object(w.b)({type:["ArcGISTiledImageServiceLayer"]})],Rt.prototype,"operationalLayerType",void 0),Object(p.a)([Object(w.b)({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:function(e,t){return!t.disablePopup}},write:{target:"disablePopup",overridePolicy:function(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}},writer:function(e,t,r){t[r]=!e}}}})],Rt.prototype,"popupEnabled",void 0),Object(p.a)([Object(w.b)({type:d.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:function(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}}}}})],Rt.prototype,"popupTemplate",void 0),Object(p.a)([Object(w.b)({readOnly:!0})],Rt.prototype,"defaultPopupTemplate",null),Object(p.a)([Object(w.b)({readOnly:!0,type:[W.a]})],Rt.prototype,"fields",void 0),Object(p.a)([Object(w.b)({readOnly:!0,type:[W.a]})],Rt.prototype,"rasterFields",null),Object(p.a)([Object(w.b)({types:m.a,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:function(){var e,t="raster-stretch"===(null==(e=this.renderer)?void 0:e.type)&&"none"===this.renderer.stretchType&&!this.renderer.useGamma;return{enabled:!this.loaded||"Raster"===this.raster.tileType||!t}}},origins:{"web-scene":{types:m.c,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:function(e){return{enabled:e&&"vector-field"!==e.type}}}}}}})],Rt.prototype,"renderer",null),Object(p.a)([Object(I.a)("renderer")],Rt.prototype,"readRenderer",null);var Et=Rt=Object(p.a)([Object(k.a)("esri.layers.ImageryTileLayer")],Rt)},660:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(2),a=r(5),i=r(6),o=r(0),s=r(42),l=r(26),u=r(1),c=(r(19),r(14),r(15),r(31)),f=r(10),h=new s.a({inherited:"inherited",codedValue:"coded-value",range:"range"}),p=function(e){Object(a.a)(r,e);var t=Object(i.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).name=null,a.type=null,a}return r}(l.a);Object(o.a)([Object(u.b)({type:String,json:{write:!0}})],p.prototype,"name",void 0),Object(o.a)([Object(c.a)(h)],p.prototype,"type",void 0);var d=p=Object(o.a)([Object(f.a)("esri.layers.support.Domain")],p)},661:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,a=r(2),i=r(4),o=r(5),s=r(6),l=r(0),u=(r(1),r(19),r(14),r(15),r(31)),c=r(10),f=r(660),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).type="inherited",n}return Object(i.a)(r,[{key:"clone",value:function(){return new n}}]),r}(f.a);Object(l.a)([Object(u.a)({inherited:"inherited"})],h.prototype,"type",void 0);var p=h=n=Object(l.a)([Object(c.a)("esri.layers.support.InheritedDomain")],h)},662:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,a=r(2),i=r(4),o=r(5),s=r(6),l=r(0),u=r(1),c=(r(19),r(14),r(15),r(31)),f=r(10),h=r(660),p=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).maxValue=null,n.minValue=null,n.type="range",n}return Object(i.a)(r,[{key:"clone",value:function(){return new n({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}}]),r}(h.a);Object(l.a)([Object(u.b)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(e,t,r){t[r]=[this.minValue||0,e]}}}})],p.prototype,"maxValue",void 0),Object(l.a)([Object(u.b)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,r){t[r]=[e,this.maxValue||0]}}}})],p.prototype,"minValue",void 0),Object(l.a)([Object(c.a)({range:"range"})],p.prototype,"type",void 0);var d=p=n=Object(l.a)([Object(f.a)("esri.layers.support.RangeDomain")],p)},664:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,a=r(2),i=r(4),o=r(5),s=r(6),l=r(0),u=r(18),c=r(1),f=(r(14),r(19),r(15),r(31)),h=r(10),p=r(26),d=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).name=null,n.code=null,n}return Object(i.a)(r,[{key:"clone",value:function(){return new n({name:this.name,code:this.code})}}]),r}(p.a);Object(l.a)([Object(c.b)({type:String,json:{write:!0}})],d.prototype,"name",void 0),Object(l.a)([Object(c.b)({type:[String,Number],json:{write:!0}})],d.prototype,"code",void 0);var m,v=d=n=Object(l.a)([Object(h.a)("esri.layers.support.CodedValue")],d),b=r(660),g=m=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).codedValues=null,n.type="coded-value",n}return Object(i.a)(r,[{key:"getName",value:function(e){var t=null;if(this.codedValues){var r=String(e);this.codedValues.some((function(e){return String(e.code)===r&&(t=e.name),!!t}))}return t}},{key:"clone",value:function(){return new m({codedValues:Object(u.a)(this.codedValues),name:this.name})}}]),r}(b.a);Object(l.a)([Object(c.b)({type:[v],json:{write:!0}})],g.prototype,"codedValues",void 0),Object(l.a)([Object(f.a)({codedValue:"coded-value"})],g.prototype,"type",void 0);var y=g=m=Object(l.a)([Object(h.a)("esri.layers.support.CodedValueDomain")],g)},666:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n,a=r(2),i=r(4),o=r(5),s=r(6),l=r(0),u=r(42),c=r(26),f=r(1),h=(r(19),r(14)),p=(r(15),r(31)),d=r(57),m=r(10),v=r(679),b=r(690),g=new u.a({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"}),y=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).alias=null,n.defaultValue=void 0,n.description=null,n.domain=null,n.editable=!0,n.length=-1,n.name=null,n.nullable=!0,n.type=null,n.valueType=null,n}return Object(i.a)(r,[{key:"readDescription",value:function(e,t){var r,n=t.description;try{r=JSON.parse(n)}catch(a){}return r?r.value:null}},{key:"readValueType",value:function(e,t){var r,n=t.description;try{r=JSON.parse(n)}catch(a){}return r?g.fromJSON(r.fieldValueType):null}},{key:"clone",value:function(){return new n({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}}]),r}(c.a);Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],y.prototype,"alias",void 0),Object(l.a)([Object(f.b)({type:[String,Number],json:{write:{allowNull:!0}}})],y.prototype,"defaultValue",void 0),Object(l.a)([Object(f.b)()],y.prototype,"description",void 0),Object(l.a)([Object(d.a)("description")],y.prototype,"readDescription",null),Object(l.a)([Object(f.b)({types:v.b,json:{read:{reader:v.a},write:!0}})],y.prototype,"domain",void 0),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],y.prototype,"editable",void 0),Object(l.a)([Object(f.b)({type:h.a,json:{write:!0}})],y.prototype,"length",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],y.prototype,"name",void 0),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],y.prototype,"nullable",void 0),Object(l.a)([Object(p.a)(b.a)],y.prototype,"type",void 0),Object(l.a)([Object(f.b)()],y.prototype,"valueType",void 0),Object(l.a)([Object(d.a)("valueType",["description"])],y.prototype,"readValueType",null);var w=y=n=Object(l.a)([Object(m.a)("esri.layers.support.Field")],y)},667:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(21),a=r(2),i=r(4),o=r(83),s=r(29),l=r(122),u=r(11),c=r(30),f=r(674),h=r(296),p={statsWorker:function(){return r.e(99).then(r.bind(null,787))},geometryEngineWorker:function(){return Promise.all([r.e(9),r.e(82)]).then(r.bind(null,788))},CSVSourceWorker:function(){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(8),r.e(59)]).then(r.bind(null,803))},EdgeProcessingWorker:function(){return Promise.all([r.e(12),r.e(81)]).then(r.bind(null,797))},ElevationSamplerWorker:function(){return Promise.all([r.e(4),r.e(8),r.e(12),r.e(20),r.e(111)]).then(r.bind(null,789))},FeatureServiceSnappingSourceWorker:function(){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(8),r.e(51)]).then(r.bind(null,798))},GeoJSONSourceWorker:function(){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(8),r.e(58)]).then(r.bind(null,790))},LercWorker:function(){return r.e(89).then(r.bind(null,791))},MemorySourceWorker:function(){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(8),r.e(57)]).then(r.bind(null,792))},PBFDecoderWorker:function(){return Promise.all([r.e(6),r.e(65)]).then(r.bind(null,800))},Pipeline:function(){return Promise.all([r.e(2),r.e(4),r.e(5),r.e(6),r.e(39)]).then(r.bind(null,795))},PointCloudWorker:function(){return Promise.all([r.e(4),r.e(27),r.e(75)]).then(r.bind(null,799))},RasterWorker:function(){return r.e(63).then(r.bind(null,793))},SceneLayerWorker:function(){return r.e(121).then(r.bind(null,804))},WFSSourceWorker:function(){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(8),r.e(56)]).then(r.bind(null,794))},WorkerTileHandler:function(){return Promise.all([r.e(26),r.e(23),r.e(93)]).then(r.bind(null,796))}},d=f.a.CLOSE,m=f.a.ABORT,v=f.a.INVOKE,b=f.a.RESPONSE,g=f.a.OPEN_PORT,y=f.a.ON,w=function(){function e(t){Object(a.a)(this,e),this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=t,this._timer=null,this._process=this._process.bind(this)}return Object(i.a)(e,[{key:"push",value:function(e){e.type===f.a.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),null===this._timer&&(this._timer=setTimeout(this._process,0)))}},{key:"clear",value:function(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}},{key:"_process",value:function(){this._timer=null;var e,t=Object(n.a)(this._invokeMessages);try{for(t.s();!(e=t.n()).done;){var r=e.value;this._cancelledJobIds.has(r.jobId)||this._invoke(r)}}catch(a){t.e(a)}finally{t.f()}this._cancelledJobIds.clear(),this._invokeMessages.length=0}}]),e}(),O=function(){function e(t,r){var n=this;Object(a.a)(this,e),this._port=t,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new w((function(e){return n._onInvokeMessage(e)})),this._client=r.client,this._onMessage=this._onMessage.bind(this),this._channel=r.channel,this._schedule=r.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}return Object(i.a)(e,[{key:"close",value:function(){this._post({type:d}),this._close()}},{key:"isBusy",value:function(){return this._outJobs.size>0}},{key:"invoke",value:function(e,t,r){var n=this,a=r&&r.signal,i=r&&r.transferList;if(!this._port)return Promise.reject(new s.a("worker:port-closed","Cannot call invoke('".concat(e,"'), port is closed"),{methodName:e,data:t}));var o=Object(f.b)();return new Promise((function(r,s){var l=Object(c.r)(a,(function(){var e,t=n._outJobs.get(o);t&&(n._outJobs.delete(o),null==(e=t.abortHandle)||e.remove(),n._post({type:m,jobId:o}),s(Object(c.e)()))})),u={resolve:r,reject:s,abortHandle:l,debugInfo:e};n._outJobs.set(o,u),n._post({type:v,jobId:o,methodName:e,abortable:null!=a},t,i)}))}},{key:"on",value:function(e,t){var r=new MessageChannel;function n(e){t(e.data)}return this._port.postMessage({type:f.a.ON,eventType:e,port:r.port2},[r.port2]),r.port1.addEventListener("message",n),r.port1.start(),{remove:function(){r.port1.postMessage({type:f.a.CLOSE}),r.port1.close(),r.port1.removeEventListener("message",n)}}}},{key:"openPort",value:function(){var e=new MessageChannel;return this._post({type:g,port:e.port2}),e.port1}},{key:"_close",value:function(){this._channel&&(this._channel=null),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((function(e){var t;null==(t=e.abortHandle)||t.remove(),e.reject(Object(c.e)("Worker closing, aborting job calling '".concat(e.debugInfo,"'")))})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=this._client=this._schedule=null}},{key:"_onMessage",value:function(e){var t=this;Object(u.j)(this._schedule)?this._schedule((function(){return t._processMessage(e)})):this._processMessage(e)}},{key:"_processMessage",value:function(e){var t=Object(f.d)(e);if(t)switch(t.type){case b:this._onResponseMessage(t);break;case v:this._invokeQueue.push(t);break;case m:this._onAbortMessage(t);break;case d:this._onCloseMessage();break;case g:this._onOpenPortMessage(t);break;case y:this._onOnMessage(t)}}},{key:"_onAbortMessage",value:function(e){var t=this._inJobs,r=e.jobId,n=t.get(r);this._invokeQueue.push(e),n&&(n.controller&&n.controller.abort(),t.delete(r))}},{key:"_onCloseMessage",value:function(){var t=this._client;this._close(),t&&"destroy"in t&&e.clients.get(this)===t&&t.destroy(),e.clients.delete(this),t&&t.remoteClient&&(t.remoteClient=null)}},{key:"_onInvokeMessage",value:function(e){var t,r=this,n=e.methodName,a=e.jobId,i=e.data,o=e.abortable?Object(c.d)():null,s=this._inJobs,l=this._client,u=l[n];try{if(!u&&n&&-1!==n.indexOf("."))for(var h=n.split("."),p=0;p<h.length-1;p++)u=(l=l[h[p]])[h[p+1]];if("function"!=typeof u)throw new TypeError("".concat(n," is not a function"));t=u.call(l,i,{client:this,signal:o?o.signal:null})}catch(d){return void this._post({type:b,jobId:a,error:Object(f.e)(d)})}Object(c.p)(t)?(s.set(a,{controller:o,promise:t}),t.then((function(e){s.has(a)&&(s.delete(a),r._post({type:b,jobId:a},e))}),(function(e){s.has(a)&&(s.delete(a),Object(c.m)(e)||r._post({type:b,jobId:a,error:Object(f.e)(e||{message:"Error encountered at method ".concat(n)})}))}))):this._post({type:b,jobId:a},t)}},{key:"_onOpenPortMessage",value:function(t){new e(t.port,{client:this._client})}},{key:"_onOnMessage",value:function(e){var t=e.port,r=this._client.on(e.eventType,(function(e){t.postMessage(e)})),n=Object(l.c)(e.port,"message",(function(e){Object(f.d)(e).type===f.a.CLOSE&&(n.remove(),r.remove(),t.close())}))}},{key:"_onResponseMessage",value:function(e){var t,r=e.jobId,n=e.error,a=e.data,i=this._outJobs;if(i.has(r)){var o=i.get(r);i.delete(r),null==(t=o.abortHandle)||t.remove(),n?o.reject(s.a.fromJSON(JSON.parse(n))):o.resolve(a)}}},{key:"_post",value:function(e,t,r){return Object(f.c)(this._port,e,t,r)}}],[{key:"connect",value:function(t){var r,n=new MessageChannel;r="function"==typeof t?new t:"default"in t&&"function"==typeof t.default?new t.default:t;var a=new e(n.port1,{channel:n,client:r});return"object"==typeof r&&"remoteClient"in r&&(r.remoteClient=a),e.clients.set(a,r),n.port2}},{key:"loadWorker",value:function(e){var t=p[e];return t?t():Promise.resolve(null)}}]),e}();O.kernelInfo={revision:h.b,version:o.d,buildDate:h.a},O.clients=new Map},668:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return I}));var n=r(22),a=r(21),i=r(2),o=r(4),s=r(5),l=r(6),u=r(0),c=r(114),f=r(210),h=r(42),p=r(26),d=r(11),m=r(1),v=(r(19),r(14),r(15),r(57)),b=r(10),g=r(43),y=r(45),w=r(62),O=r(666),j=new h.a({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null}),x=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).displayFieldName=null,n.exceededTransferLimit=!1,n.features=[],n.fields=null,n.geometryType=null,n.hasM=!1,n.hasZ=!1,n.queryGeometry=null,n.spatialReference=null,n}return Object(o.a)(r,[{key:"readFeatures",value:function(e,t){for(var r=y.a.fromJSON(t.spatialReference),n=[],a=0;a<e.length;a++){var i=e[a],o=f.a.fromJSON(i),s=i.geometry&&i.geometry.spatialReference;Object(d.j)(o.geometry)&&!s&&(o.geometry.spatialReference=r),n.push(o)}return n}},{key:"writeGeometryType",value:function(e,t,r,n){if(e)j.write(e,t,r,n);else{var i=this.features;if(i){var o,s=Object(a.a)(i);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(l&&Object(d.j)(l.geometry))return void j.write(l.geometry.type,t,r,n)}}catch(u){s.e(u)}finally{s.f()}}}}},{key:"readQueryGeometry",value:function(e,t){if(!e)return null;var r=!!e.spatialReference,n=Object(w.a)(e);return!r&&t.spatialReference&&(n.spatialReference=y.a.fromJSON(t.spatialReference)),n}},{key:"writeSpatialReference",value:function(e,t){if(e)t.spatialReference=e.toJSON();else{var r=this.features;if(r){var n,i=Object(a.a)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o&&Object(d.j)(o.geometry)&&o.geometry.spatialReference)return void(t.spatialReference=o.geometry.spatialReference.toJSON())}}catch(s){i.e(s)}finally{i.f()}}}}},{key:"toJSON",value:function(e){var t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var n=t.features[r];if(n.geometry){var a=e&&e[r];n.geometry=a&&a.toJSON()||n.geometry}}return t}},{key:"quantize",value:function(e){for(var t=Object(n.a)(e.scale,2),r=t[0],a=t[1],i=Object(n.a)(e.translate,2),o=i[0],s=i[1],l=this.features,u=this._getQuantizationFunction(this.geometryType,(function(e){return Math.round((e-o)/r)}),(function(e){return Math.round((s-e)/a)})),c=0,f=l.length;c<f;c++)u(Object(d.q)(l[c].geometry))||(l.splice(c,1),c--,f--);return this.transform=e,this}},{key:"unquantize",value:function(){var e=this.geometryType,t=this.features,r=this.transform;if(!r)return this;var i,o=Object(n.a)(r.translate,2),s=o[0],l=o[1],u=Object(n.a)(r.scale,2),c=u[0],f=u[1],h=this._getHydrationFunction(e,(function(e){return e*c+s}),(function(e){return l-e*f})),p=Object(a.a)(t);try{for(p.s();!(i=p.n()).done;){var m=i.value.geometry;Object(d.j)(m)&&h(m)}}catch(v){p.e(v)}finally{p.f()}return this.transform=null,this}},{key:"_quantizePoints",value:function(e,t,r){for(var n,a,i=[],o=0,s=e.length;o<s;o++){var l=e[o];if(o>0){var u=t(l[0]),c=r(l[1]);u===n&&c===a||(i.push([u-n,c-a]),n=u,a=c)}else n=t(l[0]),a=r(l[1]),i.push([n,a])}return i.length>0?i:null}},{key:"_getQuantizationFunction",value:function(e,t,r){var n=this;return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var a=Object(w.g)(e)?e.rings:e.paths,i=[],o=0,s=a.length;o<s;o++){var l=a[o],u=n._quantizePoints(l,t,r);u&&i.push(u)}return i.length>0?(Object(w.g)(e)?e.rings=i:e.paths=i,e):null}:"multipoint"===e?function(e){var a=n._quantizePoints(e.points,t,r);return a.length>0?(e.points=a,e):null}:"extent"===e?function(e){return e}:null}},{key:"_getHydrationFunction",value:function(e,t,r){return"point"===e?function(e){e.x=t(e.x),e.y=r(e.y)}:"polyline"===e||"polygon"===e?function(e){for(var n,a,i=Object(w.g)(e)?e.rings:e.paths,o=0,s=i.length;o<s;o++)for(var l=i[o],u=0,c=l.length;u<c;u++){var f=l[u];u>0?(n+=f[0],a+=f[1]):(n=f[0],a=f[1]),f[0]=t(n),f[1]=r(a)}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"multipoint"===e?function(e){for(var n,a,i=e.points,o=0,s=i.length;o<s;o++){var l=i[o];o>0?(n+=l[0],a+=l[1]):(n=l[0],a=l[1]),l[0]=t(n),l[1]=r(a)}}:void 0}}]),r}(p.a);Object(u.a)([Object(m.b)({type:String,json:{write:!0}})],x.prototype,"displayFieldName",void 0),Object(u.a)([Object(m.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],x.prototype,"exceededTransferLimit",void 0),Object(u.a)([Object(m.b)({type:[f.a],json:{write:!0}})],x.prototype,"features",void 0),Object(u.a)([Object(v.a)("features")],x.prototype,"readFeatures",null),Object(u.a)([Object(m.b)({type:[O.a],json:{write:!0}})],x.prototype,"fields",void 0),Object(u.a)([Object(m.b)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:j.read}}})],x.prototype,"geometryType",void 0),Object(u.a)([Object(g.a)("geometryType")],x.prototype,"writeGeometryType",null),Object(u.a)([Object(m.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],x.prototype,"hasM",void 0),Object(u.a)([Object(m.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],x.prototype,"hasZ",void 0),Object(u.a)([Object(m.b)({types:c.a,json:{write:!0}})],x.prototype,"queryGeometry",void 0),Object(u.a)([Object(v.a)("queryGeometry")],x.prototype,"readQueryGeometry",null),Object(u.a)([Object(m.b)({type:y.a,json:{write:!0}})],x.prototype,"spatialReference",void 0),Object(u.a)([Object(g.a)("spatialReference")],x.prototype,"writeSpatialReference",null),Object(u.a)([Object(m.b)({json:{write:!0}})],x.prototype,"transform",void 0),(x=Object(u.a)([Object(b.a)("esri.rest.support.FeatureSet")],x)).prototype.toJSON.isDefaultToJSON=!0,x||(x={});var I=x},674:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l}));var n,a,i=r(19);(a=n||(n={}))[a.HANDSHAKE=0]="HANDSHAKE",a[a.OPEN=1]="OPEN",a[a.OPENED=2]="OPENED",a[a.RESPONSE=3]="RESPONSE",a[a.INVOKE=4]="INVOKE",a[a.ABORT=5]="ABORT",a[a.CLOSE=6]="CLOSE",a[a.OPEN_PORT=7]="OPEN_PORT",a[a.ON=8]="ON";var o=0;function s(){return o++}function l(e){return e?"string"==typeof e?JSON.stringify({name:"message",message:e}):e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details||{stack:e.stack}}):null}function u(e,t,r,a){var i;t.type!==n.OPEN_PORT?t.type===n.INVOKE||t.type===n.RESPONSE?(!function(e){return e&&"object"==typeof e&&("result"in e||"transferList"in e)}(r)?(i=f(a),t.data=r):(i=f(r.transferList),t.data=r.result),i?e.postMessage(t,i):e.postMessage(t)):e.postMessage(t):e.postMessage(t,[t.port])}function c(e){if(!e)return null;var t=e.data;return t?"string"==typeof t?JSON.parse(t):t:null}function f(e){if(!e||!e.length)return null;if(Object(i.a)("esri-workers-arraybuffer-transfer"))return e;var t=e.filter((function(e){return!function(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name}(e)}));return t.length?t:null}},676:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return p})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return g})),r.d(t,"h",(function(){return y})),r.d(t,"i",(function(){return v})),r.d(t,"j",(function(){return w}));var n=r(22),a=r(11),i=r(27),o=r(87),s={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},l=Object.values(s),u=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(".concat(l.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),c=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(".concat(l.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),f=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function h(e){return!!u.test(e)}function p(e){var t=Object(i.J)(e),r=t.path.match(u)||t.path.match(c);if(!r)return null;var a=Object(n.a)(r,5),o=a[1],l=a[2],f=a[3],h=a[4],p=l.indexOf("/");return{title:m(-1!==p?l.slice(p+1):l),serverType:s[f.toLowerCase()],sublayer:null!=h&&""!==h?parseInt(h,10):null,url:{path:o}}}function d(e){var t=Object(i.J)(e).path.match(f);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function m(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function v(e,t){var r=[];if(e){var n=p(e);Object(a.j)(n)&&n.title&&r.push(n.title)}if(t){var i=m(t);r.push(i)}if(2===r.length){if(-1!==r[0].toLowerCase().indexOf(r[1].toLowerCase()))return r[0];if(-1!==r[1].toLowerCase().indexOf(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function b(e){if(!e)return!1;var t=-1!==(e=e.toLowerCase()).indexOf(".arcgis.com/"),r=-1!==e.indexOf("//services")||-1!==e.indexOf("//tiles")||-1!==e.indexOf("//features");return t&&r}function g(e,t){return e?Object(i.H)(Object(i.G)(e,t)):e}function y(e){var t=e.url;if(!t)return{url:t};t=Object(i.G)(t,e.logger);var r,n=Object(i.J)(t),o=p(n.path);if(Object(a.j)(o))null!=o.sublayer&&null==e.layer.layerId&&(r=o.sublayer),t=o.url.path;else if(e.nonStandardUrlAllowed){var s=d(n.path);Object(a.j)(s)&&(t=s.serviceUrl,r=s.sublayerId)}return{url:Object(i.H)(t),layerId:r}}function w(e,t,r,n,a){Object(o.f)(t,n,"url",a),n.url&&null!=e.layerId&&(n.url=Object(i.y)(n.url,r,e.layerId.toString()))}function O(e){if(!e)return!1;var t=e.toLowerCase(),r=-1!==t.indexOf("/services/"),n=-1!==t.indexOf("/mapserver/wmsserver"),a=-1!==t.indexOf("/imageserver/wmsserver"),i=-1!==t.indexOf("/wmsserver");return r&&(n||a||i)}},679:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return s}));r(19);var n=r(664),a=r(660),i=r(661),o=r(662),s={key:"type",base:a.a,typeMap:{range:o.a,"coded-value":n.a,inherited:i.a}};function l(e){if(!e||!e.type)return null;switch(e.type){case"range":return o.a.fromJSON(e);case"codedValue":return n.a.fromJSON(e);case"inherited":return i.a.fromJSON(e)}return null}},683:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(135),a=r(70),i={inches:Object(n.b)(1,"meters","inches"),feet:Object(n.b)(1,"meters","feet"),"us-feet":Object(n.b)(1,"meters","us-feet"),yards:Object(n.b)(1,"meters","yards"),miles:Object(n.b)(1,"meters","miles"),"nautical-miles":Object(n.b)(1,"meters","nautical-miles"),millimeters:Object(n.b)(1,"meters","millimeters"),centimeters:Object(n.b)(1,"meters","centimeters"),decimeters:Object(n.b)(1,"meters","decimeters"),meters:Object(n.b)(1,"meters","meters"),kilometers:Object(n.b)(1,"meters","kilometers"),"decimal-degrees":1/Object(n.i)(1,"meters",a.a.radius)}},685:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(21),a=r(2),i=r(4),o=r(185),s=r(15),l=r(30),u=r(667),c=s.a.getLogger("esri.core.workers.Connection"),f=function(){function e(){Object(a.a)(this,e),this._clients=new Array,this._clientPromises=new Array,this._clientIdx=0}return Object(i.a)(e,[{key:"destroy",value:function(){this.close()}},{key:"closed",get:function(){return!this._clients||!this._clients.length}},{key:"open",value:function(e,t){var r=this;return new Promise((function(n,a){var i=!0,o=function(e){Object(l.v)(t.signal),i&&(i=!1,e())};r._clients.length=e.length,r._clientPromises.length=e.length;for(var s=function(i){var s=e[i];Object(l.p)(s)?r._clientPromises[i]=s.then((function(e){return r._clients[i]=new u.a(e,t),o(n),r._clients[i]}),(function(){return o(a),null})):(r._clients[i]=new u.a(s,t),r._clientPromises[i]=Promise.resolve(r._clients[i]),o(n))},c=0;c<e.length;++c)s(c)}))}},{key:"broadcast",value:function(e,t,r){for(var n=new Array(this._clientPromises.length),a=0;a<this._clientPromises.length;++a){var i=this._clientPromises[a];n[a]=i.then((function(n){return n.invoke(e,t,r)}))}return n}},{key:"close",value:function(){var e,t=Object(n.a)(this._clientPromises);try{for(t.s();!(e=t.n()).done;){e.value.then((function(e){return e.close()}))}}catch(r){t.e(r)}finally{t.f()}this._clients.length=0,this._clientPromises.length=0}},{key:"getAvailableClient",value:function(){for(var e,t=0;t<this._clients.length;++t){var r=this._clients[t];if(r){if(!r.isBusy())return Promise.resolve(r)}else(e=e||[]).push(this._clientPromises[t])}return e?Promise.race(e):(this._clientIdx=(this._clientIdx+1)%this._clients.length,Promise.resolve(this._clients[this._clientIdx]))}},{key:"invoke",value:function(e,t,r){var n=null;return Array.isArray(r)?(c.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),n={transferList:r}):n=r,this.closed?Promise.reject(new Error("Connection closed")):this.getAvailableClient().then((function(r){return r.invoke(e,t,n)}))}},{key:"on",value:function(e,t){var r=this;return Promise.all(this._clientPromises).then((function(){return Object(o.a)(r._clients.map((function(r){return r.on(e,t)})))}))}},{key:"openPorts",value:function(){var e=this;return new Promise((function(t){for(var r=new Array(e._clientPromises.length),n=r.length,a=function(a){e._clientPromises[a].then((function(e){r[a]=e.openPort(),0==--n&&t(r)}))},i=0;i<e._clientPromises.length;++i)a(i)}))}},{key:"test",get:function(){return{numClients:this._clients.length}}}]),e}()},690:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new(r(42).a)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})},694:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r(19);function n(e){}},696:function(e,t,r){"use strict";r.d(t,"a",(function(){return _})),r.d(t,"b",(function(){return D}));var n=r(7),a=r.n(n),i=r(22),o=r(12),s=r(21),l=r(68),u=r(29),c=r(15),f=r(11),h=r(108),p=r(107),d=r(732),m=r(53),v=r(71),b=r(13),g=(r(114),r(82)),y=r(27),w=r(62);function O(e,t,r,n){return j.apply(this,arguments)}function j(){return(j=Object(o.a)(a.a.mark((function e(t,r,n,i){var o,s,l,u,c,f,h,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="string"==typeof t?Object(y.J)(t):t,s=r[0].spatialReference,l=Object(b.a)(Object(b.a)({},i),{},{query:Object(b.a)(Object(b.a)({},o.query),{},{f:"json",sr:JSON.stringify(s),target:JSON.stringify({geometryType:Object(w.c)(r[0]),geometries:r}),cutter:JSON.stringify(n)})}),e.next=5,Object(g.default)(o.path+"/cut",l);case 5:return u=e.sent,c=u.data,f=c.cutIndexes,h=c.geometries,p=void 0===h?[]:h,e.abrupt("return",{cutIndexes:f,geometries:p.map((function(e){var t=Object(w.a)(e);return t.spatialReference=s,t}))});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t,r){return I.apply(this,arguments)}function I(){return(I=Object(o.a)(a.a.mark((function e(t,r,n){var i,o,s,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="string"==typeof t?Object(y.J)(t):t,o=r[0].spatialReference,s=Object(w.c)(r[0]),l=Object(b.a)(Object(b.a)({},n),{},{query:Object(b.a)(Object(b.a)({},i.query),{},{f:"json",sr:o.wkid?o.wkid:JSON.stringify(o),geometries:JSON.stringify(k(r))})}),e.t0=M,e.next=4,Object(g.default)(i.path+"/simplify",l);case 4:return e.t1=e.sent.data,e.t2=s,e.t3=o,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return{geometryType:Object(w.c)(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}function M(e,t,r){var n=Object(w.b)(t);return e.map((function(e){var t=n.fromJSON(e);return t.spatialReference=r,t}))}var S=c.a.getLogger("esri.geometry.support.normalizeUtils");function T(e,t,r){if(t){var n=function(e,t){if(!(e instanceof p.a||e instanceof h.a)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw S.error(r),new u.a(r)}var n,a=Object(d.b)(e),i=[],o=Object(s.a)(a);try{for(o.s();!(n=o.n()).done;){var l=n.value,c=[];i.push(c),c.push([l[0][0],l[0][1]]);for(var f=0;f<l.length-1;f++){var m=l[f][0],v=l[f][1],b=l[f+1][0],g=l[f+1][1],y=Math.sqrt((b-m)*(b-m)+(g-v)*(g-v)),w=(g-v)/y,O=(b-m)/y,j=y/t;if(j>1){for(var x=1;x<=j-1;x++){var I=x*t,k=O*I+m,M=w*I+v;c.push([k,M])}var T=(y+Math.floor(j-1)*t)/2,C=O*T+m,A=w*T+v;c.push([C,A])}c.push([b,g])}}}catch(_){o.e(_)}finally{o.f()}return function(e){return"polygon"===e.type}(e)?new h.a({rings:i,spatialReference:e.spatialReference}):new p.a({paths:i,spatialReference:e.spatialReference})}(e,1e6);e=Object(v.e)(n,!0)}return r&&(e=Object(d.e)(e,r)),e}function C(e,t,r){if(Array.isArray(e)){var n=e[0];if(n>t){var a=Object(d.d)(n,t);e[0]=n+a*(-2*t)}else if(n<r){var i=Object(d.d)(n,r);e[0]=n+i*(-2*r)}}else{var o=e.x;if(o>t){var s=Object(d.d)(o,t);e=e.clone().offset(s*(-2*t),0)}else if(o<r){var l=Object(d.d)(o,r);e=e.clone().offset(l*(-2*r),0)}}return e}function A(e,t){for(var r=-1,n=function(n){for(var a=t.cutIndexes[n],i=t.geometries[n],o=Object(d.b)(i),l=function(e){var t=o[e];t.some((function(r){if(r[0]<180)return!0;for(var n=0,a=0;a<t.length;a++){var o=t[a][0];n=o>n?o:n}n=Number(n.toFixed(9));for(var s=-360*Object(d.d)(n,180),l=0;l<t.length;l++){var u=i.getPoint(e,l);i.setPoint(e,l,u.clone().offset(s,0))}return!0}))},u=0;u<o.length;u++)l(u);if(a===r){if(function(e){return"polygon"===e[0].type}(e)){var c,f=Object(s.a)(Object(d.b)(i));try{for(f.s();!(c=f.n()).done;){var h=c.value;e[a]=e[a].addRing(h)}}catch(b){f.e(b)}finally{f.f()}}else if(function(e){return"polyline"===e[0].type}(e)){var p,m=Object(s.a)(Object(d.b)(i));try{for(m.s();!(p=m.n()).done;){var v=p.value;e[a]=e[a].addPath(v)}}catch(b){m.e(b)}finally{m.f()}}}else r=a,e[a]=i},a=0;a<t.cutIndexes.length;a++)n(a);return e}function _(e,t,r){return P.apply(this,arguments)}function P(){return(P=Object(o.a)(a.a.mark((function e(t,r,n){var i,o,u,c,b,g,y,w,j,I,k,M,S,P,D,R,E,L,N,B,U,z,G,F,H,V,J,Z,W,q,X,Y,K,Q,$,ee,te,re,ne,ae;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)){e.next=2;break}return e.abrupt("return",_([t],r));case 2:i=r?r.url:l.a.geometryServiceUrl,I=0,k=[],M=[],S=Object(s.a)(t);try{for(S.s();!(P=S.n()).done;)D=P.value,Object(f.i)(D)?M.push(D):(o||(o=D.spatialReference,u=Object(m.e)(o),c=o.isWebMercator,y=c?102100:4326,b=d.a[y].maxX,g=d.a[y].minX,w=d.a[y].plus180Line,j=d.a[y].minus180Line),u?"mesh"===D.type?M.push(D):"point"===D.type?M.push(C(D.clone(),b,g)):"multipoint"===D.type?((R=D.clone()).points=R.points.map((function(e){return C(e,b,g)})),M.push(R)):"extent"===D.type?(E=D.clone()._normalize(!1,!1,u),M.push(E.rings?new h.a(E):E)):D.extent?(L=D.extent,N=Object(d.d)(L.xmin,g)*(2*b),B=0===N?D.clone():Object(d.e)(D.clone(),N),L.offset(N,0),L.intersects(w)&&L.xmax!==b?(I=L.xmax>I?L.xmax:I,B=T(B,c),k.push(B),M.push("cut")):L.intersects(j)&&L.xmin!==g?(I=L.xmax*(2*b)>I?L.xmax*(2*b):I,B=T(B,c,360),k.push(B),M.push("cut")):M.push(B)):M.push(D.clone()):M.push(D))}catch(a){S.e(a)}finally{S.f()}for(U=Object(d.d)(I,b),z=-90,G=U,F=new p.a;U>0;)H=360*U-180,F.addPath([[H,z],[H,-1*z]]),z*=-1,U--;if(!(k.length>0&&G>0)){e.next=28;break}return e.t0=A,e.t1=k,e.next=15,O(i,k,F,n);case 15:for(e.t2=e.sent,V=(0,e.t0)(e.t1,e.t2),J=[],Z=[],W=0;W<M.length;W++)"cut"!==(q=M[W])?Z.push(q):(X=V.shift(),Y=t[W],Object(f.j)(Y)&&"polygon"===Y.type&&Y.rings&&Y.rings.length>1&&X.rings.length>=Y.rings.length?(J.push(X),Z.push("simplify")):Z.push(c?Object(v.b)(X):X));if(J.length){e.next=22;break}return e.abrupt("return",Z);case 22:return e.next=24,x(i,J,n);case 24:for(K=e.sent,Q=[],$=0;$<Z.length;$++)"simplify"!==(ee=Z[$])?Q.push(ee):Q.push(c?Object(v.b)(K.shift()):K.shift());return e.abrupt("return",Q);case 28:for(te=[],re=0;re<M.length;re++)"cut"!==(ne=M[re])?te.push(ne):(ae=k.shift(),te.push(!0===c?Object(v.b)(ae):ae));return e.abrupt("return",Promise.resolve(te));case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t){var r=Object(m.e)(t);if(r){var n=Object(i.a)(r.valid,2),a=n[0],o=n[1],s=o-a;if(e<a)for(;e<a;)e+=s;if(e>o)for(;e>o;)e-=s}return e}},697:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r(7),a=r.n(n),i=r(12),o=r(2),s=r(4),l=r(8),u=r(5),c=r(6),f=r(0),h=r(15),p=r(30),d=r(1),m=(r(19),r(14),r(10)),v=r(21),b=r(52),g=r(215),y=new b.a,w=new WeakMap;function O(e){j(e)&&y.push(e)}function j(e){return e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function x(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:x(t,e%t):0}var I=0,k=0;function M(){var e,t=Date.now(),r=Object(v.a)(y);try{for(r.s();!(e=r.n()).done;){var n,a=e.value;if(a.refreshInterval)t-(null!=(n=w.get(a))?n:0)+5>=6e4*a.refreshInterval&&(w.set(a,t),a.refresh(t))}}catch(i){r.e(i)}finally{r.f()}}Object(g.a)((function(){var e,t=Date.now(),r=0,n=Object(v.a)(y);try{for(n.s();!(e=n.n()).done;){var a=e.value;r=x(Math.round(6e4*a.refreshInterval),r),a.refreshInterval?w.get(a)||w.set(a,t):w.delete(a)}}catch(i){n.e(i)}finally{n.f()}if(r!==k){if(k=r,clearInterval(I),0===k)return void(I=0);I=setInterval(M,k)}}));var S=function(e){var t=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(o.a)(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).refreshInterval=0,e.refreshTimestamp=0,e._debounceHasDataChanged=Object(p.i)((function(){return e.hasDataChanged()})),e.when().then((function(){O(Object(l.a)(e))}),(function(){})),e}return Object(s.a)(r,[{key:"destroy",value:function(){var e;j(e=this)&&y.includes(e)&&y.remove(e)}},{key:"refreshParameters",get:function(){return{_ts:this.refreshTimestamp||null}}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();Object(p.l)(this._debounceHasDataChanged()).then((function(r){r&&(e._set("refreshTimestamp",t),e.emit("refresh"))}),(function(t){h.a.getLogger(e.declaredClass).error(t)}))}},{key:"hasDataChanged",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),r}(e);return Object(f.a)([Object(d.b)({type:Number,cast:function(e){return e>=.1?e:e<=0?0:.1},json:{write:!0,origins:{"web-document":{write:!0}}}})],t.prototype,"refreshInterval",void 0),Object(f.a)([Object(d.b)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),Object(f.a)([Object(d.b)()],t.prototype,"refreshParameters",null),t=Object(f.a)([Object(m.a)("esri.layers.mixins.RefreshableLayer")],t),t}},704:function(e,t,r){"use strict";function n(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function a(e){return null!=e&&!isNaN(e)&&isFinite(e)}function i(e){return e.valueExpression?"expression":e.field&&"string"==typeof e.field?"field":"unknown"}function o(e,t){var r=t||i(e),n=e.valueUnit||"unknown";return"unknown"===r?"constant":e.stops?"stops":null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?"clamped-linear":"unknown"===n?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?"proportional":"additive":"identity":"real-world-size"}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return a}))},712:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),a=r(4),i=r(708),o=function(){function e(t,r){Object(n.a)(this,e),this._storage=new i.b,this._storage.maxSize=t,r&&this._storage.registerRemoveFunc("",r)}return Object(a.a)(e,[{key:"put",value:function(e,t,r){this._storage.put(e,t,r,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.destroy()}},{key:"maxSize",get:function(){return this._storage.maxSize},set:function(e){this._storage.maxSize=e}}]),e}()},721:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(2),a=r(5),i=r(6),o=r(0),s=r(1),l=(r(19),r(14),r(15),r(10)),u=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).customParameters=null,e}return r}(e);return Object(o.a)([Object(s.b)({type:Object,json:{write:{overridePolicy:function(e){return{enabled:!!(e&&Object.keys(e).length>0)}}}}})],t.prototype,"customParameters",void 0),t=Object(o.a)([Object(l.a)("esri.layers.mixins.CustomParametersMixin")],t)}},727:function(e,t,r){"use strict";r.d(t,"a",(function(){return te}));var n=r(13),a=r(7),i=r.n(a),o=r(12),s=r(29),l=r(19),u=r(30),c=r(685),f=r(667),h=r(2),p=r(4),d=r(83),m=r(15),v=r(674),b=r(54),g=r(68),y=(r(243),r(27)),w=r(21),O={};function j(e){var t,r={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:Object(n.a)({},e.has),map:Object(n.a)({},e.map),packages:e.packages&&e.packages.concat()||[],paths:Object(n.a)({},e.paths)};return e.hasOwnProperty("async")||(r.async=!0),e.hasOwnProperty("isDebug")||(r.isDebug=!1),e.baseUrl||(r.baseUrl=O.baseUrl),null==(t=O.packages)||t.forEach((function(e){!function(e,t){var r,n=Object(w.a)(e);try{for(n.s();!(r=n.n()).done;)if(r.value.name===t.name)return}catch(a){n.e(a)}finally{n.f()}e.push(t)}(r.packages,e)})),r}var x,I,k=r(37),M=function e(){var t=this;Object(h.a)(this,e);var r=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((function(e){t[e]=function(){return r[e].apply(r,arguments)}}))},S=k.a.MutationObserver||k.a.WebKitMutationObserver,T=function(){var e;if(k.a.process&&k.a.process.nextTick)e=function(e){k.a.process.nextTick(e)};else if(k.a.Promise)e=function(e){k.a.Promise.resolve().then(e)};else if(S){var t=[],r=document.createElement("div");new S((function(){for(;t.length>0;)t.shift()()})).observe(r,{attributes:!0}),e=function(e){t.push(e),r.setAttribute("queueStatus","1")}}return e}(),C=function(){var e=k.a.MessageEvent;try{new e("message",{data:null})}catch(t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.data,n=t.bubbles,a=void 0!==n&&n,i=t.cancelable,o=void 0!==i&&i,s=document.createEvent("Event");return s.initEvent(e,a,o),s.data=r,s}}return function(t,r){return new e(t,r)}}(),A=function(){function e(){Object(h.a)(this,e),this._dispatcher=new M,this._workerPostMessage({type:v.a.HANDSHAKE})}return Object(p.a)(e,[{key:"terminate",value:function(){}},{key:"onmessage",get:function(){return this._onmessageHandler},set:function(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}},{key:"onmessageerror",get:function(){return this._onmessageerrorHandler},set:function(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}},{key:"onerror",get:function(){return this._onerrorHandler},set:function(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}},{key:"postMessage",value:function(e){var t=this;T((function(){t._workerMessageHandler(C("message",{data:e}))}))}},{key:"dispatchEvent",value:function(e){return this._dispatcher.dispatchEvent(e)}},{key:"addEventListener",value:function(e,t,r){this._dispatcher.addEventListener(e,t,r)}},{key:"removeEventListener",value:function(e,t,r){this._dispatcher.removeEventListener(e,t,r)}},{key:"_workerPostMessage",value:function(e){var t=this;T((function(){t.dispatchEvent(C("message",{data:e}))}))}},{key:"_workerMessageHandler",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var r,n,a,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=Object(v.d)(t))||r.type!==v.a.OPEN){e.next=13;break}return n=r.modulePath,a=r.jobId,e.next=5,f.a.loadWorker(n);case 5:if(o=e.sent,e.t0=o,e.t0){e.next=11;break}return e.next=10,import(n);case 10:o=e.sent;case 11:s=f.a.connect(o),this._workerPostMessage({type:v.a.OPENED,jobId:a,data:s});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),_=r(75),P=r(296),D=m.a.getLogger("esri.core.workers"),R=v.a.HANDSHAKE,E='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,buildDate:r,version:t}=configuration.kernelInfo,{revision:n,buildDate:i,version:s}=e.kernelInfo;o!==n&&console.warn(`[esri.core.workers] Version mismatch detected between ArcGIS API for JavaScript and assets:\nAPI version: ${t} [Date: ${r}, Revision: ${o.slice(0,8)}]\nAssets version: ${s} [Date: ${i}, Revision: ${n.slice(0,8)}]`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let e;function t(o){const t=e.connect(o);self.postMessage({type:2,jobId:r,data:t},[t])}"function"==typeof define&&define.amd?require([workerPath],(r=>{e=r.default||r,checkWorkerRevision(e),e.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((r=>(e=r.default,checkWorkerRevision(e),e.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):(self.RemoteClient||importScripts(workerPath),e=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(e),e.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const e=outgoing.get(r);outgoing.delete(r),o.error?e.reject(JSON.parse(o.error)):e.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});',L="Failed to create Worker. Fallback to execute module in main thread";function N(){return B.apply(this,arguments)}function B(){return(B=Object(o.a)(i.a.mark((function e(){var t,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(l.a)("esri-workers")){e.next=2;break}return e.abrupt("return",U(new A));case 2:if(!x&&!I)try{t=E.replace('"{CONFIGURATION}"',"'".concat(G(),"'")),x=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}catch(n){I=n||{}}if(x)try{r=new Worker(x,{name:"esri-worker-"+F++})}catch(n){D.warn(L,I),r=new A}else D.warn(L,I),r=new A;return e.abrupt("return",U(r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){return z.apply(this,arguments)}function z(){return(z=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){function r(a){var i=Object(v.d)(a);i&&i.type===R&&(t.removeEventListener("message",r),t.removeEventListener("error",n),e(t))}function n(e){e.preventDefault(),t.removeEventListener("message",r),t.removeEventListener("error",n),D.warn("Failed to create Worker. Fallback to execute module in main thread",e),(t=new A).addEventListener("message",r),t.addEventListener("error",n)}t.addEventListener("message",r),t.addEventListener("error",n)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){var e;if(null!=g.a.default){var t=Object(n.a)({},g.a);delete t.default,e=JSON.parse(JSON.stringify(t))}else e=JSON.parse(JSON.stringify(g.a));e.assetsPath=Object(y.z)(e.assetsPath),e.request.interceptors=[],e.log.interceptors=[],e.locale=Object(_.b)(),e.has={"csp-restrictions":Object(l.a)("csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":Object(l.a)("esri-2d-update-debug"),"esri-2d-query-centroid-enabled":Object(l.a)("esri-2d-query-centroid-enabled"),"featurelayer-pbf":Object(l.a)("featurelayer-pbf"),"featurelayer-simplify-thresholds":Object(l.a)("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":Object(l.a)("featurelayer-simplify-payload-size-factors"),"esri-atomics":Object(l.a)("esri-atomics"),"esri-shared-array-buffer":Object(l.a)("esri-shared-array-buffer"),"esri-tiles-debug":Object(l.a)("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":Object(l.a)("esri-workers-arraybuffer-transfer"),"host-webworker":1},e.workers.loaderUrl&&(e.workers.loaderUrl=Object(y.z)(e.workers.loaderUrl)),e.workers.workerPath?e.workers.workerPath=Object(y.z)(e.workers.workerPath):e.workers.workerPath=Object(y.z)(Object(b.a)("esri/core/workers/RemoteClient.js"));var r=g.a.workers.loaderConfig,a=j({baseUrl:null==r?void 0:r.baseUrl,locale:Object(_.b)(),has:Object(n.a)({"csp-restrictions":Object(l.a)("csp-restrictions"),"dojo-test-sniff":0,"host-webworker":1},null==r?void 0:r.has),map:Object(n.a)({},null==r?void 0:r.map),paths:Object(n.a)({},null==r?void 0:r.paths),packages:(null==r?void 0:r.packages)||[]}),i={version:d.d,buildDate:P.a,revision:P.b};return JSON.stringify({esriConfig:e,loaderConfig:a,kernelInfo:i})}var F=0,H=m.a.getLogger("esri.core.workers"),V=v.a.ABORT,J=v.a.INVOKE,Z=v.a.OPEN,W=v.a.OPENED,q=v.a.RESPONSE,X=function(){function e(t,r){Object(h.a)(this,e),this._outJobs=new Map,this._inJobs=new Map,this.worker=t,this.id=r,t.addEventListener("message",this._onMessage.bind(this)),t.addEventListener("error",(function(e){e.preventDefault(),H.error(e)}))}return Object(p.a)(e,[{key:"terminate",value:function(){this.worker.terminate()}},{key:"open",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var r,n,a,o=this,s=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=r.signal,a=Object(v.b)(),e.abrupt("return",new Promise((function(e,r){var i={resolve:e,reject:r,abortHandle:Object(u.r)(n,(function(){o._outJobs.delete(a),o._post({type:V,jobId:a})}))};o._outJobs.set(a,i),o._post({type:Z,jobId:a,modulePath:t})})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_onMessage",value:function(e){var t=Object(v.d)(e);if(t)switch(t.type){case W:this._onOpenedMessage(t);break;case q:this._onResponseMessage(t);break;case V:this._onAbortMessage(t);break;case J:this._onInvokeMessage(t)}}},{key:"_onAbortMessage",value:function(e){var t=this._inJobs,r=e.jobId,n=t.get(r);n&&(n.controller&&n.controller.abort(),t.delete(r))}},{key:"_onInvokeMessage",value:function(e){var t,r=this,n=e.methodName,a=e.jobId,i=e.data,o=e.abortable?Object(u.d)():null,s=this._inJobs,l=d.e[n];try{if("function"!=typeof l)throw new TypeError("".concat(n," is not a function"));t=l.call(null,i,{signal:o?o.signal:null})}catch(c){return void this._post({type:q,jobId:a,error:Object(v.e)(c)})}Object(u.p)(t)?(s.set(a,{controller:o,promise:t}),t.then((function(e){s.has(a)&&(s.delete(a),r._post({type:q,jobId:a},e))}),(function(e){s.has(a)&&(s.delete(a),e||(e={message:"Error encountered at method"+n}),Object(u.m)(e)||r._post({type:q,jobId:a,error:Object(v.e)(e||{message:"Error encountered at method ".concat(n)})}))}))):this._post({type:q,jobId:a},t)}},{key:"_onOpenedMessage",value:function(e){var t,r=e.jobId,n=e.data,a=this._outJobs.get(r);a&&(this._outJobs.delete(r),null==(t=a.abortHandle)||t.remove(),a.resolve(n))}},{key:"_onResponseMessage",value:function(e){var t,r=e.jobId,n=e.error,a=e.data,i=this._outJobs.get(r);i&&(this._outJobs.delete(r),null==(t=i.abortHandle)||t.remove(),n?i.reject(s.a.fromJSON(JSON.parse(n))):i.resolve(a))}},{key:"_post",value:function(e,t,r){return Object(v.c)(this.worker,e,t,r)}}],[{key:"create",value:function(){var t=Object(o.a)(i.a.mark((function t(r){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N();case 2:return n=t.sent,t.abrupt("return",new e(n,r));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}(),Y=Object(l.a)("esri-workers-debug")?1:Object(l.a)("host-browser")?navigator.hardwareConcurrency-1:0;Y||(Y=Object(l.a)("safari")&&Object(l.a)("mac")||Object(l.a)("trident")?7:2);var K=0,Q=[];function $(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(o.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new c.a,e.next=3,n.open(t,r);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){return re.apply(this,arguments)}function re(){return re=Object(o.a)(i.a.mark((function e(t){var r,a,o,c,h,p,d,m,v,b=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=b.length>1&&void 0!==b[1]?b[1]:{},"string"==typeof t){e.next=3;break}throw new s.a("workers:undefined-module","modulePath is missing");case 3:if(a=r.strategy||"distributed",Object(l.a)("host-webworker")&&!Object(l.a)("esri-workers")&&(a="local"),"local"!==a){e.next=16;break}return e.next=7,f.a.loadWorker(t);case 7:if(o=e.sent,e.t0=o,e.t0){e.next=13;break}return e.next=12,import(t);case 12:o=e.sent;case 13:return Object(u.v)(r.signal),c=r.client||o,e.abrupt("return",$([f.a.connect(o)],Object(n.a)(Object(n.a)({},r),{},{client:c})));case 16:return e.next=18,ae();case 18:if(Object(u.v)(r.signal),"dedicated"!==a){e.next=28;break}return h=K++%Y,e.t1=$,e.next=24,Q[h].open(t,r);case 24:return e.t2=e.sent,e.t3=[e.t2],e.t4=r,e.abrupt("return",(0,e.t1)(e.t3,e.t4));case 28:if(!(r.maxNumWorkers&&r.maxNumWorkers>0)){e.next=34;break}if(!((p=Math.min(r.maxNumWorkers,Y))<Y)){e.next=34;break}for(d=new Array(p),m=0;m<p;++m)v=K++%Y,d[m]=Q[v].open(t,r);return e.abrupt("return",$(d,r));case 34:return e.abrupt("return",$(Q.map((function(e){return e.open(t,r)})),r));case 35:case"end":return e.stop()}}),e)}))),re.apply(this,arguments)}var ne=null;function ae(){return ie.apply(this,arguments)}function ie(){return(ie=Object(o.a)(i.a.mark((function e(){var t,r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ne){e.next=2;break}return e.abrupt("return",ne);case 2:for(Object(u.d)(),t=[],r=function(e){var r=X.create(e).then((function(t){return Q[e]=t,t}));t.push(r)},n=0;n<Y;n++)r(n);return e.abrupt("return",ne=Promise.all(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},732:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return u}));var n=r(21),a=r(107),i=r(45),o=r(62),s={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new a.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:i.a.WebMercator}),minus180Line:new a.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:i.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new a.a({paths:[[[180,-180],[180,180]]],spatialReference:i.a.WGS84}),minus180Line:new a.a({paths:[[[-180,-180],[-180,180]]],spatialReference:i.a.WGS84})}};function l(e,t){return Math.ceil((e-t)/(2*t))}function u(e,t){var r,a=c(e),i=Object(n.a)(a);try{for(i.s();!(r=i.n()).done;){var o,s=r.value,l=Object(n.a)(s);try{for(l.s();!(o=l.n()).done;){o.value[0]+=t}}catch(u){l.e(u)}finally{l.f()}}}catch(u){i.e(u)}finally{i.f()}return e}function c(e){return Object(o.g)(e)?e.rings:e.paths}function f(e){var t=(null==e?void 0:e.isWebMercator)?102100:4326;return[s[t].minX,s[t].maxX]}},743:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,a=r(13),i=r(2),o=r(4),s=r(5),l=r(6),u=r(0),c=r(42),f=r(26),h=r(11),p=r(135),d=r(1),m=(r(19),r(14)),v=(r(15),r(57)),b=r(10),g=r(43),y=r(48),w=r(45),O=r(333),j=r(53),x=r(71),I=r(768),k=new c.a({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"}),M=n=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).dpi=96,n.format=null,n.origin=null,n.minScale=0,n.maxScale=0,n.size=null,n.spatialReference=null,n}return Object(o.a)(r,[{key:"isWrappable",get:function(){var e=this.spatialReference,t=this.origin;if(e&&t){var r=Object(j.e)(e);return e.isWrappable&&Math.abs(r.origin[0]-t.x)<=r.dx}return!1}},{key:"readOrigin",value:function(e,t){return y.a.fromJSON(Object(a.a)({spatialReference:t.spatialReference},e))}},{key:"lods",set:function(e){var t=this,r=0,n=0,a=[];this._levelToLOD={},e&&(r=-1/0,n=1/0,e.forEach((function(e){a.push(e.scale),r=e.scale>r?e.scale:r,n=e.scale<n?e.scale:n,t._levelToLOD[e.level]=e}))),this._set("scales",a),this._set("minScale",r),this._set("maxScale",n),this._set("lods",e),this._initializeUpsampleLevels()}},{key:"readSize",value:function(e,t){return[t.cols,t.rows]}},{key:"writeSize",value:function(e,t){t.cols=e[0],t.rows=e[1]}},{key:"zoomToScale",value:function(e){var t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];var r=Math.floor(e),n=r+1;return t[r]/Math.pow(t[r]/t[n],e-r)}},{key:"scaleToZoom",value:function(e){for(var t=this.scales,r=t.length-1,n=0;n<r;n++){var a=t[n],i=t[n+1];if(a<=e)return n;if(i===e)return n+1;if(a>e&&i<e)return n+Math.log(a/e)/Math.log(a/i)}return n}},{key:"snapScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,r=this.scaleToZoom(e);return r%Math.floor(r)>=t?this.zoomToScale(Math.ceil(r)):this.zoomToScale(Math.floor(r))}},{key:"tileAt",value:function(e,t,r,n){var a,i,o=this.lodAt(e);if(!o)return null;if("number"==typeof t)a=t,i=r;else if(Object(j.d)(t.spatialReference,this.spatialReference))a=t.x,i=t.y,n=r;else{var s=Object(x.d)(t,this.spatialReference);if(Object(h.i)(s))return null;a=s.x,i=s.y,n=r}var l=o.resolution*this.size[0],u=o.resolution*this.size[1];return n||(n={id:null,level:0,row:0,col:0,extent:Object(O.e)()}),n.level=e,n.row=Math.floor((this.origin.y-i)/u+.001),n.col=Math.floor((a-this.origin.x)/l+.001),this.updateTileInfo(n),n}},{key:"updateTileInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.lodAt(e.level);if(!r&&1===t){var n=this.lods[this.lods.length-1];n.level<e.level&&(r=n)}if(r){var a=e.level-r.level,i=r.resolution*this.size[0]/Math.pow(2,a),o=r.resolution*this.size[1]/Math.pow(2,a);e.id="".concat(e.level,"/").concat(e.row,"/").concat(e.col),e.extent||(e.extent=Object(O.e)()),e.extent[0]=this.origin.x+e.col*i,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+i,e.extent[3]=e.extent[1]+o}}},{key:"upsampleTile",value:function(e){var t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}},{key:"getTileBounds",value:function(e,t){var r=this.lodAt(t.level).resolution,n=r*this.size[0],a=r*this.size[1];return e[0]=this.origin.x+t.col*n,e[1]=this.origin.y-(t.row+1)*a,e[2]=e[0]+n,e[3]=e[1]+a,e}},{key:"lodAt",value:function(e){return this._levelToLOD&&this._levelToLOD[e]||null}},{key:"clone",value:function(){return n.fromJSON(this.write({}))}},{key:"_initializeUpsampleLevels",value:function(){var e=this.lods;this._upsampleLevels=[];for(var t=null,r=0;r<e.length;r++){var n=e[r];this._upsampleLevels[n.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/n.resolution:0},t=n}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resolutionFactor,r=void 0===t?1:t,a=e.scales,i=e.size,o=void 0===i?256:i,s=e.spatialReference,l=void 0===s?w.a.WebMercator:s,u=e.numLODs,c=void 0===u?24:u;if(!Object(j.l)(l)){var f=[];if(a)for(var h=0;h<a.length;h++){var d=a[h];f.push({level:h,scale:d,resolution:d})}else for(var m=5e-4,v=c-1;v>=0;v--)f.unshift({level:v,scale:m,resolution:m}),m*=2;return new n({dpi:96,lods:f,origin:new y.a(0,0,l),size:[o,o],spatialReference:l})}var b=Object(j.e)(l),g=e.origin?new y.a({x:e.origin.x,y:e.origin.y,spatialReference:l}):new y.a(b?{x:b.origin[0],y:b.origin[1],spatialReference:l}:{x:0,y:0,spatialReference:l}),O=96,x=1/(39.37*Object(p.d)(l)*O),I=[];if(a)for(var k=0;k<a.length;k++){var M=a[k],S=M*x;I.push({level:k,scale:M,resolution:S})}else{var T=Object(j.h)(l)?512/o*591657527.5917094:256/o*591657527.591555,C=Math.ceil(c/r);I.push({level:0,scale:T,resolution:T*x});for(var A=1;A<C;A++){var _=T/Math.pow(2,r),P=_*x;I.push({level:A,scale:_,resolution:P}),T=_}}return new n({dpi:O,lods:I,origin:g,size:[o,o],spatialReference:l})}}]),r}(f.a);Object(u.a)([Object(d.b)({type:Number,json:{write:!0}})],M.prototype,"compressionQuality",void 0),Object(u.a)([Object(d.b)({type:Number,json:{write:!0}})],M.prototype,"dpi",void 0),Object(u.a)([Object(d.b)({type:String,json:{read:k.read,write:k.write,origins:{"web-scene":{read:!1,write:!1}}}})],M.prototype,"format",void 0),Object(u.a)([Object(d.b)({readOnly:!0})],M.prototype,"isWrappable",null),Object(u.a)([Object(d.b)({type:y.a,json:{write:!0}})],M.prototype,"origin",void 0),Object(u.a)([Object(v.a)("origin")],M.prototype,"readOrigin",null),Object(u.a)([Object(d.b)({type:[I.a],value:null,json:{write:!0}})],M.prototype,"lods",null),Object(u.a)([Object(d.b)({readOnly:!0})],M.prototype,"minScale",void 0),Object(u.a)([Object(d.b)({readOnly:!0})],M.prototype,"maxScale",void 0),Object(u.a)([Object(d.b)({readOnly:!0})],M.prototype,"scales",void 0),Object(u.a)([Object(d.b)({cast:function(e){return Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]}})],M.prototype,"size",void 0),Object(u.a)([Object(v.a)("size",["rows","cols"])],M.prototype,"readSize",null),Object(u.a)([Object(g.a)("size",{cols:{type:m.a},rows:{type:m.a}})],M.prototype,"writeSize",null),Object(u.a)([Object(d.b)({type:w.a,json:{write:!0}})],M.prototype,"spatialReference",void 0);var S=M=n=Object(u.a)([Object(b.a)("esri.layers.support.TileInfo")],M)},750:function(e,t,r){"use strict";r.d(t,"a",(function(){return ve})),r.d(t,"b",(function(){return Ae})),r.d(t,"c",(function(){return de})),r.d(t,"d",(function(){return be})),r.d(t,"e",(function(){return ue})),r.d(t,"f",(function(){return ce})),r.d(t,"g",(function(){return fe})),r.d(t,"h",(function(){return he})),r.d(t,"i",(function(){return Te})),r.d(t,"j",(function(){return pe})),r.d(t,"k",(function(){return Me})),r.d(t,"l",(function(){return xe}));var n,a,i,o,s,l=r(7),u=r.n(l),c=r(12),f=r(2),h=r(5),p=r(6),d=r(21),m=r(22),v=r(29),b=r(167),g=r(11),y=r(30),w=r(135),O=r(738),j=(r(238),r(211)),x=r(58),I=r(144),k=r(4),M=r(54),S=r(19),T=null;function C(){return!!T}function A(){return n||(n=Promise.all([r.e(108),r.e(100)]).then(r.bind(null,1093)).then((function(e){return e.p})).then((function(e){return(0,e.default)({locateFile:function(e){return Object(M.a)("esri/geometry/support/".concat(e))}})})).then((function(e){G(e)})))}!function(e){function t(e,t,r){T.ensureCache.prepare();var n=V(r),a=r===n,i=T.ensureFloat64(n),o=T._pe_geog_to_proj(T.getPointer(e),t,i);return o&&J(r,t,i,a),o}function r(e,t,r){return n(e,t,r,0)}function n(e,t,r,n){T.ensureCache.prepare();var a=V(r),i=r===a,o=T.ensureFloat64(a),s=T._pe_proj_to_geog_center(T.getPointer(e),t,o,n);return s&&J(r,t,o,i),s}e.geogToProj=t,e.projGeog=function(e,n,a,o){switch(o){case i.PE_TRANSFORM_P_TO_G:return r(e,n,a);case i.PE_TRANSFORM_G_TO_P:return t(e,n,a)}return 0},e.projToGeog=r,e.projToGeogCenter=n}(a||(a={})),(s=i||(i={})).init=function(){s.PE_BUFFER_MAX=T.PeDefs.prototype.PE_BUFFER_MAX,s.PE_NAME_MAX=T.PeDefs.prototype.PE_NAME_MAX,s.PE_MGRS_MAX=T.PeDefs.prototype.PE_MGRS_MAX,s.PE_USNG_MAX=T.PeDefs.prototype.PE_USNG_MAX,s.PE_DD_MAX=T.PeDefs.prototype.PE_DD_MAX,s.PE_DDM_MAX=T.PeDefs.prototype.PE_DDM_MAX,s.PE_DMS_MAX=T.PeDefs.prototype.PE_DMS_MAX,s.PE_UTM_MAX=T.PeDefs.prototype.PE_UTM_MAX,s.PE_PARM_MAX=T.PeDefs.prototype.PE_PARM_MAX,s.PE_TYPE_NONE=T.PeDefs.prototype.PE_TYPE_NONE,s.PE_TYPE_GEOGCS=T.PeDefs.prototype.PE_TYPE_GEOGCS,s.PE_TYPE_PROJCS=T.PeDefs.prototype.PE_TYPE_PROJCS,s.PE_TYPE_GEOGTRAN=T.PeDefs.prototype.PE_TYPE_GEOGTRAN,s.PE_TYPE_COORDSYS=T.PeDefs.prototype.PE_TYPE_COORDSYS,s.PE_TYPE_UNIT=T.PeDefs.prototype.PE_TYPE_UNIT,s.PE_TYPE_LINUNIT=T.PeDefs.prototype.PE_TYPE_LINUNIT,s.PE_STR_OPTS_NONE=T.PeDefs.prototype.PE_STR_OPTS_NONE,s.PE_STR_AUTH_NONE=T.PeDefs.prototype.PE_STR_AUTH_NONE,s.PE_STR_AUTH_TOP=T.PeDefs.prototype.PE_STR_AUTH_TOP,s.PE_STR_NAME_CANON=T.PeDefs.prototype.PE_STR_NAME_CANON,s.PE_PARM_X0=T.PeDefs.prototype.PE_PARM_X0,s.PE_PARM_ND=T.PeDefs.prototype.PE_PARM_ND,s.PE_TRANSFORM_1_TO_2=T.PeDefs.prototype.PE_TRANSFORM_1_TO_2,s.PE_TRANSFORM_2_TO_1=T.PeDefs.prototype.PE_TRANSFORM_2_TO_1,s.PE_TRANSFORM_P_TO_G=T.PeDefs.prototype.PE_TRANSFORM_P_TO_G,s.PE_TRANSFORM_G_TO_P=T.PeDefs.prototype.PE_TRANSFORM_G_TO_P,s.PE_HORIZON_RECT=T.PeDefs.prototype.PE_HORIZON_RECT,s.PE_HORIZON_POLY=T.PeDefs.prototype.PE_HORIZON_POLY,s.PE_HORIZON_LINE=T.PeDefs.prototype.PE_HORIZON_LINE,s.PE_HORIZON_DELTA=T.PeDefs.prototype.PE_HORIZON_DELTA},function(e){var t={},r={},n=function(e){if(e){var t=e.getType();switch(t){case i.PE_TYPE_GEOGCS:e=T.castObject(e,T.PeGeogcs);break;case i.PE_TYPE_PROJCS:e=T.castObject(e,T.PeProjcs);break;case i.PE_TYPE_GEOGTRAN:e=T.castObject(e,T.PeGeogtran);break;default:t&i.PE_TYPE_UNIT&&(e=T.castObject(e,T.PeUnit))}}return e};function a(e,r){var a=null,i=t[e];if(i||(i={},t[e]=i),i.hasOwnProperty(String(r)))a=i[r];else{var o=T.PeFactory.prototype.factoryByType(e,r);T.compare(o,T.NULL)||(a=o,i[r]=a)}return a=n(a)}e.initialize=function(){T.PeFactory.prototype.initialize(null)},e.coordsys=function(e){return a(i.PE_TYPE_COORDSYS,e)},e.factoryByType=a,e.fromString=function(e,t){var a=null,i=r[e];if(i||(i={},r[e]=i),i.hasOwnProperty(t))a=i[t];else{var o=T.PeFactory.prototype.fromString(e,t);T.compare(o,T.NULL)||(a=o,i[t]=a)}return a=n(a)},e.geogcs=function(e){return a(i.PE_TYPE_GEOGCS,e)},e.geogtran=function(e){return a(i.PE_TYPE_GEOGTRAN,e)},e.getCode=function(e){return T.PeFactory.prototype.getCode(e)},e.projcs=function(e){return a(i.PE_TYPE_PROJCS,e)},e.unit=function(e){return a(i.PE_TYPE_UNIT,e)}}(o||(o={}));var _,P,D,R,E,L,N,B,U,z=null;function G(e){function t(e,t,r){e[t]=r(e[t])}T=e,i.init(),_.init(),E.init(),N.init(),B.init(),z=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(){return Object(f.a)(this,r),t.apply(this,arguments)}return Object(k.a)(r,[{key:"destroy",value:function(){T.destroy(this)}}]),r}(T.PeGCSExtent);for(var r=0,n=[T.PeDatum,T.PeGeogcs,T.PeGeogtran,T.PeObject,T.PeParameter,T.PePrimem,T.PeProjcs,T.PeSpheroid,T.PeUnit];r<n.length;r++){t(n[r].prototype,"getName",(function(e){return function(){return e.call(this,new Array(i.PE_NAME_MAX))}}))}for(var a=0,o=[T.PeGeogtran,T.PeProjcs];a<o.length;a++){t(o[a].prototype,"getParameters",(function(e){return function(){for(var t=new Array(i.PE_PARM_MAX),r=e.call(this),n=0;n<t.length;n++){var a=T.getValue(r,"*");t[n]=a?T.wrapPointer(a,T.PeParameter):null,r+=Int32Array.BYTES_PER_ELEMENT}return t}}))}t(T.PeHorizon.prototype,"getCoord",(function(e){return function(){var t=this.getSize();if(!t)return null;var r=[];return J(r,t,e.call(this)),r}})),t(T.PeGTlistExtendedEntry.prototype,"getEntries",(function(e){var t=T._pe_getPeGTlistExtendedGTsSize();return function(){var r=null,n=e.call(this);if(!T.compare(n,T.NULL)){r=[n];var a=this.getSteps();if(a>1)for(var i=T.getPointer(n),o=1;o<a;o++)r.push(T.wrapPointer(i+t*o,T.PeGTlistExtendedGTs))}return r}}));var s=T._pe_getPeHorizonSize(),l=function(e){return function(){var t=this._cache;if(t||(t=new Map,this._cache=t),t.has(e))return t.get(e);var r=null,n=e.call(this);if(!T.compare(n,T.NULL)){r=[n];var a=n.getNump();if(a>1)for(var i=T.getPointer(n),o=1;o<a;o++)r.push(T.wrapPointer(i+s*o,T.PeHorizon))}return t.set(e,r),r}};t(T.PeProjcs.prototype,"horizonGcsGenerate",l),t(T.PeProjcs.prototype,"horizonPcsGenerate",l),T.PeObject.prototype.toString=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.PE_STR_OPTS_NONE;T.ensureCache.prepare();var t=T.getPointer(this),r=T.ensureInt8(new Array(i.PE_BUFFER_MAX));return T.UTF8ToString(T._pe_object_to_string_ext(t,e,r))}}function F(e){if(e){var t=T.getClass(e);if(t){var r=T.getCache(t);if(r){var n=T.getPointer(e);n&&delete r[n]}}}}function H(e,t){for(var r=[],n=new Array(t),a=0;a<e;a++)r.push(T.ensureInt8(n));return r}function V(e){var t;return Array.isArray(e[0])?(t=[],e.forEach((function(e){t.push(e[0],e[1])}))):t=e,t}function J(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n)for(var a=0;a<2*t;a++)e[a]=T.getValue(r+a*Float64Array.BYTES_PER_ELEMENT,"double");else for(var i=0===e.length,o=0;o<t;o++)i&&(e[o]=new Array(2)),e[o][0]=T.getValue(r,"double"),e[o][1]=T.getValue(r+Float64Array.BYTES_PER_ELEMENT,"double"),r+=2*Float64Array.BYTES_PER_ELEMENT}!function(e){var t;e.init=function(){e.PE_GTLIST_OPTS_COMMON=T.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,t=T._pe_getPeGTlistExtendedEntrySize()},e.getGTlist=function(e,r,n,a,i,o){var s=null,l=new T.PeInteger(o);try{var u=T.PeGTlistExtended.prototype.getGTlist(e,r,n,a,i,l);if((o=l.val)&&(s=[u],o>1))for(var c=T.getPointer(u),f=1;f<o;f++)s.push(T.wrapPointer(c+t*f,T.PeGTlistExtendedEntry))}finally{T.destroy(l)}return s}}(_||(_={})),function(e){e.destroy=function(e){if(e&&e.length){var t,r=Object(d.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;F(n),n.getEntries().forEach((function(e){F(e);var t=e.getGeogtran();F(t),t.getParameters().forEach(F),[t.getGeogcs1(),t.getGeogcs2()].forEach((function(e){F(e);var t=e.getDatum();F(t),F(t.getSpheroid()),F(e.getPrimem()),F(e.getUnit())}))}))}}catch(a){r.e(a)}finally{r.f()}T.PeGTlistExtendedEntry.prototype.Delete(e[0])}}}(P||(P={})),function(e){e.geogToGeog=function(e,t,r,n,a){T.ensureCache.prepare();var i=V(r),o=r===i,s=T.ensureFloat64(i),l=0;n&&(l=T.ensureFloat64(n));var u=T._pe_geog_to_geog(T.getPointer(e),t,s,l,a);return u&&J(r,t,s,o),u}}(D||(D={})),function(e){var t=function(e,t,r,n,a,o){var s,l;switch(T.ensureCache.prepare(),e){case"dd":s=T._pe_geog_to_dd,l=i.PE_DD_MAX;break;case"ddm":s=T._pe_geog_to_ddm,l=i.PE_DDM_MAX;break;case"dms":s=T._pe_geog_to_dms,l=i.PE_DMS_MAX}var u=0;t&&(u=T.getPointer(t));var c=V(n),f=T.ensureFloat64(c),h=H(r,l),p=s(u,r,f,a,T.ensureInt32(h));if(p)for(var d=0;d<r;d++)o[d]=T.UTF8ToString(h[d]);return p},r=function(e,t,r,n,a){var i;switch(T.ensureCache.prepare(),e){case"dd":i=T._pe_dd_to_geog;break;case"ddm":i=T._pe_ddm_to_geog;break;case"dms":i=T._pe_dms_to_geog}var o=0;t&&(o=T.getPointer(t));var s=n.map((function(e){return T.ensureString(e)})),l=T.ensureInt32(s),u=T.ensureFloat64(new Array(2*r)),c=i(o,r,l,u);return c&&J(a,r,u),c};e.geog_to_dms=function(e,r,n,a,i){return t("dms",e,r,n,a,i)},e.dms_to_geog=function(e,t,n,a){return r("dms",e,t,n,a)},e.geog_to_ddm=function(e,r,n,a,i){return t("ddm",e,r,n,a,i)},e.ddm_to_geog=function(e,t,n,a){return r("ddm",e,t,n,a)},e.geog_to_dd=function(e,r,n,a,i){return t("dd",e,r,n,a,i)},e.dd_to_geog=function(e,t,n,a){return r("dd",e,t,n,a)}}(R||(R={})),function(e){e.init=function(){e.PE_MGRS_STYLE_NEW=T.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=T.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=T.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=T.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=T.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},e.geog_to_mgrs_extended=function(e,t,r,n,a,o,s){T.ensureCache.prepare();var l=0;e&&(l=T.getPointer(e));var u=V(r),c=T.ensureFloat64(u),f=H(t,i.PE_MGRS_MAX),h=T.ensureInt32(f),p=T._pe_geog_to_mgrs_extended(l,t,c,n,a,o,h);if(p)for(var d=0;d<t;d++)s[d]=T.UTF8ToString(f[d]);return p},e.mgrs_to_geog_extended=function(e,t,r,n,a){T.ensureCache.prepare();var i=0;e&&(i=T.getPointer(e));var o=r.map((function(e){return T.ensureString(e)})),s=T.ensureInt32(o),l=T.ensureFloat64(new Array(2*t)),u=T._pe_mgrs_to_geog_extended(i,t,s,n,l);return u&&J(a,t,l),u}}(E||(E={})),function(e){e.geog_to_usng=function(e,t,r,n,a,o,s){T.ensureCache.prepare();var l=0;e&&(l=T.getPointer(e));var u=V(r),c=T.ensureFloat64(u),f=H(t,i.PE_MGRS_MAX),h=T.ensureInt32(f),p=T._pe_geog_to_usng(l,t,c,n,a,o,h);if(p)for(var d=0;d<t;d++)s[d]=T.UTF8ToString(f[d]);return p},e.usng_to_geog=function(e,t,r,n){T.ensureCache.prepare();var a=0;e&&(a=T.getPointer(e));var i=r.map((function(e){return T.ensureString(e)})),o=T.ensureInt32(i),s=T.ensureFloat64(new Array(2*t)),l=T._pe_usng_to_geog(a,t,o,s);return l&&J(n,t,s),l}}(L||(L={})),function(e){e.init=function(){e.PE_UTM_OPTS_NONE=T.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=T.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=T.PeNotationUtm.prototype.PE_UTM_OPTS_NS},e.geog_to_utm=function(e,t,r,n,a){T.ensureCache.prepare();var o=0;e&&(o=T.getPointer(e));var s=V(r),l=T.ensureFloat64(s),u=H(t,i.PE_UTM_MAX),c=T.ensureInt32(u),f=T._pe_geog_to_utm(o,t,l,n,c);if(f)for(var h=0;h<t;h++)a[h]=T.UTF8ToString(u[h]);return f},e.utm_to_geog=function(e,t,r,n,a){T.ensureCache.prepare();var i=0;e&&(i=T.getPointer(e));var o=r.map((function(e){return T.ensureString(e)})),s=T.ensureInt32(o),l=T.ensureFloat64(new Array(2*t)),u=T._pe_utm_to_geog(i,t,s,n,l);return u&&J(a,t,l),u}}(N||(N={})),function(e){var t=new Map;e.init=function(){e.PE_PCSINFO_OPTION_NONE=T.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=T.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=T.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=T.PePCSInfo.prototype.PE_POLE_POINT},e.generate=function(r){var n,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.PE_PCSINFO_OPTION_DOMAIN;return t.has(r)&&((a=t.get(r))[i]&&(n=a[i])),n||(n=T.PePCSInfo.prototype.generate(r,i),a||(a=[],t.set(r,a)),a[i]=n),n}}(B||(B={})),function(e){e.version_string=function(){return T.PeVersion.prototype.version_string()}}(U||(U={}));var Z=Object.freeze({__proto__:null,get _pe(){return T},isLoaded:C,isSupported:function(){return!!Object(S.a)("esri-wasm")},load:A,get PeCSTransformations(){return a},get PeDefs(){return i},get PeFactory(){return o},get PeGCSExtent(){return z},get PeGTlistExtended(){return _},get PeGTlistExtendedEntry(){return P},get PeGTTransformations(){return D},get PeNotationDms(){return R},get PeNotationMgrs(){return E},get PeNotationUsng(){return L},get PeNotationUtm(){return N},get PePCSInfo(){return B},get PeVersion(){return U},_init:G}),W=r(48),q=r(108),X=r(107),Y=r(337),K=(r(333),r(70)),Q=(Math.PI,K.a.radius),$=K.a.eccentricitySquared,ee={a1:Q*$,a2:Q*$*Q*$,a3:Q*$*$/2,a4:Q*$*Q*$*2.5,a5:Q*$+Q*$*$/2,a6:1-$},te=(K.a.radius,K.a.flattening,K.c.radius,K.c.flattening,K.b.radius,K.b.flattening,K.b.radius,0),re=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(f.a)(this,e),this.uid=te++,t?(this._wkt=void 0!==t.wkt?t.wkt:null,this._wkid=void 0!==t.wkid?t.wkid:-1,this._isInverse=void 0!==t.isInverse&&!0===t.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}return Object(k.a)(e,[{key:"wkt",get:function(){return this._wkt},set:function(e){this._wkt=e,this.uid=te++}},{key:"wkid",get:function(){return this._wkid},set:function(e){this._wkid=e,this.uid=te++}},{key:"isInverse",get:function(){return this._isInverse},set:function(e){this._isInverse=e,this.uid=te++}},{key:"getInverse",value:function(){var t=new e;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}}],[{key:"fromGE",value:function(t){var r=new e;return r._wkt=t.wkt,r._wkid=t.wkid,r._isInverse=t.isInverse,r}}]),e}(),ne=function(){function e(t){if(Object(f.a)(this,e),this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,t&&t.steps){var r,n=Object(d.a)(t.steps);try{for(n.s();!(r=n.n()).done;){var a=r.value;a instanceof re?this.steps.push(a):this.steps.push(new re({wkid:a.wkid,wkt:a.wkt,isInverse:a.isInverse}))}}catch(i){n.e(i)}finally{n.f()}}}return Object(k.a)(e,[{key:"getInverse",value:function(){var t=new e;t.steps=[];for(var r=this.steps.length-1;r>=0;r--){var n=this.steps[r];t.steps.push(n.getInverse())}return t}},{key:"getGTListEntry",value:function(){var e,t="",r=Object(d.a)(this.steps);try{for(r.s();!(e=r.n()).done;){t+=e.value.uid.toString()+","}}catch(n){r.e(n)}finally{r.f()}return t!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=t),this._gtlistentry}},{key:"assignCachedGe",value:function(t,r,n){this._cached_projection[e.cacheKey(t,r)]=n}},{key:"getCachedGeTransformation",value:function(t,r){var n,a="",i=Object(d.a)(this.steps);try{for(i.s();!(n=i.n()).done;){a+=n.value.uid.toString()+","}}catch(s){i.e(s)}finally{i.f()}a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);var o=this._cached_projection[e.cacheKey(t,r)];return void 0===o?null:o}}],[{key:"cacheKey",value:function(e,t){return[void 0!==e.wkid&&null!==e.wkid?e.wkid.toString():"-1",void 0!==e.wkt&&null!==e.wkt?e.wkt.toString():"",void 0!==t.wkid&&null!==t.wkid?t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():""].join(",")}},{key:"fromGE",value:function(t){var r,n=new e,a="",i=Object(d.a)(t.steps);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=re.fromGE(o);n.steps.push(s),a+=s.uid.toString()+","}}catch(l){i.e(l)}finally{i.f()}return n._cached_projection={},n._gtlistentry=null,n._chain=a,n}}]),e}(),ae=r(53),ie=null,oe=null,se=null,le={};function ue(){return!!ie&&C()}function ce(){return!0}function fe(e){return Object(g.i)(se)&&(se=Promise.all([A(),r.e(9).then(r.bind(null,920)).then((function(e){return e.g})),r.e(110).then(r.bind(null,1017))])),se.then((function(t){var r=Object(m.a)(t,3),n=r[1],a=r[2].hydratedAdapter;Object(y.v)(e),oe=a,(ie=n.default)._enableProjection(Z)}))}function he(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(e)?0===e.length?[]:pe(oe,e,e[0].spatialReference,t,r):pe(oe,[e],e.spatialReference,t,r)[0]}function pe(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(Object(g.i)(r)||Object(g.i)(n))return t;if(ve(r,n,a))return t.map((function(e){return Object(g.q)(ye(e,r,n))}));if(Object(g.i)(a)){var i=ne.cacheKey(r,n);void 0!==le[i]?a=le[i]:(a=de(r,n,null),Object(g.i)(a)&&(a=new ne),le[i]=a)}if(Object(g.i)(ie))throw new me;return ie._project(e,t,r,n,a)}function de(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Object(g.i)(ie))throw new me;if(Object(g.i)(e)||Object(g.i)(t))return null;var n=ie._getTransformation(oe,e,t,r,null==r?void 0:r.spatialReference);return null!==n?ne.fromGE(n):null}var me=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(){return Object(f.a)(this,r),t.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")}return r}(v.a);function ve(e,t,r){return!r&&(!!Object(ae.d)(e,t)||Object(ae.l)(e)&&Object(ae.l)(t)&&!!at(e,t,ut))}function be(e,t,r,n){return ge.apply(this,arguments)}function ge(){return ge=Object(c.a)(u.a.mark((function e(t,r,n,a){var i,o,s,l,c,f;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ue()){e.next=23;break}if(!Array.isArray(t)){e.next=21;break}i=Object(d.a)(t),e.prev=3,i.s();case 5:if((o=i.n()).done){e.next=11;break}if(s=o.value,l=s.source,c=s.dest,f=s.geographicTransformation,ve(l,c,f)){e.next=9;break}return e.abrupt("return",fe(a));case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),i.e(e.t0);case 16:return e.prev=16,i.f(),e.finish(16);case 19:e.next=23;break;case 21:if(ve(t,r,n)){e.next=23;break}return e.abrupt("return",fe(a));case 23:case"end":return e.stop()}}),e,null,[[3,13,16,19]])}))),ge.apply(this,arguments)}function ye(e,t,r){return e?"x"in e?we(e,t,new W.a,r,0):"xmin"in e?ke(e,t,new x.a,r,0):"rings"in e?Ie(e,t,new q.a,r,0):"paths"in e?je(e,t,new X.a,r,0):"points"in e?Oe(e,t,new I.a,r,0):null:null}function we(e,t,r,n,a){mt[0]=e.x,mt[1]=e.y;var i=e.z;return mt[2]=void 0!==i?i:a,Te(mt,t,0,mt,n,0,1)?(r.x=mt[0],r.y=mt[1],r.spatialReference=n,void 0===i?(r.z=void 0,r.hasZ=!1):(r.z=mt[2],r.hasZ=!0),void 0===e.m?(r.m=void 0,r.hasM=!1):(r.m=e.m,r.hasM=!0),r):null}function Oe(e,t,r,n,a){var i,o=e.points,s=e.hasZ,l=e.hasM,u=[],c=o.length,f=[],h=Object(d.a)(o);try{for(h.s();!(i=h.n()).done;){var p=i.value;f.push(p[0],p[1],s?p[2]:a)}}catch(y){h.e(y)}finally{h.f()}if(!Te(f,t,0,f,n,0,c))return null;for(var m=0;m<c;++m){var v=3*m,b=f[v],g=f[v+1];s&&l?u.push([b,g,f[v+2],o[m][3]]):s?u.push([b,g,f[v+2]]):l?u.push([b,g,o[m][2]]):u.push([b,g])}return r.points=u,r.spatialReference=n,r.hasZ=s,r.hasM=l,r}function je(e,t,r,n,a){var i=e.paths,o=e.hasZ,s=e.hasM,l=[];return Ce(i,o,s,t,l,n,a)?(r.paths=l,r.spatialReference=n,r.hasZ=o,r.hasM=s,r):null}function xe(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.spatialReference,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(g.j)(r)&&Object(g.j)(Ie(e,e.spatialReference,t,r,n))}function Ie(e,t,r,n,a){var i=e.rings,o=e.hasZ,s=e.hasM,l=[];return Ce(i,o,s,t,l,n,a)?(r.rings=l,r.spatialReference=n,r.hasZ=o,r.hasM=s,r):null}function ke(e,t,r,n,a){var i=e.xmin,o=e.ymin,s=e.xmax,l=e.ymax,u=e.hasZ,c=e.hasM;return Se(i,o,u?e.zmin:a,t,mt,n)?(r.xmin=mt[0],r.ymin=mt[1],u&&(r.zmin=mt[2]),Se(s,l,u?e.zmax:a,t,mt,n)?(r.xmax=mt[0],r.ymax=mt[1],u&&(r.zmax=mt[2]),c&&(r.mmin=e.mmin,r.mmax=e.mmax),r.spatialReference=n,r):null):null}function Me(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;mt[0]=e.x,mt[1]=e.y;var a=e.z;return mt[2]=void 0!==a?a:n,Te(mt,e.spatialReference,0,t,r,0,1)}function Se(e,t,r,n,a,i){return ht[0]=e,ht[1]=t,ht[2]=r,Te(ht,n,0,a,i,0,1)}function Te(e,t,r,n,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=at(t,a,ut);if(Object(g.i)(s))return!1;if(s===Re){if(e===n&&r===i)return!0;for(var l=r+3*o,u=r,c=i;u<l;u++,c++)n[c]=e[u];return!0}for(var f=r+3*o,h=r,p=i;h<f;h+=3,p+=3)s(e,h,n,p);return!0}function Ce(e,t,r,n,a,i){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=new Array,u=Object(d.a)(e);try{for(u.s();!(o=u.n()).done;){var c,f=o.value,h=Object(d.a)(f);try{for(h.s();!(c=h.n()).done;){var p=c.value;l.push(p[0],p[1],t?p[2]:s)}}catch(x){h.e(x)}finally{h.f()}}}catch(x){u.e(x)}finally{u.f()}if(!Te(l,n,0,l,i,0,l.length/3))return!1;var m=0;a.length=0;var v,b=Object(d.a)(e);try{for(b.s();!(v=b.n()).done;){var g,y=v.value,w=new Array,O=Object(d.a)(y);try{for(O.s();!(g=O.n()).done;){var j=g.value;t&&r?w.push([l[m++],l[m++],l[m++],j[3]]):t?w.push([l[m++],l[m++],l[m++]]):r?(w.push([l[m++],l[m++],j[2]]),m++):(w.push([l[m++],l[m++]]),m++)}}catch(x){O.e(x)}finally{O.f()}a.push(w)}}catch(x){b.e(x)}finally{b.f()}return!0}function Ae(e,t,r,n){if(Object(g.i)(e)||Object(g.i)(n))return!1;var a=De(e,st),i=De(n,lt);if(a===i&&!_e(i)&&(0!==a||Object(ae.d)(e,n)))return Object(O.h)(r),Object(O.m)(r,r,t),!0;if(_e(i)){var o=nt[a][11],s=nt[11][i];return!Object(g.i)(o)&&!Object(g.i)(s)&&(o(t,0,pt,0),s(pt,0,dt,0),Pe(ct*pt[0],ct*pt[1],r),r[12]=dt[0],r[13]=dt[1],r[14]=dt[2],!0)}if(!(3!==i&&12!==i||2!==a&&1!==a)){var l=nt[a][11],u=nt[11][i];return!Object(g.i)(l)&&!Object(g.i)(u)&&(l(t,0,pt,0),u(pt,0,dt,0),2===a?Object(O.h)(r):function(e,t,r){Pe(e,t,r),Object(O.a)(r,r)}(ct*pt[0],ct*pt[1],r),r[12]=dt[0],r[13]=dt[1],r[14]=dt[2],!0)}return!1}function _e(e){return 1===e||7===e||9===e}function Pe(e,t,r){var n=Math.sin(e),a=Math.cos(e),i=Math.sin(t),o=Math.cos(t),s=r;return s[0]=-n,s[4]=-i*a,s[8]=o*a,s[12]=0,s[1]=a,s[5]=-i*n,s[9]=o*n,s[13]=0,s[2]=0,s[6]=o,s[10]=i,s[14]=0,s[3]=0,s[7]=0,s[11]=0,s[15]=1,s}function De(e,t){return t.spatialReference===e?t.spatialReferenceId:(t.spatialReference=e,"metersPerUnit"in t&&(t.metersPerUnit=Object(w.d)(e,1)),e.wkt===Y.a.wkt?t.spatialReferenceId=1:Object(ae.m)(e)?t.spatialReferenceId=2:Object(ae.p)(e)?t.spatialReferenceId=3:Object(ae.k)(e)?t.spatialReferenceId=12:e.wkt===Y.d.wkt?t.spatialReferenceId=4:4490===e.wkid?t.spatialReferenceId=5:e.wkt===Y.b.wkt?t.spatialReferenceId=7:e.wkt===Y.c.wkt?t.spatialReferenceId=9:Object(ae.i)(e)?t.spatialReferenceId=8:Object(ae.j)(e)?t.spatialReferenceId=10:t.spatialReferenceId=0)}function Re(e,t,r,n){e!==r&&(r[n++]=e[t++],r[n++]=e[t++],r[n]=e[t])}function Ee(e,t,r,n){r[n++]=ft*(e[t++]/K.a.radius),r[n++]=ft*(Math.PI/2-2*Math.atan(Math.exp(-e[t++]/K.a.radius))),r[n]=e[t]}function Le(e,t,r,n){Ee(e,t,r,n),Ze(r,n,r,n)}function Ne(e,t,r,n){Ee(e,t,r,n),$e(r,n,r,n)}function Be(e,t,r,n){!function(e,t,r,n,a){var i=.4999999*Math.PI,o=Object(b.d)(ct*e[t+1],-i,i),s=Math.sin(o);r[n++]=ct*e[t]*a.radius,r[n++]=a.halfSemiMajorAxis*Math.log((1+s)/(1-s)),r[n]=e[t+2]}(e,t,r,n,K.a)}var Ue=K.a.radius*Math.PI/180,ze=180/(K.a.radius*Math.PI);function Ge(e,t,r,n){r[n]=e[t]*Ue,r[n+1]=e[t+1]*Ue,r[n+2]=e[t+2]}function Fe(e,t,r,n){r[n]=e[t]*ze,r[n+1]=e[t+1]*ze,r[n+2]=e[t+2]}function He(e,t,r,n,a){var i=a+e[t+2],o=ct*e[t+1],s=ct*e[t],l=Math.cos(o);r[n++]=Math.cos(s)*l*i,r[n++]=Math.sin(s)*l*i,r[n]=Math.sin(o)*i}function Ve(e,t,r,n){He(e,t,r,n,K.c.radius)}function Je(e,t,r,n){He(e,t,r,n,K.b.radius)}function Ze(e,t,r,n){He(e,t,r,n,K.a.radius)}function We(e,t,r,n,a){var i=e[t],o=e[t+1],s=e[t+2],l=Math.sqrt(i*i+o*o+s*s),u=Object(b.b)(s/(0===l?1:l)),c=Math.atan2(o,i);r[n++]=ft*c,r[n++]=ft*u,r[n]=l-a}function qe(e,t,r,n){We(e,t,r,n,K.c.radius)}function Xe(e,t,r,n){We(e,t,r,n,K.b.radius)}function Ye(e,t,r,n){We(e,t,r,n,K.a.radius)}function Ke(e,t,r,n){Ye(e,t,r,n),Be(r,n,r,n)}function Qe(e,t,r,n){Ye(e,t,r,n),$e(r,n,r,n)}function $e(e,t,r,n){!function(e,t,r,n,a){var i=ct*e[t],o=ct*e[t+1],s=e[t+2],l=Math.sin(o),u=Math.cos(o),c=a.radius/Math.sqrt(1-a.eccentricitySquared*l*l);r[n++]=(c+s)*u*Math.cos(i),r[n++]=(c+s)*u*Math.sin(i),r[n++]=(c*(1-a.eccentricitySquared)+s)*l}(e,t,r,n,K.a)}function et(e,t,r,n){var a,i,o,s,l,u,c,f,h,p,d,m,v,b,g,y,w,O,j,x,I,k=ee,M=e[t],S=e[t+1],T=e[t+2];a=Math.abs(T),i=M*M+S*S,o=Math.sqrt(i),s=i+T*T,l=Math.sqrt(s),x=Math.atan2(S,M),u=T*T/s,b=k.a2/l,g=k.a3-k.a4/l,(c=i/s)>.3?(f=a/l*(1+c*(k.a1+b+u*g)/l),j=Math.asin(f),p=f*f,h=Math.sqrt(1-p)):(h=o/l*(1-u*(k.a5-b-c*g)/l),j=Math.acos(h),p=1-h*h,f=Math.sqrt(p)),d=1-K.a.eccentricitySquared*p,m=K.a.radius/Math.sqrt(d),j+=O=(y=h*(g=a-(v=k.a6*m)*f)-f*(b=o-m*h))/(v/d+(w=h*b+f*g)),I=w+y*O/2,T<0&&(j=-j),r[n++]=ft*x,r[n++]=ft*j,r[n]=I}function tt(e,t,r,n){et(e,t,r,n),Ze(r,n,r,n)}function rt(e,t,r,n){et(e,t,r,n),Be(r,n,r,n)}var nt={2:{5:null,8:null,10:null,11:Re,6:Re,1:Ze,7:null,9:null,0:null,3:Be,12:Ge,2:Re,4:$e},5:{5:Re,8:null,10:null,11:Re,6:Re,1:Ze,7:null,9:null,0:null,3:null,12:Ge,2:null,4:$e},8:{5:null,8:Re,10:null,11:Re,6:null,1:null,7:Je,9:null,0:null,3:null,12:null,2:null,4:null},10:{5:null,8:null,10:Re,11:Re,6:null,1:null,7:null,9:Ve,0:null,3:null,12:null,2:null,4:null},3:{5:null,8:null,10:null,11:Ee,6:Ee,1:Le,7:null,9:null,0:null,3:Re,12:function(e,t,r,n){Ee(e,t,r,n),Ge(r,n,r,n)},2:Ee,4:Ne},4:{5:et,8:null,10:null,11:et,6:et,1:tt,7:null,9:null,0:null,3:rt,12:function(e,t,r,n){et(e,t,r,n),Ge(r,n,r,n)},2:et,4:Re},1:{5:Ye,8:null,10:null,11:Ye,6:Ye,1:Re,7:null,9:null,0:null,3:Ke,12:function(e,t,r,n){Ye(e,t,r,n),Ge(r,n,r,n)},2:Ye,4:Qe},7:{5:null,8:Xe,10:null,11:Xe,6:null,1:null,7:Re,9:null,0:null,3:null,12:null,2:null,4:null},9:{5:null,8:null,10:qe,11:qe,6:null,1:null,7:null,9:Re,0:null,3:null,12:null,2:null,4:null},0:{5:null,8:null,10:null,11:null,6:null,1:null,7:null,9:null,0:Re,3:null,12:null,2:null,4:null},11:{5:Re,8:Re,10:Re,11:Re,6:Re,1:Ze,7:Je,9:Ve,0:null,3:Be,12:Ge,2:Re,4:$e},6:{5:null,8:null,10:null,11:Re,6:Re,1:Ze,7:null,9:null,0:null,3:null,12:Ge,2:Re,4:$e},12:{5:Fe,8:null,10:null,11:Fe,6:Fe,1:function(e,t,r,n){Fe(e,t,r,n),Ze(r,n,r,n)},7:null,9:null,0:null,3:function(e,t,r,n){Fe(e,t,r,n),Be(r,n,r,n)},12:Re,2:Fe,4:function(e,t,r,n){Fe(e,t,r,n),$e(r,n,r,n)}}};function at(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ot();return Object(g.i)(e)||Object(g.i)(t)?null:it(e,t,r).projector}function it(e,t,r){if(Object(g.i)(e)||Object(g.i)(t)||r.source.spatialReference===e&&r.dest.spatialReference===t)return r;var n=De(e,r.source),a=De(t,r.dest);return 0===n&&0===a?Object(ae.d)(e,t)?r.projector=Re:r.projector=null:r.projector=nt[n][a],r}function ot(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:Re}}var st={spatialReference:null,spatialReferenceId:0},lt={spatialReference:null,spatialReferenceId:0},ut=ot(),ct=(ot(),Object(b.f)(1)),ft=Object(b.m)(1),ht=Object(j.e)(),pt=Object(j.e)(),dt=Object(j.e)(),mt=Object(j.e)();Object(j.e)()},751:function(e,t,r){"use strict";r.d(t,"a",(function(){return I})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return y})),r.d(t,"f",(function(){return j})),r.d(t,"g",(function(){return m}));var n=r(21),a=r(22),i=r(46),o=r(210),s=r(694),l=r(15),u=r(11),c=r(683),f=r(704),h=l.a.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),p=new o.a,d=Math.PI,m=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function v(e,t,r){var n="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"color"===e.type}))[0]:e;if(n)if("esri.renderers.visualVariables.ColorVariable"===n.declaredClass){var a="number"==typeof t,o=a?null:t,s=o&&o.attributes,l=a?t:null,c=n.field,f=n.cache,p=f.ipData,d=f.hasExpression,m=n.cache.compiledFunc;if(!c&&!d){var v=n.stops;return v&&v[0]&&v[0].color}if("number"!=typeof l)if(d){if(!Object(u.j)(r)||!Object(u.j)(r.arcade))return void h.error("Use of arcade expressions requires an arcade context");var b={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},g=r.arcade.arcadeUtils,y=g.getViewInfo(b),w=g.createExecContext(o,y);if(!m){var O=g.createSyntaxTree(n.valueExpression);m=g.createFunction(O),n.cache.compiledFunc=m}l=g.executeFunction(m,w)}else s&&(l=s[c]);var j=n.normalizationField,I=s?parseFloat(s[j]):void 0;if(null!=l&&(!j||a||!isNaN(I)&&0!==I)){isNaN(I)||a||(l/=I);var k=x(l,p);if(k){var M=k[0],S=k[1],T=M===S?n.stops[M].color:i.a.blendColors(n.stops[M].color,n.stops[S].color,k[2],Object(u.j)(r)?r.color:void 0);return new i.a(T)}}}else h.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable")}function b(e,t,r){var n="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"opacity"===e.type}))[0]:e;if(n)if("esri.renderers.visualVariables.OpacityVariable"===n.declaredClass){var a="number"==typeof t,i=a?null:t,o=i&&i.attributes,s=a?t:null,l=n.field,c=n.cache,f=c.ipData,p=c.hasExpression,d=n.cache.compiledFunc;if(!l&&!p){var m=n.stops;return m&&m[0]&&m[0].opacity}if("number"!=typeof s)if(p){if(Object(u.i)(r)||Object(u.i)(r.arcade))return void h.error("Use of arcade expressions requires an arcade context");var v={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},b=r.arcade.arcadeUtils,g=b.getViewInfo(v),y=b.createExecContext(i,g);if(!d){var w=b.createSyntaxTree(n.valueExpression);d=b.createFunction(w),n.cache.compiledFunc=d}s=b.executeFunction(d,y)}else o&&(s=o[l]);var O=n.normalizationField,j=o?parseFloat(o[O]):void 0;if(null!=s&&(!O||a||!isNaN(j)&&0!==j)){isNaN(j)||a||(s/=j);var I=x(s,f);if(I){var k=I[0],M=I[1];if(k===M)return n.stops[k].opacity;var S=n.stops[k].opacity;return S+(n.stops[M].opacity-S)*I[2]}}}else h.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable")}function g(e,t,r){var n="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"rotation"===e.type}))[0]:e;if(n){if("esri.renderers.visualVariables.RotationVariable"===n.declaredClass){var a=n.axis||"heading",i="heading"===a&&"arithmetic"===n.rotationType?90:0,o="heading"===a&&"arithmetic"===n.rotationType?-1:1,s="number"==typeof t?null:t,l=s&&s.attributes,c=n.field,f=n.cache.hasExpression,p=n.cache.compiledFunc,d=0;if(!c&&!f)return d;if(f){if(Object(u.i)(r)||Object(u.i)(r.arcade))return void h.error("Use of arcade expressions requires an arcade context");var m={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,b=v.getViewInfo(m),g=v.createExecContext(s,b);if(!p){var y=v.createSyntaxTree(n.valueExpression);p=v.createFunction(y),n.cache.compiledFunc=p}d=v.executeFunction(p,g)}else l&&(d=l[c]||0);return d="number"!=typeof d||isNaN(d)?null:i+o*d}h.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable")}}function y(e,t,r){var n="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"size"===e.type}))[0]:e;if(n){if("esri.renderers.visualVariables.SizeVariable"===n.declaredClass){var i=function(e,t,r,n,i){switch(t.transformationType){case"additive":return function(e,t,r,n){return e+(w(t.minSize,r,n)||t.minDataValue)}(e,t,r,n);case"constant":return function(e,t,r){var n=e.stops,a=n&&n.length&&n[0].size;return null==a&&(a=e.minSize),w(a,t,r)}(t,r,n);case"clamped-linear":return function(e,t,r,n){var a=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),i=w(t.minSize,r,n),o=w(t.maxSize,r,n),s=Object(u.j)(n)?n.shape:void 0;if(e<=t.minDataValue)return i;if(e>=t.maxDataValue)return o;if("area"===t.scaleBy&&s){var l="circle"===s,c=l?d*Math.pow(i/2,2):i*i,f=c+a*((l?d*Math.pow(o/2,2):o*o)-c);return l?2*Math.sqrt(f/d):Math.sqrt(f)}return i+a*(o-i)}(e,t,r,n);case"proportional":return function(e,t,r,n){var a=Object(u.j)(n)?n.shape:void 0,i=e/t.minDataValue,o=w(t.minSize,r,n),s=w(t.maxSize,r,n);return O("circle"===a?2*Math.sqrt(i*Math.pow(o/2,2)):"square"===a||"diamond"===a||"image"===a?Math.sqrt(i*Math.pow(o,2)):i*o,o,s)}(e,t,r,n);case"stops":return function(e,t,r,n,i){var o=x(e,i),s=Object(a.a)(o,3),l=s[0],u=s[1],c=s[2];if(l===u)return w(t.stops[l].size,r,n);var f=w(t.stops[l].size,r,n);return f+(w(t.stops[u].size,r,n)-f)*c}(e,t,r,n,i);case"real-world-size":return function(e,t,r,n){var a=(Object(u.j)(n)&&n.resolution?n.resolution:1)*c.a[t.valueUnit],i=w(t.minSize,r,n),o=w(t.maxSize,r,n),s=t.valueRepresentation;return O("area"===s?2*Math.sqrt(e/d)/a:"radius"===s||"distance"===s?2*e/a:e/a,i,o)}(e,t,r,n);case"identity":return e;case"unknown":return null}}(function(e,t,r){var n="number"==typeof t,a=n?null:t,i=a&&a.attributes,o=n?t:null,s=e.cache.isScaleDriven,l=e.cache.compiledFunc;if(s){var c=Object(u.j)(r)?r.scale:void 0,p=Object(u.j)(r)?r.view:void 0;o=null==c||"3d"===p?function(e){var t=null,r=null,n=e.stops;return n?(t=n[0].value,r=n[n.length-1].value):(t=e.minDataValue||0,r=e.maxDataValue||0),(t+r)/2}(e):c}else if(!n)switch(e.inputValueType){case"expression":if(Object(u.i)(r)||Object(u.i)(r.arcade))return void h.error("Use of arcade expressions requires an arcade context");var d={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},m=r.arcade.arcadeUtils,v=m.getViewInfo(d),b=m.createExecContext(a,v);if(!l){var g=m.createSyntaxTree(e.valueExpression);l=m.createFunction(g),e.cache.compiledFunc=l}o=m.executeFunction(l,b);break;case"field":i&&(o=i[e.field]);break;case"unknown":o=null}if(!Object(f.d)(o))return null;if(n||!e.normalizationField)return o;var y=i?parseFloat(i[e.normalizationField]):null;return Object(f.d)(y)&&0!==y?o/y:null}(n,t,r),n,t,r,n.cache.ipData);return null==i||isNaN(i)?0:i}h.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable")}}function w(e,t,r){return null==e?null:Object(f.c)(e)?y(e,t,r):Object(f.d)(e)?e:null}function O(e,t,r){return Object(f.d)(r)&&e>r?r:Object(f.d)(t)&&e<t?t:e}function j(e,t,r){if(!(e.cache.isScaleDriven&&"3d"===r||t))return null;var n={scale:t,view:r},a=w(e.minSize,p,n),i=w(e.maxSize,p,n);if(null!=a||null!=i){if(a>i){var o=i;i=a,a=o}return{minSize:a,maxSize:i}}}function x(e,t){if(t){var r=0,n=t.length-1;return t.some((function(t,a){return e<t?(n=a,!0):(r=a,!1)})),[r,n,(e-t[r])/(t[n]-t[r])]}}function I(e,t,r){var a,i=["proportional","proportional","proportional"],o=Object(n.a)(e);try{for(o.s();!(a=o.n()).done;){var l=a.value,u=l.useSymbolValue?"symbol-value":y(l,t,r);switch(l.axis){case"width":i[0]=u;break;case"depth":i[1]=u;break;case"height":i[2]=u;break;case"width-and-depth":i[0]=u,i[1]=u;break;case"all":case void 0:case null:i[0]=u,i[1]=u,i[2]=u;break;default:Object(s.a)(l.axis)}}}catch(c){o.e(c)}finally{o.f()}return i}},760:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n,a=r(22),i=r(2),o=r(4),s=r(5),l=r(6),u=r(0),c=(r(19),r(29)),f=r(26),h=r(18),p=r(15),d=r(11),m=r(1),v=r(97),b=r(10),g=p.a.getLogger("esri.layers.support.PixelBlock"),y=n=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).width=null,n.height=null,n.pixelType="f32",n.validPixelCount=null,n.mask=null,n.maskIsAlpha=!1,n.pixels=null,n.statistics=null,n}return Object(o.a)(r,[{key:"castPixelType",value:function(e){if(!e)return"f32";var t=e.toLowerCase();return["u1","u2","u4"].indexOf(t)>-1?t="u8":-1===["unknown","u8","s8","u16","s16","u32","s32","f32","f64"].indexOf(t)&&(t="f32"),t}},{key:"getPlaneCount",value:function(){return this.pixels&&this.pixels.length}},{key:"addData",value:function(e){if(!e.pixels||e.pixels.length!==this.width*this.height)throw new c.a("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]),this.statistics||(this.statistics=[]),this.pixels.push(e.pixels),this.statistics.push(e.statistics||{minValue:null,maxValue:null})}},{key:"getAsRGBA",value:function(){var e=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(e);break;default:this._fillFrom8Bit(e)}return new Uint8ClampedArray(e)}},{key:"getAsRGBAFloat",value:function(){var e=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(e),e}},{key:"updateStatistics",value:function(){var e=this;this.statistics=this.pixels.map((function(t){return e._calculateBandStatistics(t,e.mask)}));var t=this.mask,r=0;if(t)for(var n=0;n<t.length;n++)t[n]&&r++;else r=this.width*this.height;this.validPixelCount=r}},{key:"clamp",value:function(e){if(e&&"f64"!==e&&"f32"!==e){var t;switch(e){case"u8":t=[0,255];break;case"u16":t=[0,65535];break;case"u32":t=[0,4294967295];break;case"s8":t=[-128,127];break;case"s16":t=[-32768,32767];break;case"s32":t=[-2147483648,2147483647];break;default:t=[-34e38,34e38]}for(var r,i,o,s=t,l=Object(a.a)(s,2),u=l[0],c=l[1],f=this.pixels,h=this.width*this.height,p=f.length,d=[],m=0;m<p;m++){o=n.createEmptyBand(e,h),r=f[m];for(var v=0;v<h;v++)i=r[v],o[v]=i>c?c:i<u?u:i;d.push(o)}this.pixels=d,this.pixelType=e}}},{key:"extractBands",value:function(e){var t=this;if(Object(d.i)(e)||0===e.length||null==this.pixels||0===this.pixels.length)return this;var r=this.pixels.length,a=e.some((function(e){return e>=t.pixels.length})),i=r===e.length&&!e.some((function(e,t){return e!==t}));return a||i?this:new n({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:e.map((function(e){return t.pixels[e]})),statistics:this.statistics&&e.map((function(e){return t.statistics[e]}))})}},{key:"clone",value:function(){var e,t=new n({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(this.mask instanceof Uint8Array?t.mask=new Uint8Array(this.mask):t.mask=this.mask.slice(0));var r=n.getPixelArrayConstructor(this.pixelType);if(this.pixels&&this.pixels.length>0){t.pixels=[];var a=this.pixels[0].slice;for(e=0;e<this.pixels.length;e++)t.pixels[e]=a?this.pixels[e].slice(0,this.pixels[e].length):new r(this.pixels[e])}if(this.statistics)for(t.statistics=[],e=0;e<this.statistics.length;e++)t.statistics[e]=Object(h.a)(this.statistics[e]);return t}},{key:"_fillFrom8Bit",value:function(e){var t=this.mask,r=this.maskIsAlpha,n=this.pixels;if(e&&n&&n.length){var a,i,o,s;a=i=o=n[0],n.length>=3?(i=n[1],o=n[2]):2===n.length&&(i=n[1]);var l=new Uint32Array(e),u=this.width*this.height;if(a.length===u)if(t&&t.length===u)if(r)for(s=0;s<u;s++)t[s]&&(l[s]=t[s]<<24|o[s]<<16|i[s]<<8|a[s]);else for(s=0;s<u;s++)t[s]&&(l[s]=255<<24|o[s]<<16|i[s]<<8|a[s]);else for(s=0;s<u;s++)l[s]=255<<24|o[s]<<16|i[s]<<8|a[s];else g.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.")}else g.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}},{key:"_fillFromNon8Bit",value:function(e){var t=this.pixels,r=this.mask,n=this.statistics;if(e&&t&&t.length){var a=this.pixelType,i=1,o=0,s=1;if(n&&n.length>0)o=n.map((function(e){return e.minValue})).reduce((function(e,t){return Math.min(e,t)})),s=n.map((function(e){return e.maxValue-e.minValue})).reduce((function(e,t){return Math.max(e,t)})),i=255/s;else{var l=255;"s8"===a?(o=-128,l=127):"u16"===a?l=65535:"s16"===a?(o=-32768,l=32767):"u32"===a?l=4294967295:"s32"===a?(o=-2147483648,l=2147483647):"f32"===a?(o=-34e38,l=34e38):"f64"===a&&(o=-Number.MAX_VALUE,l=Number.MAX_VALUE),i=255/(l-o)}var u,c,f,h,p,d=new Uint32Array(e),m=this.width*this.height;if((u=c=f=t[0]).length!==m)return g.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(t.length>=2)if(c=t[1],t.length>=3&&(f=t[2]),r&&r.length===m)for(h=0;h<m;h++)r[h]&&(d[h]=255<<24|(f[h]-o)*i<<16|(c[h]-o)*i<<8|(u[h]-o)*i);else for(h=0;h<m;h++)d[h]=255<<24|(f[h]-o)*i<<16|(c[h]-o)*i<<8|(u[h]-o)*i;else if(r&&r.length===m)for(h=0;h<m;h++)p=(u[h]-o)*i,r[h]&&(d[h]=255<<24|p<<16|p<<8|p);else for(h=0;h<m;h++)p=(u[h]-o)*i,d[h]=255<<24|p<<16|p<<8|p}else g.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}},{key:"_fillFrom32Bit",value:function(e){var t,r,n,a,i=this.pixels,o=this.mask;if(!e||!i||!i.length)return g.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");t=r=n=i[0],i.length>=3?(r=i[1],n=i[2]):2===i.length&&(r=i[1]);var s=this.width*this.height;if(t.length!==s)return g.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var l=0;if(o&&o.length===s)for(a=0;a<s;a++)e[l++]=t[a],e[l++]=r[a],e[l++]=n[a],e[l++]=1&o[a];else for(a=0;a<s;a++)e[l++]=t[a],e[l++]=r[a],e[l++]=n[a],e[l++]=1}},{key:"_calculateBandStatistics",value:function(e,t){var r,n=1/0,a=-1/0,i=e.length,o=0;if(t)for(r=0;r<i;r++)t[r]&&(n=(o=e[r])<n?o:n,a=o>a?o:a);else for(r=0;r<i;r++)n=(o=e[r])<n?o:n,a=o>a?o:a;return{minValue:n,maxValue:a}}}],[{key:"createEmptyBand",value:function(e,t){return new(n.getPixelArrayConstructor(e))(t)}},{key:"getPixelArrayConstructor",value:function(e){var t;switch(e){case"u1":case"u2":case"u4":case"u8":t=Uint8Array;break;case"u16":t=Uint16Array;break;case"u32":case"u32":t=Uint32Array;break;case"s8":t=Int8Array;break;case"s16":t=Int16Array;break;case"s32":t=Int32Array;break;case"f32":case"c64":case"c128":case"unknown":t=Float32Array;break;case"f64":t=Float64Array}return t}}]),r}(f.a);Object(u.a)([Object(m.b)({json:{write:!0}})],y.prototype,"width",void 0),Object(u.a)([Object(m.b)({json:{write:!0}})],y.prototype,"height",void 0),Object(u.a)([Object(m.b)({json:{write:!0}})],y.prototype,"pixelType",void 0),Object(u.a)([Object(v.a)("pixelType")],y.prototype,"castPixelType",null),Object(u.a)([Object(m.b)({json:{write:!0}})],y.prototype,"validPixelCount",void 0),Object(u.a)([Object(m.b)({json:{write:!0}})],y.prototype,"mask",void 0),Object(u.a)([Object(m.b)({json:{write:!0}})],y.prototype,"maskIsAlpha",void 0),Object(u.a)([Object(m.b)({json:{write:!0}})],y.prototype,"pixels",void 0),Object(u.a)([Object(m.b)({json:{write:!0}})],y.prototype,"statistics",void 0);var w=y=n=Object(u.a)([Object(b.a)("esri.layers.support.PixelBlock")],y)},764:function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return f})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return u})),r.d(t,"h",(function(){return o})),r.d(t,"i",(function(){return i})),r.d(t,"j",(function(){return d})),r.d(t,"k",(function(){return b})),r.d(t,"l",(function(){return m})),r.d(t,"m",(function(){return g})),r.d(t,"n",(function(){return k})),r.d(t,"o",(function(){return p}));var n=r(11),a=r(760);function i(e){return Object(n.j)(e)&&"esri.layers.support.PixelBlock"===e.declaredClass&&e.pixels&&e.pixels.length>0}function o(e,t){if(null==t||!t.length||!i(e))return e;var r=e.pixels.length;return t&&t.some((function(e){return e>=r}))||1===r&&1===t.length&&0===t[0]?e:r!==t.length||t.some((function(e,t){return e!==t}))?new a.a({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:t.map((function(t){return e.pixels[t]})),statistics:e.statistics&&t.map((function(t){return e.statistics[t]}))}):e}function s(e){if(e){var t=e.colormap;if(t&&0!==t.length){var r=t.sort((function(e,t){return e[0]-t[0]})),n=0;r[0][0]<0&&(n=r[0][0]);var a,i=Math.max(256,r[r.length-1][0]-n+1),o=new Uint8Array(4*i),s=[],l=0,u=0,c=5===r[0].length;if(i>65536)return r.forEach((function(e){s[e[0]-n]=c?e.slice(1):e.slice(1).concat([255])})),{indexed2DColormap:s,offset:n,alphaSpecified:c};if(e.fillUnspecified)for(l=(a=r[u])[0]-n;l<i;l++)o[4*l]=a[1],o[4*l+1]=a[2],o[4*l+2]=a[3],o[4*l+3]=c?a[4]:255,l===a[0]-n&&(a=u===r.length-1?a:r[++u]);else for(l=0;l<r.length;l++)o[u=4*((a=r[l])[0]-n)]=a[1],o[u+1]=a[2],o[u+2]=a[3],o[u+3]=c?a[4]:255;return{indexedColormap:o,offset:n,alphaSpecified:c}}}}function l(e,t){if(!i(e))return e;if(!t&&(t.indexedColormap||t.indexed2DColormap))return e;var r=e.clone(),n=r.pixels,a=r.mask,o=r.width*r.height;if(1!==n.length)return e;var s,l=t.indexedColormap,u=t.indexed2DColormap,c=t.offset,f=t.alphaSpecified,h=l.length-1,p=0,d=n[0],m=new Uint8Array(d.length),v=new Uint8Array(d.length),b=new Uint8Array(d.length),g=0;if(l)if(a)for(p=0;p<o;p++)a[p]&&((g=4*(d[p]-c))<c||g>h?a[p]=0:(m[p]=l[g],v[p]=l[g+1],b[p]=l[g+2],a[p]=l[g+3]));else{for(a=new Uint8Array(o),p=0;p<o;p++)(g=4*(d[p]-c))<c||g>h?a[p]=0:(m[p]=l[g],v[p]=l[g+1],b[p]=l[g+2],a[p]=l[g+3]);r.mask=a}else if(a)for(p=0;p<o;p++)a[p]&&(s=u[d[p]],m[p]=s[0],v[p]=s[1],b[p]=s[2],a[p]=s[3]);else{for(a=new Uint8Array(o),p=0;p<o;p++)s=u[d[p]],m[p]=s[0],v[p]=s[1],b[p]=s[2],a[p]=s[3];r.mask=a}return r.pixels=[m,v,b],r.statistics=null,r.pixelType="u8",r.maskIsAlpha=f,r}function u(e){if(!i(e))return null;e.statistics||e.updateStatistics();var t,r,n,a,o,s,l,u,c,f,h,p,d,m,v=e.pixels,b=e.mask,g=e.pixelType,y=e.statistics,w=e.width*e.height,O=v.length,j=[],x=[],I=256;for(a=0;a<O;a++){if(s=new Uint32Array(I),u=v[a],"u8"===g)if(t=-.5,r=255.5,b)for(o=0;o<w;o++)b[o]&&s[u[o]]++;else for(o=0;o<w;o++)s[u[o]]++;else{if(t=y[a].minValue,n=((r=y[a].maxValue)-t)/I,l=new Uint32Array(257),b)for(o=0;o<w;o++)b[o]&&l[Math.floor((u[o]-t)/n)]++;else for(o=0;o<w;o++)l[Math.floor((u[o]-t)/n)]++;for(o=0;o<255;o++)s[o]=l[o];s[255]=l[255]+l[256]}for(j.push({min:t,max:r,size:I,counts:s}),c=0,f=0,d=0,o=0;o<I;o++)c+=s[o],f+=o*s[o];for(m=f/c,o=0;o<I;o++)d+=s[o]*Math.pow(o-m,2);h=(m+.5)*(n=(r-t)/I)+t,p=Math.sqrt(d/(c-1))*n,x.push({min:t,max:r,avg:h,stddev:p})}return{statistics:x,histograms:j}}function c(e){for(var t=[],r=0;r<e.length;r++){for(var n=e[r],a=n.min,i=n.max,o=n.size,s=n.counts,l=0,u=0,c=0;c<o;c++)l+=s[c],u+=c*s[c];for(var f=u/l,h=0,p=0;p<o;p++)h+=s[p]*Math.pow(p-f,2);var d=(i-a)/o,m=(f+.5)*d+a,v=Math.sqrt(h/(l-1))*d;t.push({min:a,max:i,avg:m,stddev:v})}return t}function f(e){var t=e.minCutOff,r=e.maxCutOff,n=e.gamma,a=e.pixelType,i=e.outMin||0,o=e.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(a))return null;var s,l,u=t.length,c=0;"s8"===a?c=-127:"s16"===a&&(c=-32767);var f=256;["u16","s16"].indexOf(a)>-1&&(f=65536);var h=[],p=[],d=o-i;for(s=0;s<u;s++)p[s]=r[s]-t[s],h[s]=d/(r[s]-t[s]);var m,v=n&&n.length>=u,b=[];if(v)for(s=0;s<u;s++)n[s]>1?n[s]>2?b[s]=6.5+Math.pow(n[s]-2,2.5):b[s]=6.5+100*Math.pow(2-n[s],4):b[s]=1;var g,y,w,O=[];if(v)for(s=0;s<u;s++){for(w=[],l=0;l<f;l++)m=((g=l+c)-t[s])/p[s],y=1,n[s]>1&&(y-=Math.pow(1/d,m*b[s])),g<r[s]&&g>t[s]?w[l]=Math.floor(y*d*Math.pow(m,1/n[s]))+i:g>=r[s]?w[l]=o:w[l]=i;O[s]=w}else for(s=0;s<u;s++){for(w=[],l=0;l<f;l++)(g=l+c)<=t[s]?w[l]=i:g>=r[s]?w[l]=o:w[l]=Math.floor((g-t[s])/p[s]*d)+i;O[s]=w}if(null!=e.contrastOffset){var j=function(e,t){var r,n,a=Math.min(Math.max(e,-100),100),i=Math.min(Math.max(t,-100),100),o=255,s=128,l=new Uint8Array(256);for(r=0;r<256;r++)a>0&&a<100?n=(200*r-100*o+2*o*i)/(2*(100-a))+s:a<=0&&a>-100?n=(200*r-100*o+2*o*i)*(100+a)/2e4+s:100===a?n=(n=200*r-100*o+(o+1)*(100-a)+2*o*i)>0?o:0:-100===a&&(n=s),l[r]=n>o?o:n<0?0:n;return l}(e.contrastOffset,e.brightnessOffset);for(s=0;s<u;s++)for(w=O[s],l=0;l<f;l++)w[l]=j[w[l]]}return{lut:O,offset:c}}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256;t=Math.min(t,256);for(var r=e.size,n=e.counts,a=new Uint8Array(r),i=n.reduce((function(e,r){return e+r/t}),0),o=0,s=0,l=0,u=i,c=0;c<r;c++)if(l+=n[c],!(c<r-1&&l+n[c+1]<u)){for(;o<t-1&&u<l;)o++,u+=i;for(var f=s;f<=c;f++)a[f]=o;s=c+1}for(var h=s;h<r;h++)a[h]=t-1;return a}function p(e,t){if(!i(e))return null;var r,n,a,o,s,l=e.clone(),u=l.pixels,c=l.mask,f=t.minCutOff,h=t.maxCutOff,p=t.gamma,d=t.outMin||0,m=t.outMax||255,v=l.width*l.height,b=u.length,g=m-d,y=[],w=[];for(r=0;r<b;r++)w[r]=h[r]-f[r],y[r]=g/(h[r]-f[r]);var O=p&&p.length>=b,j=[];if(O)for(r=0;r<b;r++)p[r]>1?p[r]>2?j[r]=6.5+Math.pow(p[r]-2,2.5):j[r]=6.5+100*Math.pow(2-p[r],4):j[r]=1;if(O)if(null!=c){for(n=0;n<v;n++)if(c[n])for(r=0;r<b;r++)s=((a=u[r][n])-f[r])/w[r],o=1,p[r]>1&&(o-=Math.pow(1/g,s*j[r])),a<h[r]&&a>f[r]?u[r][n]=Math.floor(o*g*Math.pow(s,1/p[r]))+d:a>=h[r]?u[r][n]=m:u[r][n]=d}else for(n=0;n<v;n++)for(r=0;r<b;r++)s=((a=u[r][n])-f[r])/w[r],o=1,p[r]>1&&(o-=Math.pow(1/g,s*j[r])),a<h[r]&&a>f[r]?u[r][n]=Math.floor(o*g*Math.pow(s,1/p[r]))+d:a>=h[r]?u[r][n]=m:u[r][n]=d;else if(null!=c){for(n=0;n<v;n++)if(c[n])for(r=0;r<b;r++)(a=u[r][n])<h[r]&&a>f[r]?u[r][n]=Math.floor((a-f[r])/w[r]*g)+d:a>=h[r]?u[r][n]=m:u[r][n]=d}else for(n=0;n<v;n++)for(r=0;r<b;r++)(a=u[r][n])<h[r]&&a>f[r]?u[r][n]=Math.floor((a-f[r])/w[r]*g)+d:a>=h[r]?u[r][n]=m:u[r][n]=d;return l.pixelType="u8",l.updateStatistics(),l}function d(e,t){if(!i(e))return null;var r,n,o=e.pixels,s=e.mask,l=e.width*e.height,u=o.length,c=t.lut,f=t.offset;c&&1===c[0].length&&(c=o.map((function(){return c})));var h,p,d,m=[];if(f)if(null==s)for(r=0;r<u;r++){for(h=o[r],p=c[r],d=new Uint8Array(l),n=0;n<l;n++)d[n]=p[h[n]-f];m.push(d)}else for(r=0;r<u;r++){for(h=o[r],p=c[r],d=new Uint8Array(l),n=0;n<l;n++)s[n]&&(d[n]=p[h[n]-f]);m.push(d)}else if(null==s)for(r=0;r<u;r++){for(h=o[r],p=c[r],d=new Uint8Array(l),n=0;n<l;n++)d[n]=p[h[n]];m.push(d)}else for(r=0;r<u;r++){for(h=o[r],p=c[r],d=new Uint8Array(l),n=0;n<l;n++)s[n]&&(d[n]=p[h[n]]);m.push(d)}var v=new a.a({width:e.width,height:e.height,pixels:m,mask:s,pixelType:"u8"});return v.updateStatistics(),v}function m(e,t){if(!i(e))return null;var r,n,a,o,s,l,u=e.clone(),c=u.pixels,f=u.width*u.height,h=t.length,p=Math.floor(h/2),d=t[Math.floor(p)],m=c[0],v=!1,b=new Uint8Array(f),g=new Uint8Array(f),y=new Uint8Array(f),w=u.mask,O=4===t[0].mappedColor.length;for(w||((w=new Uint8Array(f)).fill(O?255:1),u.mask=w),s=0;s<f;s++)if(w[s]){for(r=m[s],v=!1,l=p,n=d,a=0,o=h-1;o-a>1;){if(r===n.value){v=!0;break}r>n.value?a=l:o=l,l=Math.floor((a+o)/2),n=t[Math.floor(l)]}v||(r===t[a].value?(n=t[a],v=!0):r===t[o].value?(n=t[o],v=!0):r<t[a].value?(v=!1,n=null):r>t[a].value&&(r<t[o].value?(n=t[a],v=!0):o===h-1?(v=!1,n=null):(n=t[o],v=!0))),v?(b[s]=n.mappedColor[0],g[s]=n.mappedColor[1],y[s]=n.mappedColor[2],w[s]=n.mappedColor[3]):b[s]=g[s]=y[s]=w[s]=0}return u.pixels=[b,g,y],u.mask=w,u.pixelType="u8",u.maskIsAlpha=O,u}function v(e,t,r,n,a,i){var o=r.block,s=o.width,l=o.height,u=r.offset,c=u.x,f=u.y,h=r.mosaic,p=h.width,d=function(e,t,r,n,a,i,o,s){return{xmin:a<=r*e?0:a<r*e+e?a-r*e:e,ymin:i<=n*t?0:i<n*t+t?i-n*t:t,xmax:a+o<=r*e?0:a+o<r*e+e?a+o-r*e:e,ymax:i+s<=n*t?0:i+s<n*t+t?i+s-n*t:t}}(s,l,n,a,c,f,p,h.height),m=0,v=0;if(i){var b=i.hasGCSSShiftTransform?360:i.halfWorldWidth,g=s*i.resolutionX,y=i.startX+n*g;y<b&&y+g>b?v=i.rightPadding:y>=b&&(m=i.leftMargin-i.rightPadding,v=0)}if(d.xmax-=v,"number"!=typeof t)for(var w=d.ymin;w<d.ymax;w++)for(var O=(a*l+w-f)*p+(n*s-c)+m,j=w*s,x=d.xmin;x<d.xmax;x++)e[O+x]=t[j+x];else for(var I=d.ymin;I<d.ymax;I++)for(var k=(a*l+I-f)*p+(n*s-c)+m,M=d.xmin;M<d.xmax;M++)e[k+M]=t}function b(e,t,r,o,s){var l=e.filter((function(e){return i(e)}))[0];if(Object(n.i)(l))return null;for(var u,c,f=o?o.width:t.width,h=o?o.height:t.height,p=l.width,d=l.height,m=t.width/p,b=t.height/d,g={offset:r||{x:0,y:0},mosaic:o||t,block:{width:p,height:d}},y=l.pixelType,w=a.a.getPixelArrayConstructor(y),O=l.pixels.length,j=[],x=0;x<O;x++){u=new w(f*h);for(var I=0;I<b;I++)for(var k=0;k<m;k++){var M=e[I*m+k];i(M)&&v(u,M.pixels[x],g,k,I,s)}j.push(u)}if(e.some((function(e){return Object(n.i)(e)||e.mask&&e.mask.length>0}))){c=new Uint8Array(f*h);for(var S=0;S<b;S++)for(var T=0;T<m;T++){var C=e[S*m+T];v(c,(Object(n.j)(C)?C.mask:null)||(C?1:0),g,T,S,s)}}var A=new a.a({width:f,height:h,pixels:j,pixelType:y,mask:c});return A.updateStatistics(),A}function g(e,t,r){if(!i(e))return null;var n=e.width,a=e.height,o=t.x,s=t.y,l=r.width+o,u=r.height+s;if(o<0||s<0||l>n||u>a)return e;if(0===o&&0===s&&l===n&&u===a)return e;e.mask||(e.mask=new Uint8Array(n*a));for(var c=e.mask,f=0;f<a;f++)for(var h=f*n,p=0;p<n;p++)c[h+p]=f<s||f>=u||p<o||p>=l?0:1;return e.updateStatistics(),e}function y(e){if(!i(e))return null;for(var t=e.clone(),r=e.width,n=e.height,a=e.pixels,o=e.mask,s=a[0],l=t.pixels[0],u=2;u<n-1;u++){for(var c=new Map,f=u-2;f<u+2;f++)for(var h=0;h<4;h++){var p=f*r+h;j(c,s[p],o?o[p]:1)}l[u*r]=w(c),l[u*r+1]=l[u*r+2]=l[u*r];for(var d=3;d<r-1;d++){var m=(u-2)*r+d+1;j(c,s[m],o?o[m]:1),j(c,s[m=(u-1)*r+d+1],o?o[m]:1),j(c,s[m=u*r+d+1],o?o[m]:1),j(c,s[m=(u+1)*r+d+1],o?o[m]:1),O(c,s[m=(u-2)*r+d-3],o?o[m]:1),O(c,s[m=(u-1)*r+d-3],o?o[m]:1),O(c,s[m=u*r+d-3],o?o[m]:1),O(c,s[m=(u+1)*r+d-3],o?o[m]:1),l[u*r+d]=w(c)}l[u*r+d+1]=l[u*r+d]}for(var v=0;v<r;v++)l[v]=l[r+v]=l[2*r+v],l[(n-1)*r+v]=l[(n-2)*r+v];return t.updateStatistics(),t}function w(e){if(0===e.size)return 0;for(var t=0,r=-1,n=0,a=e.keys(),i=a.next();!i.done;)(n=e.get(i.value))>t&&(r=i.value,t=n),i=a.next();return r}function O(e,t,r){if(0!==r){var n=e.get(t);1===n?e.delete(t):e.set(t,n-1)}}function j(e,t,r){0!==r&&e.set(t,e.has(t)?e.get(t)+1:1)}function x(e,t,r){var n=t.x,o=t.y,s=r.width,l=r.height;if(0===n&&0===o&&l===e.height&&s===e.width)return e;var u=e.width,c=e.height,f=Math.max(0,o),h=Math.max(0,n),p=Math.min(n+s,u),d=Math.min(o+l,c);if(p<0||d<0||!i(e))return null;n=Math.max(0,-n),o=Math.max(0,-o);for(var m=e.pixels,v=e.mask,b=s*l,g=m.length,y=[],w=0;w<g;w++){for(var O=m[w],j=a.a.createEmptyBand(e.pixelType,b),x=f;x<d;x++)for(var I=x*u,k=(x+o-f)*s+n,M=h;M<p;M++)j[k++]=O[I+M];y.push(j)}for(var S=new Uint8Array(b),T=f;T<d;T++)for(var C=T*u,A=(T+o-f)*s+n,_=h;_<p;_++)S[A++]=v?v[C+_]:1;var P=new a.a({width:r.width,height:r.height,pixelType:e.pixelType,pixels:y,mask:S});return P.updateStatistics(),P}function I(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!i(e))return null;for(var r=e.pixels,n=e.width,o=e.height,s=e.mask,l=e.pixelType,u=[],c=Math.round(n/2),f=Math.round(o/2),h=o-1,p=n-1,d=0;d<r.length;d++){for(var m=r[d],v=a.a.createEmptyBand(l,c*f),b=0,g=0;g<o;g+=2)for(var y=0;y<n;y+=2){var w=m[g*n+y];if(t){var O=y===p?w:m[g*n+y+1],j=g===h?w:m[g*n+y+n],x=y===p?j:g===h?O:m[g*n+y+n+1];v[b++]=(w+O+j+x)/4}else v[b++]=w}u.push(v)}var I=null;if(s){I=new Uint8Array(c*f);for(var k=0,M=0;M<o;M+=2)for(var S=0;S<n;S+=2){var T=s[M*n+S];if(t){var C=S===p?T:s[M*n+S+1],A=M===h?T:s[M*n+S+n],_=S===p?A:M===h?C:s[M*n+S+n+1];I[k++]=T*C*A*_?1:0}else I[k++]=T}}return new a.a({width:c,height:f,pixelType:l,pixels:u,mask:I})}function k(e,t,r){if(!i(e))return null;for(var n=t.width,a=t.height,o=e.width,s=e.height,l=new Map,u={x:0,y:0},c=null==r?1:1+r,f=e,h=0;h<c;h++){for(var p=Math.ceil(o/n),d=Math.ceil(s/a),m=0;m<d;m++){u.y=m*a;for(var v=0;v<p;v++){u.x=v*n;var b=x(f,u,t);l.set("".concat(h,"/").concat(m,"/").concat(v),b)}}h<c-1&&(f=I(f)),o=Math.round(o/2),s=Math.round(s/2)}return l}function M(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"nearest";if(!i(e))return null;"majority"===o&&(e=y(e));for(var s,l,u,c,f,h,p,d=e,m=d.pixels,v=d.mask,b=d.pixelType,g=e.width,w=e.height,O=a.a.getPixelArrayConstructor(b),j=m.length,x=t.width,I=t.height,k=n.cols,M=n.rows,S=Math.ceil(x/k-.1/k),T=Math.ceil(I/M-.1/M),C=!1,A=0;A<r.length;A+=3)-1===r[A]&&-1===r[A+1]&&-1===r[A+2]&&(C=!0);for(var _,P,D=S*k,R=D*T*M,E=new Float32Array(R),L=new Float32Array(R),N=0,B="majority"===o?0:.5,U=0;U<T;U++)for(var z=0;z<S;z++){l=r[s=12*(U*S+z)],u=r[s+1],c=r[s+2],f=r[s+3],h=r[s+4],p=r[s+5];for(var G=0;G<M;G++){N=(U*M+G)*D+z*k,P=(G+.5)/M;for(var F=0;F<G;F++)_=(F+.5)/k,E[N+F]=Math.round((l*_+u*P+c)*g-B),L[N+F]=Math.round((f*_+h*P+p)*w-B)}l=r[s+=6],u=r[s+1],c=r[s+2],f=r[s+3],h=r[s+4],p=r[s+5];for(var H=0;H<M;H++){N=(U*M+H)*D+z*k,P=(H+.5)/M;for(var V=H;V<k;V++)_=(V+.5)/k,E[N+V]=Math.round((l*_+u*P+c)*g-B),L[N+V]=Math.round((f*_+h*P+p)*w-B)}}for(var J,Z=function(e,t){for(var r=0;r<I;r++){s=r*D;for(var n=0;n<x;n++)E[s]<0||L[s]<0?e[r*x+n]=0:e[r*x+n]=t[E[s]+L[s]*g],s++}},W=[],q=0;q<j;q++)Z(J=new O(x*I),m[q]),W.push(J);var X=new a.a({width:x,height:I,pixelType:b,pixels:W});if(v)X.mask=new Uint8Array(x*I),Z(X.mask,v);else if(C){X.mask=new Uint8Array(x*I);for(var Y=0;Y<x*I;Y++)X.mask[Y]=E[Y]<0||L[Y]<0?0:1}return X.updateStatistics(),X}},768:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,a=r(2),i=r(4),o=r(5),s=r(6),l=r(0),u=r(26),c=r(1),f=(r(19),r(14)),h=(r(15),r(10)),p=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).cols=null,n.level=0,n.levelValue=null,n.resolution=0,n.rows=null,n.scale=0,n}return Object(i.a)(r,[{key:"clone",value:function(){return new n({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}}]),r}(u.a);Object(l.a)([Object(c.b)({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],p.prototype,"cols",void 0),Object(l.a)([Object(c.b)({type:f.a,json:{write:!0}})],p.prototype,"level",void 0),Object(l.a)([Object(c.b)({type:String,json:{write:!0}})],p.prototype,"levelValue",void 0),Object(l.a)([Object(c.b)({type:Number,json:{write:!0}})],p.prototype,"resolution",void 0),Object(l.a)([Object(c.b)({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],p.prototype,"rows",void 0),Object(l.a)([Object(c.b)({type:Number,json:{write:!0}})],p.prototype,"scale",void 0);var d=p=n=Object(l.a)([Object(h.a)("esri.layers.support.LOD")],p)},771:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),a=r(4),i=r(708),o=function(){function e(t,r){Object(n.a)(this,e),this._storage=new i.b,this._storage.maxSize=t,r&&this._storage.registerRemoveFunc("",r)}return Object(a.a)(e,[{key:"put",value:function(e,t){this._storage.put(e,t,1,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.destroy()}}]),e}()},780:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,a,i,o={exports:{}};a=o,void 0!==(n=function(){function e(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return e.prototype={ensureBuffer:function(e){var t=this.buffer,r=t?t.byteLength:0;if(e<r)return t;for(var n=512;n<e;)n<<=1;for(var a=new Uint8Array(n),i=0;i<r;++i)a[i]=t[i];return this.buffer=a},getByte:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(e){var t=this.pos;if(e){this.ensureBuffer(t+e);for(var r=t+e;!this.eof&&this.bufferLength<r;)this.readBlock();var n=this.bufferLength;r>n&&(r=n)}else{for(;!this.eof;)this.readBlock();r=this.bufferLength}return this.pos=r,this.buffer.subarray(t,r)},lookChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(e,t,r){for(var n=e+t;this.bufferLength<=n&&!this.eof;)this.readBlock();return new Stream(this.buffer,e,t,r)},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=0}},e}(),i=function(){if(!self||!self.Uint32Array)return null;var e=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),t=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),r=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),a=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],i=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];function o(e){throw new Error(e)}function s(e){var t=0,r=e[t++],a=e[t++];-1!=r&&-1!=a||o("Invalid header in flate stream"),8!=(15&r)&&o("Unknown compression method in flate stream"),((r<<8)+a)%31!=0&&o("Bad FCHECK in flate stream"),32&a&&o("FDICT bit set in flate stream"),this.bytes=e,this.bytesPos=2,this.codeSize=0,this.codeBuf=0,n.call(this)}return s.prototype=Object.create(n.prototype),s.prototype.getBits=function(e){for(var t,r=this.codeSize,n=this.codeBuf,a=this.bytes,i=this.bytesPos;r<e;)void 0===(t=a[i++])&&o("Bad encoding in flate stream"),n|=t<<r,r+=8;return t=n&(1<<e)-1,this.codeBuf=n>>e,this.codeSize=r-=e,this.bytesPos=i,t},s.prototype.getCode=function(e){for(var t=e[0],r=e[1],n=this.codeSize,a=this.codeBuf,i=this.bytes,s=this.bytesPos;n<r;){var l;void 0===(l=i[s++])&&o("Bad encoding in flate stream"),a|=l<<n,n+=8}var u=t[a&(1<<r)-1],c=u>>16,f=65535&u;return(0==n||n<c||0==c)&&o("Bad encoding in flate stream"),this.codeBuf=a>>c,this.codeSize=n-c,this.bytesPos=s,f},s.prototype.generateHuffmanTable=function(e){for(var t=e.length,r=0,n=0;n<t;++n)e[n]>r&&(r=e[n]);for(var a=1<<r,i=new Uint32Array(a),o=1,s=0,l=2;o<=r;++o,s<<=1,l<<=1)for(var u=0;u<t;++u)if(e[u]==o){var c=0,f=s;for(n=0;n<o;++n)c=c<<1|1&f,f>>=1;for(n=c;n<a;n+=l)i[n]=o<<16|u;++s}return[i,r]},s.prototype.readBlock=function(){function n(e,t,r,n,a){for(var i=e.getBits(r)+n;i-- >0;)t[d++]=a}var s=this.getBits(3);if(1&s&&(this.eof=!0),0!=(s>>=1)){var l,u;if(1==s)l=a,u=i;else if(2==s){for(var c=this.getBits(5)+257,f=this.getBits(5)+1,h=this.getBits(4)+4,p=Array(e.length),d=0;d<h;)p[e[d++]]=this.getBits(3);for(var m=this.generateHuffmanTable(p),v=0,b=(d=0,c+f),g=new Array(b);d<b;){var y=this.getCode(m);16==y?n(this,g,2,3,v):17==y?n(this,g,3,3,v=0):18==y?n(this,g,7,11,v=0):g[d++]=v=y}l=this.generateHuffmanTable(g.slice(0,c)),u=this.generateHuffmanTable(g.slice(c,b))}else o("Unknown block type in flate stream");for(var w=(P=this.buffer)?P.length:0,O=this.bufferLength;;){var j=this.getCode(l);if(j<256)O+1>=w&&(w=(P=this.ensureBuffer(O+1)).length),P[O++]=j;else{if(256==j)return void(this.bufferLength=O);var x=(j=t[j-=257])>>16;x>0&&(x=this.getBits(x)),v=(65535&j)+x,j=this.getCode(u),(x=(j=r[j])>>16)>0&&(x=this.getBits(x));var I=(65535&j)+x;O+v>=w&&(w=(P=this.ensureBuffer(O+v)).length);for(var k=0;k<v;++k,++O)P[O]=P[O-I]}}}else{var M,S=this.bytes,T=this.bytesPos;void 0===(M=S[T++])&&o("Bad block header in flate stream");var C=M;void 0===(M=S[T++])&&o("Bad block header in flate stream"),C|=M<<8,void 0===(M=S[T++])&&o("Bad block header in flate stream");var A=M;void 0===(M=S[T++])&&o("Bad block header in flate stream"),(A|=M<<8)!=(65535&~C)&&o("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var _=this.bufferLength,P=this.ensureBuffer(_+C),D=_+C;this.bufferLength=D;for(var R=_;R<D;++R){if(void 0===(M=S[T++])){this.eof=!0;break}P[R]=M}this.bytesPos=T}},s}())&&(a.exports=i);var s=o.exports},785:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(2),a=r(4),i=r(5),o=r(6),s=r(0),l=r(26),u=r(11),c=r(1),f=(r(19),r(14),r(15),r(10)),h=r(58),p=r(45),d=r(815),m=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).attributeTable=null,a.bandCount=null,a.colormap=null,a.extent=null,a.format=void 0,a.height=null,a.width=null,a.histograms=null,a.keyProperties={},a.multidimensionalInfo=null,a.noDataValue=null,a.pixelSize=null,a.pixelType=null,a.isPseudoSpatialReference=!1,a.spatialReference=null,a.statistics=null,a.storageInfo=null,a.transform=null,a}return Object(a.a)(r,[{key:"dataType",get:function(){var e,t,r,n=null!=(e=null==(t=this.keyProperties)||null==(r=t.DataType)?void 0:r.toLowerCase())?e:"generic";return"stdtime"===n?"standard-time":n}},{key:"nativeExtent",get:function(){return this._get("nativeExtent")||this.extent},set:function(e){e&&this._set("nativeExtent",e)}},{key:"nativePixelSize",get:function(){if(!Object(u.j)(this.transform)||!this.transform.affectsPixelSize)return this.pixelSize;var e=this.nativeExtent;return{x:e.width/this.width,y:e.height/this.height}}}]),r}(l.a);Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"attributeTable",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"bandCount",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"colormap",void 0),Object(s.a)([Object(c.b)({type:String,readOnly:!0})],m.prototype,"dataType",null),Object(s.a)([Object(c.b)({type:h.a,json:{write:!0}})],m.prototype,"extent",void 0),Object(s.a)([Object(c.b)({type:h.a,json:{write:!0}})],m.prototype,"nativeExtent",null),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"nativePixelSize",null),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"format",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"height",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"width",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"histograms",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"keyProperties",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"multidimensionalInfo",void 0),Object(s.a)([Object(c.b)()],m.prototype,"noDataValue",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"pixelSize",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"pixelType",void 0),Object(s.a)([Object(c.b)()],m.prototype,"isPseudoSpatialReference",void 0),Object(s.a)([Object(c.b)({type:p.a,json:{write:!0}})],m.prototype,"spatialReference",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"statistics",void 0),Object(s.a)([Object(c.b)({type:d.a,json:{write:!0}})],m.prototype,"storageInfo",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],m.prototype,"transform",void 0);var v=m=Object(s.a)([Object(f.a)("esri.layers.support.RasterInfo")],m)},814:function(e,t,r){"use strict";function n(e){return"h"in e&&"s"in e&&"v"in e}function a(e){return"l"in e&&"a"in e&&"b"in e}function i(e){return"l"in e&&"c"in e&&"h"in e}function o(e){return"x"in e&&"y"in e&&"z"in e}r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return w})),r.d(t,"c",(function(){return O})),r.d(t,"d",(function(){return g}));var s=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],l=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function u(e,t){var r,n,a=[];if(e[0].length!==t.length)throw"dimensions do not match";var i=e.length,o=e[0].length,s=0;for(r=0;r<i;r++){for(s=0,n=0;n<o;n++)s+=e[r][n]*t[n];a.push(s)}return a}function c(e){var t=[e.r/255,e.g/255,e.b/255].map((function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)})),r=u(s,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function f(e){var t=u(l,[e.x/100,e.y/100,e.z/100]).map((function(e){var t=e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055;return Math.min(1,Math.max(t,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function h(e){var t=[e.x/95.047,e.y/100,e.z/108.883].map((function(e){return e>Math.pow(6/29,3)?Math.pow(e,1/3):1/3*Math.pow(29/6,2)*e+4/29}));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function p(e){var t=e.l,r=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map((function(e){return e>6/29?Math.pow(e,3):3*Math.pow(6/29,2)*(e-4/29)}));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function d(e){return h(c(e))}function m(e){return f(p(e))}function v(e){return function(e){var t=e.l,r=e.a,n=e.b,a=Math.sqrt(r*r+n*n),i=Math.atan2(n,r);return{l:t,c:a,h:i=i>0?i:i+2*Math.PI}}(h(c(e)))}function b(e){return f(p(function(e){var t=e.l,r=e.c,n=e.h;return{l:t,a:r*Math.cos(n),b:r*Math.sin(n)}}(e)))}function g(e){return function(e){return"r"in e&&"g"in e&&"b"in e}(e)?e:i(e)?b(e):a(e)?m(e):o(e)?f(e):n(e)?function(e){var t,r=(e.h+360)%360/60,n=e.s/100,a=e.v/100*255,i=a*n,o=i*(1-Math.abs(r%2-1));switch(Math.floor(r)){case 0:t={r:i,g:o,b:0};break;case 1:t={r:o,g:i,b:0};break;case 2:t={r:0,g:i,b:o};break;case 3:t={r:0,g:o,b:i};break;case 4:t={r:o,g:0,b:i};break;case 5:case 6:t={r:i,g:0,b:o};break;default:t={r:0,g:0,b:0}}return t.r=Math.round(t.r+a-i),t.g=Math.round(t.g+a-i),t.b=Math.round(t.b+a-i),t}(e):e}function y(e){return n(e)?e:function(e){var t=e.r,r=e.g,n=e.b,a=Math.max(t,r,n),i=a-Math.min(t,r,n),o=a,s=0===i?0:a===t?(r-n)/i%6:a===r?(n-t)/i+2:(t-r)/i+4,l=0===i?0:i/o;return s<0&&(s+=6),{h:s*=60,s:l*=100,v:o*=100/255}}(g(e))}function w(e){return a(e)?e:d(g(e))}function O(e){return i(e)?e:v(g(e))}},815:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(2),a=r(5),i=r(6),o=r(0),s=r(26),l=r(1),u=(r(19),r(14),r(15),r(10)),c=r(48),f=function(e){Object(a.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).blockWidth=void 0,e.blockHeight=void 0,e.compression=null,e.origin=null,e.firstPyramidLevel=null,e.maximumPyramidLevel=null,e.pyramidScalingFactor=2,e.pyramidBlockWidth=null,e.pyramidBlockHeight=null,e.isVirtualTileInfo=!1,e.tileInfo=null,e.blockBoundary=null,e}return r}(s.a);Object(o.a)([Object(l.b)({type:Number,json:{write:!0}})],f.prototype,"blockWidth",void 0),Object(o.a)([Object(l.b)({type:Number,json:{write:!0}})],f.prototype,"blockHeight",void 0),Object(o.a)([Object(l.b)({type:String,json:{write:!0}})],f.prototype,"compression",void 0),Object(o.a)([Object(l.b)({type:c.a,json:{write:!0}})],f.prototype,"origin",void 0),Object(o.a)([Object(l.b)({type:Number,json:{write:!0}})],f.prototype,"firstPyramidLevel",void 0),Object(o.a)([Object(l.b)({type:Number,json:{write:!0}})],f.prototype,"maximumPyramidLevel",void 0),Object(o.a)([Object(l.b)({json:{write:!0}})],f.prototype,"pyramidResolutions",void 0),Object(o.a)([Object(l.b)({type:Number,json:{write:!0}})],f.prototype,"pyramidScalingFactor",void 0),Object(o.a)([Object(l.b)({type:Number,json:{write:!0}})],f.prototype,"pyramidBlockWidth",void 0),Object(o.a)([Object(l.b)({type:Number,json:{write:!0}})],f.prototype,"pyramidBlockHeight",void 0),Object(o.a)([Object(l.b)({type:Boolean,json:{write:!0}})],f.prototype,"isVirtualTileInfo",void 0),Object(o.a)([Object(l.b)({json:{write:!0}})],f.prototype,"tileInfo",void 0),Object(o.a)([Object(l.b)()],f.prototype,"blockBoundary",void 0);var h=f=Object(o.a)([Object(u.a)("esri.layers.support.RasterStorageInfo")],f)},816:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u}));var n=r(46),a=r(814),i=[{id:"aspect_predefined",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blueBright_predefined",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,102,51]},{id:"greenToBlue_predefined",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",fromColor:[250,215,246],toColor:[143,17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"redToGreen_predefined",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrumFullLight_predefined",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],o={aspect_predefined:"Aspect",blackToWhite_predefined:"Black to White",blueBright_predefined:"Blue Bright",blueLightToDark_predefined:"Blue Light to Dark",blueGreenBright_predefined:"Blue-Green Bright",blueGreenLightToDark_predefined:"Blue-Green Light to Dark",brownLightToDark_predefined:"Brown Light to Dark",brownToBlueGreenDivergingBright_predefined:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark_predefined:"Brown to Blue Green Diverging, Dark",coefficientBias_predefined:"Coefficient Bias",coldToHotDiverging_predefined:"Cold to Hot Diverging",conditionNumber_predefined:"Condition Number",cyanToPurple_predefined:"Cyan to Purple",cyanLightToBlueDark_predefined:"Cyan-Light to Blue-Dark",distance_predefined:"Distance",elevation1_predefined:"Elevation #1",elevation2_predefined:"Elevation #2",errors_predefined:"Errors",grayLightToDark_predefined:"Gray Light to Dark",greenBright_predefined:"Green Bright",greenLightToDark_predefined:"Green Light to Dark",greenToBlue_predefined:"Green to Blue",orangeBright_predefined:"Orange Bright",orangeLightToDark_predefined:"Orange Light to Dark",partialSpectrum_predefined:"Partial Spectrum",partialSpectrum1Diverging_predefined:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging_predefined:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright_predefined:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark_predefined:"Pink to YellowGreen Diverging, Dark",precipitation_predefined:"Precipitation",prediction_predefined:"Prediction",purpleBright_predefined:"Purple Bright",purpleToGreenDivergingBright_predefined:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark_predefined:"Purple to Green Diverging, Dark",purpleBlueBright_predefined:"Purple-Blue Bright",purpleBlueLightToDark_predefined:"Purple-Blue Light to Dark",purpleRedBright_predefined:"Purple-Red Bright",purpleRedLightToDark_predefined:"Purple-Red Light to Dark",redBright_predefined:"Red Bright",redLightToDark_predefined:"Red Light to Dark",redToBlueDivergingBright_predefined:"Red to Blue Diverging, Bright",redToBlueDivergingDark_predefined:"Red to Blue Diverging, Dark",redToGreen_predefined:"Red to Green",redToGreenDivergingBright_predefined:"Red to Green Diverging, Bright",redToGreenDivergingDark_predefined:"Red to Green Diverging, Dark",slope_predefined:"Slope",spectrumFullBright_predefined:"Spectrum-Full Bright",spectrumFullDark_predefined:"Spectrum-Full Dark",spectrumFullLight_predefined:"Spectrum-Full Light",surface_predefined:"Surface",temperature_predefined:"Temperature",whiteToBlack_predefined:"White to Black",yellowToDarkRed_predefined:"Yellow to Dark Red",yellowToGreenToDarkBlue_predefined:"Yellow to Green to Dark Blue",yellowToRed_predefined:"Yellow to Red",yellowGreenBright_predefined:"Yellow-Green Bright",yellowGreenLightToDark_predefined:"Yellow-Green Light to Dark"};function s(e,t){if(!e||!t||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]>t[r]+2||e[r]<t[r]-2)return!1;return!0}function l(e,t,r){var n=Object(a.b)(e),i=Object(a.b)(t),o={l:n.l*(1-r)+r*i.l,a:n.a*(1-r)+r*i.a,b:n.b*(1-r)+r*i.b};return Object(a.d)(o)}function u(e){var t=function(e,t){if(e){var r,a=t||i,o=null;return"algorithmic"===e.type?a.some((function(t){if(s(e.fromColor.toRgb(),t.fromColor)&&s(e.toColor.toRgb(),t.toColor))return o=t.id,!0})):"multipart"===e.type&&a.some((function(t){if(e.colorRamps&&t.colorRamps&&e.colorRamps.length===t.colorRamps.length&&(r=e.colorRamps,!t.colorRamps.some((function(e,t){if(!s(r[t].fromColor.toRgb(),new n.a(e.fromColor).toRgb())||!s(r[t].toColor.toRgb(),new n.a(e.toColor).toRgb()))return!0})))){if(o)return!0;o=t.id}})),o}}(e);return t?o[t]:null}function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e&&t&&!(t<1)){var n,a,i,o,s,u="toJSON"in e?e.toJSON():e,c="multipart"===u.type?u.colorRamps.length:1,f=[],h=[],p=0;if(1===t)return n="multipart"===u.type?u.colorRamps[0].fromColor:u.fromColor,h.push([0].concat(n)),h;for(var d=0;d<c;d++)f[d]={start:null,end:null},f[d].start=p,f[d].end=p+1/c,p=f[d].end;for(var m=function(e){o=e/(t-1),f.forEach((function(f,p){if(o>=f.start&&(o<f.end||e===t-1&&p===c-1)){s=(o-f.start)/(f.end-f.start),"multipart"===u.type?(n=u.colorRamps[p].fromColor,a=u.colorRamps[p].toColor):(n=u.fromColor,a=u.toColor),0===e?h.push([e].concat(n.slice(0,3))):e===t-1?h.push([e].concat(a.slice(0,3))):(i=l({r:n[0],g:n[1],b:n[2]},{r:a[0],g:a[1],b:a[2]},s),h.push([e,i.r,i.g,i.b]));var d=null!=n[3]?n[3]>1?n[3]/255:n[3]:1,m=null!=a[3]?a[3]>1?a[3]/255:a[3]:1;r&&h[e].push(Math.min(255,Math.round(255*(d*(1-s)+m*s))))}}))},v=0;v<t;v++)m(v);return h}}},823:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){var e=new ArrayBuffer(4),t=new Uint8Array(e);return new Uint32Array(e)[0]=1,1===t[0]}()},825:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n,a=r(2),i=r(4),o=r(5),s=r(6),l=r(0),u=r(26),c=r(18),f=r(1),h=(r(14),r(19),r(15),r(31)),p=r(57),d=r(10),m=r(844),v=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).altitude=45,n.azimuth=315,n.colorRamp=null,n.hillshadeType="multi-directional",n.pixelSizePower=.664,n.pixelSizeFactor=.024,n.scalingType="none",n.type="raster-shaded-relief",n.zFactor=1,n}return Object(i.a)(r,[{key:"readColorRamp",value:function(e){return Object(m.a)(e)}},{key:"clone",value:function(){return new n({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:Object(c.a)(this.colorRamp)})}}]),r}(u.a);Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],v.prototype,"altitude",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],v.prototype,"azimuth",void 0),Object(l.a)([Object(f.b)({types:m.b,json:{write:!0}})],v.prototype,"colorRamp",void 0),Object(l.a)([Object(p.a)("colorRamp")],v.prototype,"readColorRamp",null),Object(l.a)([Object(f.b)({type:["traditional","multi-directional"],json:{write:!0}})],v.prototype,"hillshadeType",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],v.prototype,"pixelSizePower",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],v.prototype,"pixelSizeFactor",void 0),Object(l.a)([Object(f.b)({type:["none","adjusted"],json:{write:!0}})],v.prototype,"scalingType",void 0),Object(l.a)([Object(h.a)({rasterShadedRelief:"raster-shaded-relief"})],v.prototype,"type",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],v.prototype,"zFactor",void 0);var b=v=n=Object(l.a)([Object(d.a)("esri.renderers.RasterShadedReliefRenderer")],v)},826:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,a=r(2),i=r(4),o=r(5),s=r(6),l=r(0),u=r(26),c=r(18),f=r(1),h=(r(14),r(19),r(15),r(31)),p=r(57),d=r(10),m=r(43),v=r(936),b=r(844),g=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).colorRamp=null,n.computeGamma=!1,n.dynamicRangeAdjustment=!1,n.gamma=[],n.maxPercent=null,n.minPercent=null,n.numberOfStandardDeviations=null,n.outputMax=null,n.outputMin=null,n.sigmoidStrengthLevel=null,n.statistics=[],n.histograms=null,n.useGamma=!1,n.stretchType="none",n.type="raster-stretch",n}return Object(i.a)(r,[{key:"readColorRamp",value:function(e){if(e)return Object(b.a)(e)}},{key:"writeStatistics",value:function(e,t,r){var n;null!=(n=e)&&n.length&&(Array.isArray(e[0])||(e=e.map((function(e){return[e.min,e.max,e.avg,e.stddev]}))),t[r]=e)}},{key:"readStretchType",value:function(e,t){var r=t.stretchType;return"number"==typeof r&&(r=v.a[r]),v.b.read(r)}},{key:"clone",value:function(){return new n({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:Object(c.a)(this.statistics),gamma:Object(c.a)(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:Object(c.a)(this.colorRamp),histograms:Object(c.a)(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})}}]),r}(u.a);Object(l.a)([Object(f.b)({types:b.b,json:{write:!0}})],g.prototype,"colorRamp",void 0),Object(l.a)([Object(p.a)("colorRamp")],g.prototype,"readColorRamp",null),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],g.prototype,"computeGamma",void 0),Object(l.a)([Object(f.b)({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],g.prototype,"dynamicRangeAdjustment",void 0),Object(l.a)([Object(f.b)({type:[Number],json:{write:!0}})],g.prototype,"gamma",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],g.prototype,"maxPercent",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],g.prototype,"minPercent",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],g.prototype,"numberOfStandardDeviations",void 0),Object(l.a)([Object(f.b)({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],g.prototype,"outputMax",void 0),Object(l.a)([Object(f.b)({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],g.prototype,"outputMin",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],g.prototype,"sigmoidStrengthLevel",void 0),Object(l.a)([Object(f.b)({json:{type:[[Number]],write:!0}})],g.prototype,"statistics",void 0),Object(l.a)([Object(f.b)()],g.prototype,"histograms",void 0),Object(l.a)([Object(m.a)("statistics")],g.prototype,"writeStatistics",null),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],g.prototype,"useGamma",void 0),Object(l.a)([Object(f.b)({type:v.b.apiValues,json:{type:v.b.jsonValues,write:v.b.write}})],g.prototype,"stretchType",void 0),Object(l.a)([Object(p.a)("stretchType",["stretchType"])],g.prototype,"readStretchType",null),Object(l.a)([Object(h.a)({rasterStretch:"raster-stretch"})],g.prototype,"type",void 0);var y=g=n=Object(l.a)([Object(d.a)("esri.renderers.RasterStretchRenderer")],g)},829:function(e,t,r){"use strict";r.d(t,"a",(function(){return ie}));var n=r(7),a=r.n(n),i=r(12),o=r(21),s=r(2),l=r(4),u=r(5),c=r(6),f=r(0),h=r(46),p=(r(114),r(210)),d=r(332),m=r(42),v=r(26),b=r(18),g=r(11),y=r(1),w=(r(14),r(19),r(15),r(31)),O=r(57),j=r(10),x=r(696),I=r(837),k=r(700),M=r(684),S=r(890),T=r(925),C=r(853),A=r(751),_=r(98),P=r(143),D=r(295),R=(r(44),r(211)),E=(r(54),r(82),r(771));r(13),r(871);new E.a(1e3);(function(){var e={}})(),new h.a([128,128,128]),r(103),new h.a("white");function L(e,t){return N.apply(this,arguments)}function N(){return N=Object(i.a)(a.a.mark((function e(t,r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.symbolLayers,e.t0=n,!e.t0){e.next=5;break}return e.next=5,Object(D.a)(n,function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B(t,r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)}))),N.apply(this,arguments)}function B(e,t){return U.apply(this,arguments)}function U(){return(U=Object(i.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="extrude"===e.t0?3:"icon"===e.t0||"line"===e.t0||"text"===e.t0?5:"path"===e.t0?7:"object"===e.t0?9:11;break;case 3:return F(t,r),e.abrupt("break",11);case 5:return z(t,r),e.abrupt("break",11);case 7:return J(t,r),e.abrupt("break",11);case 9:return e.next=11,H(t,r);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,t){var r=G(t);Object(g.j)(r)&&(e.size=r)}function G(e){var t,r=Object(o.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if("number"==typeof n)return n}}catch(a){r.e(a)}finally{r.f()}return null}function F(e,t){e.size="number"==typeof t[2]?t[2]:0}function H(e,t){return V.apply(this,arguments)}function V(){return(V=Object(i.a)(a.a.mark((function e(t,r){var n,i,o,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(t);case 2:n=e.sent,i=n.resourceSize,o=n.symbolSize,s=Z(r,i,o),t.width=X(r[0],o[0],i[0],s),t.depth=X(r[1],o[1],i[1],s),t.height=X(r[2],o[2],i[2],s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t){var r=Z(t,R.a,[e.width,void 0,e.height]);e.width=X(t[0],e.width,1,r),e.height=X(t[2],e.height,1,r)}function Z(e,t,r){for(var n=0;n<3;n++){var a=e[n];switch(a){case"symbol-value":return null!=r[n]?r[n]/t[n]:1;case"proportional":break;default:if(a&&t[n])return a/t[n]}}return 1}function W(e){return q.apply(this,arguments)}function q(){return(q=Object(i.a)(a.a.mark((function e(t){var n,i,o,s,l,u,c,f,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(116).then(r.bind(null,1096));case 2:return n=e.sent,e.next=5,n.computeObjectLayerResourceSize(t,10);case 5:i=e.sent,o=t.width,s=t.height,l=t.depth,u=[o,l,s],c=1,f=0;case 12:if(!(f<3)){e.next=19;break}if(null==u[f]){e.next=16;break}return c=u[f]/i[f],e.abrupt("break",19);case 16:f++,e.next=12;break;case 19:for(h=0;h<3;h++)null==u[h]&&(u[h]=i[h]*c);return e.abrupt("return",{resourceSize:i,symbolSize:u});case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t,r,n){switch(e){case"proportional":return r*n;case"symbol-value":return null!=t?t:r;default:return e}}function Y(e,t){var r=G(t);if(!Object(g.i)(r))switch(e.type){case"simple-marker":e.size=r;break;case"picture-marker":var n=e.width/e.height;n>1?(e.width=r,e.height=r*n):(e.width=r*n,e.height=r);break;case"simple-line":e.width=r;break;case"text":e.font.size=r}}function K(){return(K=Object(i.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!r){e.next=2;break}return e.abrupt("return",Object(d.c)(t)?L(t,r):void(Object(d.b)(t)&&Y(t,r)));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q,$=r(48),ee=r(146),te=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]),re=new m.a({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"}),ne=new m.a({flow_from:"flow-from",flow_to:"flow-to"}),ae=Q=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(s.a)(this,r),(n=t.call(this,e)).attributeField="Magnitude",n.flowRepresentation="flow-from",n.rotationType="arithmetic",n.style="single-arrow",n.symbolTileSize=50,n.type="vector-field",n}return Object(l.a)(r,[{key:"readInputUnit",value:function(e,t){return te.has(e)?I.d.fromJSON(e):null}},{key:"readOutputUnit",value:function(e,t){return te.has(e)?I.d.fromJSON(e):null}},{key:"styleRenderer",get:function(){var e=this.style,t=this.attributeField,r=this._createStyleRenderer(e);return r.field=t,r}},{key:"sizeVariables",get:function(){var e=[];if(this.visualVariables){var t,r=Object(o.a)(this.visualVariables);try{for(r.s();!(t=r.n()).done;){var n=t.value;"size"===n.type&&e.push(n)}}catch(i){r.e(i)}finally{r.f()}}if(0===e.length){var a=new C.a({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize});this.visualVariables?this.visualVariables.push(a):this._set("visualVariables",[a]),e.push(a)}return e}},{key:"rotationVariables",get:function(){var e=[];if(this.visualVariables){var t,r=Object(o.a)(this.visualVariables);try{for(r.s();!(t=r.n()).done;){var n=t.value;"rotation"===n.type&&e.push(n)}}catch(i){r.e(i)}finally{r.f()}}if(0===e.length){var a=new T.a({field:"Direction",rotationType:this.rotationType});this.visualVariables?this.visualVariables.push(a):this._set("visualVariables",[a]),e.push(a)}return e}},{key:"clone",value:function(){return new Q({attributeField:this.attributeField,flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:Object(b.a)(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})}},{key:"getGraphicsFromPixelData",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var r,n,i,o,s,l,u,c,f,h,d,m,v,b=this,y=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=y.length>1&&void 0!==y[1]&&y[1],n=y.length>2&&void 0!==y[2]?y[2]:[],i=new Array,o=Object(I.c)(this.inputUnit,this.outputUnit),s=r?Object(I.a)(t.pixelBlock,"vector-uv",this.rotationType,o):Object(I.b)(t.pixelBlock,"vector-magdir",o),!Object(g.i)(s)){e.next=5;break}return e.abrupt("return",i);case 5:l=t.extent,u=s.mask&&s.mask.length>0,c=0,f=(l.xmax-l.xmin)/s.width,h=(l.ymax-l.ymin)/s.height,d=0;case 9:if(!(d<s.height)){e.next=20;break}m=a.a.mark((function e(t){var r,o,m,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new $.a({x:l.xmin+t*f+f/2,y:l.ymax-d*h-h/2,spatialReference:l.spatialReference}),e.next=3,Object(x.a)(r);case 3:r=e.sent[0],o=n.some((function(e){return e.intersects(r)})),u&&!s.mask[c]||o||(m={Magnitude:s.pixels[0][c],Direction:s.pixels[1][c]},(v=new p.a({geometry:{type:"point",x:r.x,y:r.y,spatialReference:l.spatialReference},attributes:m})).symbol=b._getVisualVariablesAppliedSymbol(v),i.push(v));case 6:case"end":return e.stop()}}),e)})),v=0;case 12:if(!(v<s.width)){e.next=17;break}return e.delegateYield(m(v),"t0",14);case 14:v++,c++,e.next=12;break;case 17:d++,e.next=9;break;case 20:return e.abrupt("return",i);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSymbol",value:function(e,t){}},{key:"getSymbolAsync",value:function(){var e=Object(i.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSymbols",value:function(){return[]}},{key:"getClassBreakInfos",value:function(){var e;return null==(e=this.styleRenderer)?void 0:e.classBreakInfos}},{key:"getDefaultSymbol",value:function(){var e;return null==(e=this.styleRenderer)?void 0:e.defaultSymbol}},{key:"_getDefaultSymbol",value:function(e){return new P.a({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",outline:new _.a({width:0}),size:20,color:e||new h.a([0,92,230])})}},{key:"_getVisualVariablesAppliedSymbol",value:function(e){if(e){var t=this.styleRenderer&&this.styleRenderer.getSymbol(e);t=t.clone();var r=this.sizeVariables,n=this.rotationVariables;if(r&&r.length&&this.sizeVariables.forEach((function(r){return function(e,t){return K.apply(this,arguments)}(t,Object(A.a)([r],e))})),n&&n.length){var a=e.attributes.Direction;e.attributes.Direction="flow-from"===this.flowRepresentation?a:a+180,this.rotationVariables.forEach((function(r){return function(e,t,r){if(e&&null!=t)if(Object(d.c)(e)){var n=e.symbolLayers;n&&n.forEach((function(e){if(e&&"object"===e.type)switch(r){case"tilt":e.tilt=t;break;case"roll":e.roll=t;break;default:e.heading=t}}))}else Object(d.b)(e)&&("simple-marker"!==e.type&&"picture-marker"!==e.type&&"text"!==e.type||(e.angle=t))}(t,Object(A.d)(r,e),r.axis)}))}return t}}},{key:"_createStyleRenderer",value:function(e){var t={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(e){case"single-arrow":t=this._createSingleArrowRenderer();break;case"beaufort-kn":t=this._createBeaufortKnotsRenderer();break;case"beaufort-m":t=this._createBeaufortMeterRenderer();break;case"beaufort-ft":t=this._createBeaufortFeetRenderer();break;case"beaufort-mi":t=this._createBeaufortMilesRenderer();break;case"beaufort-km":t=this._createBeaufortKilometersRenderer();break;case"ocean-current-m":t=this._createCurrentMeterRenderer();break;case"ocean-current-kn":t=this._createCurrentKnotsRenderer();break;case"simple-scalar":t=this._createSimpleScalarRenderer();break;case"wind-barb":t=this._createWindBarbsRenderer();break;case"classified-arrow":t=this._createClassifiedArrowRenderer()}return new k.a(t)}},{key:"_createSingleArrowRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol()}}},{key:"_createBeaufortKnotsRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new h.a([214,47,39])),classBreakInfos:this._getClassBreaks([0,1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])}}},{key:"_createBeaufortMeterRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new h.a([214,47,39])),classBreakInfos:this._getClassBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createBeaufortFeetRenderer",value:function(){var e=this._getDefaultSymbol(new h.a([214,47,39])),t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];return t=t.map((function(e){return 3.28084*e})),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createBeaufortMilesRenderer",value:function(){var e=this._getDefaultSymbol(new h.a([214,47,39])),t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];return t=t.map((function(e){return 2.23694*e})),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createBeaufortKilometersRenderer",value:function(){var e=this._getDefaultSymbol(new h.a([214,47,39])),t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];return t=t.map((function(e){return 3.6*e})),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createCurrentMeterRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new h.a([177,177,177])),classBreakInfos:this._getClassBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]])}}},{key:"_createCurrentKnotsRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new h.a([177,177,177])),classBreakInfos:this._getClassBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])}}},{key:"_createClassifiedArrowRenderer",value:function(){var e,t=this._getDefaultSymbol(new h.a([56,168,0])),r=[0,1e-6,3.5,7,10.5,14];if(null!=(e=this.sizeVariables)&&e.length){var n=this.sizeVariables[0].minDataValue,a=this.sizeVariables[0].maxDataValue;if(n&&a){var i=(a-n)/5;r=Array.from(Array(6).keys()).map((function(e){return n+i*e}))}}return{defaultSymbol:t,classBreakInfos:this._getClassBreaks(r,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])}}},{key:"_createSimpleScalarRenderer",value:function(){return{defaultSymbol:ee.a.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII=",height:20,width:20,type:"esriPMS",angle:0})}}},{key:"_createWindBarbsRenderer",value:function(){var e=Array.from(Array(31).keys()).map((function(e){return 5*e})),t=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"90-95",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="}],r=ee.a.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",height:20,width:20,type:"esriPMS",angle:0}),n=e.map((function(n,a){var i;if(a!==e.length-1)if(0===a)i={minValue:n,maxValue:e[a+1],symbol:r};else{var o=ee.a.fromJSON({type:"esriPMS",imageData:t[a].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0});i={minValue:n,maxValue:e[a+1],symbol:o}}return new S.a(i)}));return{defaultSymbol:r,classBreakInfos:n}}},{key:"_getClassBreaks",value:function(e,t){var r=this;return t.map((function(t,n){return new S.a({minValue:e[n],maxValue:e[n+1],symbol:r._getDefaultSymbol(new h.a(t))})}))}}]),r}(Object(M.a)(v.a));Object(f.a)([Object(y.b)({type:String,json:{write:!0}})],ae.prototype,"attributeField",void 0),Object(f.a)([Object(y.b)({type:ne.apiValues,json:{type:ne.jsonValues,read:{reader:ne.read},write:{writer:ne.write}}})],ae.prototype,"flowRepresentation",void 0),Object(f.a)([Object(y.b)({type:["geographic","arithmetic"],json:{write:!0}})],ae.prototype,"rotationType",void 0),Object(f.a)([Object(y.b)({type:re.apiValues,json:{type:re.jsonValues,read:{reader:re.read},write:{writer:re.write}}})],ae.prototype,"style",void 0),Object(f.a)([Object(y.b)({json:{write:!0}})],ae.prototype,"symbolTileSize",void 0),Object(f.a)([Object(y.b)({type:I.d.apiValues,json:{type:I.d.jsonValues,write:{writer:I.d.write}}})],ae.prototype,"inputUnit",void 0),Object(f.a)([Object(O.a)("inputUnit")],ae.prototype,"readInputUnit",null),Object(f.a)([Object(y.b)({type:I.d.apiValues,json:{type:I.d.jsonValues,read:{reader:I.d.read},write:{writer:I.d.write}}})],ae.prototype,"outputUnit",void 0),Object(f.a)([Object(O.a)("outputUnit")],ae.prototype,"readOutputUnit",null),Object(f.a)([Object(w.a)({vectorField:"vector-field"})],ae.prototype,"type",void 0),Object(f.a)([Object(y.b)({type:k.a})],ae.prototype,"styleRenderer",null),Object(f.a)([Object(y.b)({type:C.a})],ae.prototype,"sizeVariables",null),Object(f.a)([Object(y.b)({type:T.a})],ae.prototype,"rotationVariables",null);var ie=ae=Q=Object(f.a)([Object(j.a)("esri.renderers.VectorFieldRenderer")],ae)},830:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(23),a=r(2),i=r(4),o=r(5),s=r(6),l=r(0),u=r(26),c=r(1),f=(r(19),r(14)),h=(r(15),r(31)),p=r(10),d=r(46),m=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).value=null,e.label=null,e.color=null,e}return r}(u.a);Object(l.a)([Object(c.b)({type:Number,json:{write:!0}})],m.prototype,"value",void 0),Object(l.a)([Object(c.b)({type:String,json:{write:!0}})],m.prototype,"label",void 0),Object(l.a)([Object(c.b)({type:d.a,json:{type:[f.a],write:!0}})],m.prototype,"color",void 0);var v,b=m=Object(l.a)([Object(p.a)("esri.renderers.support.ColormapInfo")],m),g=r(816),y=v=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).colormapInfos=null,n.type="raster-colormap",n}return Object(i.a)(r,[{key:"clone",value:function(){return new v({colormapInfos:this.colormapInfos.map((function(e){return e.toJSON()}))})}},{key:"extractColormap",value:function(){return this.colormapInfos.map((function(e){return[e.value,e.color.r,e.color.g,e.color.b,e.color.a>1?e.color.a:255*e.color.a&255]})).sort((function(e,t){return e[0]-t[0]}))}}],[{key:"createFromColormap",value:function(e,t){if(!e)return null;var r=5===e[0].length,a=Object(n.a)(e).sort((function(e){return e[0][0]-e[1][0]})).map((function(e){var n;return b.fromJSON({value:e[0],color:r?e.slice(1,5):e.slice(1,4).concat([255]),label:t?null!=(n=t[e[0]])?n:"":e[0]})}));return new v({colormapInfos:a})}},{key:"createFromColorramp",value:function(e){var t=Object(g.b)(e,256);return v.createFromColormap(t)}}]),r}(u.a);Object(l.a)([Object(c.b)({type:[b],json:{write:!0}})],y.prototype,"colormapInfos",void 0),Object(l.a)([Object(h.a)({rasterColormap:"raster-colormap"})],y.prototype,"type",void 0);var w=y=v=Object(l.a)([Object(p.a)("esri.renderers.RasterColormapRenderer")],y)},836:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,a,i,o={exports:{}};n=o,a=function(){var e=function(){function e(e){this.message="JPEG error: "+e}return e.prototype=new Error,e.prototype.name="JpegError",e.constructor=e,e}();return function(){if(!self||!self.Uint8ClampedArray)return null;var t=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),r=4017,n=799,a=3406,i=2276,o=1567,s=3784,l=5793,u=2896;function c(){this.decodeTransform=null,this.colorTransform=-1}function f(e,t){for(var r,n,a=0,i=[],o=16;o>0&&!e[o-1];)o--;i.push({children:[],index:0});var s,l=i[0];for(r=0;r<o;r++){for(n=0;n<e[r];n++){for((l=i.pop()).children[l.index]=t[a];l.index>0;)l=i.pop();for(l.index++,i.push(l);i.length<=r;)i.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;a++}r+1<o&&(i.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return i[0].children}function h(e,t,r){return 64*((e.blocksPerLine+1)*t+r)}function p(r,n,a,i,o,s,l,u,c){var f=a.mcusPerLine,p=a.progressive,d=n,m=0,b=0;function g(){if(b>0)return b--,m>>b&1;if(255===(m=r[n++])){var t=r[n++];if(t)throw new e("unexpected marker "+(m<<8|t).toString(16))}return b=7,m>>>7}function y(t){for(var r=t;;){if("number"==typeof(r=r[g()]))return r;if("object"!=typeof r)throw new e("invalid huffman sequence")}}function w(e){for(var t=0;e>0;)t=t<<1|g(),e--;return t}function O(e){if(1===e)return 1===g()?1:-1;var t=w(e);return t>=1<<e-1?t:t+(-1<<e)+1}var j=0;var x,I=0;function k(e,t,r,n,a){var i=r%f;t(e,h(e,(r/f|0)*e.v+n,i*e.h+a))}function M(e,t,r){t(e,h(e,r/e.blocksPerLine|0,r%e.blocksPerLine))}var S,T,C,A,_,P,D=i.length;P=p?0===s?0===u?function(e,t){var r=y(e.huffmanTableDC),n=0===r?0:O(r)<<c;e.blockData[t]=e.pred+=n}:function(e,t){e.blockData[t]|=g()<<c}:0===u?function(e,r){if(j>0)j--;else for(var n=s,a=l;n<=a;){var i=y(e.huffmanTableAC),o=15&i,u=i>>4;if(0!==o){var f=t[n+=u];e.blockData[r+f]=O(o)*(1<<c),n++}else{if(u<15){j=w(u)+(1<<u)-1;break}n+=16}}}:function(r,n){for(var a,i,o=s,u=l,f=0;o<=u;){var h=t[o];switch(I){case 0:if(f=(i=y(r.huffmanTableAC))>>4,0==(a=15&i))f<15?(j=w(f)+(1<<f),I=4):(f=16,I=1);else{if(1!==a)throw new e("invalid ACn encoding");x=O(a),I=f?2:3}continue;case 1:case 2:r.blockData[n+h]?r.blockData[n+h]+=g()<<c:0==--f&&(I=2===I?3:0);break;case 3:r.blockData[n+h]?r.blockData[n+h]+=g()<<c:(r.blockData[n+h]=x<<c,I=0);break;case 4:r.blockData[n+h]&&(r.blockData[n+h]+=g()<<c)}o++}4===I&&0==--j&&(I=0)}:function(e,r){var n=y(e.huffmanTableDC),a=0===n?0:O(n);e.blockData[r]=e.pred+=a;for(var i=1;i<64;){var o=y(e.huffmanTableAC),s=15&o,l=o>>4;if(0!==s){var u=t[i+=l];e.blockData[r+u]=O(s),i++}else{if(l<15)break;i+=16}}};var R,E,L,N,B=0;for(E=1===D?i[0].blocksPerLine*i[0].blocksPerColumn:f*a.mcusPerColumn;B<E;){var U=o?Math.min(E-B,o):E;for(T=0;T<D;T++)i[T].pred=0;if(j=0,1===D)for(S=i[0],_=0;_<U;_++)M(S,P,B),B++;else for(_=0;_<U;_++){for(T=0;T<D;T++)for(L=(S=i[T]).h,N=S.v,C=0;C<N;C++)for(A=0;A<L;A++)k(S,P,B,C,A);B++}b=0,(R=v(r,n))&&R.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+R.invalid),n=R.offset);var z=R&&R.marker;if(!z||z<=65280)throw new e("marker was not found");if(!(z>=65488&&z<=65495))break;n+=2}return(R=v(r,n))&&R.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+R.invalid),n=R.offset),n-d}function d(t,c,f){var h,p,d,m,v,b,g,y,w,O,j,x,I,k,M,S,T,C=t.quantizationTable,A=t.blockData;if(!C)throw new e("missing required Quantization Table.");for(var _=0;_<64;_+=8)w=A[c+_],O=A[c+_+1],j=A[c+_+2],x=A[c+_+3],I=A[c+_+4],k=A[c+_+5],M=A[c+_+6],S=A[c+_+7],w*=C[_],0!=(O|j|x|I|k|M|S)?(O*=C[_+1],j*=C[_+2],x*=C[_+3],I*=C[_+4],k*=C[_+5],M*=C[_+6],S*=C[_+7],p=(h=(h=l*w+128>>8)+(p=l*I+128>>8)+1>>1)-p,T=(d=j)*s+(m=M)*o+128>>8,d=d*o-m*s+128>>8,g=(v=(v=u*(O-S)+128>>8)+(g=k<<4)+1>>1)-g,b=(y=(y=u*(O+S)+128>>8)+(b=x<<4)+1>>1)-b,m=(h=h+(m=T)+1>>1)-m,d=(p=p+d+1>>1)-d,T=v*i+y*a+2048>>12,v=v*a-y*i+2048>>12,y=T,T=b*n+g*r+2048>>12,b=b*r-g*n+2048>>12,g=T,f[_]=h+y,f[_+7]=h-y,f[_+1]=p+g,f[_+6]=p-g,f[_+2]=d+b,f[_+5]=d-b,f[_+3]=m+v,f[_+4]=m-v):(T=l*w+512>>10,f[_]=T,f[_+1]=T,f[_+2]=T,f[_+3]=T,f[_+4]=T,f[_+5]=T,f[_+6]=T,f[_+7]=T);for(var P=0;P<8;++P)w=f[P],0!=((O=f[P+8])|(j=f[P+16])|(x=f[P+24])|(I=f[P+32])|(k=f[P+40])|(M=f[P+48])|(S=f[P+56]))?(p=(h=4112+((h=l*w+2048>>12)+(p=l*I+2048>>12)+1>>1))-p,T=(d=j)*s+(m=M)*o+2048>>12,d=d*o-m*s+2048>>12,m=T,g=(v=(v=u*(O-S)+2048>>12)+(g=k)+1>>1)-g,b=(y=(y=u*(O+S)+2048>>12)+(b=x)+1>>1)-b,T=v*i+y*a+2048>>12,v=v*a-y*i+2048>>12,y=T,T=b*n+g*r+2048>>12,b=b*r-g*n+2048>>12,w=(w=(h=h+m+1>>1)+y)<16?0:w>=4080?255:w>>4,O=(O=(p=p+d+1>>1)+(g=T))<16?0:O>=4080?255:O>>4,j=(j=(d=p-d)+b)<16?0:j>=4080?255:j>>4,x=(x=(m=h-m)+v)<16?0:x>=4080?255:x>>4,I=(I=m-v)<16?0:I>=4080?255:I>>4,k=(k=d-b)<16?0:k>=4080?255:k>>4,M=(M=p-g)<16?0:M>=4080?255:M>>4,S=(S=h-y)<16?0:S>=4080?255:S>>4,A[c+P]=w,A[c+P+8]=O,A[c+P+16]=j,A[c+P+24]=x,A[c+P+32]=I,A[c+P+40]=k,A[c+P+48]=M,A[c+P+56]=S):(T=(T=l*w+8192>>14)<-2040?0:T>=2024?255:T+2056>>4,A[c+P]=T,A[c+P+8]=T,A[c+P+16]=T,A[c+P+24]=T,A[c+P+32]=T,A[c+P+40]=T,A[c+P+48]=T,A[c+P+56]=T)}function m(e,t){for(var r=t.blocksPerLine,n=t.blocksPerColumn,a=new Int16Array(64),i=0;i<n;i++)for(var o=0;o<r;o++)d(t,h(t,i,o),a);return t.blockData}function v(e,t,r){function n(t){return e[t]<<8|e[t+1]}var a=e.length-1,i=r<t?r:t;if(t>=a)return null;var o=n(t);if(o>=65472&&o<=65534)return{invalid:null,marker:o,offset:t};for(var s=n(i);!(s>=65472&&s<=65534);){if(++i>=a)return null;s=n(i)}return{invalid:o.toString(16),marker:s,offset:i}}return c.prototype={parse:function(r){function n(){var e=r[l]<<8|r[l+1];return l+=2,e}function a(){var e=n(),t=l+e-2,a=v(r,t,l);a&&a.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+a.invalid),t=a.offset);var i=r.subarray(l,t);return l+=i.length,i}function i(e){for(var t=Math.ceil(e.samplesPerLine/8/e.maxH),r=Math.ceil(e.scanLines/8/e.maxV),n=0;n<e.components.length;n++){B=e.components[n];var a=Math.ceil(Math.ceil(e.samplesPerLine/8)*B.h/e.maxH),i=Math.ceil(Math.ceil(e.scanLines/8)*B.v/e.maxV),o=t*B.h,s=r*B.v*64*(o+1);B.blockData=new Int16Array(s),B.blocksPerLine=a,B.blocksPerColumn=i}e.mcusPerLine=t,e.mcusPerColumn=r}var o,s,l=0,u=null,c=null,h=[],d=[],b=[],g=n();if(65496!==g)throw new e("SOI not found");for(g=n();65497!==g;){var y,w,O;switch(g){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var j=a();65504===g&&74===j[0]&&70===j[1]&&73===j[2]&&70===j[3]&&0===j[4]&&(u={version:{major:j[5],minor:j[6]},densityUnits:j[7],xDensity:j[8]<<8|j[9],yDensity:j[10]<<8|j[11],thumbWidth:j[12],thumbHeight:j[13],thumbData:j.subarray(14,14+3*j[12]*j[13])}),65518===g&&65===j[0]&&100===j[1]&&111===j[2]&&98===j[3]&&101===j[4]&&(c={version:j[5]<<8|j[6],flags0:j[7]<<8|j[8],flags1:j[9]<<8|j[10],transformCode:j[11]});break;case 65499:for(var x=n()+l-2;l<x;){var I=r[l++],k=new Uint16Array(64);if(I>>4==0)for(w=0;w<64;w++)k[t[w]]=r[l++];else{if(I>>4!=1)throw new e("DQT - invalid table spec");for(w=0;w<64;w++)k[t[w]]=n()}h[15&I]=k}break;case 65472:case 65473:case 65474:if(o)throw new e("Only single frame JPEGs supported");n(),(o={}).extended=65473===g,o.progressive=65474===g,o.precision=r[l++],o.scanLines=n(),o.samplesPerLine=n(),o.components=[],o.componentIds={};var M,S=r[l++],T=0,C=0;for(y=0;y<S;y++){M=r[l];var A=r[l+1]>>4,_=15&r[l+1];T<A&&(T=A),C<_&&(C=_);var P=r[l+2];O=o.components.push({h:A,v:_,quantizationId:P,quantizationTable:null}),o.componentIds[M]=O-1,l+=3}o.maxH=T,o.maxV=C,i(o);break;case 65476:var D=n();for(y=2;y<D;){var R=r[l++],E=new Uint8Array(16),L=0;for(w=0;w<16;w++,l++)L+=E[w]=r[l];var N=new Uint8Array(L);for(w=0;w<L;w++,l++)N[w]=r[l];y+=17+L,(R>>4==0?b:d)[15&R]=f(E,N)}break;case 65501:n(),s=n();break;case 65498:n();var B,U=r[l++],z=[];for(y=0;y<U;y++){var G=o.componentIds[r[l++]];B=o.components[G];var F=r[l++];B.huffmanTableDC=b[F>>4],B.huffmanTableAC=d[15&F],z.push(B)}var H=r[l++],V=r[l++],J=r[l++],Z=p(r,l,o,z,s,H,V,J>>4,15&J);l+=Z;break;case 65535:255!==r[l]&&l--;break;default:if(255===r[l-3]&&r[l-2]>=192&&r[l-2]<=254){l-=3;break}throw new e("unknown marker "+g.toString(16))}g=n()}for(this.width=o.samplesPerLine,this.height=o.scanLines,this.jfif=u,this.eof=l,this.adobe=c,this.components=[],y=0;y<o.components.length;y++){var W=h[(B=o.components[y]).quantizationId];W&&(B.quantizationTable=W),this.components.push({output:m(0,B),scaleX:B.h/o.maxH,scaleY:B.v/o.maxV,blocksPerLine:B.blocksPerLine,blocksPerColumn:B.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(e,t){var r,n,a,i,o,s,l,u,c,f,h,p=this.width/e,d=this.height/t,m=0,v=this.components.length,b=e*t*v,g=new Uint8ClampedArray(b),y=new Uint32Array(e),w=4294967288;for(l=0;l<v;l++){for(n=(r=this.components[l]).scaleX*p,a=r.scaleY*d,m=l,h=r.output,i=r.blocksPerLine+1<<3,o=0;o<e;o++)u=0|o*n,y[o]=(u&w)<<3|7&u;for(s=0;s<t;s++)for(f=i*((u=0|s*a)&w)|(7&u)<<3,o=0;o<e;o++)g[m]=h[f+y[o]],m+=v}var O=this.decodeTransform;if(O)for(l=0;l<b;)for(u=0,c=0;u<v;u++,l++,c+=2)g[l]=(g[l]*O[c]>>8)+O[c+1];return g},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0!==this.colorTransform:1===this.colorTransform},_convertYccToRgb:function(e){for(var t,r,n,a=0,i=e.length;a<i;a+=3)t=e[a],r=e[a+1],n=e[a+2],e[a]=t-179.456+1.402*n,e[a+1]=t+135.459-.344*r-.714*n,e[a+2]=t-226.816+1.772*r;return e},_convertYcckToRgb:function(e){for(var t,r,n,a,i=0,o=0,s=e.length;o<s;o+=4)t=e[o],r=e[o+1],n=e[o+2],a=e[o+3],e[i++]=r*(-660635669420364e-19*r+.000437130475926232*n-54080610064599e-18*t+.00048449797120281*a-.154362151871126)-122.67195406894+n*(-.000957964378445773*n+.000817076911346625*t-.00477271405408747*a+1.53380253221734)+t*(.000961250184130688*t-.00266257332283933*a+.48357088451265)+a*(-.000336197177618394*a+.484791561490776),e[i++]=107.268039397724+r*(219927104525741e-19*r-.000640992018297945*n+.000659397001245577*t+.000426105652938837*a-.176491792462875)+n*(-.000778269941513683*n+.00130872261408275*t+.000770482631801132*a-.151051492775562)+t*(.00126935368114843*t-.00265090189010898*a+.25802910206845)+a*(-.000318913117588328*a-.213742400323665),e[i++]=r*(-.000570115196973677*r-263409051004589e-19*n+.0020741088115012*t-.00288260236853442*a+.814272968359295)-20.810012546947+n*(-153496057440975e-19*n-.000132689043961446*t+.000560833691242812*a-.195152027534049)+t*(.00174418132927582*t-.00255243321439347*a+.116935020465145)+a*(-.000343531996510555*a+.24165260232407);return e},_convertYcckToCmyk:function(e){for(var t,r,n,a=0,i=e.length;a<i;a+=4)t=e[a],r=e[a+1],n=e[a+2],e[a]=434.456-t-1.402*n,e[a+1]=119.541-t+.344*r+.714*n,e[a+2]=481.816-t-1.772*r;return e},_convertCmykToRgb:function(e){for(var t,r,n,a,i=0,o=1/255,s=0,l=e.length;s<l;s+=4)t=e[s]*o,r=e[s+1]*o,n=e[s+2]*o,a=e[s+3]*o,e[i++]=255+t*(-4.387332384609988*t+54.48615194189176*r+18.82290502165302*n+212.25662451639585*a-285.2331026137004)+r*(1.7149763477362134*r-5.6096736904047315*n-17.873870861415444*a-5.497006427196366)+n*(-2.5217340131683033*n-21.248923337353073*a+17.5119270841813)-a*(21.86122147463605*a+189.48180835922747),e[i++]=255+t*(8.841041422036149*t+60.118027045597366*r+6.871425592049007*n+31.159100130055922*a-79.2970844816548)+r*(-15.310361306967817*r+17.575251261109482*n+131.35250912493976*a-190.9453302588951)+n*(4.444339102852739*n+9.8632861493405*a-24.86741582555878)-a*(20.737325471181034*a+187.80453709719578),e[i++]=255+t*(.8842522430003296*t+8.078677503112928*r+30.89978309703729*n-.23883238689178934*a-14.183576799673286)+r*(10.49593273432072*r+63.02378494754052*n+50.606957656360734*a-112.23884253719248)+n*(.03296041114873217*n+115.60384449646641*a-193.58209356861505)-a*(22.33816807309886*a+180.12613974708367);return e},getData:function(t,r,n){if(this.numComponents>4)throw new e("Unsupported color mode");var a=this._getLinearizedBlockData(t,r);if(1===this.numComponents&&n){for(var i=a.length,o=new Uint8ClampedArray(3*i),s=0,l=0;l<i;l++){var u=a[l];o[s++]=u,o[s++]=u,o[s++]=u}return o}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(a);if(4===this.numComponents){if(this._isColorConversionNeeded())return n?this._convertYcckToRgb(a):this._convertYcckToCmyk(a);if(n)return this._convertCmykToRgb(a)}return a}},c}()},void 0!==(i=a())&&(n.exports=i);var s=o.exports},837:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return h}));var n=r(22),a=r(42),i=(r(11),r(760)),o=r(764),s=new Map;s.set("meter-per-second",1),s.set("kilometer-per-hour",.277778),s.set("knots",.514444),s.set("feet-per-second",.3048),s.set("mile-per-hour",.44704);var l=180/Math.PI,u=new a.a({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function c(e,t){return s.get(e)/s.get(t)||1}function f(e){return(450-e)%360}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geographic",r=Object(n.a)(e,2),a=r[0],i=r[1],o=Math.sqrt(a*a+i*i),s=Math.atan2(i,a)*l;return s=(360+s)%360,"geographic"===t&&(s=f(s)),[o,s]}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geographic",r=e[1];"geographic"===t&&(r=f(r)),r%=360;var n=e[0];return[n*Math.cos(r/l),n*Math.sin(r/l)]}function d(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"geographic",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!Object(o.i)(e))return e;for(var s=e.pixels,l=e.width,u=e.height,c=l*u,f=s[0],d=s[1],m=i.a.createEmptyBand(e.pixelType,c),v=i.a.createEmptyBand(e.pixelType,c),b=0,g=0;g<u;g++)for(var y=0;y<l;y++){var w,O,j,x;"vector-uv"===t?(w=h([f[b],d[b]],r),O=Object(n.a)(w,2),m[b]=O[0],v[b]=O[1],m[b]*=a):(j=p([f[b],d[b]],r),x=Object(n.a)(j,2),m[b]=x[0],v[b]=x[1],m[b]*=a,v[b]*=a),b++}var I=new i.a({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[m,v]});return I.updateStatistics(),I}function m(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(1===r||!Object(o.i)(e))return e;for(var n=e.clone(),a=n.pixels,i=n.width,s=n.height,l=a[0],u=a[1],c=0,f=0;f<s;f++)for(var h=0;h<i;h++)"vector-uv"===t?(l[c]*=r,u[c]*=r):l[c]*=r,c++;return n.updateStatistics(),n}!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.PI,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];a&&(r=(2*Math.PI-r)%(2*Math.PI));var i=a?-1:1,o=13*i,s=-7*i,l=-2*i,u=-16*i,c=29,f=v(0,t+o,r,c),h=Object(n.a)(f,2),p=h[0],d=h[1],m=v(e-5.5,t+s,r,c),b=Object(n.a)(m,2),g=b[0],y=b[1],w=v(e+5.5,t+s,r,c),O=Object(n.a)(w,2),j=O[0],x=O[1],I=v(e-1.5,t+l,r,c),k=Object(n.a)(I,2),M=k[0],S=k[1],T=v(e+1.5,t+l,r,c),C=Object(n.a)(T,2),A=C[0],_=C[1],P=v(e-1.5,t+u,r,c),D=Object(n.a)(P,2),R=D[0],E=D[1],L=v(e+1.5,t+u,r,c),N=Object(n.a)(L,2),B=N[0],U=N[1]}(0,0,0);function v(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=Math.sqrt(e*e+t*t)/n,i=(2*Math.PI+Math.atan2(t,e))%(2*Math.PI);return[a,(2*Math.PI+i-r)%(2*Math.PI)]}},840:function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n,a=r(7),i=r.n(a),o=r(12),s=r(13),l=r(2),u=r(4),c=r(5),f=r(6),h=r(0),p=r(82),d=r(60),m=r(29),v=r(183),b=r(15),g=r(712),y=r(297),w=r(30),O=r(241),j=r(27),x=r(99),I=r(1),k=(r(19),r(97)),M=r(10),S=r(137),T=r(18),C=function(){function e(){Object(l.a)(this,e),this.location={left:0,top:0,width:0,height:0},this._allAvailability="unknown",this.byteSize=40}return Object(u.a)(e,[{key:"getAvailability",value:function(e,t){if("unknown"!==this._allAvailability)return this._allAvailability;var r=(e-this.location.top)*this.location.width+(t-this.location.left),n=r%8,a=r>>3,i=this._tileAvailabilityBitSet;return a<0||a>i.length?"unknown":i[a]&1<<n?"available":"unavailable"}},{key:"_updateFromData",value:function(e){for(var t=this.location.width,r=this.location.height,n=!0,a=!0,i=Math.ceil(t*r/8),o=new Uint8Array(i),s=0,l=0;l<e.length;l++){var u=l%8;e[l]?(a=!1,o[s]|=1<<u):n=!1,7===u&&++s}a?this._allAvailability="unavailable":n?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=o,this.byteSize+=o.length)}}],[{key:"fromDefinition",value:function(t,r){var n=t.service.request||p.default,a=t.row,i=t.col,o=t.width,l=t.height,u={query:{f:"json"}};return r=r?Object(s.a)(Object(s.a)({},u),r):u,n(function(e){var t;if("vector-tile"===e.service.type)t="".concat(e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height);else{var r=e.service.tileServers;t="".concat(r&&r.length?r[e.row%r.length]:e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}var n=e.service.query;return n&&(t="".concat(t,"?").concat(n)),t}(t),r).then((function(e){return e.data})).catch((function(e){if(e&&e.details&&422===e.details.httpStatus)return{location:{top:a,left:i,width:o,height:l},valid:!0,data:Object(S.b)(o*l,0)};throw e})).then((function(t){if(t.location&&(t.location.top!==a||t.location.left!==i||t.location.width!==o||t.location.height!==l))throw new m.a("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:a,left:i,width:o,height:l}});return e.fromJSON(t)}))}},{key:"fromJSON",value:function(t){e.validateJSON(t);var r=new e;return r.location=Object.freeze(Object(T.a)(t.location)),r._updateFromData(t.data),Object.freeze(r)}},{key:"validateJSON",value:function(e){if(!e||!e.location)throw new m.a("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new m.a("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new m.a("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new m.a("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new m.a("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}]),e}();function A(e){return"".concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}var _=b.a.getLogger("esri.layers.support.TilemapCache"),P=n=function(e){Object(c.a)(r,e);var t=Object(f.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e))._handles=new v.a,n._pendingTilemapRequests={},n._availableLevels={},n.levels=5,n.cacheByteSize=2097152,n.request=p.default,n._prefetchingEnabled=!0,n}return Object(u.a)(r,[{key:"initialize",value:function(){var e=this;this._tilemapCache=new g.a(this.cacheByteSize),this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],(function(){return e._initializeTilemapDefinition()})),Object(x.a)(this,"layer.tileInfo.lods",(function(t){return e._initializeAvailableLevels(t)}),!0)]),this._initializeTilemapDefinition()}},{key:"destroy",value:function(){this._handles&&(this._handles.destroy(),this._handles=null)}},{key:"castLevels",value:function(e){return e<=2?(_.error("Minimum levels for Tilemap is 3, but got ",e),3):e}},{key:"size",get:function(){return 1<<this.levels}},{key:"fetchTilemap",value:function(e,t,r,n){var a=this;if(!this._availableLevels[e])return Promise.reject(new m.a("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")));var i=this._tmpTilemapDefinition,o=this._tilemapFromCache(e,t,r,i);if(o)return Promise.resolve(o);var l=n&&n.signal;return n=Object(s.a)(Object(s.a)({},n),{},{signal:null}),new Promise((function(e,t){Object(w.q)(l,(function(){return t(Object(w.e)())}));var r=A(i),o=a._pendingTilemapRequests[r];if(!o){o=C.fromDefinition(i,n).then((function(e){return a._tilemapCache.put(r,e,e.byteSize),e}));var s=function(){return delete a._pendingTilemapRequests[r]};a._pendingTilemapRequests[r]=o,o.then(s,s)}o.then(e,t)}))}},{key:"getAvailability",value:function(e,t,r){if(!this._availableLevels[e])return"unavailable";var n=this._tilemapFromCache(e,t,r,this._tmpTilemapDefinition);return n?n.getAvailability(t,r):"unknown"}},{key:"getAvailabilityUpsample",value:function(e,t,r,n){n.level=e,n.row=t,n.col=r;var a=this.layer.tileInfo;for(a.updateTileInfo(n);;){var i=this.getAvailability(n.level,n.row,n.col);if("unavailable"!==i)return i;if(!a.upsampleTile(n))return"unavailable"}}},{key:"fetchAvailability",value:function(e,t,r,n){return this._availableLevels[e]?this.fetchTilemap(e,t,r,n).catch((function(e){return e})).then((function(n){if(n instanceof C){var a=n.getAvailability(t,r);return"unavailable"===a?Promise.reject(new m.a("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r})):a}if(Object(w.m)(n))throw n;return"unknown"})):Promise.reject(new m.a("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")))}},{key:"fetchAvailabilityUpsample",value:function(e,t,r,n,a){var i=this;n.level=e,n.row=t,n.col=r;var o=this.layer.tileInfo;o.updateTileInfo(n);var s=this.fetchAvailability(e,t,r,a).catch((function(e){if(Object(w.m)(e))throw e;if(o.upsampleTile(n))return i.fetchAvailabilityUpsample(n.level,n.row,n.col,n);throw e}));return this._fetchAvailabilityUpsamplePrefetch(n.id,e,t,r,a,s),s}},{key:"_fetchAvailabilityUpsamplePrefetch",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r,a,o,l,u){var c,f,h,p,d,m,v,b,g,y=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._prefetchingEnabled){e.next=2;break}return e.abrupt("return");case 2:if(c="prefetch-".concat(t),!this._handles.has(c)){e.next=5;break}return e.abrupt("return");case 5:return f=Object(w.d)(),u.then((function(){return f.abort()}),(function(){return f.abort()})),h=!1,p={remove:function(){h||(h=!0,f.abort())}},this._handles.add(p,c),e.next=12,Object(O.b)(10,f.signal).catch((function(){}));case 12:if(h||(h=!0,this._handles.remove(c)),!Object(w.n)(f)){e.next=15;break}return e.abrupt("return");case 15:for(d={id:t,level:r,row:a,col:o},m=Object(s.a)(Object(s.a)({},l),{},{signal:f.signal}),v=this.layer.tileInfo,b=function(e){var t=y.fetchAvailability(d.level,d.row,d.col,m);n._prefetches.push(t);var r=function(){n._prefetches.removeUnordered(t)};t.then(r,r)},g=0;n._prefetches.length<n._maxPrefetch&&v.upsampleTile(d);++g)b();case 18:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,o){return e.apply(this,arguments)}}()},{key:"_initializeTilemapDefinition",value:function(){if(this.layer.parsedUrl){var e=this.layer.parsedUrl,t=e.query;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?Object(j.D)(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}}},{key:"_tilemapFromCache",value:function(e,t,r,n){n.level=e,n.row=t-t%this.size,n.col=r-r%this.size;var a=A(n);return this._tilemapCache.get(a)}},{key:"_initializeAvailableLevels",value:function(e){var t=this;this._availableLevels={},e&&e.forEach((function(e){return t._availableLevels[e.level]=!0}))}},{key:"test",get:function(){var e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:function(t,r,n){return!!e._tilemapFromCache(t,r,n,e._tmpTilemapDefinition)}}}}]),r}(d.a);P._maxPrefetch=4,P._prefetches=new y.a({initialSize:n._maxPrefetch}),Object(h.a)([Object(I.b)({constructOnly:!0,type:Number})],P.prototype,"levels",void 0),Object(h.a)([Object(k.a)("levels")],P.prototype,"castLevels",null),Object(h.a)([Object(I.b)({readOnly:!0,type:Number})],P.prototype,"size",null),Object(h.a)([Object(I.b)({constructOnly:!0,type:Number})],P.prototype,"cacheByteSize",void 0),Object(h.a)([Object(I.b)({constructOnly:!0})],P.prototype,"layer",void 0),Object(h.a)([Object(I.b)({constructOnly:!0})],P.prototype,"request",void 0),P=n=Object(h.a)([Object(M.a)("esri.layers.support.TilemapCache")],P)},850:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(167),a={};a.defaultNoDataValue=Object(n.e)(-1/0),a.decode=function(e,t){var r=(t=t||{}).encodedMaskData||null===t.encodedMaskData,u=l(e,t.inputOffset||0,r),c=null!=t.noDataValue?Object(n.e)(t.noDataValue):a.defaultNoDataValue,f=i(u,t.pixelType||Float32Array,t.encodedMaskData,c,t.returnMask),h={width:u.width,height:u.height,pixelData:f.resultPixels,minValue:u.pixels.minValue,maxValue:u.pixels.maxValue,noDataValue:c};return f.resultMask&&(h.maskData=f.resultMask),t.returnEncodedMask&&u.mask&&(h.encodedMaskData=u.mask.bitset?u.mask.bitset:null),t.returnFileInfo&&(h.fileInfo=o(u,c),t.computeUsedBitDepths&&(h.fileInfo.bitDepths=s(u))),h};var i=function(e,t,r,n,a){var i,o,s=0,l=e.pixels.numBlocksX,c=e.pixels.numBlocksY,f=Math.floor(e.width/l),h=Math.floor(e.height/c),p=2*e.maxZError;r=r||(e.mask?e.mask.bitset:null),i=new t(e.width*e.height),a&&r&&(o=new Uint8Array(e.width*e.height));for(var d,m,v=new Float32Array(f*h),b=0;b<=c;b++){var g=b!==c?h:e.height%c;if(0!==g)for(var y=0;y<=l;y++){var w=y!==l?f:e.width%l;if(0!==w){var O,j,x,I,k=b*e.width*h+y*f,M=e.width-w,S=e.pixels.blocks[s];if(S.encoding<2?(0===S.encoding?O=S.rawData:(u(S.stuffedData,S.bitsPerPixel,S.numValidPixels,S.offset,p,v,e.pixels.maxValue),O=v),j=0):x=2===S.encoding?0:S.offset,r)for(m=0;m<g;m++){for(7&k&&(I=r[k>>3],I<<=7&k),d=0;d<w;d++)7&k||(I=r[k>>3]),128&I?(o&&(o[k]=1),i[k++]=S.encoding<2?O[j++]:x):(o&&(o[k]=0),i[k++]=n),I<<=1;k+=M}else if(S.encoding<2)for(m=0;m<g;m++){for(d=0;d<w;d++)i[k++]=O[j++];k+=M}else for(m=0;m<g;m++)if(i.fill)i.fill(x,k,k+w),k+=w+M;else{for(d=0;d<w;d++)i[k++]=x;k+=M}if(1===S.encoding&&j!==S.numValidPixels)throw"Block and Mask do not match";s++}}}return{resultPixels:i,resultMask:o}},o=function(e,t){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,minValue:e.pixels.minValue,noDataValue:t}}},s=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},n=0;n<t;n++){var a=e.pixels.blocks[n];0===a.encoding?r.float32=!0:1===a.encoding?r[a.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},l=function(e,t,r){var n={},a=new Uint8Array(e,t,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,a),"CntZImage"!=n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;t+=10;var i=new DataView(e,t,24);if(n.fileVersion=i.getInt32(0,!0),n.imageType=i.getInt32(4,!0),n.height=i.getUint32(8,!0),n.width=i.getUint32(12,!0),n.maxZError=i.getFloat64(16,!0),t+=24,!r)if(i=new DataView(e,t,16),n.mask={},n.mask.numBlocksY=i.getUint32(0,!0),n.mask.numBlocksX=i.getUint32(4,!0),n.mask.numBytes=i.getUint32(8,!0),n.mask.maxValue=i.getFloat32(12,!0),t+=16,n.mask.numBytes>0){var o=new Uint8Array(Math.ceil(n.width*n.height/8)),s=(i=new DataView(e,t,n.mask.numBytes)).getInt16(0,!0),l=2,u=0;do{if(s>0)for(;s--;)o[u++]=i.getUint8(l++);else{var c=i.getUint8(l++);for(s=-s;s--;)o[u++]=c}s=i.getInt16(l,!0),l+=2}while(l<n.mask.numBytes);if(-32768!==s||u<o.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=o,t+=n.mask.numBytes}else 0==(n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue)&&(o=new Uint8Array(Math.ceil(n.width*n.height/8)),n.mask.bitset=o);i=new DataView(e,t,16),n.pixels={},n.pixels.numBlocksY=i.getUint32(0,!0),n.pixels.numBlocksX=i.getUint32(4,!0),n.pixels.numBytes=i.getUint32(8,!0),n.pixels.maxValue=i.getFloat32(12,!0),t+=16;var f=n.pixels.numBlocksX,h=n.pixels.numBlocksY,p=f+(n.width%f>0?1:0),d=h+(n.height%h>0?1:0);n.pixels.blocks=new Array(p*d);for(var m=1e9,v=0,b=0;b<d;b++)for(var g=0;g<p;g++){var y=0,w=e.byteLength-t;i=new DataView(e,t,Math.min(10,w));var O={};n.pixels.blocks[v++]=O;var j=i.getUint8(0);if(y++,O.encoding=63&j,O.encoding>3)throw"Invalid block encoding ("+O.encoding+")";if(2!==O.encoding){if(0!==j&&2!==j){if(j>>=6,O.offsetType=j,2===j)O.offset=i.getInt8(1),y++;else if(1===j)O.offset=i.getInt16(1,!0),y+=2;else{if(0!==j)throw"Invalid block offset type";O.offset=i.getFloat32(1,!0),y+=4}if(m=Math.min(O.offset,m),1===O.encoding)if(j=i.getUint8(y),y++,O.bitsPerPixel=63&j,j>>=6,O.numValidPixelsType=j,2===j)O.numValidPixels=i.getUint8(y),y++;else if(1===j)O.numValidPixels=i.getUint16(y,!0),y+=2;else{if(0!==j)throw"Invalid valid pixel count type";O.numValidPixels=i.getUint32(y,!0),y+=4}}var x;if(t+=y,3!=O.encoding)if(0===O.encoding){var I=(n.pixels.numBytes-1)/4;if(I!==Math.floor(I))throw"uncompressed block has invalid length";x=new ArrayBuffer(4*I),new Uint8Array(x).set(new Uint8Array(e,t,4*I));for(var k=new Float32Array(x),M=0;M<k.length;M++)m=Math.min(m,k[M]);O.rawData=k,t+=4*I}else if(1===O.encoding){var S=Math.ceil(O.numValidPixels*O.bitsPerPixel/8),T=Math.ceil(S/4);x=new ArrayBuffer(4*T),new Uint8Array(x).set(new Uint8Array(e,t,S)),O.stuffedData=new Uint32Array(x),t+=S}}else t++,m=Math.min(m,0)}return n.pixels.minValue=m,n.eofOffset=t,n},u=function(e,t,r,n,a,i,o){var s,l,u,c=(1<<t)-1,f=0,h=0,p=Math.ceil((o-n)/a),d=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*d,s=0;s<r;s++){if(0===h&&(u=e[f++],h=32),h>=t)l=u>>>h-t&c,h-=t;else{var m=t-h;l=(u&c)<<m&c,l+=(u=e[f++])>>>(h=32-m)}i[s]=l<p?n+l*a:o}return i},c=a.decode},856:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=r(13),a=r(743),i={type:a.a,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:o}}}}};function o(e,t,r,i){if(!e)return null;var o=t.minScale,s=t.maxScale,l=t.minLOD,u=t.maxLOD;if(null!=l&&null!=u)return i&&i.ignoreMinMaxLOD?a.a.fromJSON(e):a.a.fromJSON(Object(n.a)(Object(n.a)({},e),{},{lods:e.lods.filter((function(e){var t=e.level;return null!=t&&t>=l&&t<=u}))}));if(0!==o&&0!==s){var c=function(e){return Math.round(1e4*e)/1e4},f=o?c(o):1/0,h=s?c(s):-1/0;return a.a.fromJSON(Object(n.a)(Object(n.a)({},e),{},{lods:e.lods.filter((function(e){var t=c(e.scale);return t<=f&&t>=h}))}))}return a.a.fromJSON(e)}},866:function(e,t,r){"use strict";function n(e,t){for(var r=0,n="",a=0,i=0,o=e.length;r<o;)(a=(i=e[r++])>>4)<8?a=1:15===a?(a=4,i=(7&i)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++]):14===a?(a=3,i=(15&i)<<12|(63&e[r++])<<6|63&e[r++]):(a=2,i=(31&i)<<6|63&e[r++]),(0!==i||t)&&(n+=String.fromCharCode(i));return n}r.d(t,"a",(function(){return n}))},867:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=function(){var e=[];return e[254]="NEWSUBFILETYPE",e[255]="SUBFILETYPE",e[256]="IMAGEWIDTH",e[257]="IMAGELENGTH",e[258]="BITSPERSAMPLE",e[259]="COMPRESSION",e[262]="PHOTOMETRICINTERPRETATION",e[263]="THRESHHOLDING",e[264]="CELLWIDTH",e[265]="CELLLENGTH",e[266]="FILLORDER",e[269]="DOCUMENTNAME",e[270]="IMAGEDESCRIPTION",e[271]="MAKE",e[272]="MODEL",e[273]="STRIPOFFSETS",e[274]="ORIENTATION",e[277]="SAMPLESPERPIXEL",e[278]="ROWSPERSTRIP",e[279]="STRIPBYTECOUNTS",e[280]="MINSAMPLEVALUE",e[281]="MAXSAMPLEVALUE",e[282]="XRESOLUTION",e[283]="YRESOLUTION",e[284]="PLANARCONFIGURATION",e[285]="PAGENAME",e[286]="XPOSITION",e[287]="YPOSITION",e[288]="FREEOFFSETS",e[289]="FREEBYTECOUNTS",e[290]="GRAYRESPONSEUNIT",e[291]="GRAYRESPONSECURVE",e[292]="T4OPTIONS",e[293]="T6OPTIONS",e[296]="RESOLUTIONUNIT",e[297]="PAGENUMBER",e[300]="COLORRESPONSEUNIT",e[301]="TRANSFERFUNCTION",e[305]="SOFTWARE",e[306]="DATETIME",e[315]="ARTIST",e[316]="HOSTCOMPUTER",e[317]="PREDICTOR",e[318]="WHITEPOINT",e[319]="PRIMARYCHROMATICITIES",e[320]="COLORMAP",e[321]="HALFTONEHINTS",e[322]="TILEWIDTH",e[323]="TILELENGTH",e[324]="TILEOFFSETS",e[325]="TILEBYTECOUNTS",e[326]="BADFAXLINES",e[327]="CLEANFAXDATA",e[328]="CONSECUTIVEBADFAXLINES",e[330]="SUBIFD",e[332]="INKSET",e[333]="INKNAMES",e[334]="NUMBEROFINKS",e[336]="DOTRANGE",e[337]="TARGETPRINTER",e[338]="EXTRASAMPLES",e[339]="SAMPLEFORMAT",e[340]="SMINSAMPLEVALUE",e[341]="SMAXSAMPLEVALUE",e[342]="TRANSFERRANGE",e[347]="JPEGTABLES",e[512]="JPEGPROC",e[513]="JPEGIFOFFSET",e[514]="JPEGIFBYTECOUNT",e[515]="JPEGRESTARTINTERVAL",e[517]="JPEGLOSSLESSPREDICTORS",e[518]="JPEGPOINTTRANSFORM",e[519]="JPEGQTABLES",e[520]="JPEGDCTABLES",e[521]="JPEGACTABLES",e[529]="YCBCRCOEFFICIENTS",e[530]="YCBCRSUBSAMPLING",e[531]="YCBCRPOSITIONING",e[532]="REFERENCEBLACKWHITE",e[700]="XMP",e[33550]="GEOPIXELSCALE",e[33922]="GEOTIEPOINTS",e[33432]="COPYRIGHT",e[42112]="GDAL_METADATA",e[42113]="GDAL_NODATA",e[50844]="RPCCOEFFICIENT",e[34264]="GEOTRANSMATRIX",e[34735]="GEOKEYDIRECTORY",e[34736]="GEODOUBLEPARAMS",e[34737]="GEOASCIIPARAMS",e[34665]="EXIFIFD",e[34853]="GPSIFD",e[40965]="INTEROPERABILITYIFD",e}(),a=function(){var e=[].concat(n);return e[36864]="ExifVersion",e[40960]="FlashpixVersion",e[40961]="ColorSpace",e[42240]="Gamma",e[37121]="ComponentsConfiguration",e[37122]="CompressedBitsPerPixel",e[40962]="PixelXDimension",e[40963]="PixelYDimension",e[37500]="MakerNote",e[37510]="UserComment",e[40964]="RelatedSoundFile",e[36867]="DateTimeOriginal",e[36868]="DateTimeDigitized",e[36880]="OffsetTime",e[36881]="OffsetTimeOriginal",e[36882]="OffsetTimeDigitized",e[37520]="SubSecTime",e[37521]="SubSecTimeOriginal",e[37522]="SubSecTimeDigitized",e[37888]="Temperature",e[37889]="Humidity",e[37890]="Pressure",e[37891]="WaterDepth",e[37892]="Acceleration",e[37893]="CameraElevationAngle",e[42016]="ImageUniqueID",e[42032]="CameraOwnerName",e[42033]="BodySerialNumber",e[42034]="LensSpecification",e[42035]="LensMake",e[42036]="LensModel",e[42037]="LensSerialNumber",e[33434]="ExposureTime",e[33437]="FNumber",e[34850]="ExposureProgram",e[34852]="SpectralSensitivity",e[34855]="PhotographicSensitivity",e[34856]="OECF",e[34864]="SensitivityType",e[34865]="StandardOutputSensitivity",e[34866]="RecommendedExposureIndex",e[34867]="ISOSpeed",e[34868]="ISOSpeedLatitudeyyy",e[34869]="ISOSpeedLatitudezzz",e[37377]="ShutterSpeedValue",e[37378]="ApertureValue",e[37379]="BrightnessValue",e[37380]="ExposureBiasValue",e[37381]="MaxApertureValue",e[37382]="SubjectDistance",e[37383]="MeteringMode",e[37384]="LightSource",e[37385]="Flash",e[37386]="FocalLength",e[37396]="SubjectArea",e[41483]="FlashEnergy",e[41484]="SpatialFrequencyResponse",e[41486]="FocalPlaneXResolution",e[41487]="FocalPlaneYResolution",e[41488]="FocalPlaneResolutionUnit",e[41492]="SubjectLocation",e[41493]="ExposureIndex",e[41495]="SensingMethod",e[41728]="FileSource",e[41729]="SceneType",e[41730]="CFAPattern",e[41985]="CustomRendered",e[41986]="ExposureMode",e[41987]="WhiteBalance",e[41988]="DigitalZoomRatio",e[41989]="FocalLengthIn35mmFilm",e[41990]="SceneCaptureType",e[41991]="GainControl",e[41992]="Contrast",e[41993]="Saturation",e[41994]="Sharpness",e[41995]="DeviceSettingDescription",e[41996]="SubjectDistanceRange",e}(),i=function(){var e=[];return e[1024]="GTModelTypeGeoKey",e[1025]="GTRasterTypeGeoKey",e[1026]="GTCitationGeoKey",e[2048]="GeographicTypeGeoKey",e[2049]="GeogCitationGeoKey",e[2050]="GeogGeodeticDatumGeoKey",e[2051]="GeogPrimeMeridianGeoKey",e[2052]="GeogLinearUnitsGeoKey",e[2053]="GeogLinearUnitSizeGeoKey",e[2054]="GeogAngularUnitsGeoKey",e[2055]="GeogAngularUnitSizeGeoKey",e[2056]="GeogEllipsoidGeoKey",e[2057]="GeogSemiMajorAxisGeoKey",e[2058]="GeogSemiMinorAxisGeoKey",e[2059]="GeogInvFlatteningGeoKey",e[2061]="GeogPrimeMeridianLongGeoKey",e[2060]="GeogAzimuthUnitsGeoKey",e[3072]="ProjectedCSTypeGeoKey",e[3073]="PCSCitationGeoKey",e[3074]="ProjectionGeoKey",e[3075]="ProjCoordTransGeoKey",e[3076]="ProjLinearUnitsGeoKey",e[3077]="ProjLinearUnitSizeGeoKey",e[3078]="ProjStdParallel1GeoKey",e[3079]="ProjStdParallel2GeoKey",e[3080]="ProjNatOriginLongGeoKey",e[3081]="ProjNatOriginLatGeoKey",e[3082]="ProjFalseEastingGeoKey",e[3083]="ProjFalseNorthingGeoKey",e[3084]="ProjFalseOriginLongGeoKey",e[3085]="ProjFalseOriginLatGeoKey",e[3086]="ProjFalseOriginEastingGeoKey",e[3087]="ProjFalseOriginNorthingGeoKey",e[3088]="ProjCenterLongGeoKey",e[3090]="ProjCenterEastingGeoKey",e[3091]="ProjCenterNorthingGeoKey",e[3092]="ProjScaleAtNatOriginGeoKey",e[3093]="ProjScaleAtCenterGeoKey",e[3094]="ProjAzimuthAngleGeoKey",e[3095]="ProjStraightVertPoleLongGeoKey",e[4096]="VerticalCSTypeGeoKey",e[4097]="VerticalCitationGeoKey",e[4098]="VerticalDatumGeoKey",e[4099]="VerticalUnitsGeoKey",e}(),o=new Map;o.set("EXIFIFD",a),o.set("GPSIFD",["GPSVersionID","GPSLatitudeRef","GPSLatitude","GPSLongitudeRef","GPSLongitude","GPSAltitudeRef","GPSAltitude","GPSTimeStamp","GPSSatellites","GPSStatus","GPSMeasureMode","GPSDOP","GPSSpeedRef","GPSSpeed","GPSTrackRef","GPSTrack","GPSImgDirectionRef","GPSImgDirection","GPSMapDatum","GPSDestLatitudeRef","GPSDestLatitude","GPSDestLongitudeRef","GPSDestLongitude","GPSDestBearingRef","GPSDestBearing","GPSDestDistanceRef","GPSDestDistance","GPSProcessingMethod","GPSAreaInformation","GPSDateStamp","GPSDifferential","GPSHPositioningError"]);var s={TIFF_TAGS:n,ifdTags:o,GEO_KEYS:i,getTagName:function(e,t){var r=(t||n)[e];return void 0===r&&(r="unknown"+String(e)),r}}},870:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return h}));var n=r(13),a=r(165),i=r(700),o=r(830),s=r(825),l=r(826),u=r(701),c=r(829),f={key:"type",base:null,typeMap:{"unique-value":u.a,"class-breaks":i.a,"raster-colormap":o.a,"raster-stretch":l.a,"vector-field":c.a,"raster-shaded-relief":s.a}},h=Object(n.a)(Object(n.a)({},f),{},{typeMap:Object(n.a)({},f.typeMap)});delete h.typeMap["vector-field"];var p={uniqueValue:u.a,classBreaks:i.a,rasterStretch:l.a,rasterColormap:o.a,vectorField:c.a,rasterShadedRelief:s.a};function d(e,t){if(!e)return null;if("classBreaks"===e.type&&e.classificationMethod){var r=e.authoringInfo||{classificationMethod:""};r.classificationMethod=e.classificationMethod,e.authoringInfo=r}var n,i=(n=e)&&p[n.type]||null;if(i){var o=new i;return o.read(e,t),o}return t&&t.messages&&e&&t.messages.push(new a.a("renderer:unsupported","Renderers of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:t})),null}},871:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return h})),r.d(t,"g",(function(){return c})),r.d(t,"h",(function(){return l}));var n=r(22),a=r(21);function i(e,t,r){var i=function(e){for(var t=e.length;t--;)if(-1===" /-,\n".indexOf(e.charAt(t)))return!1;return!0},s=[],l=0,u=-1;do{if((u=t.indexOf("[",l))>=l){if(u>l){var c=t.substr(l,u-l);s.push([c,null,i(c)])}if(l=u+1,(u=t.indexOf("]",l))>=l){if(u>l){var f=e[t.substr(l,u-l)];f&&s.push([null,f,!1])}l=u+1}}}while(-1!==u);if(l<t.length-1){var h=t.substr(l);s.push([h,null,i(h)])}return function(e){var t,i="",l=null,u=Object(a.a)(s);try{for(u.s();!(t=u.n()).done;){var c=t.value,f=Object(n.a)(c,3),h=f[0],p=f[1],d=f[2];if(h)d?l=h:(l&&(i+=l,l=null),i+=h);else{var m=e.attributes[p];m&&(l&&(i+=l,l=null),i+=m)}}}catch(v){u.e(v)}finally{u.f()}return o(i,r)}}function o(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function s(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function l(e){var t;return null==(t=e.data)?void 0:t.symbol}function u(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function c(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function f(e){return"CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type}function h(e){return"CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type}},878:function(e,t,r){"use strict";r.d(t,"a",(function(){return N})),r.d(t,"b",(function(){return L}));var n=r(7),a=r.n(n),i=r(13),o=r(12),s=r(29),l=r(760),u=r(2),c=r(4),f=r(30),h=r(780),p=function(){function e(t){Object(u.a)(this,e),t&&(this.canvas=t.canvas,this.ctx=t.ctx||t.canvas&&t.canvas.getContext("2d"))}return Object(c.a)(e,[{key:"decode",value:function(t,r,n){var a=this;if(!t||t.byteLength<10)throw new s.a("imagecanvasdecoder: decode","required a valid encoded data as input.");var i=r.width,o=r.height,l=r.format,u=r.applyJpegMask;if(u&&(!i||!o))throw new s.a("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((function(s,c){var h=null;"jpg"===l&&u&&(h=e.getMask(t,{width:i,height:o}));var p,d=new Blob([new Uint8Array(t)],{type:"image/"+l=="jpg"?"jpeg":l}),m=URL.createObjectURL(d),v=new Image;v.src=m,v.onload=function(){if(URL.revokeObjectURL(m),Object(f.n)(n))c(Object(f.e)());else{i=v.width,o=v.height,a.canvas?(a.canvas.width===i&&a.canvas.height===o||(a.canvas.width=i,a.canvas.height=o),a.ctx.clearRect(0,0,i,o)):(a.canvas=document.createElement("canvas"),a.canvas.width=i,a.canvas.height=o,a.ctx=a.canvas.getContext("2d")),a.ctx.drawImage(v,0,0);var e,t=a.ctx.getImageData(0,0,i,o);if(p=t.data,r.renderOnCanvas){if(h)for(e=0;e<h.length;e++)h[e]?p[4*e+3]=255:p[4*e+3]=0;return a.ctx.putImageData(t,0,0),void s(null)}var l=i*o,u=new Uint8Array(l),d=new Uint8Array(l),b=new Uint8Array(l);if(h)for(e=0;e<l;e++)u[e]=p[4*e],d[e]=p[4*e+1],b[e]=p[4*e+2];else for(h=new Uint8Array(l),e=0;e<l;e++)u[e]=p[4*e],d[e]=p[4*e+1],b[e]=p[4*e+2],h[e]=p[4*e+3];s({width:i,height:o,pixels:[u,d,b],mask:h,pixelType:"u8"})}},v.onerror=function(){URL.revokeObjectURL(m),c("cannot load image")}}))}}],[{key:"getMask",value:function(e,t){var r=null;try{var n=new Uint8Array(e),a=Math.ceil(n.length/2),i=0,o=n.length-2;for(i=a;i<o&&(255!==n[i]||217!==n[i+1]);i++);if((i+=2)<n.length-1){var s=new h.a(n.subarray(i)).getBytes();r=new Uint8Array(t.width*t.height);for(var l=0,u=0;u<s.length;u++)for(var c=7;c>=0;c--)r[l++]=s[u]>>c&1}}catch(f){}return r}}]),e}(),d=r(836),m=function(){function e(){Object(u.a)(this,e)}return Object(c.a)(e,null,[{key:"decode",value:function(e){var t=new Uint8Array(e),r=new d.a;r.parse(t);var n,a=r.width,i=r.height,o=r.numComponents,s=r.eof,l=r.getData(a,i,!0),u=a*i,c=0,f=0,p=0;if(s<t.length-1){var m=new h.a(t.subarray(s)).getBytes();n=new Uint8Array(u);var v=0;for(c=0;c<m.length;c++)for(p=7;p>=0;p--)n[v++]=m[c]>>p&1}var b,g=null;if(1===o)g=[l,l,l];else{for(g=[],c=0;c<3;c++)b=new Uint8Array(u),g.push(b);for(p=0,f=0;f<u;f++)for(c=0;c<3;c++)g[c][f]=l[p++]}return{width:a,height:i,pixels:g,mask:n}}}]),e}(),v=r(880),b=r(850),g=function(e,t){var r=t.width*t.height,n=t.pixelType;return Math.floor(e.byteLength/(r*y(n)))},y=function(e){var t=1;switch(e){case Uint8Array:case Int8Array:t=1;break;case Uint16Array:case Int16Array:t=2;break;case Uint32Array:case Int32Array:case Float32Array:t=4;break;case Float64Array:t=8}return t},w=function(){function e(){Object(u.a)(this,e)}return Object(c.a)(e,null,[{key:"decode",value:function(e,t){var r,n,a,i,o,s=t.pixelType,l=[],u=t.width*t.height,c=g(e,t),f=t.bandIds,h=t.format,p=f&&f.length||g(e,t),d=e.byteLength-e.byteLength%(u*y(s)),m=new s(e,0,u*c);if("bip"===h)for(r=0;r<p;r++){for(i=new s(u),o=f?f[r]:r,n=0;n<u;n++)i[n]=m[n*c+o];l.push(i)}else if("bsq"===h)for(r=0;r<p;r++)o=f?f[r]:r,l.push(m.subarray(o*u,(o+1)*u));return d<e.byteLength-1&&(a=function(e,t){if(8*e.byteLength<t)return null;var r=new Uint8Array(e,0,Math.ceil(t/8)),n=new Uint8Array(t),a=0,i=0,o=0,s=0;for(o=0;o<r.length-1;o++)for(i=r[o],s=7;s>=0;s--)n[a++]=i>>s&1;for(s=7;a<t-1;)i=r[r.length-1],n[a++]=i>>s&1,s--;return n}(e.slice(d),u)),{pixels:l,mask:a}}}]),e}(),O=r(823),j=function(e){var t,r,n;function a(e){var t,r,n,a,i,o,s,l,u,c,f,h,p;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},i=null;;){switch(t=this.readUInt32(),l=function(){var e,t;for(t=[],e=0;e<4;++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join(""),l){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":i&&this.animation.frames.push(i),this.pos+=4,i={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},a=this.readUInt16(),n=this.readUInt16()||100,i.delay=1e3*a/n,i.disposeOp=this.data[this.pos++],i.blendOp=this.data[this.pos++],i.data=[];break;case"IDAT":case"fdAT":for("fdAT"===l&&(this.pos+=4,t-=4),e=(null!=i?i.data:void 0)||this.imgData,f=0;0<=t?f<t:f>t;0<=t?++f:--f)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(t),(u=255-this.transparency.indexed.length)>0)for(h=0;0<=u?h<u:h>u;0<=u?++h:--h)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":o=(c=this.read(t)).indexOf(0),s=String.fromCharCode.apply(String,c.slice(0,o)),this.text[s]=String.fromCharCode.apply(String,c.slice(o+1));break;case"IEND":return i&&this.animation.frames.push(i),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(p=this.colorType)||6===p,r=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*r,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}return a.load=function(e,t,r){var n;return"function"==typeof t&&(r=t),(n=new XMLHttpRequest).open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){var e;return e=new a(new Uint8Array(n.response||n.mozResponseArrayBuffer)),"function"==typeof(null!=t?t.getContext:void 0)&&e.render(t),"function"==typeof r?r(e):void 0},n.send(null)},1,2,0,a.prototype.read=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)r.push(this.data[this.pos++]);return r},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(e){var t,r,n,a,i,o,s,l,u,c,f,p,d,m,v,b,g,y,w,O,j,x,I;if(null==e&&(e=this.imgData),0===e.length)return new Uint8Array(0);for(e=(e=new h.a(e)).getBytes(),b=(p=this.pixelBitlength/8)*this.width,d=new Uint8Array(b*this.height),o=e.length,v=0,m=0,r=0;m<o;){switch(e[m++]){case 0:for(a=w=0;w<b;a=w+=1)d[r++]=e[m++];break;case 1:for(a=O=0;O<b;a=O+=1)t=e[m++],i=a<p?0:d[r-p],d[r++]=(t+i)%256;break;case 2:for(a=j=0;j<b;a=j+=1)t=e[m++],n=(a-a%p)/p,g=v&&d[(v-1)*b+n*p+a%p],d[r++]=(g+t)%256;break;case 3:for(a=x=0;x<b;a=x+=1)t=e[m++],n=(a-a%p)/p,i=a<p?0:d[r-p],g=v&&d[(v-1)*b+n*p+a%p],d[r++]=(t+Math.floor((i+g)/2))%256;break;case 4:for(a=I=0;I<b;a=I+=1)t=e[m++],n=(a-a%p)/p,i=a<p?0:d[r-p],0===v?g=y=0:(g=d[(v-1)*b+n*p+a%p],y=n&&d[(v-1)*b+(n-1)*p+a%p]),s=i+g-y,l=Math.abs(s-i),c=Math.abs(s-g),f=Math.abs(s-y),u=l<=c&&l<=f?i:c<=f?g:y,d[r++]=(t+u)%256;break;default:throw new Error("Invalid filter algorithm: "+e[m-1])}v++}return d},a.prototype.decodePalette=function(){var e,t,r,n,a,i,o,s,l;for(r=this.palette,i=this.transparency.indexed||[],a=new Uint8Array((i.length||0)+r.length),n=0,e=0,t=o=0,s=r.length;o<s;t=o+=3)a[n++]=r[t],a[n++]=r[t+1],a[n++]=r[t+2],a[n++]=null!=(l=i[e++])?l:255;return a},a.prototype.copyToImageData=function(e,t){var r,n,a,i,o,s,l,u,c,f,h;if(n=this.colors,c=null,r=this.hasAlphaChannel,this.palette.length&&(c=null!=(h=this._decodedPalette)?h:this._decodedPalette=this.decodePalette(),n=4,r=!0),u=(a=e.data||e).length,o=c||t,i=s=0,1===n)for(;i<u;)l=c?4*t[i/4]:s,f=o[l++],a[i++]=f,a[i++]=f,a[i++]=f,a[i++]=r?o[l++]:this.transparency.grayscale&&this.transparency.grayscale===f?0:255,s=l;else for(;i<u;)l=c?4*t[i/4]:s,a[i++]=o[l++],a[i++]=o[l++],a[i++]=o[l++],a[i++]=r?o[l++]:this.transparency.rgb&&this.transparency.rgb[1]===o[l-3]&&this.transparency.rgb[3]===o[l-2]&&this.transparency.rgb[5]===o[l-1]?0:255,s=l},a.prototype.decode=function(){var e;return e=new Uint8Array(this.width*this.height*4),this.copyToImageData(e,this.decodePixels()),e},r=e.document&&e.document.createElement("canvas"),n=r&&r.getContext("2d"),t=function(e){var t;return n.width=e.width,n.height=e.height,n.clearRect(0,0,e.width,e.height),n.putImageData(e,0,0),(t=new Image).src=r.toDataURL(),t},a.prototype.decodeFrames=function(e){var r,n,a,i,o,s,l,u;if(this.animation){for(u=[],n=o=0,s=(l=this.animation.frames).length;o<s;n=++o)r=l[n],a=e.createImageData(r.width,r.height),i=this.decodePixels(new Uint8Array(r.data)),this.copyToImageData(a,i),r.imageData=a,u.push(r.image=t(a));return u}},a.prototype.renderFrame=function(e,t){var r,n,a;return r=(n=this.animation.frames)[t],a=n[t-1],0===t&&e.clearRect(0,0,this.width,this.height),1===(null!=a?a.disposeOp:void 0)?e.clearRect(a.xOffset,a.yOffset,a.width,a.height):2===(null!=a?a.disposeOp:void 0)&&e.putImageData(a.imageData,a.xOffset,a.yOffset),0===r.blendOp&&e.clearRect(r.xOffset,r.yOffset,r.width,r.height),e.drawImage(r.image,r.xOffset,r.yOffset)},a.prototype.animate=function(e){var t,r,n,a,i,o,s=this;return r=0,o=this.animation,a=o.numFrames,n=o.frames,i=o.numPlays,(t=function(){var o,l;if(o=r++%a,l=n[o],s.renderFrame(e,o),a>1&&r/a<i)return s.animation._timeout=setTimeout(t,l.delay)})()},a.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)},a.prototype.render=function(e){var t,r;return e._png&&e._png.stopAnimation(),e._png=this,e.width=this.width,e.height=this.height,t=e.getContext("2d"),this.animation?(this.decodeFrames(t),this.animate(t)):(r=t.createImageData(this.width,this.height),this.copyToImageData(r,this.decodePixels()),t.putImageData(r,0,0))},a}(self),x=new Set(["jpg","png","bmp","gif"]);function I(e,t){if(!O.a)throw new s.a("rasterCoded:decode","lerc decoder is not supported on big endian platform");for(var r,n,a=t.width,i=t.height,o=t.pixelType,u=R(o),c=u.pixelTypeCtor,f=null==t.noDataValue?u.noDataValue:t.noDataValue,h=0,p=0,d=e.byteLength-10;p<d;){var m=Object(b.a)(e,{inputOffset:p,encodedMaskData:r,returnMask:0===h,returnEncodedMask:0===h,returnFileInfo:!0,pixelType:c,noDataValue:f});if(a&&i&&(m.width!==a||m.height!==i))throw new s.a("rasterCoded:decode","lerc decoded result has width or height different from specified in options");if(p=m.fileInfo.eofOffset,0===h&&(r=m.encodedMaskData,n=new l.a({width:m.width,height:m.height,pixels:[],pixelType:o,mask:m.maskData,statistics:[]})),h++,n.addData({pixels:m.pixelData,statistics:{minValue:m.minValue,maxValue:m.maxValue,noDataValue:m.noDataValue}}),d-p>10){var v=String.fromCharCode.apply(null,new Uint8Array(e,p,10));p+=v.indexOf("CntZ")>-1?v.indexOf("CntZ"):0}}return n}function k(e,t){if(!O.a)throw new s.a("rasterCoded:decode","lerc decoder is not supported on big endian platform");for(var r,n,a,i=0,o=t.offset||0,u=0,c=t.eof||e.byteLength-10,f=[],h=t.width,p=t.height,d=0;o<c;){var m;if(n=v.a.decode(e,{inputOffset:o,maskData:r,returnFileInfo:!0}),h&&p&&(n.width!==h||n.height!==p))throw new s.a("rasterCoded:decode","lerc2 decoded result has width or height different from what's specified in options");if(o=n.fileInfo.eofOffset,r=n.maskData,0===i&&(u=n.fileInfo.numValidPixel,a=new l.a({width:n.width,height:n.height,pixels:[],pixelType:n.fileInfo.pixelType,mask:r,statistics:[]})),n.fileInfo.mask&&n.fileInfo.mask.numBytes>0&&d++,r&&f.push(r),n.dimCount>1&&(null==(m=n.pixelData)?void 0:m.length)===n.width*n.height*n.dimCount){var b,g,y,w;n.pixelData=n.pixelData.slice(-n.width*n.height);var j=null==(b=n.dimStats)||null==(g=b.minValues)?void 0:g[n.dimCount-1],x=null==(y=n.dimStats)||null==(w=y.maxValues)?void 0:w[n.dimCount-1];null!=j&&null!=x&&(n.minValue=j,n.maxValue=x)}if(i++,a.addData({pixels:n.pixelData,statistics:{minValue:n.minValue,maxValue:n.maxValue}}),c-o>10){var I=String.fromCharCode.apply(null,new Uint8Array(e,o,10));o+=I.indexOf("Lerc")>-1?I.indexOf("Lerc"):0}}var k=0,M=0,S=0;if(d>1){for(S=a.width*a.height,(r=new Uint8Array(S)).set(f[0]),k=1;k<f.length;k++){var T=f[k];for(M=0;M<S;M++)r[M]=r[M]&T[M]}for(u=0,M=0;M<S;M++)u+=r[M];a.mask=r}return a.validPixelCount=u,a}function M(e,t){var r=Object(v.b)(e,t.pyramidLevel||0),n=new l.a({width:r.width,height:r.height,pixels:r.pixels,pixelType:r.pixelType.toLowerCase(),mask:r.mask,statistics:null});return n.updateStatistics(),n}function S(e,t){var r=Object(v.e)(e,t.customOptions),n=new l.a({width:r.width,height:r.height,pixels:r.pixels,pixelType:r.pixelType.toLowerCase(),mask:r.mask,statistics:null});return n.updateStatistics(),n}function T(e){var t=m.decode(e),r=new l.a({width:t.width,height:t.height,pixels:t.pixels,pixelType:"U8",mask:t.mask,statistics:null});return r.updateStatistics(),r}function C(e,t){var r,n=new Uint8Array(e),a=new j(n),i=t.width,o=t.height,s=i*o,u=a.decode(),c=0,f=0,h=new Uint8Array(s);for(c=0;c<s;c++)h[c]=u[4*c+3];var p=new l.a({width:i,height:o,pixels:[],pixelType:"U8",mask:h,statistics:[]});for(c=0;c<3;c++){for(r=new Uint8Array(s),f=0;f<s;f++)r[f]=u[4*f+c];p.addData({pixels:r})}return p.updateStatistics(),p}function A(e,t,r,n){return _.apply(this,arguments)}function _(){return(_=Object(o.a)(a.a.mark((function e(t,r,n,o){var s,u,c,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new p,u=Object(i.a)({applyJpegMask:!1,format:r},n),e.next=4,s.decode(t,u,o);case 4:return c=e.sent,f=new l.a(c),e.abrupt("return",(f.updateStatistics(),f));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){if(null==e)throw new s.a("rasterCodec:decode","parameter encodeddata is required.");var t=new Uint8Array(e,0,10),r="";return 255===t[0]&&216===t[1]?r="jpg":137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]?r="png":67===t[0]&&110===t[1]&&116===t[2]&&90===t[3]&&73===t[4]&&109===t[5]&&97===t[6]&&103===t[7]&&101===t[8]&&32===t[9]?r="lerc":76===t[0]&&101===t[1]&&114===t[2]&&99===t[3]&&50===t[4]&&32===t[5]?r="lerc2":73===t[0]&&73===t[1]&&42===t[2]&&0===t[3]||77===t[0]&&77===t[1]&&0===t[2]&&42===t[3]||73===t[0]&&73===t[1]&&43===t[2]&&0===t[3]||77===t[0]&&77===t[1]&&0===t[2]&&43===t[3]?r="tiff":71===t[0]&&73===t[1]&&70===t[2]?r="gif":66===t[0]&&77===t[1]?r="bmp":String.fromCharCode.apply(null,t).toLowerCase().indexOf("error")>-1&&(r="error"),r}function D(e){var t=null;switch(e){case"lerc":t=I;break;case"lerc2":t=k;break;case"jpg":t=T;break;case"png":t=C;break;case"bsq":case"bip":t=function(t,r){return function(e,t,r){var n=R(t.pixelType).pixelTypeCtor,a=(0,w.decode)(e,{width:t.width,height:t.height,pixelType:n,format:r}),i=new l.a({width:t.width,height:t.height,pixels:a.pixels,pixelType:t.pixelType,mask:a.mask,statistics:null});return i.updateStatistics(),i}(t,r,e)};break;case"tiff":t=M;break;case"error":t=function(){throw new s.a("rasterCodec:decode","input data contains error")};break;default:t=function(){throw new s.a("rasterCodec:decode","unsupported raster format")}}return t}function R(e){var t=null,r=null;switch(e?e.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":r=255,t=Uint8Array;break;case"u16":r=r||65535,t=Uint16Array;break;case"u32":r=r||Math.pow(2,32)-1,t=Uint32Array;break;case"s8":r=r||-128,t=Int8Array;break;case"s16":r=r||-32768,t=Int16Array;break;case"s32":r=r||0-Math.pow(2,31),t=Int32Array;break;default:t=Float32Array}return{pixelTypeCtor:t,noDataValue:r}}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e){var r=e.pixels,n=e.width,a=e.height,i=e.mask;if(r&&0!==r.length){var o,s,u,c,f,h,p,d=r.length,m=n-1,v=a-1,b=[],g=l.a.getPixelArrayConstructor(e.pixelType);if(0===t){for(o=0;o<d;o++){for(f=r[o],h=new g(m*v),s=0;s<v;s++)for(c=s*n,u=0;u<m;u++)h[s*m+u]=f[c+u];b.push(h)}if(i)for(p=new Uint8Array(m*v),s=0;s<v;s++)for(c=s*n,u=0;u<m;u++)p[s*m+u]=i[c+u]}else{for(o=0;o<d;o++){for(f=r[o],h=new g(m*v),s=0;s<v;s++)for(c=s*n,u=0;u<m;u++)h[s*m+u]=(f[c+u]+f[c+u+1]+f[c+n+u]+f[c+n+u+1])/4;b.push(h)}if(i)for(p=new Uint8Array(m*v),s=0;s<v;s++)for(c=s*n,u=0;u<m;u++)p[s*m+u]=Math.min.apply(null,[i[c+u],i[c+u+1],i[c+n+u],i[c+n+u+1]])}e.width=m,e.height=v,e.mask=p,e.pixels=b}}}function L(e){var t=P(e);return"lerc2"===t?t="lerc":"error"===t&&(t=""),t}function N(e){return B.apply(this,arguments)}function B(){return B=Object(o.a)(a.a.mark((function e(t){var r,n,o,l,u,c=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>1&&void 0!==c[1]?c[1]:{},n=c.length>2?c[2]:void 0,null!=t){e.next=4;break}throw new s.a("rasterCodec:decode","missing encodeddata parameter.");case 4:if("bsq"!==(u=r.format&&r.format.toLowerCase())&&"bip"!==u||null!=r.width&&null!=r.height){e.next=7;break}throw new s.a("rasterCodec:decode","requires width and height in options parameter.");case 7:if("tiff"!==u||!r.customOptions){e.next=11;break}e.t0=S(t,r),e.next=20;break;case 11:if((!u||"bsq"!==u&&"bip"!==u)&&(u=P(t)),!r.useCanvas||!x.has(u)){e.next=18;break}return e.next=15,A(t,u,r,n);case 15:l=e.sent,e.next=19;break;case 18:o=D(u),r.isPoint&&((r=Object(i.a)({},r)).width++,r.height++),l=o(t,r),r.isPoint&&E(l);case 19:e.t0=l;case 20:return e.abrupt("return",e.t0);case 21:case"end":return e.stop()}}),e)}))),B.apply(this,arguments)}},880:function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return J})),r.d(t,"c",(function(){return F})),r.d(t,"d",(function(){return R})),r.d(t,"e",(function(){return V})),r.d(t,"f",(function(){return E})),r.d(t,"g",(function(){return L})),r.d(t,"h",(function(){return G}));var n=r(13),a=r(866),i=r(836);function o(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t%4!=0||r%4!=0){var a=new ArrayBuffer(4*Math.ceil(r/4)),i=new Uint8Array(a),o=new Uint8Array(e,t,r);if(n)for(var s=0;s<i.length;s+=4)i[s]=o[s+3],i[s+1]=o[s+2],i[s+2]=o[s+1],i[s+3]=o[s];else i.set(o);return new Uint32Array(i.buffer)}if(n){for(var l=new Uint8Array(e,t,r),u=new Uint8Array(l.length),c=0;c<u.length;c+=4)u[c]=l[c+3],u[c+1]=l[c+2],u[c+2]=l[c+1],u[c+3]=l[c];return new Uint32Array(u.buffer)}return new Uint32Array(e,t,r/4)}function s(){for(var e=[],t=0;t<=257;t++)e[t]=[t];return e}function l(e,t){for(var r=0;r<t.length;r++)e.push(t[r])}var u=new Set;function c(e,t,r){for(var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=o(e,t,r,n),i=9,c=s(),f=32,h=c.length,p=[],d=1,m=a[0],v=0,b=a.length,g=8*(4*b-r),y=[];null!=m;){if(f>=i)f-=i,v=m>>>32-i,m<<=i;else{var w=i-f;v=((v=m>>>32-f)<<w)+((m=a[d++])>>>(f=32-w)),m<<=w}if(257===v)break;if(256!==v){var O=c[v];if(null==O){if(v>c.length)throw"data integrity issue: code does not exist on code page";p.push(p[0]),c[h++]=p.slice(),l(y,p)}else l(y,O),p.push(O[0]),p.length>1&&(c[h++]=p.slice()),p=O.slice();if(u.has(h)&&i++,0===f&&(m=a[d++],f=32),d>b||d===b&&f<=g)break}else i=9,h=(c=s()).length,p=[]}return new Uint8Array(y)}u.add(511),u.add(1023),u.add(2047),u.add(4095),u.add(8191);var f,h,p,d,m=r(867),v=r(823),b=r(780),g={exports:{}};void 0!==(f={unstuff:function(e,t,r,n,a,i,o,s){var l,u,c,f,h,p=(1<<r)-1,d=0,m=0,v=4*e.length-Math.ceil(r*n/8);if(e[e.length-1]<<=8*v,a)for(l=0;l<n;l++)0===m&&(c=e[d++],m=32),m>=r?(u=c>>>m-r&p,m-=r):(u=(c&p)<<(f=r-m)&p,u+=(c=e[d++])>>>(m=32-f)),t[l]=a[u];else for(h=Math.ceil((s-i)/o),l=0;l<n;l++)0===m&&(c=e[d++],m=32),m>=r?(u=c>>>m-r&p,m-=r):(u=(c&p)<<(f=r-m)&p,u+=(c=e[d++])>>>(m=32-f)),t[l]=u<h?i+u*o:s},unstuffLUT:function(e,t,r,n,a,i){var o,s=(1<<t)-1,l=0,u=0,c=0,f=0,h=0,p=[],d=4*e.length-Math.ceil(t*r/8);e[e.length-1]<<=8*d;var m=Math.ceil((i-n)/a);for(u=0;u<r;u++)0===f&&(o=e[l++],f=32),f>=t?(h=o>>>f-t&s,f-=t):(h=(o&s)<<(c=t-f)&s,h+=(o=e[l++])>>>(f=32-c)),p[u]=h<m?n+h*a:i;return p.unshift(n),p},unstuff2:function(e,t,r,n,a,i,o,s){var l,u,c,f,h=(1<<r)-1,p=0,d=0,m=0;if(a)for(l=0;l<n;l++)0===d&&(c=e[p++],d=32,m=0),d>=r?(u=c>>>m&h,d-=r,m+=r):(u=c>>>m&h,d=32-(f=r-d),u|=((c=e[p++])&(1<<f)-1)<<r-f,m=f),t[l]=a[u];else{var v=Math.ceil((s-i)/o);for(l=0;l<n;l++)0===d&&(c=e[p++],d=32,m=0),d>=r?(u=c>>>m&h,d-=r,m+=r):(u=c>>>m&h,d=32-(f=r-d),u|=((c=e[p++])&(1<<f)-1)<<r-f,m=f),t[l]=u<v?i+u*o:s}return t},unstuffLUT2:function(e,t,r,n,a,i){var o,s=(1<<t)-1,l=0,u=0,c=0,f=0,h=0,p=0,d=[],m=Math.ceil((i-n)/a);for(u=0;u<r;u++)0===f&&(o=e[l++],f=32,p=0),f>=t?(h=o>>>p&s,f-=t,p+=t):(h=o>>>p&s,f=32-(c=t-f),h|=((o=e[l++])&(1<<c)-1)<<t-c,p=c),d[u]=h<m?n+h*a:i;return d.unshift(n),d},originalUnstuff:function(e,t,r,n){var a,i,o,s,l=(1<<r)-1,u=0,c=0,f=4*e.length-Math.ceil(r*n/8);for(e[e.length-1]<<=8*f,a=0;a<n;a++)0===c&&(o=e[u++],c=32),c>=r?(i=o>>>c-r&l,c-=r):(i=(o&l)<<(s=r-c)&l,i+=(o=e[u++])>>>(c=32-s)),t[a]=i;return t},originalUnstuff2:function(e,t,r,n){var a,i,o,s,l=(1<<r)-1,u=0,c=0,f=0;for(a=0;a<n;a++)0===c&&(o=e[u++],c=32,f=0),c>=r?(i=o>>>f&l,c-=r,f+=r):(i=o>>>f&l,c=32-(s=r-c),i|=((o=e[u++])&(1<<s)-1)<<r-s,f=s),t[a]=i;return t}},h={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,r=65535,n=e.length,a=Math.floor(n/2),i=0;a;){var o=a>=359?359:a;a-=o;do{t+=e[i++]<<8,r+=t+=e[i++]}while(--o);t=(65535&t)+(t>>>16),r=(65535&r)+(r>>>16)}return 1&n&&(r+=t+=e[i]<<8),((r=(65535&r)+(r>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var r=t.ptr,n=new Uint8Array(e,r,6),a={};if(a.fileIdentifierString=String.fromCharCode.apply(null,n),0!==a.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+a.fileIdentifierString;r+=6;var i,o=new DataView(e,r,8),s=o.getInt32(0,!0);if(a.fileVersion=s,r+=4,s>=3&&(a.checksum=o.getUint32(4,!0),r+=4),o=new DataView(e,r,12),a.height=o.getUint32(0,!0),a.width=o.getUint32(4,!0),r+=8,s>=4?(a.numDims=o.getUint32(8,!0),r+=4):a.numDims=1,o=new DataView(e,r,40),a.numValidPixel=o.getUint32(0,!0),a.microBlockSize=o.getInt32(4,!0),a.blobSize=o.getInt32(8,!0),a.imageType=o.getInt32(12,!0),a.maxZError=o.getFloat64(16,!0),a.zMin=o.getFloat64(24,!0),a.zMax=o.getFloat64(32,!0),r+=40,t.headerInfo=a,t.ptr=r,s>=3&&(i=s>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(e,r-i,a.blobSize-14))!==a.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var r=t.headerInfo,n=this.getDataTypeArray(r.imageType),a=r.numDims*this.getDataTypeSize(r.imageType),i=this.readSubArray(e,t.ptr,n,a),o=this.readSubArray(e,t.ptr+a,n,a);t.ptr+=2*a;var s,l=!0;for(s=0;s<r.numDims;s++)if(i[s]!==o[s]){l=!1;break}return r.minValues=i,r.maxValues=o,l},readSubArray:function(e,t,r,n){var a;if(r===Uint8Array)a=new Uint8Array(e,t,n);else{var i=new ArrayBuffer(n);new Uint8Array(i).set(new Uint8Array(e,t,n)),a=new r(i)}return a},readMask:function(e,t){var r,n,a=t.ptr,i=t.headerInfo,o=i.width*i.height,s=i.numValidPixel,l=new DataView(e,a,4),u={};if(u.numBytes=l.getUint32(0,!0),a+=4,(0===s||o===s)&&0!==u.numBytes)throw"invalid mask";if(0===s)r=new Uint8Array(Math.ceil(o/8)),u.bitset=r,n=new Uint8Array(o),t.pixels.resultMask=n,a+=u.numBytes;else if(u.numBytes>0){r=new Uint8Array(Math.ceil(o/8));var c=(l=new DataView(e,a,u.numBytes)).getInt16(0,!0),f=2,h=0,p=0;do{if(c>0)for(;c--;)r[h++]=l.getUint8(f++);else for(p=l.getUint8(f++),c=-c;c--;)r[h++]=p;c=l.getInt16(f,!0),f+=2}while(f<u.numBytes);if(-32768!==c||h<r.length)throw"Unexpected end of mask RLE encoding";n=new Uint8Array(o);var d=0,m=0;for(m=0;m<o;m++)7&m?(d=r[m>>3],d<<=7&m):d=r[m>>3],128&d&&(n[m]=1);t.pixels.resultMask=n,u.bitset=r,a+=u.numBytes}return t.ptr=a,t.mask=u,!0},readDataOneSweep:function(e,t,r,n){var a,i=t.ptr,o=t.headerInfo,s=o.numDims,l=o.width*o.height,u=o.imageType,c=o.numValidPixel*h.getDataTypeSize(u)*s,f=t.pixels.resultMask;if(r===Uint8Array)a=new Uint8Array(e,i,c);else{var p=new ArrayBuffer(c);new Uint8Array(p).set(new Uint8Array(e,i,c)),a=new r(p)}if(a.length===l*s)t.pixels.resultPixels=n?h.swapDimensionOrder(a,l,s,r,!0):a;else{t.pixels.resultPixels=new r(l*s);var d=0,m=0,v=0,b=0;if(s>1){if(n){for(m=0;m<l;m++)if(f[m])for(b=m,v=0;v<s;v++,b+=l)t.pixels.resultPixels[b]=a[d++]}else for(m=0;m<l;m++)if(f[m])for(b=m*s,v=0;v<s;v++)t.pixels.resultPixels[b+v]=a[d++]}else for(m=0;m<l;m++)f[m]&&(t.pixels.resultPixels[m]=a[d++])}return i+=c,t.ptr=i,!0},readHuffmanTree:function(e,t){var r=this.HUFFMAN_LUT_BITS_MAX,n=new DataView(e,t.ptr,16);if(t.ptr+=16,n.getInt32(0,!0)<2)throw"unsupported Huffman version";var a=n.getInt32(4,!0),i=n.getInt32(8,!0),o=n.getInt32(12,!0);if(i>=o)return!1;var s=new Uint32Array(o-i);h.decodeBits(e,t,s);var l,u,c,f,d=[];for(l=i;l<o;l++)d[u=l-(l<a?0:a)]={first:s[l-i],second:null};var m=e.byteLength-t.ptr,v=Math.ceil(m/4),b=new ArrayBuffer(4*v);new Uint8Array(b).set(new Uint8Array(e,t.ptr,m));var g,y=new Uint32Array(b),w=0,O=0;for(g=y[0],l=i;l<o;l++)(f=d[u=l-(l<a?0:a)].first)>0&&(d[u].second=g<<w>>>32-f,32-w>=f?32===(w+=f)&&(w=0,g=y[++O]):(w+=f-32,g=y[++O],d[u].second|=g>>>32-w));var j,x=0,I=new p;for(l=0;l<d.length;l++)void 0!==d[l]&&(x=Math.max(x,d[l].first));j=x>=r?r:x;var k,M,S,T,C,A=[];for(l=i;l<o;l++)if((f=d[u=l-(l<a?0:a)].first)>0)if(k=[f,u],f<=j)for(M=d[u].second<<j-f,S=1<<j-f,c=0;c<S;c++)A[M|c]=k;else for(M=d[u].second,C=I,T=f-1;T>=0;T--)M>>>T&1?(C.right||(C.right=new p),C=C.right):(C.left||(C.left=new p),C=C.left),0!==T||C.val||(C.val=k[1]);return{decodeLut:A,numBitsLUTQick:j,numBitsLUT:x,tree:I,stuffedData:y,srcPtr:O,bitPos:w}},readHuffman:function(e,t,r,n){var a,i,o,s,l,u,c,f,p,d=t.headerInfo.numDims,m=t.headerInfo.height,v=t.headerInfo.width,b=v*m,g=this.readHuffmanTree(e,t),y=g.decodeLut,w=g.tree,O=g.stuffedData,j=g.srcPtr,x=g.bitPos,I=g.numBitsLUTQick,k=g.numBitsLUT,M=0===t.headerInfo.imageType?128:0,S=t.pixels.resultMask,T=0;x>0&&(j++,x=0);var C,A=O[j],_=1===t.encodeMode,P=new r(b*d),D=P;if(d<2||_){for(C=0;C<d;C++)if(d>1&&(D=new r(P.buffer,b*C,b),T=0),t.headerInfo.numValidPixel===v*m)for(f=0,u=0;u<m;u++)for(c=0;c<v;c++,f++){if(i=0,l=s=A<<x>>>32-I,32-x<I&&(l=s|=O[j+1]>>>64-x-I),y[l])i=y[l][1],x+=y[l][0];else for(l=s=A<<x>>>32-k,32-x<k&&(l=s|=O[j+1]>>>64-x-k),a=w,p=0;p<k;p++)if(!(a=s>>>k-p-1&1?a.right:a.left).left&&!a.right){i=a.val,x=x+p+1;break}x>=32&&(x-=32,A=O[++j]),o=i-M,_?(o+=c>0?T:u>0?D[f-v]:T,o&=255,D[f]=o,T=o):D[f]=o}else for(f=0,u=0;u<m;u++)for(c=0;c<v;c++,f++)if(S[f]){if(i=0,l=s=A<<x>>>32-I,32-x<I&&(l=s|=O[j+1]>>>64-x-I),y[l])i=y[l][1],x+=y[l][0];else for(l=s=A<<x>>>32-k,32-x<k&&(l=s|=O[j+1]>>>64-x-k),a=w,p=0;p<k;p++)if(!(a=s>>>k-p-1&1?a.right:a.left).left&&!a.right){i=a.val,x=x+p+1;break}x>=32&&(x-=32,A=O[++j]),o=i-M,_?(c>0&&S[f-1]?o+=T:u>0&&S[f-v]?o+=D[f-v]:o+=T,o&=255,D[f]=o,T=o):D[f]=o}}else for(f=0,u=0;u<m;u++)for(c=0;c<v;c++)if(f=u*v+c,!S||S[f])for(C=0;C<d;C++,f+=b){if(i=0,l=s=A<<x>>>32-I,32-x<I&&(l=s|=O[j+1]>>>64-x-I),y[l])i=y[l][1],x+=y[l][0];else for(l=s=A<<x>>>32-k,32-x<k&&(l=s|=O[j+1]>>>64-x-k),a=w,p=0;p<k;p++)if(!(a=s>>>k-p-1&1?a.right:a.left).left&&!a.right){i=a.val,x=x+p+1;break}x>=32&&(x-=32,A=O[++j]),o=i-M,D[f]=o}t.ptr=t.ptr+4*(j+1)+(x>0?4:0),t.pixels.resultPixels=P,d>1&&!n&&(t.pixels.resultPixels=h.swapDimensionOrder(P,b,d,r))},decodeBits:function(e,t,r,n,a){var i=t.headerInfo,o=i.fileVersion,s=0,l=e.byteLength-t.ptr>=5?5:e.byteLength-t.ptr,u=new DataView(e,t.ptr,l),c=u.getUint8(0);s++;var h=c>>6,p=0===h?4:3-h,d=(32&c)>0,m=31&c,v=0;if(1===p)v=u.getUint8(s),s++;else if(2===p)v=u.getUint16(s,!0),s+=2;else{if(4!==p)throw"Invalid valid pixel count type";v=u.getUint32(s,!0),s+=4}var b,g,y,w,O,j,x,I,k,M=2*i.maxZError,S=i.numDims>1?i.maxValues[a]:i.zMax;if(d){for(t.counter.lut++,I=u.getUint8(s),s++,w=Math.ceil((I-1)*m/8),O=Math.ceil(w/4),g=new ArrayBuffer(4*O),y=new Uint8Array(g),t.ptr+=s,y.set(new Uint8Array(e,t.ptr,w)),x=new Uint32Array(g),t.ptr+=w,k=0;I-1>>>k;)k++;w=Math.ceil(v*k/8),O=Math.ceil(w/4),g=new ArrayBuffer(4*O),(y=new Uint8Array(g)).set(new Uint8Array(e,t.ptr,w)),b=new Uint32Array(g),t.ptr+=w,j=o>=3?f.unstuffLUT2(x,m,I-1,n,M,S):f.unstuffLUT(x,m,I-1,n,M,S),o>=3?f.unstuff2(b,r,k,v,j):f.unstuff(b,r,k,v,j)}else t.counter.bitstuffer++,k=m,t.ptr+=s,k>0&&(w=Math.ceil(v*k/8),O=Math.ceil(w/4),g=new ArrayBuffer(4*O),(y=new Uint8Array(g)).set(new Uint8Array(e,t.ptr,w)),b=new Uint32Array(g),t.ptr+=w,o>=3?null==n?f.originalUnstuff2(b,r,k,v):f.unstuff2(b,r,k,v,!1,n,M,S):null==n?f.originalUnstuff(b,r,k,v):f.unstuff(b,r,k,v,!1,n,M,S))},readTiles:function(e,t,r,n){var a=t.headerInfo,i=a.width,o=a.height,s=i*o,l=a.microBlockSize,u=a.imageType,c=h.getDataTypeSize(u),f=Math.ceil(i/l),p=Math.ceil(o/l);t.pixels.numBlocksY=p,t.pixels.numBlocksX=f,t.pixels.ptr=0;var d,m,v,b,g,y,w,O,j,x,I=0,k=0,M=0,S=0,T=0,C=0,A=0,_=0,P=0,D=0,R=0,E=0,L=0,N=0,B=0,U=new r(l*l),z=o%l||l,G=i%l||l,F=a.numDims,H=t.pixels.resultMask,V=t.pixels.resultPixels,J=a.fileVersion>=5?14:15,Z=a.zMax;for(M=0;M<p;M++)for(T=M!==p-1?l:z,S=0;S<f;S++)for(D=M*i*l+S*l,R=i-(C=S!==f-1?l:G),O=0;O<F;O++){if(F>1?(x=V,D=M*i*l+S*l,V=new r(t.pixels.resultPixels.buffer,s*O*c,s),Z=a.maxValues[O]):x=null,A=e.byteLength-t.ptr,m={},B=0,_=(d=new DataView(e,t.ptr,Math.min(10,A))).getUint8(0),B++,j=a.fileVersion>=5?4&_:0,P=_>>6&255,(_>>2&J)!=(S*l>>3&J))throw"integrity issue";if(j&&0===O)throw"integrity issue";if((g=3&_)>3)throw t.ptr+=B,"Invalid block encoding ("+g+")";if(2!==g)if(0===g){if(j)throw"integrity issue";if(t.counter.uncompressed++,t.ptr+=B,E=(E=T*C*c)<(L=e.byteLength-t.ptr)?E:L,v=new ArrayBuffer(E%c==0?E:E+c-E%c),new Uint8Array(v).set(new Uint8Array(e,t.ptr,E)),b=new r(v),N=0,H)for(I=0;I<T;I++){for(k=0;k<C;k++)H[D]&&(V[D]=b[N++]),D++;D+=R}else for(I=0;I<T;I++){for(k=0;k<C;k++)V[D++]=b[N++];D+=R}t.ptr+=N*c}else if(y=h.getDataTypeUsed(j&&u<6?4:u,P),w=h.getOnePixel(m,B,y,d),B+=h.getDataTypeSize(y),3===g)if(t.ptr+=B,t.counter.constantoffset++,H)for(I=0;I<T;I++){for(k=0;k<C;k++)H[D]&&(V[D]=j?Math.min(Z,x[D]+w):w),D++;D+=R}else for(I=0;I<T;I++){for(k=0;k<C;k++)V[D]=j?Math.min(Z,x[D]+w):w,D++;D+=R}else if(t.ptr+=B,h.decodeBits(e,t,U,w,O),B=0,j)if(H)for(I=0;I<T;I++){for(k=0;k<C;k++)H[D]&&(V[D]=U[B++]+x[D]),D++;D+=R}else for(I=0;I<T;I++){for(k=0;k<C;k++)V[D]=U[B++]+x[D],D++;D+=R}else if(H)for(I=0;I<T;I++){for(k=0;k<C;k++)H[D]&&(V[D]=U[B++]),D++;D+=R}else for(I=0;I<T;I++){for(k=0;k<C;k++)V[D++]=U[B++];D+=R}else{if(j)if(H)for(I=0;I<T;I++)for(k=0;k<C;k++)H[D]&&(V[D]=x[D]),D++;else for(I=0;I<T;I++)for(k=0;k<C;k++)V[D]=x[D],D++;t.counter.constant++,t.ptr+=B}}F>1&&!n&&(t.pixels.resultPixels=h.swapDimensionOrder(t.pixels.resultPixels,s,F,r))},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:h.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e,t){var r=e.headerInfo.zMax,n=e.headerInfo.zMin,a=e.headerInfo.maxValues,i=e.headerInfo.numDims,o=e.headerInfo.height*e.headerInfo.width,s=0,l=0,u=0,c=e.pixels.resultMask,f=e.pixels.resultPixels;if(c)if(i>1){if(t)for(s=0;s<i;s++)for(u=s*o,r=a[s],l=0;l<o;l++)c[l]&&(f[u+l]=r);else for(l=0;l<o;l++)if(c[l])for(u=l*i,s=0;s<i;s++)f[u+i]=a[s]}else for(l=0;l<o;l++)c[l]&&(f[l]=r);else if(i>1&&n!==r)if(t)for(s=0;s<i;s++)for(u=s*o,r=a[s],l=0;l<o;l++)f[u+l]=r;else for(l=0;l<o;l++)for(u=l*i,s=0;s<i;s++)f[u+s]=a[s];else for(l=0;l<o*i;l++)f[l]=r},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;default:t=Float32Array;break;case 7:t=Float64Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;default:t="F32";break;case 7:t="F64"}return t},isValidPixelValue:function(e,t){if(null==t)return!1;var r;switch(e){case 0:r=t>=-128&&t<=127;break;case 1:r=t>=0&&t<=255;break;case 2:r=t>=-32768&&t<=32767;break;case 3:r=t>=0&&t<=65536;break;case 4:r=t>=-2147483648&&t<=2147483647;break;case 5:r=t>=0&&t<=4294967296;break;case 6:r=t>=-34027999387901484e22&&t<=34027999387901484e22;break;case 7:r=t>=5e-324&&t<=17976931348623157e292;break;default:r=!1}return r},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var r=e;switch(e){case 2:case 4:r=e-t;break;case 3:case 5:r=e-2*t;break;case 6:r=0===t?e:1===t?2:1;break;case 7:r=0===t?e:e-2*t+1;break;default:r=e}return r},getOnePixel:function(e,t,r,n){var a=0;switch(r){case 0:a=n.getInt8(t);break;case 1:a=n.getUint8(t);break;case 2:a=n.getInt16(t,!0);break;case 3:a=n.getUint16(t,!0);break;case 4:a=n.getInt32(t,!0);break;case 5:a=n.getUInt32(t,!0);break;case 6:a=n.getFloat32(t,!0);break;case 7:a=n.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return a},swapDimensionOrder:function(e,t,r,n,a){var i=0,o=0,s=0,l=0,u=e;if(r>1)if(u=new n(t*r),a)for(i=0;i<t;i++)for(l=i,s=0;s<r;s++,l+=t)u[l]=e[o++];else for(i=0;i<t;i++)for(l=i,s=0;s<r;s++,l+=t)u[o++]=e[l];return u}},p=function(e,t,r){this.val=e,this.left=t,this.right=r},d={decode:function(e,t){var r=(t=t||{}).noDataValue,n=0,a={};a.ptr=t.inputOffset||0,a.pixels={},h.readHeaderInfo(e,a);var i=a.headerInfo,o=i.fileVersion,s=h.getDataTypeArray(i.imageType);if(o>5)throw"unsupported lerc version 2."+o;h.readMask(e,a),i.numValidPixel===i.width*i.height||a.pixels.resultMask||(a.pixels.resultMask=t.maskData);var l=i.width*i.height;a.pixels.resultPixels=new s(l*i.numDims),a.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var u,c=!t.returnPixelInterleavedDims;if(0!==i.numValidPixel)if(i.zMax===i.zMin)h.constructConstantSurface(a,c);else if(o>=4&&h.checkMinMaxRanges(e,a))h.constructConstantSurface(a,c);else{var f=new DataView(e,a.ptr,2),p=f.getUint8(0);if(a.ptr++,p)h.readDataOneSweep(e,a,s,c);else if(o>1&&i.imageType<=1&&Math.abs(i.maxZError-.5)<1e-5){var d=f.getUint8(1);if(a.ptr++,a.encodeMode=d,d>2||o<4&&d>1)throw"Invalid Huffman flag "+d;d?h.readHuffman(e,a,s,c):h.readTiles(e,a,s,c)}else h.readTiles(e,a,s,c)}a.eofOffset=a.ptr,t.inputOffset?(u=a.headerInfo.blobSize+t.inputOffset-a.ptr,Math.abs(u)>=1&&(a.eofOffset=t.inputOffset+a.headerInfo.blobSize)):(u=a.headerInfo.blobSize-a.ptr,Math.abs(u)>=1&&(a.eofOffset=a.headerInfo.blobSize));var m={width:i.width,height:i.height,pixelData:a.pixels.resultPixels,minValue:i.zMin,maxValue:i.zMax,validPixelCount:i.numValidPixel,dimCount:i.numDims,dimStats:{minValues:i.minValues,maxValues:i.maxValues},maskData:a.pixels.resultMask};if(a.pixels.resultMask&&h.isValidPixelValue(i.imageType,r)){var v=a.pixels.resultMask;for(n=0;n<l;n++)v[n]||(m.pixelData[n]=r);m.noDataValue=r}return a.noDataValue=r,t.returnFileInfo&&(m.fileInfo=h.formatFileInfo(a)),m},getBandCount:function(e){for(var t=0,r=0,n={ptr:0,pixels:{}};r<e.byteLength-58;)h.readHeaderInfo(e,n),r+=n.headerInfo.blobSize,t++,n.ptr=r;return t}})&&(g.exports=d);var y=g.exports,w=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],O=4294967296,j=new Set([1,5,6,7,8,34712,34887]);function x(e,t){var r="unknown";return 3===e?r="f32":1===e?1===t?r="u1":2===t?r="u2":4===t?r="u4":t<=8?r="u8":t<=16?r="u16":t<=32&&(r="u32"):2===e&&(t<=8?r="s8":t<=16?r="s16":t<=32&&(r="s32")),r}function I(e){var t=null;switch(e?e.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":t=Uint8Array;break;case"u16":t=Uint16Array;break;case"u32":t=Uint32Array;break;case"s8":t=Int8Array;break;case"s16":t=Int16Array;break;case"s32":t=Int32Array;break;default:t=Float32Array}return t}function k(e,t){return{x:t[0]*e.x+t[1]*e.y+t[2],y:t[3]*e.x+t[4]*e.y+t[5]}}function M(e,t){var r;return null==(r=e.get(t))?void 0:r.values}function S(e,t){var r;return null==(r=e.get(t))?void 0:r.values}function T(e,t){var r;return null==(r=e.get(t))?void 0:r.values[0]}function C(e,t){var r;return null==(r=e.get(t))?void 0:r.values[0]}function A(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:m.a.TIFF_TAGS,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4,o=8===i,s=o?B(new DataView(e,r,8),0,t):new DataView(e,r,2).getUint16(0,t),l=4+2*i,u=o?8:2,c=u+s*l;if(r+c>e.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:c};for(var f,h,p,d,v,b,g,y=r+c+4<=e.byteLength?z(new DataView(e,r+c,8===i?8:4),0,t,8===i):null,w=r+u,O=new Map,j=0;j<s;j++){p=(h=new DataView(e,w+l*j,l)).getUint16(0,t),v=h.getUint16(2,t),d=m.a.getTagName(p,a);var x=[];2===i?(b=h.getUint16(4,t),g=h.getUint16(6,t)):4===i?(b=h.getUint32(4,t),g=h.getUint32(8,t)):8===i&&(b=z(h,4,t,!0),g=z(h,12,t,!0),x.push(h.getUint32(12,t)),x.push(h.getUint32(16,t))),R(e,t,f={id:p,type:v,valueCount:b,valueOffset:g,valueOffsets:x,values:null},n,!1,i),O.set(d,f)}return{success:!0,ifd:O,nextIFD:y,requiredBufferSize:c}}var _=function(e,t,r,n,a){var o,s,l,u,f,h,p,d,m,g=v.a===t,w=C(r,"BITSPERSAMPLE"),O=x(null!=(o=C(r,"SAMPLEFORMAT"))?o:1,w),j=null!=(s=C(r,"COMPRESSION"))?s:1,k=I(O);if(34887===j)return function(e,t){return y.decode(e,{inputOffset:t,returnFileInfo:!0}).pixelData}(e,n);if(1===j)f=e.slice(n,n+a),h=new Uint8Array(f);else if(8===j||32946===j)h=new Uint8Array(e,n,a),d=new b.a(h),m=d.getBytes(),f=new ArrayBuffer(m.length),(h=new Uint8Array(f)).set(m);else if(6===j){h=new Uint8Array(e,n,a);var M=new i.a;M.parse(h);var S=M.getData(M.width,M.height,!0);f=new ArrayBuffer(S.length),(h=new Uint8Array(f)).set(S)}else if(7===j){var T=r.get("JPEGTABLES").values,A=T.length-2;h=new Uint8Array(A+a-2);for(var _=0;_<A;_++)h[_]=T[_];for(var P=new Uint8Array(e,n+2,a-2),D=0;D<P.length;D++)h[A+D]=P[D];var R=new i.a;R.parse(h);var E=R.getData(R.width,R.height,!0);f=new ArrayBuffer(E.length),(h=new Uint8Array(f)).set(E)}else 5===j&&(f=(h=c(e,n,a,t)).buffer);if("u8"===O||"s8"===O||g)u=new k(f);else{switch(f=new ArrayBuffer(h.length),p=new Uint8Array(f),O){case"u16":case"s16":for(l=0;l<h.length;l+=2)p[l]=h[l+1],p[l+1]=h[l];break;case"u32":case"s32":case"f32":for(l=0;l<h.length;l+=4)p[l]=h[l+3],p[l+1]=h[l+2],p[l+2]=h[l+1],p[l+3]=h[l]}u=new k(f)}return u},P=function(e,t,r){var n,a=S(r,"TILEOFFSETS");if(void 0===a)return null;for(var i,o,s,l,u,c,f,h,p,d,m,v,b,g=S(r,"TILEBYTECOUNTS"),y=E([r]),w=y.width,O=y.height,j=y.pixelType,x=y.tileWidth,k=y.tileHeight,M=L(r,t),T=t.planes,A=w*O,P=C(r,"BITSPERSAMPLE"),D=34887===(null!=(n=C(r,"COMPRESSION"))?n:1),R=I(j),N=[],B=0;B<T;B++)N.push(new R(A));var U=Math.ceil(w/x);if(P%8==0)if(D&&M&&T>1){var z=Math.round(a.length/T);for(i=0;i<z;i++){h=(c=Math.floor(i/U)*k)*w+(f=i%U*x);for(var G=0;G<T;G++){var F=i*T+G;for(s=_(e,t.littleEndian,r,a[F],g[F]),d=0,p=h,v=Math.min(x,w-f),m=Math.min(k,O-c),b=N[G],l=0;l<m;l++)for(p=h+l*w,d=l*x,u=0;u<v;u++,p++,d++)b[p]=s[d]}}}else for(i=0;i<a.length;i++)for(h=(c=Math.floor(i/U)*k)*w+(f=i%U*x),s=_(e,t.littleEndian,r,a[i],g[i]),d=0,p=h,v=Math.min(x,w-f),m=Math.min(k,O-c),o=0;o<T;o++)if(b=N[o],M||D)for(l=0;l<m;l++)for(p=h+l*w,d=x*k*o+l*x,u=0;u<v;u++,p++,d++)b[p]=s[d];else for(l=0;l<m;l++)for(p=h+l*w,d=l*x*T+o,u=0;u<v;u++,p++,d+=T)b[p]=s[d];return{width:w,height:O,pixelType:j,pixels:N}},D=function(e,t,r){var n,a=v.a===t.littleEndian,o=S(r,"STRIPOFFSETS");if(void 0===o)return null;var s,l,u,f,h,p,d,m,g,y,w=E([r]),O=w.width,j=w.height,x=w.pixelType,k=t.planes,M=O*j,T=C(r,"BITSPERSAMPLE"),A=I(x),_=new A(M*k),P=S(r,"STRIPBYTECOUNTS"),D=C(r,"ROWSPERSTRIP"),R=null!=(n=C(r,"COMPRESSION"))?n:1,L=D;if(T%8==0)for(s=0;s<o.length;s++){if(h=s*(D*O)*k,L=(s+1)*D>j?j-s*D:D,"u8"===x||"s8"===x||a){if(8===R||32946===R)d=new Uint8Array(e,o[s],P[s]),y=new b.a(d).getBytes(),p=new ArrayBuffer(y.length),(d=new Uint8Array(p)).set(y),d.length!==L*O*k*T/8&&console.log("strip byte counts is different than expected");else if(6===R){d=new Uint8Array(e,o[s],P[s]);var N=new i.a;N.parse(d);var B=N.getData(N.width,N.height,!0);p=new ArrayBuffer(B.length),(d=new Uint8Array(p)).set(B)}else 5===R?p=(d=c(e,o[s],P[s],t.littleEndian)).buffer:1===R&&(P[s]!==L*O*k*T/8&&console.log("strip byte counts is different than expected"),p=e.slice(o[s],o[s]+P[s]));f=new A(p)}else{switch(6===R||8===R||32946===R?(d=new Uint8Array(e,o[s],P[s]),d=new b.a(d).getBytes(),p=new ArrayBuffer(d.length),m=new Uint8Array(p),d.length!==L*O*k*T/8&&console.log("strip byte counts is different than expected")):1===R&&(P[s]!==L*O*k*T/8&&console.log("strip byte counts is different than expected"),p=new ArrayBuffer(P[s]),d=new Uint8Array(e,o[s],P[s]),m=new Uint8Array(p)),x){case"u16":case"s16":for(u=0;u<d.length;u+=2)m[u]=d[u+1],m[u+1]=d[u];break;case"u32":case"s32":case"f32":for(u=0;u<d.length;u+=4)m[u]=d[u+3],m[u+1]=d[u+2],m[u+2]=d[u+1],m[u+3]=d[u]}f=new A(p)}_.set(f,h)}var U=[];if(1===k)U.push(_);else for(s=0;s<k;s++){for(g=new A(M),l=0;l<M;l++)g[l]=_[l*k+s];U.push(g)}return{width:O,height:j,pixelType:x,pixels:U}};function R(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4;if(r.values)return!0;var o,s,l=r.type,u=r.valueCount,c=r.valueOffset,f=[],h=w[l],p=8*h,d=u*h,m=u*w[l]*8,v=8===i?64:32,b=r.valueOffsets;if(m>v&&d>(a?e.byteLength:e?e.byteLength-c+n:0))return r.offlineOffsetSize=[c,d],r.values=null,!1;if(m<=v){if(!t)if(v<=32)c>>>=32-m;else{var g=null!=b&&b.length?b[0]:c>>>0,y=null!=b&&b.length?b[1]:Math.round((c-g)/O);m<=32?(c=g>>>32-m,b[0]=c):(c=g*Math.pow(2,32-m)+(y>>>32-m),b[0]=g,b[1]=y>>>32-m)}if(1===u&&p===v)f=[c];else if(64===v){var j=null!=b&&b.length?b[0]:c>>>0,x=null!=b&&b.length?b[1]:Math.round((c-j)/O),I=j,k=32;for(s=1;s<=u;s++){var M=32-p*s%32;if(k<p){var S=I<<M>>>32-k,T=x<<32-k>>>32-k;I=x,f.push(S+T*Math.pow(2,p-k)),k-=32-(p-k)}else f.push(I<<M>>>32-p),k-=p;0===k&&(k=32,I=x)}}else for(s=1;s<=u;s++){var C=32-p*s;f.push(c<<C>>>32-p)}}else{c-=n,a&&(c=0);for(var A=c;A<c+d;A+=h){switch(l){case 1:case 2:case 7:o=new DataView(e,A,1).getUint8(0);break;case 3:o=new DataView(e,A,2).getUint16(0,t);break;case 4:case 13:o=new DataView(e,A,4).getUint32(0,t);break;case 5:o=new DataView(e,A,4).getUint32(0,t)/new DataView(e,A+4,4).getUint32(0,t);break;case 6:o=new DataView(e,A,1).getInt8(0);break;case 8:o=new DataView(e,A,2).getInt16(0,t);break;case 9:o=new DataView(e,A,4).getInt32(0,t);break;case 10:o=new DataView(e,A,4).getInt32(0,t)/new DataView(e,A+4,4).getInt32(0,t);break;case 11:o=new DataView(e,A,4).getFloat32(0,t);break;case 12:o=new DataView(e,A,8).getFloat64(0,t);break;case 16:case 18:o=B(new DataView(e,A,8),0,t);break;case 17:o=U(new DataView(e,A,8),0,t);break;default:o=null}f.push(o)}}if(2===l){var _="",P=f;for(f=[],s=0;s<P.length;s++)0===P[s]&&""!==_?(f.push(_),_=""):_+=String.fromCharCode(P[s]);""===_&&0!==f.length||f.push(_)}return r.values=f,!0}function E(e){var t,r,n,a=e[0],i=C(a,"TILEWIDTH"),o=C(a,"TILELENGTH"),s=C(a,"IMAGEWIDTH"),l=C(a,"IMAGELENGTH"),u=C(a,"BITSPERSAMPLE"),c=C(a,"SAMPLESPERPIXEL"),f=null!=(t=C(a,"SAMPLEFORMAT"))?t:1,h=x(f,u),p=L(a),d=M(a,"GDAL_NODATA");null!=d&&d.length&&(n=d.map((function(e){return parseFloat(e)})),n.some((function(e){return isNaN(e)}))&&(n=null));var m,v=null!=(r=C(a,"COMPRESSION"))?r:1;switch(v){case 1:m="NONE";break;case 2:case 3:case 4:case 32771:m="CCITT";break;case 5:m="LZW";break;case 6:case 7:m="JPEG";break;case 32773:m="PACKBITS";break;case 8:case 32946:m="DEFLATE";break;case 34712:m="JPEG2000";break;case 34887:m="LERC";break;default:m=String(v)}var b=!0,g="";j.has(v)||(b=!1,g+="unsupported tag compression "+v),f>3&&(b=!1,g+="unsupported tag sampleFormat "+f),u%8!=0&&(b=!1,g+="unsupported tag bitsPerSample "+u);var y,w=T(a,"GEOASCIIPARAMS");if(w){var O=w.split("|").filter((function(e){return e.indexOf("ESRI PE String = ")>-1}))[0],I=O?O.replace("ESRI PE String = ",""):"";y=I.startsWith("COMPD_CS")||I.startsWith("PROJCS")||I.startsWith("GEOGCS")?{wkid:null,wkt:I}:null}var A,_,P=S(a,"GEOTIEPOINTS"),D=S(a,"GEOPIXELSCALE"),R=S(a,"GEOTRANSMATRIX"),E=a.has("GEOKEYDIRECTORY")?a.get("GEOKEYDIRECTORY").data:null,N=!1;if(E){N=2===C(E,"GTRasterTypeGeoKey");var B=C(E,"GTModelTypeGeoKey");if(2===B){var U=C(E,"GeographicTypeGeoKey");U>=1024&&U<=32766&&(y={wkid:U})}else if(1===B){var z=C(E,"ProjectedCSTypeGeoKey");z>=1024&&z<=32766&&(y={wkid:z})}}if(D&&P&&P.length>=6?(A=[D[0],0,P[3]-P[0]*D[0],0,-Math.abs(D[1]),P[4]-P[1]*D[1]],N&&(A[2]-=.5*A[0]+.5*A[1],A[5]-=.5*A[3]+.5*A[4])):R&&16===R.length&&(A=N?[R[0],R[1],R[3]-.5*R[0],R[4],R[5],R[7]-.5*R[5]]:[R[0],R[1],R[3],R[4],R[5],R[7]]),A){for(var G,F=[{x:0,y:l},{x:0,y:0},{x:s,y:l},{x:s,y:0}],V=Number.POSITIVE_INFINITY,J=Number.POSITIVE_INFINITY,Z=Number.NEGATIVE_INFINITY,W=Number.NEGATIVE_INFINITY,q=0;q<F.length;q++)V=(G=k(F[q],A)).x>V?V:G.x,Z=G.x<Z?Z:G.x,J=G.y>J?J:G.y,W=G.y<W?W:G.y;_={xmin:V,xmax:Z,ymin:J,ymax:W,spatialReference:y}}else _={xmin:-.5,ymin:.5-l,xmax:s-.5,ymax:.5,spatialReference:y};var X,Y,K,Q,$,ee=e.filter((function(e){return 1===T(e,"NEWSUBFILETYPE")}));if(ee.length>0){X=Math.round(Math.log(s/C(ee[0],"IMAGEWIDTH"))/Math.LN2);var te=ee[ee.length-1];Y=Math.round(Math.log(s/C(te,"IMAGEWIDTH"))/Math.LN2),K=C(te,"TILEWIDTH"),Q=C(te,"TILELENGTH")}K=Y>0?K||i:null,Q=Y>0?Q||o:null,i&&($=[{maxCol:Math.ceil(s/i)-1,maxRow:Math.ceil(l/o)-1,minRow:0,minCol:0}],ee.forEach((function(e){$.push({maxCol:Math.ceil(C(e,"IMAGEWIDTH")/C(e,"TILEWIDTH"))-1,maxRow:Math.ceil(C(e,"IMAGELENGTH")/C(e,"TILELENGTH"))-1,minRow:0,minCol:0})})));var re=function(e){if(!e)return null;var t=e.match(/<Item(.*?)Item>/gi);if(!t||0===t.length)return null;for(var r,n,a,i,o,s=new Map,l=0;l<t.length;l++)n=(r=t[l]).slice("<Item ".length,r.indexOf(">")),(i=r.indexOf("sample="))>-1&&(o=r.slice(i+'sample="'.length,r.indexOf('"',i+'sample="'.length))),(i=r.indexOf("name="))>-1&&(n=r.slice(i+'name="'.length,r.indexOf('"',i+'name="'.length))),n&&(a=r.slice(r.indexOf(">")+1,r.indexOf("</Item>")).trim(),null!=o?s.has(n)?s.get(n)[o]=a:s.set(n,[a]):s.set(n,a)),o=null;var u=s.get("STATISTICS_MINIMUM"),c=s.get("STATISTICS_MAXIMUM"),f=s.get("STATISTICS_MEAN"),h=s.get("STATISTICS_STDDEV"),p=null;if(u&&c){p=[];for(var d=0;d<u.length;d++)p.push({min:parseFloat(u[d]),max:parseFloat(c[d]),avg:f&&parseFloat(f[d]),stddev:h&&parseFloat(h[d])})}var m=s.get("BandName"),v=s.get("WavelengthMin"),b=s.get("WavelengthMax"),g=null;if(m){g=[];for(var y=0;y<m.length;y++)g.push({BandName:m[y],WavelengthMin:v&&parseFloat(v[y]),WavelengthMax:b&&parseFloat(b[y])})}return{statistics:p,bandProperties:g,dataType:s.get("DataType"),rawMetadata:s}}(T(e[0],"GDAL_METADATA"));return{width:s,height:l,tileWidth:i,tileHeight:o,planes:c,isBSQ:p,pixelType:h,compression:m,noData:n,isSupported:b,message:g+=" "+H({width:s,height:l,tileWidth:i,tileHeight:o,planes:c,ifds:e}),extent:_,affine:D?null:A,firstPyramidLevel:X,maximumPyramidLevel:Y,pyramidBlockWidth:K,pyramidBlockHeight:Q,tileBoundary:$,metadata:re}}function L(e,t){var r=M(e,"PLANARCONFIGURATION");return r?2===r[0]:!!t&&t.isBSQ}function N(e){var t=G(e),r=t.littleEndian,a=t.isBigTiff,i=t.firstIFD,o=[];do{var s=F(e,r,i,0,m.a.TIFF_TAGS,a?8:4);if(!s.success)break;o.push(s.ifd),i=s.nextIFD}while(i>0);return Object(n.a)(Object(n.a)({},E(o)),{},{littleEndian:r,isBigTiff:a,ifds:o})}function B(e,t,r){var n=e.getUint32(t,r),a=e.getUint32(t+4,r);return r?a*O+n:n*O+a}function U(e,t,r){var n=r?e.getInt32(t,r):e.getUint32(t,r),a=r?e.getUint32(t+4,r):e.getInt32(t+4,r),i=(r?n:a)>=0?1:-1;return r?n*=i:a*=i,i*(r?a*O+n:n*O+a)}function z(e,t,r,n){return n?B(e,t,r):e.getUint32(t,r)}function G(e){var t=new DataView(e,0,16),r=t.getUint16(0,!1),n=null;if(18761===r)n=!0;else{if(19789!==r)throw"unexpected endianess byte";n=!1}var a=t.getUint16(2,n);if(42!==a&&43!==a)throw"unexpected tiff identifier";var i=4,o=43===a;if(o){var s=t.getUint16(i,n);if(i+=2,8!==s)throw"unsupported bigtiff version";if(0!==t.getUint16(i,n))throw"unsupported bigtiff version";i+=2}return{littleEndian:n,isBigTiff:o,firstIFD:z(t,i,n,o)}}function F(e,t,r){var n,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:m.a.TIFF_TAGS,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4,l=A(e,t,r,i,o,s),u=l.ifd;if(u){if(m.a.ifdTags.forEach((function(r,a){u.has(a)&&((n=u.get(a)).data=A(e,t,n.valueOffset-i,i,r).ifd)})),u.has("GEOKEYDIRECTORY")){var c=(n=u.get("GEOKEYDIRECTORY")).values;if(c&&c.length>4){var f=c[0]+"."+c[1]+"."+c[2];n.data=A(e,t,n.valueOffset+6-i,i,m.a.GEO_KEYS,2).ifd,n.data&&n.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[f]})}}if(u.has("XMP")){var h=(n=u.get("XMP")).values;"number"==typeof h[0]&&7===n.type&&(n.values=[Object(a.a)(new Uint8Array(h))])}}return l}function H(e){var t=e.width,r=e.height,n=e.tileHeight,a=e.tileWidth,i=e.planes,o=a?a*n:t*r,s=C(e.ifds[0],"BITSPERSAMPLE"),l="";return o*i>Math.pow(2,30)/(s>8?s/8:1)&&(l=a?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported"),l}function V(e,t){for(var r,n,a=t.headerInfo,i=t.ifd,o=t.offsets,s=t.sizes,l=o.map((function(t,r){return _(e,a.littleEndian,i,t,s[r]||e.byteLength)})),u=L(i,a),c=a.pixelType,f=a.planes,h=I(c),p=C(i,"TILEWIDTH"),d=C(i,"TILELENGTH"),m=null!=(r=C(i,"COMPRESSION"))?r:1,v=p*d,b=[],g=l[0],y=34887===m,w=0;w<f;w++){if(n=new h(v),u&&y){g=l[w];for(var O=0;O<v;O++)n[O]=g[w][O+w]}else if(u||y&&!u)n=g.slice(v*w,v*(w+1));else for(var j=0;j<v;j++)n[j]=g[j*f+w];b.push(n)}var x,k,M=a.noData?a.noData[0]:null,S=a.metadata?a.metadata.statistics:null,T=S?S.map((function(e){return e.min})):null,A=S?S.map((function(e){return e.max})):null;if(null!=M)if(x=new Uint8Array(v),Math.abs(M)>1e24)for(k=0;k<v;k++)Math.abs((b[0][k]-M)/M)<1e-6?x[k]=0:x[k]=1;else for(k=0;k<v;k++)b[0][k]===M?x[k]=0:x[k]=1;else T&&A&&t.applyMinMaxConstraint&&(x=function(e,t,r){if(!(e&&e.length>0&&t&&r))return null;for(var n,a,i,o=e[0].length,s=e.length,l=new Uint8Array(o),u=0;u<s;u++)if(n=e[u],a=t[u],i=r[u],0===u)for(var c=0;c<o;c++)l[c]=n[c]<a||n[c]>i?0:1;else for(var f=0;f<o;f++)l[f]&&(l[f]=n[f]<a||n[f]>i?0:1);return l}(b,T,A));return{pixelType:c,width:p,height:d,pixels:b,mask:x,noDataValue:M}}function J(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=r=r||N(e),a=n.ifds,i=n.noData;if(0===a.length)throw"no valid image file directory";var o,s,l=H(r);if(l)throw l;var u=-1===t?a[a.length-1]:a[t],c=i?i[0]:null;if(s=r.tileWidth?P(e,r,u):D(e,r,u),null!==c){if(s.mask=new Uint8Array(s.width*s.height),Math.abs(c)>1e24)for(o=0;o<s.width*s.height;o++)Math.abs((s.pixels[0][o]-c)/c)<1e-6?s.mask[o]=0:s.mask[o]=1;else for(o=0;o<s.width*s.height;o++)s.pixels[0][o]===c?s.mask[o]=0:s.mask[o]=1;s.noDataValue=c}return s}},901:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(42),a=Object(n.b)()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"}),i=Object(n.b)()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"})},910:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var n=r(13),a=r(2),i=r(4),o=r(5),s=r(6),l=r(0),u=r(814),c=r(26),f=r(15),h=r(11),p=r(1),d=(r(19),r(14),r(10)),m=r(785),v=r(764),b=r(22),g=r(760);function y(e){var t=e.altitude,r=e.azimuth,n=e.hillshadeType,a=e.pixelSizePower,i=e.pixelSizeFactor,o=e.scalingType,s=e.isGCS,l=e.resolution,u="multi-directional"===n?2*e.zFactor:e.zFactor,c=l.x,f=l.y,h=u/(8*c),p=u/(8*f);if(s&&u>.001&&(h/=111e3,p/=111e3),"adjusted"===o)if(s){var d=111e3*c,m=111e3*f;h=(u+Math.pow(d,a)*i)/(8*d),p=(u+Math.pow(m,a)*i)/(8*m)}else h=(u+Math.pow(c,a)*i)/(8*c),p=(u+Math.pow(f,a)*i)/(8*f);var v=(90-t)*Math.PI/180,b=Math.cos(v),g=(360-r+90)*Math.PI/180,y=Math.sin(v)*Math.cos(g),w=Math.sin(v)*Math.sin(g),O=[315,270,225,360,180,0],j=[60,60,60,60,60,90],x=new Float32Array([3,5,3,2,1,4]),I=x.reduce((function(e,t){return e+t})),k=x.map((function(e){return e/I})),M="multi-directional"===n?O.length:1,S=new Float32Array(6),T=new Float32Array(6),C=new Float32Array(6);if("multi-directional"===n)for(var A=0;A<M;A++)r=O[A],v=(90-(t=j[A]))*Math.PI/180,b=Math.cos(v),g=(360-r+90)*Math.PI/180,y=Math.sin(v)*Math.cos(g),w=Math.sin(v)*Math.sin(g),S[A]=b,T[A]=y,C[A]=w;else S.fill(b),T.fill(y),C.fill(w);return{resolution:l,factor:[h,p],sinZcosA:y,sinZsinA:w,cosZ:b,sinZcosAs:T,sinZsinAs:C,cosZs:S,weights:k,hillshadeType:["traditional","multi-directional"].indexOf(n)}}var w=r(816),O=f.a.getLogger("esri.renderers.support.RasterSymbolizer");var j={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34e38,34e38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},x=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){return Object(a.a)(this,r),t.call(this,e)}return Object(i.a)(r,[{key:"bind",value:function(){var e,t=this.rendererJSON;if(!t)return!1;switch(this.lookup={rendererJSON:{}},t.type){case"uniqueValue":e=this._updateUVRenderer(t);break;case"rasterColormap":e=this._updateColormapRenderer(t);break;case"rasterStretch":e=this._updateStretchRenderer(t);break;case"classBreaks":e=this._updateClassBreaksRenderer(t);break;case"rasterShadedRelief":e=this._updateShadedReliefRenderer(t);break;case"vectorField":e=this._updateVectorFieldRenderer()}return e}},{key:"symbolize",value:function(e){var t=e&&e.pixelBlock;if(!I(t))return t;if(e.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(t,e.simpleStretchParams);try{var r;switch(t.pixels.length>3&&(t=Object(v.h)(t,[0,1,2])),this.rendererJSON.type){case"uniqueValue":case"rasterColormap":r=this._symbolize_colormap(t);break;case"classBreaks":r=this._symbolize_classBreaks(t);break;case"rasterStretch":r=this._symbolize_stretch(t,e.bandIds);break;case"rasterShadedRelief":var n=e.extent,a=n.spatialReference.isGeographic,i={x:(n.xmax-n.xmin)/t.width,y:(n.ymax-n.ymin)/t.height};r=this._symbolize_shadedRelief(t,{isGCS:a,resolution:i})}return r}catch(o){return O.error("symbolize",o.message),t}}},{key:"simpleStretch",value:function(e,t){if(!I(e))return e;try{return e.pixels.length>3&&(e=Object(v.h)(e,[0,1,2])),Object(v.o)(e,t)}catch(r){return O.error("symbolize",r.message),e}}},{key:"generateWebGLParameters",value:function(e){if(["uniqueValue","rasterColormap","classBreaks"].indexOf(this.rendererJSON.type)>-1){var t,r=(null==(t=this.lookup)?void 0:t.colormapLut)||{};return{colormap:r.indexedColormap,colormapOffset:r.offset,type:"lut"}}var n=e.pixelBlock,a=e.isGCS,i=e.resolution,o=e.bandIds,s=this.rendererJSON;return"rasterStretch"===s.type?this.generateStretchWebGLParams(n,s,o):"rasterShadedRelief"===s.type?this.generateShadedReliefWebGLParams(s,a,i):"vectorField"===s.type?this._generateVectorFieldWebGLParams(s):null}},{key:"_isLUTChanged",value:function(e){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){var t=this.rendererJSON.colorRamp;return e?JSON.stringify(t)!==JSON.stringify(this.lookup.rendererJSON.colorRamp):(this.rendererJSON,this.lookup.rendererJSON,JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON))}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}},{key:"_symbolize_colormap",value:function(e){return this._isLUTChanged()&&!this.bind()?e:Object(v.b)(e,this.lookup.colormapLut)}},{key:"_symbolize_classBreaks",value:function(e){var t=this.rasterInfo.pixelType,r=["u8","u16","s8","s16"].indexOf(t)>-1;return this._isLUTChanged()&&!this.bind()?e:r?Object(v.b)(e,this.lookup.colormapLut):Object(v.l)(e,this.lookup.remapLut)}},{key:"_symbolize_stretch",value:function(e,t){var r,a,i=this.rasterInfo,o=i.pixelType,s=i.bandCount,l=this.rendererJSON,u=["u8","u16","s8","s16"].indexOf(o)>-1,c=l.dra,f=l.useGamma?l.gamma:null;if("histogramEqualization"===l.stretchType){var p=c?null:this.lookup.histogramLut,d=this.getStretchCutoff(l,e,t,!p),m=Object(v.o)(e,Object(n.a)(Object(n.a)({},d),{},{gamma:f}));a=Object(v.j)(m,{lut:c?d.histogramLut:p,offset:0})}else if(u){var b,g;if(c){var y=this.getStretchCutoff(l,e,t);r=Object(v.e)(Object(n.a)(Object(n.a)({pixelType:o},y),{},{gamma:f}))}else if(this._isLUTChanged()){if(!this.bind())return e;r=this.lookup?this.lookup.stretchLut:null}else r=this.lookup?this.lookup.stretchLut:null;if(!r)return e;s>1&&(null==t?void 0:t.length)===(null==(b=Object(h.q)(e))?void 0:b.pixels.length)&&(null==(g=r)?void 0:g.lut.length)===s&&(r={lut:t.map((function(e){return r.lut[e]})),offset:r.offset}),a=Object(v.j)(e,r)}else{var w=this.getStretchCutoff(l,e,t);a=Object(v.o)(e,Object(n.a)(Object(n.a)({},w),{},{gamma:f}))}if(l.colorRamp){if(this._isLUTChanged(!0)&&!this.bind())return e;a=Object(v.b)(a,this.lookup.colormapLut)}return a}},{key:"_symbolize_shadedRelief",value:function(e,t){var r,a,i,o=this.rendererJSON,s=function(e,t){if(!Object(v.i)(e))return e;var r=e.width,n=e.height,a=e.mask,i=new Uint8Array(r*n);a&&i.set(a);for(var o,s,l,u,c,f,h,p,d=y(t),m=d.factor,w=d.sinZcosA,O=d.sinZsinA,j=d.cosZ,x=d.sinZcosAs,I=d.sinZsinAs,k=d.cosZs,M=d.weights,S=Object(b.a)(m,2),T=S[0],C=S[1],A=t.hillshadeType,_=e.pixels[0],P=new Uint8Array(r*n),D=1;D<n-1;D++)for(var R=D*r,E=1;E<r-1;E++)if(!a||a[R+E]){var L=8;if(a&&(L=a[R-r+E-1]+a[R-r+E]+a[R-r+E+1]+a[R+E-1]+a[R+E+1]+a[R+r+E-1]+a[R+r+E]+a[R+r+E+1])<7)P[R+E]=0,i[R+E]=0;else{7===L?(o=a[R-r+E-1]?_[R-r+E-1]:_[R+E],s=a[R-r+E]?_[R-r+E]:_[R+E],l=a[R-r+E+1]?_[R-r+E+1]:_[R+E],u=a[R+E-1]?_[R+E-1]:_[R+E],c=a[R+E+1]?_[R+E+1]:_[R+E],f=a[R+r+E-1]?_[R+r+E-1]:_[R+E],h=a[R+r+E]?_[R+r+E]:_[R+E],p=a[R+r+E+1]?_[R+r+E+1]:_[R+E]):(o=_[R-r+E-1],s=_[R-r+E],l=_[R-r+E+1],u=_[R+E-1],c=_[R+E+1],f=_[R+r+E-1],h=_[R+r+E],p=_[R+r+E+1]);var N=(l+c+c+p-(o+u+u+f))*T,B=(f+h+h+p-(o+s+s+l))*C,U=Math.sqrt(1+N*N+B*B),z=0;if("traditional"===A){var G=255*(j+O*B-w*N)/U;G<0&&(G=0),z=G}else for(var F=I.length,H=0;H<F;H++){var V=255*(k[H]+I[H]*B-x[H]*N)/U;V<0&&(V=0),z+=V*M[H]}P[R+E]=255&z}}else P[R+E]=0;for(var J=0;J<n;J++)P[J*r]=P[J*r+1],P[(J+1)*r-1]=P[(J+1)*r-2];for(var Z=1;Z<r-1;Z++)P[Z]=P[Z+r],P[Z+(n-1)*r]=P[Z+(n-2)*r];return new g.a({width:r,height:n,pixels:[P],mask:a?i:null,pixelType:"u8",validPixelCount:e.validPixelCount,statistics:[{minValue:0,maxValue:255}]})}(e,Object(n.a)(Object(n.a)({},o),t));if(!o.colorRamp)return s;if(this._isLUTChanged(!0)){if(!this.bind())return s;i=this.lookup?this.lookup.hsvMap:null}else i=this.lookup?this.lookup.hsvMap:null;return i?(function(e,t,r,n){if(Object(v.i)(e)&&Object(v.i)(t)){for(var a=n.min,i=n.max,o=e.pixels[0],s=t.pixels,l=t.mask,u=s[0],c=255.00001/(i-a),f=new Uint8ClampedArray(u.length),h=new Uint8ClampedArray(u.length),p=new Uint8ClampedArray(u.length),d=r.length-1,m=0;m<u.length;m++)if(!l||0!==l[m]){var g=Math.floor((u[m]-a)*c),y=Object(b.a)(r[g<0?0:g>d?d:g],2),w=y[0],O=y[1],j=o[m],x=j*O,I=x*(1-Math.abs(w%2-1)),k=j-x;switch(Math.floor(w)){case 0:f[m]=x+k,h[m]=I+k,p[m]=k;break;case 1:f[m]=I+k,h[m]=x+k,p[m]=k;break;case 2:f[m]=k,h[m]=x+k,p[m]=I+k;break;case 3:f[m]=k,h[m]=I+k,p[m]=x+k;break;case 4:f[m]=I+k,h[m]=k,p[m]=x+k;break;case 5:case 6:f[m]=x+k,h[m]=k,p[m]=I+k}}e.pixels=[f,h,p],e.updateStatistics()}}(s,e,i,null!=(r=null==(a=Object(h.q)(this.rasterInfo.statistics))?void 0:a[0])?r:{min:0,max:8e3}),s):s}},{key:"_updateVectorFieldRenderer",value:function(){var e=this.rasterInfo,t=e.bandCount,r=e.dataType;return 2===t&&("vector-magdir"===r||"vector-uv"===r)}},{key:"_updateUVRenderer",value:function(e){var t=this.rasterInfo,r=t.bandCount,n=t.attributeTable,a=t.pixelType,i=e.field1;if(!i)return!1;var o=e.defaultSymbol,s=1===r&&["u8","s8"].includes(a);if(!function(e,t){var r=e.attributeTable,n=e.bandCount;return!(!Object(h.j)(r)||n>1)&&(!t||null!=r.fields.find((function(e){return e.name.toLowerCase()===t.toLowerCase()})))}(this.rasterInfo,i)&&!s)return!1;var l=[];if(n){var u=n.fields.filter((function(e){return"value"===e.name.toLowerCase()}))[0];if(!u)return!1;n.features.forEach((function(t){var r,n=e.uniqueValueInfos.filter((function(e){return String(e.value)===String(t.attributes[i])}))[0],a=null==n||null==(r=n.symbol)?void 0:r.color;a?l.push([t.attributes[u.name]].concat(a)):o&&l.push([t.attributes[u.name]].concat(o.color))}))}else{if("value"!==i.toLowerCase())return!1;e.uniqueValueInfos.forEach((function(e){var t,r=null==e||null==(t=e.symbol)?void 0:t.color;r?l.push([parseInt(""+e.value,10)].concat(r)):o&&l.push([parseInt(""+e.value,10)].concat(o.color))}))}if(0===l.length)return!1;var c=Object(v.c)({colormap:l});return this.lookup={rendererJSON:e,colormapLut:c},this.canRenderInWebGL=!0,!0}},{key:"_updateColormapRenderer",value:function(e){if(!function(e){var t=e.bandCount,r=e.colormap;return Object(h.j)(r)&&r.length&&1===t}(this.rasterInfo))return!1;var t=e.colormapInfos.map((function(e){return[e.value].concat(e.color)})).sort((function(e,t){return e[0]-t[0]}));if(!t||0===t.length)return!1;var r=Object(v.c)({colormap:t});return this.lookup={rendererJSON:e,colormapLut:r},this.canRenderInWebGL=!0,!0}},{key:"_updateShadedReliefRenderer",value:function(e){if(!function(e){return"elevation"===e.dataType}(this.rasterInfo))return!1;if(e.colorRamp){for(var t=Object(w.b)(e.colorRamp,256,!0),r=Object(v.c)({colormap:t}),n=[],a=r.indexedColormap,i=0;i<a.length;i+=4){var o=Object(u.a)({r:a[i],g:a[i+1],b:a[i+2]});n.push([o.h/60,o.s/100,255*o.v/100])}this.lookup={rendererJSON:e,colormapLut:r,hsvMap:n}}else this.lookup=null;return this.canRenderInWebGL=!0,!0}},{key:"_updateClassBreaksRenderer",value:function(e){var t=this.rasterInfo.pixelType,r=["u8","u16","s8","s16"].indexOf(t)>-1,n=e.classBreakInfos;if(null==n||!n.length)return!1;var a=n.sort((function(e,t){return e.classMaxValue-t.classMaxValue})),i=a[a.length-1],o=e.minValue;if(!r){for(var s=[],l=0;l<a.length;l++){var u;s.push({value:null!=(u=a[l].classMinValue)?u:o,mappedColor:a[l].symbol.color}),o=a[l].classMaxValue}return s.push({value:i.classMaxValue,mappedColor:i.symbol.color}),this.lookup={rendererJSON:e,remapLut:s},this.canRenderInWebGL=!1,!0}var c=[];o=Math.floor(e.minValue);for(var f=0;f<a.length;f++){for(var h=a[f],p=o;p<h.classMaxValue;p++)c.push([p].concat(h.symbol.color));o=Math.ceil(h.classMaxValue)}i.classMaxValue===o&&c.push([i.classMaxValue].concat(i.symbol.color));var d=Object(v.c)({colormap:c,fillUnspecified:!1});return this.lookup={rendererJSON:e,colormapLut:d},this.canRenderInWebGL=!0,!0}},{key:"_isHistogramRequired",value:function(e){return"percentClip"===e||"histogramEqualization"===e}},{key:"_isValidRasterStatistics",value:function(e){return Object(h.j)(e)&&e.length>0&&null!=e[0].min&&null!=e[0].max}},{key:"_updateStretchRenderer",value:function(e){var t,r=e.stretchType,a=e.dra;if(!("none"===r||null!=(t=e.statistics)&&t.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||a))return!1;var i=Object(h.q)(e.histograms||this.rasterInfo.histograms);!this._isHistogramRequired(e.stretchType)||null!=i&&i.length||a||(r="minMax");var o=e.gamma,s=e.useGamma,l=e.colorRamp,u=this.rasterInfo.pixelType,c=!a&&["u8","u16","s8","s16"].indexOf(u)>-1;if("histogramEqualization"===r){var f=i.map((function(e){return Object(v.d)(e)}));this.lookup={rendererJSON:e,histogramLut:f}}else if(c){var p=this.getStretchCutoff(e),d=Object(v.e)(Object(n.a)(Object(n.a)({pixelType:u},p),{},{gamma:s?o:null}));this.lookup={rendererJSON:e,stretchLut:d}}if(l){var m=Object(w.b)(l,256,!0);this.lookup||(this.lookup={rendererJSON:e}),this.lookup.colormapLut=Object(v.c)({colormap:m}),this.lookup.rendererJSON=e}return this.canRenderInWebGL=!0,!0}},{key:"getStretchCutoff",value:function(e){var t,r,n,a,i,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0,c=e.stretchType;if(e.dra)if("minMax"===c&&Object(h.j)(s)&&s.statistics)a=s.statistics.map((function(e){return[e.minValue,e.maxValue,0,0]}));else{var f=Object(v.g)(s);a=Object(h.j)(f)?f.statistics:null,i=Object(h.j)(f)?f.histograms:null}else a=(null==(o=e.statistics)?void 0:o.length)>0?e.statistics:Object(h.q)(this.rasterInfo.statistics),i=e.histograms||Object(h.q)(this.rasterInfo.histograms);!this._isHistogramRequired(c)||null!=(t=i)&&t.length||(c="minMax");var p,d,m,b,g,y,w,O,x,I,k,M,S=(null==(r=a)?void 0:r.length)||(null==(n=i)?void 0:n.length)||this.rasterInfo.bandCount,T=[],C=[];switch(a&&!Array.isArray(a[0])&&(a=a.map((function(e){return[e.min,e.max,e.avg,e.stddev]}))),c){case"none":var A=j[this.rasterInfo.pixelType]||j.f32;for(O=0;O<S;O++)T[O]=A[0],C[O]=A[1];break;case"minMax":for(O=0;O<S;O++)T[O]=a[O][0],C[O]=a[O][1];break;case"standardDeviation":for(O=0;O<S;O++)T[O]=a[O][2]-e.numberOfStandardDeviations*a[O][3],C[O]=a[O][2]+e.numberOfStandardDeviations*a[O][3],T[O]<a[O][0]&&(T[O]=a[O][0]),C[O]>a[O][1]&&(C[O]=a[O][1]);break;case"histogramEqualization":for(O=0;O<S;O++)T[O]=i[O].min,C[O]=i[O].max;break;case"percentClip":for(O=0;O<i.length;O++){for(p=i[O],g=new Uint32Array(p.size),b=p.counts,m=0,d=(p.max-p.min)/p.size,w=-.5===p.min&&1===d?.5:0,x=0;x<p.size;x++)m+=b[x],g[x]=m;for(y=e.minPercent*m/100,x=0;x<p.size;x++)if(g[x]>y){T[O]=p.min+d*(x+w);break}for(y=(1-e.maxPercent/100)*m,x=p.size-2;x>=0;x--)if(g[x]<y){C[O]=p.min+d*(x+2-w);break}}break;default:for(O=0;O<S;O++)T[O]=a[O][0],C[O]=a[O][1]}"histogramEqualization"===c?(k=i[0].size||256,I=0,u&&(M=i.map((function(e){return Object(v.d)(e)})))):(k=e.max||255,I=e.min||0);var _={minCutOff:T,maxCutOff:C,outMax:k,outMin:I,histogramLut:M};return this.getSelectedBandCutoffs(_,l)}},{key:"getSelectedBandCutoffs",value:function(e,t){if(null==t||0===t.length)return e;var r=Math.max.apply(null,t),n=e.minCutOff,a=e.maxCutOff,i=e.outMin,o=e.outMax,s=e.histogramLut;return n.length===t.length||n.length<=r?e:{minCutOff:t.map((function(e){return n[e]})),maxCutOff:t.map((function(e){return a[e]})),histogramLut:s?t.map((function(e){return s[e]})):null,outMin:i,outMax:o}}},{key:"generateStretchWebGLParams",value:function(e,t,r){var a=null,i=null,o=this.lookup&&this.lookup.colormapLut;t.colorRamp&&o&&(a=o.indexedColormap,i=o.offset),"histogramEqualization"===t.stretchType&&(t=Object(n.a)(Object(n.a)({},t),{},{stretchType:"minMax"}));var s=t.gamma,l=!!(t.useGamma&&s&&s.some((function(e){return 1!==e}))),u=this.getStretchCutoff(t,e,r),c=u.minCutOff,f=u.maxCutOff,p=u.outMin,d=u.outMax,m=0;Object(h.j)(e)&&(2===(m=e.getPlaneCount())&&((e=e.clone()).statistics=[e.statistics[0]],e.pixels=[e.pixels[0]]));var v,b=Math.min(3,(null==r?void 0:r.length)||m||this.rasterInfo.bandCount),g=new Float32Array(b),y=a||l?1:255;for(v=0;v<b;v++)g[v]=(d-p)/(f[v]-c[v])/y;var w=new Float32Array(b);if(l)for(v=0;v<b;v++)s[v]>1?s[v]>2?w[v]=6.5+Math.pow(s[v]-2,2.5):w[v]=6.5+100*Math.pow(2-s[v],4):w[v]=1;return{bandCount:b,outMin:p/y,outMax:d/y,minCutOff:c,maxCutOff:f,factor:g,useGamma:l,gamma:l?s:[1,1,1],gammaCorrection:l?w:[1,1,1],colormap:a,colormapOffset:i,stretchType:t.stretchType,type:"stretch"}}},{key:"generateShadedReliefWebGLParams",value:function(e,t,r){var a,i,o,s=null,l=null,u=this.lookup&&this.lookup.colormapLut;e.colorRamp&&u&&(s=u.indexedColormap,l=u.offset);var c=y(Object(n.a)(Object(n.a)({},e),{},{isGCS:t,resolution:r})),f=null==(a=Object(h.q)(this.rasterInfo.statistics))?void 0:a[0];return Object(n.a)(Object(n.a)({},c),{},{minValue:null!=(i=null==f?void 0:f.min)?i:0,maxValue:null!=(o=null==f?void 0:f.max)?o:8e3,hillshadeType:"traditional"===e.hillshadeType?0:1,type:"hillshade",colormap:s,colormapOffset:l})}},{key:"_generateVectorFieldWebGLParams",value:function(e){var t,r,n,a,i,o,s=e.style,l=e.inputUnit,u=e.outputUnit,c=e.visualVariables,f=e.symbolTileSize,p=e.flowRepresentation,d=null!=(t=null==c?void 0:c.find((function(e){return"sizeInfo"===e.type})))?t:{type:"sizeInfo",field:"Magnitude",maxDataValue:null==(r=this.rasterInfo.statistics)?void 0:r[0].max,maxSize:.8*f,minDataValue:null==(n=this.rasterInfo.statistics)?void 0:n[0].min,minSize:.2*f},m=d?d.minDataValue:null==(a=this.rasterInfo.statistics)?void 0:a[0].min,v=d?d.maxDataValue:null==(i=this.rasterInfo.statistics)?void 0:i[0].max,b=Object(h.j)(d.maxSize)&&Object(h.j)(d.minSize)?[d.minSize/f,d.maxSize/f]:[.2,.8];if("wind_speed"===s||"simple_scalar"===s){var g=(b[0]+b[1])/2;b[0]=b[1]=g}var y=Object(h.j)(m)&&Object(h.j)(v)?[m,v]:null;if("classified_arrow"===s)if(Object(h.j)(m)&&Object(h.j)(v)&&Object(h.j)(d)){o=[];for(var w=(d.maxDataValue-d.minDataValue)/5,O=0;O<6;O++)o.push(d.minDataValue+w*O)}else o=[0,1e-6,3.5,7,10.5,14];var j="flow_to"===p===("ocean_current_kn"===s||"ocean_current_m"===s)?0:Math.PI,x=null==c?void 0:c.find((function(e){return"rotationInfo"===e.type}));return{breakValues:o,dataRange:y,inputUnit:l,outputUnit:u,symbolTileSize:f,symbolPercentRange:b,style:s||"single_arrow",rotation:j,rotationType:(null==x?void 0:x.rotationType)||e.rotationType,type:"vectorField"}}}]),r}(c.a);function I(e){return Object(v.i)(e)&&0!==e.validPixelCount}Object(l.a)([Object(p.b)({json:{write:!0}})],x.prototype,"rendererJSON",void 0),Object(l.a)([Object(p.b)({type:m.a,json:{write:!0}})],x.prototype,"rasterInfo",void 0),Object(l.a)([Object(p.b)({json:{write:!0}})],x.prototype,"lookup",void 0),Object(l.a)([Object(p.b)()],x.prototype,"canRenderInWebGL",void 0);var k=x=Object(l.a)([Object(d.a)("esri.renderers.support.RasterSymbolizer")],x)},936:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return n}));var n=new(r(42).a)({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"}),a={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"}},937:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,a=r(2),i=r(4),o=r(5),s=r(6),l=r(0),u=r(26),c=r(18),f=r(1),h=r(14),p=(r(19),r(15),r(10)),d=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).variableName=null,n.dimensionName=null,n.values=[],n.isSlice=!1,n}return Object(i.a)(r,[{key:"clone",value:function(){return new n({variableName:this.variableName,dimensionName:this.dimensionName,values:Object(c.a)(this.values),isSlice:this.isSlice})}}]),r}(u.a);Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],d.prototype,"variableName",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],d.prototype,"dimensionName",void 0),Object(l.a)([Object(f.b)({type:h.p.array(h.p.oneOf([h.p.native(Number),h.p.array(h.p.native(Number))])),json:{write:!0}})],d.prototype,"values",void 0),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],d.prototype,"isSlice",void 0);var m=d=n=Object(l.a)([Object(p.a)("esri.layers.support.DimensionalDefinition")],d)},994:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(13),a=r(7),i=r.n(a),o=r(12),s=r(2),l=r(4),u=r(29),c=r(11),f=r(727),h=r(760),p=function(){function e(){Object(s.a)(this,e),this._workerThread=null,this._destroyed=!1}return Object(l.a)(e,[{key:"initialize",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)("RasterWorker");case 2:t=e.sent,this._destroyed?t.close():this._workerThread=t;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this._destroyed=!0,this._workerThread&&(this._workerThread.close(),this._workerThread=null)}},{key:"convertVectorFieldData",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new u.a("raster-jobhandler:no-connection","no available worker connection");case 2:return e.next=4,this._workerThread.invoke("convertVectorFieldData",{pixelBlock:t.pixelBlock.toJSON(),type:t.dataType},r);case 4:return n=e.sent,e.abrupt("return",n?new h.a(n):null);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"decode",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new u.a("raster-jobhandler:no-connection","no available worker connection");case 2:return e.next=4,this._workerThread.invoke("decode",t,r);case 4:return n=e.sent,e.abrupt("return",n?new h.a(n):null);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"symbolize",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new u.a("raster-jobhandler:no-connection","no available worker connection");case 2:return n={extent:t.extent&&t.extent.toJSON(),pixelBlock:Object(c.j)(t.pixelBlock)&&t.pixelBlock.toJSON(),simpleStretchParams:t.simpleStretchParams,bandIds:t.bandIds},e.next=5,this._workerThread.invoke("symbolize",n,r);case 5:return a=e.sent,e.abrupt("return",a?new h.a(a):null);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateSymbolizer",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new u.a("raster-jobhandler:no-connection","no available worker connection");case 2:return a=null==t||null==(n=t.rendererJSON)?void 0:n.histograms,e.next=5,Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:t.toJSON(),histograms:a},r));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"stretch",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new u.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!=t&&t.pixelBlock){e.next=4;break}return e.abrupt("return",null);case 4:return n={srcPixelBlock:t.pixelBlock.toJSON(),stretchParams:t.stretchParams},e.next=7,this._workerThread.invoke("stretch",n,r);case 7:return a=e.sent,e.abrupt("return",a?new h.a(a):null);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"split",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new u.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!=t&&t.pixelBlock){e.next=4;break}return e.abrupt("return",null);case 4:return n={srcPixelBlock:t.pixelBlock.toJSON(),tileSize:t.tileSize,maximumPyramidLevel:t.maximumPyramidLevel},e.next=7,this._workerThread.invoke("split",n,r);case 7:return a=e.sent,e.abrupt("return",(a&&a.forEach((function(e,t){a.set(t,e?h.a.fromJSON(e):null)})),Promise.resolve(a)));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"estimateStatisticsHistograms",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new u.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!=t&&t.pixelBlock){e.next=4;break}return e.abrupt("return",null);case 4:return n={srcPixelBlock:t.pixelBlock.toJSON()},e.next=7,this._workerThread.invoke("estimateStatisticsHistograms",n,r);case 7:return a=e.sent,e.abrupt("return",Promise.resolve(a));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"mosaicAndTransform",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var a,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new u.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!=t&&null!=(a=t.srcPixelBlocks)&&a.length){e.next=4;break}return e.abrupt("return",null);case 4:return o=Object(n.a)(Object(n.a)({},t),{},{srcPixelBlocks:t.srcPixelBlocks.map((function(e){return Object(c.j)(e)?e.toJSON():null}))}),e.next=7,this._workerThread.invoke("mosaicAndTransform",o,r);case 7:return s=e.sent,e.abrupt("return",s?new h.a(s):null);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}()}}]);
//# sourceMappingURL=47.4e468cd4.chunk.js.map