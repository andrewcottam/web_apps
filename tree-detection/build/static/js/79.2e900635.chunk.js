(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[79,92],{1034:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return d}));var a=r(2),n=r(4),i=r(77),o=r(65),c=r(5),s=r(6),u=r(0),l=r(29),p=r(677),b=r(241),f=r(1),v=(r(19),r(14),r(15),r(10)),h=r(682),O=r(699),y=function(t){Object(c.a)(r,t);var e=Object(s.a)(r);function r(t){var n;return Object(a.a)(this,r),(n=e.call(this,t)).resourceInfo=null,n.type="unknown",n}return Object(n.a)(r,[{key:"initialize",value:function(){var t=this;this.addResolvingPromise(new Promise((function(e,r){Object(b.a)((function(){var e=t.resourceInfo&&(t.resourceInfo.layerType||t.resourceInfo.type),a="Unknown layer type";e&&(a+=" "+e),r(new l.a("layer:unknown-layer-type",a,{layerType:e}))}))})))}},{key:"read",value:function(t,e){Object(i.a)(Object(o.a)(r.prototype),"read",this).call(this,{resourceInfo:t},e)}},{key:"write",value:function(){return null}}]),r}(Object(O.a)(Object(p.a)(h.a)));Object(u.a)([Object(f.b)({readOnly:!0})],y.prototype,"resourceInfo",void 0),Object(u.a)([Object(f.b)({type:["show","hide"]})],y.prototype,"listMode",void 0),Object(u.a)([Object(f.b)({json:{read:!1},readOnly:!0,value:"unknown"})],y.prototype,"type",void 0);var d=y=Object(u.a)([Object(v.a)("esri.layers.UnknownLayer")],y)},677:function(t,e,r){"use strict";r.d(e,"a",(function(){return I})),r.d(e,"b",(function(){return S}));var a=r(21),n=r(2),i=r(4),o=r(5),c=r(6),s=r(0),u=r(60),l=r(8),p=r(11),b=r(23),f=r(18),v=r(164),h=function(){function t(){Object(n.a)(this,t),this._propertyOriginMap=new Map,this._originStores=new Array(v.a),this._values=new Map}return Object(i.a)(t,[{key:"clone",value:function(e){var r=this,a=new t,n=this._originStores[0];n&&n.forEach((function(t,e){a.set(e,Object(f.a)(t),0)}));for(var i=function(t){var n=r._originStores[t];n&&n.forEach((function(r,n){e&&e.has(n)||a.set(n,Object(f.a)(r),t)}))},o=2;o<v.a;o++)i(o);return a}},{key:"get",value:function(t,e){var r=void 0===e?this._values:this._originStores[e];return r?r.get(t):void 0}},{key:"keys",value:function(t){var e=null==t?this._values:this._originStores[t];return e?Object(b.a)(e.keys()):[]}},{key:"set",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,a=this._originStores[r];if(a||(a=new Map,this._originStores[r]=a),a.set(t,e),!this._values.has(t)||Object(p.c)(this._propertyOriginMap.get(t))<=r){var n=this._values.get(t);return this._values.set(t,e),this._propertyOriginMap.set(t,r),n!==e}return!1}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,r=this._originStores[e];if(r){var a=r.get(t);if(r.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===e){this._values.delete(t);for(var n=e-1;n>=0;n--){var i=this._originStores[n];if(i&&i.has(t)){this._values.set(t,i.get(t)),this._propertyOriginMap.set(t,n);break}}}return a}}},{key:"has",value:function(t,e){var r=void 0===e?this._values:this._originStores[e];return!!r&&r.has(t)}},{key:"revert",value:function(t,e){for(;e>0&&!this.has(t,e);)--e;var r=this._originStores[e],a=r&&r.get(t),n=this._values.get(t);return this._values.set(t,a),this._propertyOriginMap.set(t,e),n!==a}},{key:"originOf",value:function(t){return this._propertyOriginMap.get(t)||0}},{key:"forEach",value:function(t){this._values.forEach(t)}}]),t}(),O=r(336),y=r(69),d=r(10),j=function(t){var e=function(t){Object(o.a)(r,t);var e=Object(c.a)(r);function r(){var t;Object(n.a)(this,r);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];t=e.call.apply(e,[this].concat(i));var c=Object(p.c)(Object(y.a)(Object(l.a)(t))),s=c.metadatas,u=c.store,b=new h;return c.store=b,u.keys().forEach((function(t){b.set(t,u.get(t),0)})),Object.keys(s).forEach((function(t){c.internalGet(t)&&b.set(t,c.internalGet(t),0)})),t}return Object(i.a)(r,[{key:"read",value:function(t,e){Object(O.a)(this,t,e)}},{key:"getAtOrigin",value:function(t,e){var r=g(this),a=Object(v.d)(e);if("string"==typeof t)return r.get(t,a);var n={};return t.forEach((function(t){n[t]=r.get(t,a)})),n}},{key:"originOf",value:function(t){return Object(v.b)(this.originIdOf(t))}},{key:"originIdOf",value:function(t){return g(this).originOf(t)}},{key:"revert",value:function(t,e){var r=g(this),a=Object(v.d)(e),n=Object(y.a)(this);("string"==typeof t?"*"===t?r.keys(a):[t]:t).forEach((function(t){n.invalidate(t),r.revert(t,a),n.commit(t)}))}}]),r}(t);return e=Object(s.a)([Object(d.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function g(t){return Object(y.a)(t).store}var m=function(t){Object(o.a)(r,t);var e=Object(c.a)(r);function r(){return Object(n.a)(this,r),e.apply(this,arguments)}return r}(j(u.a));m=Object(s.a)([Object(d.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],m);var k=r(335);function w(t){return Object(y.a)(t).store}var I=function(t){var e=function(t){Object(o.a)(r,t);var e=Object(c.a)(r);function r(){Object(n.a)(this,r);for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];return e.call.apply(e,[this].concat(a))}return r}(function(t){var e=function(t){Object(o.a)(r,t);var e=Object(c.a)(r);function r(){Object(n.a)(this,r);for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];return e.call.apply(e,[this].concat(a))}return Object(i.a)(r,[{key:"clear",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";return w(this).delete(t,Object(v.d)(e))}},{key:"write",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return Object(k.b)(this,t=t||{},e),t}},{key:"setAtOrigin",value:function(t,e,r){Object(y.a)(this).setAtOrigin(t,e,Object(v.d)(r))}},{key:"removeOrigin",value:function(t){var e,r=w(this),n=Object(v.d)(t),i=r.keys(n),o=Object(a.a)(i);try{for(o.s();!(e=o.n()).done;){var c=e.value;r.originOf(c)===n&&r.set(c,r.get(c,n),6)}}catch(s){o.e(s)}finally{o.f()}}},{key:"updateOrigin",value:function(t,e){for(var r=w(this),a=Object(v.d)(e),n=this.get(t),i=a+1;i<v.a;++i)r.delete(t,i);r.set(t,n,a)}},{key:"toJSON",value:function(t){return this.write({},t)}}]),r}(t);return(e=Object(s.a)([Object(d.a)("esri.core.WriteableMultiOriginJSONSupport")],e)).prototype.toJSON.isDefaultToJSON=!0,e}(j(t)));return e=Object(s.a)([Object(d.a)("esri.core.MultiOriginJSONSupport")],e)},S=function(t){Object(o.a)(r,t);var e=Object(c.a)(r);function r(){return Object(n.a)(this,r),e.apply(this,arguments)}return r}(I(u.a));S=Object(s.a)([Object(d.a)("esri.core.MultiOriginJSONSupport")],S)},682:function(t,e,r){"use strict";r.d(e,"a",(function(){return x}));var a=r(7),n=r.n(a),i=r(12),o=r(2),c=r(4),s=r(5),u=r(6),l=r(0),p=r(68),b=(r(114),r(82)),f=r(29),v=r(184),h=r(239),O=r(142),y=r(15),d=r(30),j=r(27),g=r(1),m=(r(19),r(14),r(10)),k=r(58),w=r(45),I=0,S=y.a.getLogger("esri.layers.Layer"),_=function(t){Object(s.a)(a,t);var e=Object(u.a)(a);function a(){var t;return Object(o.a)(this,a),(t=e.apply(this,arguments)).attributionDataUrl=null,t.fullExtent=new k.a(-180,-90,180,90,w.a.WGS84),t.id=Date.now().toString(16)+"-layer-"+I++,t.legendEnabled=!0,t.listMode="show",t.opacity=1,t.parent=null,t.popupEnabled=!0,t.attributionVisible=!0,t.spatialReference=w.a.WGS84,t.title=null,t.type=null,t.url=null,t.visible=!0,t}return Object(c.a)(a,[{key:"initialize",value:function(){var t=this;this.when().catch((function(e){var r,a;Object(d.m)(e)||y.a.getLogger(t.declaredClass).error("#load()","Failed to load layer (title: '".concat(null!=(r=t.title)?r:"no title","', id: '").concat(null!=(a=t.id)?a:"no id","')"),{error:e})}))}},{key:"destroy",value:function(){if(this.parent){var t=this,e=this.parent;"layers"in e&&e.layers.includes(t)?e.layers.remove(t):"tables"in e&&e.tables.includes(t)?e.tables.remove(t):"baseLayers"in e&&e.baseLayers.includes(t)?e.baseLayers.remove(t):"baseLayers"in e&&e.referenceLayers.includes(t)&&e.referenceLayers.remove(t)}}},{key:"hasAttributionData",get:function(){return null!=this.attributionDataUrl}},{key:"parsedUrl",get:function(){var t=this.url;return t?Object(j.J)(t):null}},{key:"fetchAttributionData",value:function(){var t=Object(i.a)(n.a.mark((function t(){var e;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.attributionDataUrl,!this.hasAttributionData||!e){t.next=5;break}return t.next=4,Object(b.default)(e,{query:{f:"json"},responseType:"json"});case 4:return t.abrupt("return",t.sent.data);case 5:throw new f.a("layer:no-attribution-data","Layer does not have attribution data");case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}],[{key:"fromArcGISServerUrl",value:function(){var t=Object(i.a)(n.a.mark((function t(e){var a,i;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="string"==typeof e?{url:e}:e,t.next=3,r.e(85).then(r.bind(null,783));case 3:return i=t.sent,t.prev=4,t.next=7,i.fromUrl(a);case 7:return t.abrupt("return",t.sent);case 10:throw t.prev=10,t.t0=t.catch(4),S.error("#fromArcGISServerUrl({ url: '"+a.url+"'})","Failed to create layer from arcgis server url",t.t0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e){return t.apply(this,arguments)}}()},{key:"fromPortalItem",value:function(){var t=Object(i.a)(n.a.mark((function t(e){var a,i,o,c,s;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="portalItem"in e?e:{portalItem:e},t.next=3,Promise.all([r.e(17),r.e(97)]).then(r.bind(null,774));case 3:return i=t.sent,t.prev=4,t.next=7,i.fromItem(a);case 7:return t.abrupt("return",t.sent);case 10:throw t.prev=10,t.t0=t.catch(4),o=a&&a.portalItem,c=o&&o.id||"unset",s=o&&o.portal&&o.portal.url||p.a.portalUrl,S.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+s+"', id: '"+c+"')",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e){return t.apply(this,arguments)}}()}]),a}(v.a.EventedMixin(Object(h.a)(O.a)));Object(l.a)([Object(g.b)({type:String})],_.prototype,"attributionDataUrl",void 0),Object(l.a)([Object(g.b)({type:k.a})],_.prototype,"fullExtent",void 0),Object(l.a)([Object(g.b)({readOnly:!0})],_.prototype,"hasAttributionData",null),Object(l.a)([Object(g.b)({type:String})],_.prototype,"id",void 0),Object(l.a)([Object(g.b)({type:Boolean,nonNullable:!0})],_.prototype,"legendEnabled",void 0),Object(l.a)([Object(g.b)({type:["show","hide","hide-children"]})],_.prototype,"listMode",void 0),Object(l.a)([Object(g.b)({type:Number,range:{min:0,max:1},nonNullable:!0})],_.prototype,"opacity",void 0),Object(l.a)([Object(g.b)()],_.prototype,"parent",void 0),Object(l.a)([Object(g.b)({readOnly:!0})],_.prototype,"parsedUrl",null),Object(l.a)([Object(g.b)({type:Boolean})],_.prototype,"popupEnabled",void 0),Object(l.a)([Object(g.b)({type:Boolean})],_.prototype,"attributionVisible",void 0),Object(l.a)([Object(g.b)({type:w.a})],_.prototype,"spatialReference",void 0),Object(l.a)([Object(g.b)({type:String})],_.prototype,"title",void 0),Object(l.a)([Object(g.b)({type:String,readOnly:!0,json:{read:!1}})],_.prototype,"type",void 0),Object(l.a)([Object(g.b)()],_.prototype,"url",void 0),Object(l.a)([Object(g.b)({type:Boolean,nonNullable:!0})],_.prototype,"visible",void 0);var x=_=Object(l.a)([Object(m.a)("esri.layers.Layer")],_)},699:function(t,e,r){"use strict";r.d(e,"a",(function(){return M}));var a=r(13),n=r(7),i=r.n(n),o=r(12),c=r(2),s=r(4),u=r(77),l=r(65),p=r(5),b=r(6),f=r(0),v=r(83),h=r(82),O=r(295),y=r(29),d=r(15),j=r(11),g=r(30),m=r(27),k=r(1),w=(r(19),r(14),r(57)),I=r(10),S=r(43),_=r(85),x=r(334),E=r(338),U=d.a.getLogger("esri.layers.mixins.PortalLayer"),M=function(t){var e=function(t){Object(p.a)(n,t);var e=Object(b.a)(n);function n(){var t;return Object(c.a)(this,n),(t=e.apply(this,arguments)).resourceReferences={portalItem:null,paths:[]},t.userHasEditingPrivileges=!0,t}return Object(s.a)(n,[{key:"destroy",value:function(){var t;null==(t=this.portalItem)||t.destroy(),this.portalItem=null}},{key:"portalItem",set:function(t){t!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",t))}},{key:"readPortalItem",value:function(t,e,r){if(e.itemId)return new x.default({id:e.itemId,portal:r&&r.portal})}},{key:"writePortalItem",value:function(t,e){t&&t.id&&(e.itemId=t.id)}},{key:"loadFromPortal",value:function(){var t=Object(o.a)(i.a.mark((function t(e,a){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.portalItem||!this.portalItem.id){t.next=14;break}return t.prev=1,t.next=4,r.e(17).then(r.bind(null,781));case 4:return n=t.sent,Object(g.v)(a),t.next=8,n.load({instance:this,supportedTypes:e.supportedTypes,validateItem:e.validateItem,supportsData:e.supportsData},a);case 8:return t.abrupt("return",t.sent);case 11:throw t.prev=11,t.t0=t.catch(1),Object(g.m)(t.t0)||U.warn("Failed to load layer (".concat(this.title,", ").concat(this.id,") portal item (").concat(this.portalItem.id,")\n  ").concat(t.t0)),t.t0;case 14:case"end":return t.stop()}}),t,this,[[1,11]])})));return function(e,r){return t.apply(this,arguments)}}()},{key:"finishLoadEditablePortalLayer",value:function(){var t=Object(o.a)(i.a.mark((function t(e){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=this,t.next=3,this.fetchUserHasEditingPrivileges(e).catch((function(t){return Object(g.u)(t),!0}));case 3:t.t1=t.sent,t.t0._set.call(t.t0,"userHasEditingPrivileges",t.t1);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"fetchUserHasEditingPrivileges",value:function(){var t=Object(o.a)(i.a.mark((function t(e){var r,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.url?null==v.b?void 0:v.b.findCredential(this.url):null){t.next=3;break}return t.abrupt("return",!0);case 3:if(P.credential!==r){t.next=7;break}t.t0=P.user,t.next=10;break;case 7:return t.next=9,this.fetchEditingUser(e);case 9:t.t0=t.sent;case 10:return a=t.t0,t.abrupt("return",(P.credential=r,P.user=a,Object(j.i)(a)||null==a.privileges||a.privileges.includes("features:user:edit")));case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"fetchEditingUser",value:function(){var t=Object(o.a)(i.a.mark((function t(e){var r,a,n,o,c,s,u,l,p;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=null==(r=this.portalItem)||null==(a=r.portal)?void 0:a.user)){t.next=3;break}return t.abrupt("return",n);case 3:if(null!=(o=v.b.findServerInfo(this.url))&&o.owningSystemUrl){t.next=6;break}return t.abrupt("return",null);case 6:if(c="".concat(o.owningSystemUrl,"/sharing/rest"),!(s=_.a.getDefault())||!s.loaded||Object(m.C)(s.restUrl)!==Object(m.C)(c)){t.next=9;break}return t.abrupt("return",s.user);case 9:return u="".concat(c,"/community/self"),l=Object(j.j)(e)?e.signal:null,t.next=13,Object(O.c)(Object(h.default)(u,{authMode:"no-prompt",query:{f:"json"},signal:l}));case 13:return p=t.sent,t.abrupt("return",p.ok?E.default.fromJSON(p.value.data):null);case 15:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"read",value:function(t,e){e&&(e.layer=this),Object(u.a)(Object(l.a)(n.prototype),"read",this).call(this,t,e)}},{key:"write",value:function(t,e){var r=e&&e.portal,i=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||_.a.getDefault());return r&&i&&!Object(m.r)(i.restUrl,r.restUrl)?(e.messages&&e.messages.push(new y.a("layer:cross-portal","The layer '".concat(this.title," (").concat(this.id,")' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer"),{layer:this})),null):Object(u.a)(Object(l.a)(n.prototype),"write",this).call(this,t,Object(a.a)(Object(a.a)({},e),{},{layer:this}))}}]),n}(t);return Object(f.a)([Object(k.b)({type:x.default})],e.prototype,"portalItem",null),Object(f.a)([Object(w.a)("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),Object(f.a)([Object(S.a)("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),Object(f.a)([Object(k.b)()],e.prototype,"resourceReferences",void 0),Object(f.a)([Object(k.b)({readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),e=Object(f.a)([Object(I.a)("esri.layers.mixins.PortalLayer")],e),e},P={credential:null,user:null}}}]);
//# sourceMappingURL=79.2e900635.chunk.js.map