(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[51,24,98,105],{660:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(2),i=r(5),a=r(6),s=r(0),u=r(42),o=r(26),c=r(1),l=(r(19),r(14),r(15),r(31)),h=r(10),f=new u.a({inherited:"inherited",codedValue:"coded-value",range:"range"}),d=function(e){Object(i.a)(r,e);var t=Object(a.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).name=null,i.type=null,i}return r}(o.a);Object(s.a)([Object(c.b)({type:String,json:{write:!0}})],d.prototype,"name",void 0),Object(s.a)([Object(l.a)(f)],d.prototype,"type",void 0);var p=d=Object(s.a)([Object(h.a)("esri.layers.support.Domain")],d)},661:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=(r(1),r(19),r(14),r(15),r(31)),l=r(10),h=r(660),f=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="inherited",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n}}]),r}(h.a);Object(o.a)([Object(c.a)({inherited:"inherited"})],f.prototype,"type",void 0);var d=f=n=Object(o.a)([Object(l.a)("esri.layers.support.InheritedDomain")],f)},662:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=r(1),l=(r(19),r(14),r(15),r(31)),h=r(10),f=r(660),d=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).maxValue=null,n.minValue=null,n.type="range",n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}}]),r}(f.a);Object(o.a)([Object(c.b)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(e,t,r){t[r]=[this.minValue||0,e]}}}})],d.prototype,"maxValue",void 0),Object(o.a)([Object(c.b)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,r){t[r]=[e,this.maxValue||0]}}}})],d.prototype,"minValue",void 0),Object(o.a)([Object(l.a)({range:"range"})],d.prototype,"type",void 0);var p=d=n=Object(o.a)([Object(h.a)("esri.layers.support.RangeDomain")],d)},664:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=r(18),l=r(1),h=(r(14),r(19),r(15),r(31)),f=r(10),d=r(26),p=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).name=null,n.code=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({name:this.name,code:this.code})}}]),r}(d.a);Object(o.a)([Object(l.b)({type:String,json:{write:!0}})],p.prototype,"name",void 0),Object(o.a)([Object(l.b)({type:[String,Number],json:{write:!0}})],p.prototype,"code",void 0);var b,y=p=n=Object(o.a)([Object(f.a)("esri.layers.support.CodedValue")],p),v=r(660),m=b=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).codedValues=null,n.type="coded-value",n}return Object(a.a)(r,[{key:"getName",value:function(e){var t=null;if(this.codedValues){var r=String(e);this.codedValues.some((function(e){return String(e.code)===r&&(t=e.name),!!t}))}return t}},{key:"clone",value:function(){return new b({codedValues:Object(c.a)(this.codedValues),name:this.name})}}]),r}(v.a);Object(o.a)([Object(l.b)({type:[y],json:{write:!0}})],m.prototype,"codedValues",void 0),Object(o.a)([Object(h.a)({codedValue:"coded-value"})],m.prototype,"type",void 0);var g=m=b=Object(o.a)([Object(f.a)("esri.layers.support.CodedValueDomain")],m)},665:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=r(26),l=r(11),h=r(692),f=r(1),d=(r(19),r(14),r(15),r(57)),p=r(10),b=r(43),y=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).end=null,n.start=null,n}return Object(a.a)(r,[{key:"readEnd",value:function(e,t){return null!=t.end?new Date(t.end):null}},{key:"writeEnd",value:function(e,t){t.end=e?e.getTime():null}},{key:"isAllTime",get:function(){return this.equals(n.allTime)}},{key:"isEmpty",get:function(){return this.equals(n.empty)}},{key:"readStart",value:function(e,t){return null!=t.start?new Date(t.start):null}},{key:"writeStart",value:function(e,t){t.start=e?e.getTime():null}},{key:"clone",value:function(){return new n({end:this.end,start:this.start})}},{key:"equals",value:function(e){if(!e)return!1;var t=Object(l.j)(this.start)?this.start.getTime():this.start,r=Object(l.j)(this.end)?this.end.getTime():this.end,n=Object(l.j)(e.start)?e.start.getTime():e.start,i=Object(l.j)(e.end)?e.end.getTime():e.end;return t===n&&r===i}},{key:"expandTo",value:function(e){if(this.isEmpty||this.isAllTime)return this.clone();var t=Object(l.a)(this.start,(function(t){return Object(h.c)(t,e)})),r=Object(l.a)(this.end,(function(t){return Object(h.b)(Object(h.c)(t,e),1,e)}));return new n({start:t,end:r})}},{key:"intersection",value:function(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return n.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();var t,r,i=Object(l.m)(this.start,-1/0,(function(e){return e.getTime()})),a=Object(l.m)(this.end,1/0,(function(e){return e.getTime()})),s=Object(l.m)(e.start,-1/0,(function(e){return e.getTime()})),u=Object(l.m)(e.end,1/0,(function(e){return e.getTime()}));if(s>=i&&s<=a?t=s:i>=s&&i<=u&&(t=i),a>=s&&a<=u?r=a:u>=i&&u<=a&&(r=u),!isNaN(t)&&!isNaN(r)){var o=new n;return o.start=t===-1/0?null:new Date(t),o.end=r===1/0?null:new Date(r),o}return n.empty}},{key:"offset",value:function(e,t){if(this.isEmpty||this.isAllTime)return this.clone();var r=new n,i=this.start,a=this.end;return Object(l.j)(i)&&(r.start=Object(h.b)(i,e,t)),Object(l.j)(a)&&(r.end=Object(h.b)(a,e,t)),r}},{key:"union",value:function(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return v.clone();var t=Object(l.j)(this.start)&&Object(l.j)(e.start)?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=Object(l.j)(this.end)&&Object(l.j)(e.end)?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new n({start:t,end:r})}}],[{key:"allTime",get:function(){return v}},{key:"empty",get:function(){return m}}]),r}(c.a);Object(o.a)([Object(f.b)({type:Date,json:{write:{allowNull:!0}}})],y.prototype,"end",void 0),Object(o.a)([Object(d.a)("end")],y.prototype,"readEnd",null),Object(o.a)([Object(b.a)("end")],y.prototype,"writeEnd",null),Object(o.a)([Object(f.b)({readOnly:!0,json:{read:!1}})],y.prototype,"isAllTime",null),Object(o.a)([Object(f.b)({readOnly:!0,json:{read:!1}})],y.prototype,"isEmpty",null),Object(o.a)([Object(f.b)({type:Date,json:{write:{allowNull:!0}}})],y.prototype,"start",void 0),Object(o.a)([Object(d.a)("start")],y.prototype,"readStart",null),Object(o.a)([Object(b.a)("start")],y.prototype,"writeStart",null);var v=new(y=n=Object(o.a)([Object(p.a)("esri.TimeExtent")],y)),m=new y({start:void 0,end:void 0}),g=y},666:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=r(42),l=r(26),h=r(1),f=(r(19),r(14)),d=(r(15),r(31)),p=r(57),b=r(10),y=r(679),v=r(690),m=new c.a({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"}),g=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).alias=null,n.defaultValue=void 0,n.description=null,n.domain=null,n.editable=!0,n.length=-1,n.name=null,n.nullable=!0,n.type=null,n.valueType=null,n}return Object(a.a)(r,[{key:"readDescription",value:function(e,t){var r,n=t.description;try{r=JSON.parse(n)}catch(i){}return r?r.value:null}},{key:"readValueType",value:function(e,t){var r,n=t.description;try{r=JSON.parse(n)}catch(i){}return r?m.fromJSON(r.fieldValueType):null}},{key:"clone",value:function(){return new n({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}}]),r}(l.a);Object(o.a)([Object(h.b)({type:String,json:{write:!0}})],g.prototype,"alias",void 0),Object(o.a)([Object(h.b)({type:[String,Number],json:{write:{allowNull:!0}}})],g.prototype,"defaultValue",void 0),Object(o.a)([Object(h.b)()],g.prototype,"description",void 0),Object(o.a)([Object(p.a)("description")],g.prototype,"readDescription",null),Object(o.a)([Object(h.b)({types:y.b,json:{read:{reader:y.a},write:!0}})],g.prototype,"domain",void 0),Object(o.a)([Object(h.b)({type:Boolean,json:{write:!0}})],g.prototype,"editable",void 0),Object(o.a)([Object(h.b)({type:f.a,json:{write:!0}})],g.prototype,"length",void 0),Object(o.a)([Object(h.b)({type:String,json:{write:!0}})],g.prototype,"name",void 0),Object(o.a)([Object(h.b)({type:Boolean,json:{write:!0}})],g.prototype,"nullable",void 0),Object(o.a)([Object(d.a)(v.a)],g.prototype,"type",void 0),Object(o.a)([Object(h.b)()],g.prototype,"valueType",void 0),Object(o.a)([Object(p.a)("valueType",["description"])],g.prototype,"readValueType",null);var j=g=n=Object(o.a)([Object(b.a)("esri.layers.support.Field")],g)},669:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(42),i=Object(n.b)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0})},670:function(e,t,r){"use strict";r.d(t,"a",(function(){return R}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=r(114),l=r(665),h=r(42),f=r(26),d=r(18),p=r(11),b=r(1),y=r(97),v=(r(19),r(15),r(31)),m=r(10),g=r(43),j=r(14),O=r(62),x=r(673),k=r(717),w=r(714),_=r(45),S=r(48),I=new h.a({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),F=new h.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),T=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).aggregateIds=null,n.cacheHint=void 0,n.datumTransformation=null,n.distance=void 0,n.dynamicDataSource=void 0,n.formatOf3DObjects=null,n.gdbVersion=null,n.geometry=null,n.geometryPrecision=void 0,n.groupByFieldsForStatistics=null,n.having=null,n.historicMoment=null,n.maxAllowableOffset=void 0,n.maxRecordCountFactor=1,n.multipatchOption=null,n.num=void 0,n.objectIds=null,n.orderByFields=null,n.outFields=null,n.outSpatialReference=null,n.outStatistics=null,n.parameterValues=null,n.pixelSize=null,n.quantizationParameters=null,n.rangeValues=null,n.relationParameter=null,n.resultType=null,n.returnCentroid=!1,n.returnDistinctValues=!1,n.returnExceededLimitFeatures=!0,n.returnGeometry=!1,n.returnQueryGeometry=!1,n.returnM=void 0,n.returnZ=void 0,n.sourceSpatialReference=null,n.spatialRelationship="intersects",n.start=void 0,n.sqlFormat=null,n.text=null,n.timeExtent=null,n.timeReferenceUnknownClient=!1,n.units=null,n.where=null,n}return Object(a.a)(r,[{key:"castDatumTransformation",value:function(e){return"number"==typeof e||"object"==typeof e?e:null}},{key:"writeHistoricMoment",value:function(e,t){t.historicMoment=e&&e.getTime()}},{key:"writeParameterValues",value:function(e,t){if(e){var r={};for(var n in e){var i=e[n];Array.isArray(i)?r[n]=i.map((function(e){return e instanceof Date?e.getTime():e})):i instanceof Date?r[n]=i.getTime():r[n]=i}t.parameterValues=r}}},{key:"writeStart",value:function(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}},{key:"writeWhere",value:function(e,t){t.where=e||"1=1"}},{key:"clone",value:function(){return new n(Object(d.a)({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:Object(p.j)(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}}],[{key:"from",value:function(e){return Object(j.d)(n,e)}}]),r}(f.a);T.MAX_MAX_RECORD_COUNT_FACTOR=5,Object(o.a)([Object(b.b)({json:{write:!0}})],T.prototype,"aggregateIds",void 0),Object(o.a)([Object(b.b)({type:Boolean,json:{write:!0}})],T.prototype,"cacheHint",void 0),Object(o.a)([Object(b.b)({json:{write:!0}})],T.prototype,"datumTransformation",void 0),Object(o.a)([Object(y.a)("datumTransformation")],T.prototype,"castDatumTransformation",null),Object(o.a)([Object(b.b)({type:Number,json:{write:{overridePolicy:function(e){return{enabled:e>0}}}}})],T.prototype,"distance",void 0),Object(o.a)([Object(b.b)({type:x.a,json:{write:!0}})],T.prototype,"dynamicDataSource",void 0),Object(o.a)([Object(b.b)({type:String,json:{write:!0}})],T.prototype,"formatOf3DObjects",void 0),Object(o.a)([Object(b.b)({type:String,json:{write:!0}})],T.prototype,"gdbVersion",void 0),Object(o.a)([Object(b.b)({types:c.a,json:{read:O.a,write:!0}})],T.prototype,"geometry",void 0),Object(o.a)([Object(b.b)({type:Number,json:{write:!0}})],T.prototype,"geometryPrecision",void 0),Object(o.a)([Object(b.b)({type:[String],json:{write:!0}})],T.prototype,"groupByFieldsForStatistics",void 0),Object(o.a)([Object(b.b)({type:String,json:{write:!0}})],T.prototype,"having",void 0),Object(o.a)([Object(b.b)({type:Date})],T.prototype,"historicMoment",void 0),Object(o.a)([Object(g.a)("historicMoment")],T.prototype,"writeHistoricMoment",null),Object(o.a)([Object(b.b)({type:Number,json:{write:!0}})],T.prototype,"maxAllowableOffset",void 0),Object(o.a)([Object(b.b)({type:Number,cast:function(e){return e<1?1:e>n.MAX_MAX_RECORD_COUNT_FACTOR?n.MAX_MAX_RECORD_COUNT_FACTOR:e},json:{write:{overridePolicy:function(e){return{enabled:e>1}}}}})],T.prototype,"maxRecordCountFactor",void 0),Object(o.a)([Object(b.b)({type:["xyFootprint"],json:{write:!0}})],T.prototype,"multipatchOption",void 0),Object(o.a)([Object(b.b)({type:Number,json:{read:{source:"resultRecordCount"}}})],T.prototype,"num",void 0),Object(o.a)([Object(b.b)({json:{write:!0}})],T.prototype,"objectIds",void 0),Object(o.a)([Object(b.b)({type:[String],json:{write:!0}})],T.prototype,"orderByFields",void 0),Object(o.a)([Object(b.b)({type:[String],json:{write:!0}})],T.prototype,"outFields",void 0),Object(o.a)([Object(b.b)({type:_.a,json:{name:"outSR",write:!0}})],T.prototype,"outSpatialReference",void 0),Object(o.a)([Object(b.b)({type:[w.a],json:{write:{enabled:!0,overridePolicy:function(){return{enabled:Object(p.j)(this.outStatistics)&&this.outStatistics.length>0}}}}})],T.prototype,"outStatistics",void 0),Object(o.a)([Object(b.b)({json:{write:!0}})],T.prototype,"parameterValues",void 0),Object(o.a)([Object(g.a)("parameterValues")],T.prototype,"writeParameterValues",null),Object(o.a)([Object(b.b)({type:S.a,json:{write:!0}})],T.prototype,"pixelSize",void 0),Object(o.a)([Object(b.b)({type:k.a,json:{write:!0}})],T.prototype,"quantizationParameters",void 0),Object(o.a)([Object(b.b)({type:[Object],json:{write:!0}})],T.prototype,"rangeValues",void 0),Object(o.a)([Object(b.b)({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy:function(){return{enabled:"relation"===this.spatialRelationship}}}}})],T.prototype,"relationParameter",void 0),Object(o.a)([Object(b.b)({type:String,json:{write:!0}})],T.prototype,"resultType",void 0),Object(o.a)([Object(b.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"returnCentroid",void 0),Object(o.a)([Object(b.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"returnDistinctValues",void 0),Object(o.a)([Object(b.b)({type:Boolean,json:{default:!0,write:!0}})],T.prototype,"returnExceededLimitFeatures",void 0),Object(o.a)([Object(b.b)({type:Boolean,json:{write:!0}})],T.prototype,"returnGeometry",void 0),Object(o.a)([Object(b.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"returnQueryGeometry",void 0),Object(o.a)([Object(b.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"returnM",void 0),Object(o.a)([Object(b.b)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],T.prototype,"returnZ",void 0),Object(o.a)([Object(b.b)({type:_.a,json:{write:!0}})],T.prototype,"sourceSpatialReference",void 0),Object(o.a)([Object(v.a)(I,{ignoreUnknown:!1,name:"spatialRel"})],T.prototype,"spatialRelationship",void 0),Object(o.a)([Object(b.b)({type:Number,json:{read:{source:"resultOffset"}}})],T.prototype,"start",void 0),Object(o.a)([Object(g.a)("start"),Object(g.a)("num")],T.prototype,"writeStart",null),Object(o.a)([Object(b.b)({type:String,json:{write:!0}})],T.prototype,"sqlFormat",void 0),Object(o.a)([Object(b.b)({type:String,json:{write:!0}})],T.prototype,"text",void 0),Object(o.a)([Object(b.b)({type:l.a,json:{write:!0}})],T.prototype,"timeExtent",void 0),Object(o.a)([Object(b.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"timeReferenceUnknownClient",void 0),Object(o.a)([Object(v.a)(F,{ignoreUnknown:!1}),Object(b.b)({json:{write:{overridePolicy:function(e){return{enabled:e&&this.distance>0}}}}})],T.prototype,"units",void 0),Object(o.a)([Object(b.b)({type:String,json:{write:{overridePolicy:function(e){return{enabled:null!=e||this.start>0}}}}})],T.prototype,"where",void 0),Object(o.a)([Object(g.a)("where")],T.prototype,"writeWhere",null);var R=T=n=Object(o.a)([Object(m.a)("esri.rest.support.Query")],T)},672:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(21),i=r(2),a=r(4);function s(e){return"date"===e.type||"esriFieldTypeDate"===e.type}var u=function(){function e(t){if(Object(i.a)(this,e),this.fields=t,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],t){var r,a=[],u=Object(n.a)(t);try{for(u.s();!(r=u.n()).done;){var c=r.value,l=c&&c.name;if(l){var h=o(l);this._fieldsMap.set(l,c),this._fieldsMap.set(h,c),a.push(h),s(c)&&(this.dateFields.push(c),this._dateFieldsSet.add(c))}}}catch(f){u.e(f)}finally{u.f()}a.sort(),this.uid=a.join(",")}}return Object(a.a)(e,[{key:"destroy",value:function(){this._fieldsMap.clear()}},{key:"has",value:function(e){return null!=this.get(e)}},{key:"get",value:function(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(o(e)):void 0}},{key:"isDateField",value:function(e){return this._dateFieldsSet.has(this.get(e))}},{key:"normalizeFieldName",value:function(e){var t=this.get(e);if(t)return t.name}}]),e}();function o(e){return e.toLowerCase().trim()}},673:function(e,t,r){"use strict";r.d(t,"a",(function(){return N}));var n,i,a=r(2),s=r(4),u=r(5),o=r(6),c=r(0),l=r(42),h=r(26),f=r(1),d=(r(19),r(97)),p=(r(15),r(31)),b=r(57),y=r(10),v=r(14),m=r(212),g=r(666),j=r(711),O=(r(114),r(45)),x=r(236),k=n=function(e){Object(u.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).type="query-table",n}return Object(s.a)(r,[{key:"clone",value:function(){var e,t=this.workspaceId,r=this.query,i=this.oidFields,a=this.spatialReference,s=this.geometryType,u={workspaceId:t,query:r,oidFields:i,spatialReference:null!=(e=null==a?void 0:a.clone())?e:void 0,geometryType:s};return new n(u)}}]),r}(h.a);Object(c.a)([Object(p.a)({queryTable:"query-table"})],k.prototype,"type",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],k.prototype,"workspaceId",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],k.prototype,"query",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],k.prototype,"oidFields",void 0),Object(c.a)([Object(f.b)({type:O.a,json:{write:!0}})],k.prototype,"spatialReference",void 0),Object(c.a)([Object(p.a)(x.a)],k.prototype,"geometryType",void 0),k=n=Object(c.a)([Object(y.a)("esri.layers.support.source.QueryTableDataSource")],k);var w,_=i=function(e){Object(u.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).type="raster",n}return Object(s.a)(r,[{key:"clone",value:function(){var e=this.workspaceId,t=this.dataSourceName;return new i({workspaceId:e,dataSourceName:t})}}]),r}(h.a);Object(c.a)([Object(p.a)({raster:"raster"})],_.prototype,"type",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],_.prototype,"dataSourceName",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],_.prototype,"workspaceId",void 0),_=i=Object(c.a)([Object(y.a)("esri.layers.support.source.RasterDataSource")],_);var S,I,F=w=function(e){Object(u.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).type="table",n}return Object(s.a)(r,[{key:"clone",value:function(){var e=this.workspaceId,t=this.gdbVersion,r=this.dataSourceName;return new w({workspaceId:e,gdbVersion:t,dataSourceName:r})}}]),r}(h.a);Object(c.a)([Object(p.a)({table:"table"})],F.prototype,"type",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],F.prototype,"workspaceId",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],F.prototype,"gdbVersion",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],F.prototype,"dataSourceName",void 0),F=w=Object(c.a)([Object(y.a)("esri.layers.support.source.TableDataSource")],F);var T=Object(l.b)()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"}),R=S=function(e){Object(u.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).type="join-table",n}return Object(s.a)(r,[{key:"readLeftTableSource",value:function(e,t,r){return P()(e,t,r)}},{key:"castLeftTableSource",value:function(e){return Object(v.k)(E(),e)}},{key:"readRightTableSource",value:function(e,t,r){return P()(e,t,r)}},{key:"castRightTableSource",value:function(e){return Object(v.k)(E(),e)}},{key:"clone",value:function(){var e,t,r=this.leftTableKey,n=this.rightTableKey,i=this.leftTableSource,a=this.rightTableSource,s=this.joinType,u={leftTableKey:r,rightTableKey:n,leftTableSource:null!=(e=null==i?void 0:i.clone())?e:void 0,rightTableSource:null!=(t=null==a?void 0:a.clone())?t:void 0,joinType:s};return new S(u)}}]),r}(h.a);Object(c.a)([Object(p.a)({joinTable:"join-table"})],R.prototype,"type",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],R.prototype,"leftTableKey",void 0),Object(c.a)([Object(f.b)({type:String,json:{write:!0}})],R.prototype,"rightTableKey",void 0),Object(c.a)([Object(f.b)({json:{write:!0}})],R.prototype,"leftTableSource",void 0),Object(c.a)([Object(b.a)("leftTableSource")],R.prototype,"readLeftTableSource",null),Object(c.a)([Object(d.a)("leftTableSource")],R.prototype,"castLeftTableSource",null),Object(c.a)([Object(f.b)({json:{write:!0}})],R.prototype,"rightTableSource",void 0),Object(c.a)([Object(b.a)("rightTableSource")],R.prototype,"readRightTableSource",null),Object(c.a)([Object(d.a)("rightTableSource")],R.prototype,"castRightTableSource",null),Object(c.a)([Object(p.a)(T)],R.prototype,"joinType",void 0),R=S=Object(c.a)([Object(y.a)("esri.layers.support.source.JoinTableDataSource")],R);var M=null;function P(){return M||(M=Object(m.b)({types:E()})),M}var C=null;function E(){return C||(C={key:"type",base:null,typeMap:{"data-layer":N,"map-layer":j.a}}),C}var A={key:"type",base:null,typeMap:{"join-table":R,"query-table":k,raster:_,table:F}},N=I=function(e){Object(u.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).type="data-layer",n}return Object(s.a)(r,[{key:"clone",value:function(){var e=this.fields,t=this.dataSource;return new I({fields:e,dataSource:t})}}]),r}(h.a);Object(c.a)([Object(p.a)({dataLayer:"data-layer"})],N.prototype,"type",void 0),Object(c.a)([Object(f.b)({type:[g.a],json:{write:!0}})],N.prototype,"fields",void 0),Object(c.a)([Object(f.b)({types:A,json:{write:!0}})],N.prototype,"dataSource",void 0),(N=I=Object(c.a)([Object(y.a)("esri.layers.support.source.DataLayerSource")],N)).from=Object(v.m)(N)},678:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=r(26),l=r(692),h=r(1),f=(r(19),r(14),r(15),r(10)),d=r(669),p=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).value=0,n.unit="milliseconds",n}return Object(a.a)(r,[{key:"toMilliseconds",value:function(){return Object(l.a)(this.value,this.unit,"milliseconds")}},{key:"clone",value:function(){return new n({value:this.value,unit:this.unit})}}]),r}(c.a);Object(o.a)([Object(h.b)({type:Number,json:{write:!0},nonNullable:!0})],p.prototype,"value",void 0),Object(o.a)([Object(h.b)({type:d.a.apiValues,json:{type:d.a.jsonValues,read:d.a.read,write:d.a.write},nonNullable:!0})],p.prototype,"unit",void 0);var b=p=n=Object(o.a)([Object(f.a)("esri.TimeInterval")],p)},679:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return u}));r(19);var n=r(664),i=r(660),a=r(661),s=r(662),u={key:"type",base:i.a,typeMap:{range:s.a,"coded-value":n.a,inherited:a.a}};function o(e){if(!e||!e.type)return null;switch(e.type){case"range":return s.a.fromJSON(e);case"codedValue":return n.a.fromJSON(e);case"inherited":return a.a.fromJSON(e)}return null}},690:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=new(r(42).a)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})},692:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return s}));r(19);var n={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8},i={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};function a(e,t,r){var n=new Date(e.getTime());if(t&&r){var a=i[r],s=a.getter,u=a.setter,o=a.multiplier;n[u](n[s]()+t*o)}return n}function s(e,t){switch(t){case"milliseconds":return new Date(e.getTime());case"seconds":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());case"minutes":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());case"hours":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours());case"days":return new Date(e.getFullYear(),e.getMonth(),e.getDate());case"weeks":return new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay());case"months":return new Date(e.getFullYear(),e.getMonth(),1);case"years":return new Date(e.getFullYear(),0,1);case"decades":return new Date(e.getFullYear()-e.getFullYear()%10,0,1);case"centuries":return new Date(e.getFullYear()-e.getFullYear()%100,0,1);default:return new Date}}function u(e,t,r){return 0===e?0:e*n[t]/n[r]}},696:function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return C}));var n=r(7),i=r.n(n),a=r(22),s=r(12),u=r(21),o=r(68),c=r(29),l=r(15),h=r(11),f=r(108),d=r(107),p=r(732),b=r(53),y=r(71),v=r(13),m=(r(114),r(82)),g=r(27),j=r(62);function O(e,t,r,n){return x.apply(this,arguments)}function x(){return(x=Object(s.a)(i.a.mark((function e(t,r,n,a){var s,u,o,c,l,h,f,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="string"==typeof t?Object(g.J)(t):t,u=r[0].spatialReference,o=Object(v.a)(Object(v.a)({},a),{},{query:Object(v.a)(Object(v.a)({},s.query),{},{f:"json",sr:JSON.stringify(u),target:JSON.stringify({geometryType:Object(j.c)(r[0]),geometries:r}),cutter:JSON.stringify(n)})}),e.next=5,Object(m.default)(s.path+"/cut",o);case 5:return c=e.sent,l=c.data,h=l.cutIndexes,f=l.geometries,d=void 0===f?[]:f,e.abrupt("return",{cutIndexes:h,geometries:d.map((function(e){var t=Object(j.a)(e);return t.spatialReference=u,t}))});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t,r){return w.apply(this,arguments)}function w(){return(w=Object(s.a)(i.a.mark((function e(t,r,n){var a,s,u,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="string"==typeof t?Object(g.J)(t):t,s=r[0].spatialReference,u=Object(j.c)(r[0]),o=Object(v.a)(Object(v.a)({},n),{},{query:Object(v.a)(Object(v.a)({},a.query),{},{f:"json",sr:s.wkid?s.wkid:JSON.stringify(s),geometries:JSON.stringify(_(r))})}),e.t0=S,e.next=4,Object(m.default)(a.path+"/simplify",o);case 4:return e.t1=e.sent.data,e.t2=u,e.t3=s,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return{geometryType:Object(j.c)(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}function S(e,t,r){var n=Object(j.b)(t);return e.map((function(e){var t=n.fromJSON(e);return t.spatialReference=r,t}))}var I=l.a.getLogger("esri.geometry.support.normalizeUtils");function F(e,t,r){if(t){var n=function(e,t){if(!(e instanceof d.a||e instanceof f.a)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw I.error(r),new c.a(r)}var n,i=Object(p.b)(e),a=[],s=Object(u.a)(i);try{for(s.s();!(n=s.n()).done;){var o=n.value,l=[];a.push(l),l.push([o[0][0],o[0][1]]);for(var h=0;h<o.length-1;h++){var b=o[h][0],y=o[h][1],v=o[h+1][0],m=o[h+1][1],g=Math.sqrt((v-b)*(v-b)+(m-y)*(m-y)),j=(m-y)/g,O=(v-b)/g,x=g/t;if(x>1){for(var k=1;k<=x-1;k++){var w=k*t,_=O*w+b,S=j*w+y;l.push([_,S])}var F=(g+Math.floor(x-1)*t)/2,T=O*F+b,R=j*F+y;l.push([T,R])}l.push([v,m])}}}catch(M){s.e(M)}finally{s.f()}return function(e){return"polygon"===e.type}(e)?new f.a({rings:a,spatialReference:e.spatialReference}):new d.a({paths:a,spatialReference:e.spatialReference})}(e,1e6);e=Object(y.e)(n,!0)}return r&&(e=Object(p.e)(e,r)),e}function T(e,t,r){if(Array.isArray(e)){var n=e[0];if(n>t){var i=Object(p.d)(n,t);e[0]=n+i*(-2*t)}else if(n<r){var a=Object(p.d)(n,r);e[0]=n+a*(-2*r)}}else{var s=e.x;if(s>t){var u=Object(p.d)(s,t);e=e.clone().offset(u*(-2*t),0)}else if(s<r){var o=Object(p.d)(s,r);e=e.clone().offset(o*(-2*r),0)}}return e}function R(e,t){for(var r=-1,n=function(n){for(var i=t.cutIndexes[n],a=t.geometries[n],s=Object(p.b)(a),o=function(e){var t=s[e];t.some((function(r){if(r[0]<180)return!0;for(var n=0,i=0;i<t.length;i++){var s=t[i][0];n=s>n?s:n}n=Number(n.toFixed(9));for(var u=-360*Object(p.d)(n,180),o=0;o<t.length;o++){var c=a.getPoint(e,o);a.setPoint(e,o,c.clone().offset(u,0))}return!0}))},c=0;c<s.length;c++)o(c);if(i===r){if(function(e){return"polygon"===e[0].type}(e)){var l,h=Object(u.a)(Object(p.b)(a));try{for(h.s();!(l=h.n()).done;){var f=l.value;e[i]=e[i].addRing(f)}}catch(v){h.e(v)}finally{h.f()}}else if(function(e){return"polyline"===e[0].type}(e)){var d,b=Object(u.a)(Object(p.b)(a));try{for(b.s();!(d=b.n()).done;){var y=d.value;e[i]=e[i].addPath(y)}}catch(v){b.e(v)}finally{b.f()}}}else r=i,e[i]=a},i=0;i<t.cutIndexes.length;i++)n(i);return e}function M(e,t,r){return P.apply(this,arguments)}function P(){return(P=Object(s.a)(i.a.mark((function e(t,r,n){var a,s,c,l,v,m,g,j,x,w,_,S,I,P,C,E,A,N,z,V,D,B,q,Q,G,L,U,Z,J,H,Y,W,X,K,$,ee,te,re,ne,ie;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)){e.next=2;break}return e.abrupt("return",M([t],r));case 2:a=r?r.url:o.a.geometryServiceUrl,w=0,_=[],S=[],I=Object(u.a)(t);try{for(I.s();!(P=I.n()).done;)C=P.value,Object(h.i)(C)?S.push(C):(s||(s=C.spatialReference,c=Object(b.e)(s),l=s.isWebMercator,g=l?102100:4326,v=p.a[g].maxX,m=p.a[g].minX,j=p.a[g].plus180Line,x=p.a[g].minus180Line),c?"mesh"===C.type?S.push(C):"point"===C.type?S.push(T(C.clone(),v,m)):"multipoint"===C.type?((E=C.clone()).points=E.points.map((function(e){return T(e,v,m)})),S.push(E)):"extent"===C.type?(A=C.clone()._normalize(!1,!1,c),S.push(A.rings?new f.a(A):A)):C.extent?(N=C.extent,z=Object(p.d)(N.xmin,m)*(2*v),V=0===z?C.clone():Object(p.e)(C.clone(),z),N.offset(z,0),N.intersects(j)&&N.xmax!==v?(w=N.xmax>w?N.xmax:w,V=F(V,l),_.push(V),S.push("cut")):N.intersects(x)&&N.xmin!==m?(w=N.xmax*(2*v)>w?N.xmax*(2*v):w,V=F(V,l,360),_.push(V),S.push("cut")):S.push(V)):S.push(C.clone()):S.push(C))}catch(i){I.e(i)}finally{I.f()}for(D=Object(p.d)(w,v),B=-90,q=D,Q=new d.a;D>0;)G=360*D-180,Q.addPath([[G,B],[G,-1*B]]),B*=-1,D--;if(!(_.length>0&&q>0)){e.next=28;break}return e.t0=R,e.t1=_,e.next=15,O(a,_,Q,n);case 15:for(e.t2=e.sent,L=(0,e.t0)(e.t1,e.t2),U=[],Z=[],J=0;J<S.length;J++)"cut"!==(H=S[J])?Z.push(H):(Y=L.shift(),W=t[J],Object(h.j)(W)&&"polygon"===W.type&&W.rings&&W.rings.length>1&&Y.rings.length>=W.rings.length?(U.push(Y),Z.push("simplify")):Z.push(l?Object(y.b)(Y):Y));if(U.length){e.next=22;break}return e.abrupt("return",Z);case 22:return e.next=24,k(a,U,n);case 24:for(X=e.sent,K=[],$=0;$<Z.length;$++)"simplify"!==(ee=Z[$])?K.push(ee):K.push(l?Object(y.b)(X.shift()):X.shift());return e.abrupt("return",K);case 28:for(te=[],re=0;re<S.length;re++)"cut"!==(ne=S[re])?te.push(ne):(ie=_.shift(),te.push(!0===l?Object(y.b)(ie):ie));return e.abrupt("return",Promise.resolve(te));case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){var r=Object(b.e)(t);if(r){var n=Object(a.a)(r.valid,2),i=n[0],s=n[1],u=s-i;if(e<i)for(;e<i;)e+=u;if(e>s)for(;e>s;)e-=u}return e}},698:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=r(665),l=r(678),h=r(26),f=r(18),d=r(11),p=r(1),b=(r(14),r(19),r(15),r(57)),y=r(10),v=r(43),m=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).respectsDaylightSaving=!1,n.timezone=null,n}return Object(a.a)(r,[{key:"readRespectsDaylightSaving",value:function(e,t){return void 0!==t.respectsDaylightSaving?t.respectsDaylightSaving:void 0!==t.respectDaylightSaving&&t.respectDaylightSaving}},{key:"clone",value:function(){var e=this.respectsDaylightSaving,t=this.timezone;return new n({respectsDaylightSaving:e,timezone:t})}}]),r}(h.a);Object(o.a)([Object(p.b)({type:Boolean,json:{write:!0}})],m.prototype,"respectsDaylightSaving",void 0),Object(o.a)([Object(b.a)("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],m.prototype,"readRespectsDaylightSaving",null),Object(o.a)([Object(p.b)({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],m.prototype,"timezone",void 0);var g,j=m=n=Object(o.a)([Object(y.a)("esri.layers.support.TimeReference")],m),O=r(669),x=g=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).cumulative=!1,n.endField=null,n.fullTimeExtent=null,n.hasLiveData=!1,n.interval=null,n.startField=null,n.timeReference=null,n.trackIdField=null,n.useTime=!0,n}return Object(a.a)(r,[{key:"readFullTimeExtent",value:function(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;var r=new Date(t.timeExtent[0]),n=new Date(t.timeExtent[1]);return new c.a({start:r,end:n})}},{key:"writeFullTimeExtent",value:function(e,t){e&&Object(d.j)(e.start)&&Object(d.j)(e.end)?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}},{key:"readInterval",value:function(e,t){return t.timeInterval&&t.timeIntervalUnits?new l.a({value:t.timeInterval,unit:O.a.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new l.a({value:t.defaultTimeInterval,unit:O.a.fromJSON(t.defaultTimeIntervalUnits)}):null}},{key:"writeInterval",value:function(e,t){if(e){var r=e.toJSON();t.timeInterval=r.value,t.timeIntervalUnits=r.unit}else t.timeInterval=null,t.timeIntervalUnits=null}},{key:"clone",value:function(){var e=this.cumulative,t=this.endField,r=this.hasLiveData,n=this.interval,i=this.startField,a=this.timeReference,s=this.fullTimeExtent,u=this.trackIdField,o=this.useTime;return new g({cumulative:e,endField:t,hasLiveData:r,interval:n,startField:i,timeReference:Object(f.a)(a),fullTimeExtent:Object(f.a)(s),trackIdField:u,useTime:o})}}]),r}(h.a);Object(o.a)([Object(p.b)({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],x.prototype,"cumulative",void 0),Object(o.a)([Object(p.b)({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],x.prototype,"endField",void 0),Object(o.a)([Object(p.b)({type:c.a,json:{write:{enabled:!0,allowNull:!0}}})],x.prototype,"fullTimeExtent",void 0),Object(o.a)([Object(b.a)("fullTimeExtent",["timeExtent"])],x.prototype,"readFullTimeExtent",null),Object(o.a)([Object(v.a)("fullTimeExtent")],x.prototype,"writeFullTimeExtent",null),Object(o.a)([Object(p.b)({type:Boolean,json:{write:!0}})],x.prototype,"hasLiveData",void 0),Object(o.a)([Object(p.b)({type:l.a,json:{write:{enabled:!0,allowNull:!0}}})],x.prototype,"interval",void 0),Object(o.a)([Object(b.a)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],x.prototype,"readInterval",null),Object(o.a)([Object(v.a)("interval")],x.prototype,"writeInterval",null),Object(o.a)([Object(p.b)({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],x.prototype,"startField",void 0),Object(o.a)([Object(p.b)({type:j,json:{write:{enabled:!0,allowNull:!0}}})],x.prototype,"timeReference",void 0),Object(o.a)([Object(p.b)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],x.prototype,"trackIdField",void 0),Object(o.a)([Object(p.b)({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],x.prototype,"useTime",void 0);var k=x=g=Object(o.a)([Object(y.a)("esri.layers.support.TimeInfo")],x)},702:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return c}));var n=r(21),i=r(11),a=r(135),s=r(53);function u(e,t,r){if(Object(i.i)(t)||Object(i.i)(r)||r.vcsWkid||Object(s.d)(t,r))return null;var u=Object(a.e)(t)/Object(a.e)(r);if(1===u)return null;switch(e){case"point":case"esriGeometryPoint":return function(e){return function(e,t){e&&null!=e.z&&(e.z*=t)}(e,u)};case"polyline":case"esriGeometryPolyline":return function(e){return function(e,t){if(e){var r,i=Object(n.a)(e.paths);try{for(i.s();!(r=i.n()).done;){var a,s=r.value,u=Object(n.a)(s);try{for(u.s();!(a=u.n()).done;){var o=a.value;o.length>2&&(o[2]*=t)}}catch(c){u.e(c)}finally{u.f()}}}catch(c){i.e(c)}finally{i.f()}}}(e,u)};case"polygon":case"esriGeometryPolygon":return function(e){return function(e,t){if(e){var r,i=Object(n.a)(e.rings);try{for(i.s();!(r=i.n()).done;){var a,s=r.value,u=Object(n.a)(s);try{for(u.s();!(a=u.n()).done;){var o=a.value;o.length>2&&(o[2]*=t)}}catch(c){u.e(c)}finally{u.f()}}}catch(c){i.e(c)}finally{i.f()}}}(e,u)};case"multipoint":case"esriGeometryMultipoint":return function(e){return function(e,t){if(e){var r,i=Object(n.a)(e.points);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.length>2&&(a[2]*=t)}}catch(s){i.e(s)}finally{i.f()}}}(e,u)};default:return null}}function o(e,t,r){if(null==e.hasM||e.hasZ){var i,a=Object(n.a)(t);try{for(a.s();!(i=a.n()).done;){var s,u=i.value,o=Object(n.a)(u);try{for(o.s();!(s=o.n()).done;){var c=s.value;c.length>2&&(c[2]*=r)}}catch(l){o.e(l)}finally{o.f()}}}catch(l){a.e(l)}finally{a.f()}}}function c(e,t,r){if((e||t)&&r){var n=Object(a.e)(r);l(e,r,n),l(t,r,n)}}function l(e,t,r){if(e){var i,a=Object(n.a)(e);try{for(a.s();!(i=a.n()).done;){h(i.value.geometry,t,r)}}catch(s){a.e(s)}finally{a.f()}}}function h(e,t,r){if(!Object(i.i)(e)&&e.spatialReference&&!Object(s.d)(e.spatialReference,t)){var u=Object(a.e)(e.spatialReference)/r;if(1!==u)if("x"in e)null!=e.z&&(e.z*=u);else if("rings"in e)o(e,e.rings,u);else if("paths"in e)o(e,e.paths,u);else if("points"in e&&(null==e.hasM||e.hasZ)){var c,l=Object(n.a)(e.points);try{for(l.s();!(c=l.n()).done;){var h=c.value;h.length>2&&(h[2]*=u)}}catch(f){l.e(f)}finally{l.f()}}}}},708:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return c}));var n=r(22),i=r(21),a=r(2),s=r(4),u=r(297),o=function(){function e(t,r,n){Object(a.a)(this,e),this._namespace=t,this._storage=r,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",n&&(this._storage.registerRemoveFunc(this._namespace,n),this._removeFunc=!0)}return Object(s.a)(e,[{key:"destroy",value:function(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}},{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}},{key:"resetHitRate",value:function(){this._hit=this._miss=0}},{key:"put",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._storage.put(this._namespace+e,t,r,n)}},{key:"get",value:function(e){var t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"pop",value:function(e){var t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"updateSize",value:function(e,t,r){this._storage.updateSize(this._namespace+e,t,r)}},{key:"clear",value:function(){this._storage.clear(this._namespace)}},{key:"clearAll",value:function(){this._storage.clearAll()}},{key:"getStats",value:function(){return this._storage.getStats()}},{key:"resetStats",value:function(){this._storage.resetStats()}}]),e}(),c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10485760;Object(a.a)(this,e),this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new u.a,this._users=new u.a}return Object(s.a)(e,[{key:"destroy",value:function(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}},{key:"register",value:function(e){this._users.push(e)}},{key:"deregister",value:function(e){this._users.removeUnordered(e)}},{key:"registerRemoveFunc",value:function(e,t){this._removeFuncs.push([e,t])}},{key:"deregisterRemoveFunc",value:function(e){this._removeFuncs.filterInPlace((function(t){return t[0]!==e}))}},{key:"size",get:function(){return this._size}},{key:"maxSize",get:function(){return this._maxSize},set:function(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}},{key:"put",value:function(e,t,r,n){var i=this._db.get(e);if(i&&(this._size-=i.size,this._db.delete(e),i.entry!==t&&this._notifyRemoved(e,i.entry)),r>this._maxSize)this._notifyRemoved(e,t);else if(void 0!==t)if(!r||r<0)console.warn("Refusing to cache entry with invalid size "+r);else{var a=1+Math.max(n,-3)- -3;this._db.set(e,{entry:t,size:r,lifetime:a,lives:a}),this._size+=r,this._checkSizeLimit()}else console.warn("Refusing to cache undefined entry ")}},{key:"updateSize",value:function(e,t,r){var n=this._db.get(e);if(n&&n.entry===t){if(this._size-=n.size,r>this._maxSize)return this._db.delete(e),void this._notifyRemoved(e,t);n.size=r,this._size+=r,this._checkSizeLimit()}}},{key:"pop",value:function(e){var t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}},{key:"get",value:function(e){var t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}},{key:"getStats",value:function(){var e=this,t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},r={},n=new Array;this._db.forEach((function(t,i){var a=t.lifetime;n[a]=(n[a]||0)+t.size,e._users.forAll((function(e){var n=e.namespace;if(i.startsWith(n)){var a=r[n]||0;r[n]=a+t.size}}))}));var i={};this._users.forAll((function(e){var t=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){var n=r[t]||0;r[t]=n,i[t]=Math.round(100*e.hitRate)+"%"}else i[t]="0%"}));var a=Object.keys(r);a.forEach((function(t){return r[t]=r[t]/e._size*100})),a.sort((function(e,t){return r[t]-r[e]})),a.forEach((function(e){return t[e]=Math.round(r[e])+"% / "+i[e]}));for(var s=n.length-1;s>=0;--s){var u=n[s];u&&(t["Priority "+(s+-3-1)]=Math.round(u/this.size*100)+"%")}return t}},{key:"resetStats",value:function(){this._hit=this._miss=0,this._users.forAll((function(e){return e.resetHitRate()}))}},{key:"clear",value:function(e){var t=this;this._db.forEach((function(r,n){n.startsWith(e)&&(t._size-=r.size,t._db.delete(n),t._notifyRemoved(n,r.entry))}))}},{key:"clearAll",value:function(){var e=this;this._db.forEach((function(t,r){return e._notifyRemoved(r,t.entry)})),this._size=0,this._db.clear()}},{key:"_getHitRate",value:function(){return this._hit/(this._hit+this._miss)}},{key:"_notifyRemoved",value:function(e,t){this._removeFuncs.forAll((function(r){e.startsWith(r[0])&&r[1](t)}))}},{key:"_checkSizeLimit",value:function(){if(!(this._size<=this._maxSize)){var e,t=Object(i.a)(this._db);try{for(t.s();!(e=t.n()).done;){var r=Object(n.a)(e.value,2),a=r[0],s=r[1];if(this._db.delete(a),s.lives<=1?(this._size-=s.size,this._notifyRemoved(a,s.entry)):(--s.lives,this._db.set(a,s)),this._size<=.9*this.maxSize)return}}catch(u){t.e(u)}finally{t.f()}}}}]),e}()},711:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=r(26),l=r(1),h=(r(19),r(14)),f=(r(15),r(31)),d=r(10),p=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).type="map-layer",n}return Object(a.a)(r,[{key:"clone",value:function(){var e=this.mapLayerId,t=this.gdbVersion;return new n({mapLayerId:e,gdbVersion:t})}}]),r}(c.a);Object(o.a)([Object(f.a)({mapLayer:"map-layer"})],p.prototype,"type",void 0),Object(o.a)([Object(l.b)({type:h.a,json:{write:!0}})],p.prototype,"mapLayerId",void 0),Object(o.a)([Object(l.b)({type:String,json:{write:!0}})],p.prototype,"gdbVersion",void 0),p=n=Object(o.a)([Object(d.a)("esri.layers.support.source.MapLayerSource")],p)},714:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=r(42),l=r(26),h=r(18),f=r(1),d=(r(14),r(19),r(15),r(10)),p=r(43),b=new c.a({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete"}),y=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).maxPointCount=void 0,n.maxRecordCount=void 0,n.maxVertexCount=void 0,n.onStatisticField=null,n.outStatisticFieldName=null,n.statisticType=null,n.statisticParameters=null,n}return Object(a.a)(r,[{key:"writeStatisticParameters",value:function(e,t){"percentile-continuous"!==this.statisticType&&"percentile-discrete"!==this.statisticType||(t.statisticParameters=Object(h.a)(e))}},{key:"clone",value:function(){return new n({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:Object(h.a)(this.statisticParameters)})}}]),r}(l.a);Object(o.a)([Object(f.b)({type:Number,json:{write:!0}})],y.prototype,"maxPointCount",void 0),Object(o.a)([Object(f.b)({type:Number,json:{write:!0}})],y.prototype,"maxRecordCount",void 0),Object(o.a)([Object(f.b)({type:Number,json:{write:!0}})],y.prototype,"maxVertexCount",void 0),Object(o.a)([Object(f.b)({type:String,json:{write:!0}})],y.prototype,"onStatisticField",void 0),Object(o.a)([Object(f.b)({type:String,json:{write:!0}})],y.prototype,"outStatisticFieldName",void 0),Object(o.a)([Object(f.b)({type:String,json:{read:{source:"statisticType",reader:b.read},write:{target:"statisticType",writer:b.write}}})],y.prototype,"statisticType",void 0),Object(o.a)([Object(f.b)({type:Object})],y.prototype,"statisticParameters",void 0),Object(o.a)([Object(p.a)("statisticParameters")],y.prototype,"writeStatisticParameters",null);var v=y=n=Object(o.a)([Object(d.a)("esri.rest.support.StatisticDefinition")],y)},717:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=(r(114),r(42)),l=r(26),h=r(18),f=r(1),d=(r(14),r(19),r(15),r(10)),p=r(58),b=new c.a({upperLeft:"upper-left",lowerLeft:"lower-left"}),y=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).extent=null,n.mode="view",n.originPosition="upper-left",n.tolerance=1,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n(Object(h.a)({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}}]),r}(l.a);Object(o.a)([Object(f.b)({type:p.a,json:{write:{overridePolicy:function(){return{enabled:"view"===this.mode}}}}})],y.prototype,"extent",void 0),Object(o.a)([Object(f.b)({type:["view","edit"],json:{write:!0}})],y.prototype,"mode",void 0),Object(o.a)([Object(f.b)({type:String,json:{read:b.read,write:b.write}})],y.prototype,"originPosition",void 0),Object(o.a)([Object(f.b)({type:Number,json:{write:{overridePolicy:function(){return{enabled:"view"===this.mode}}}}})],y.prototype,"tolerance",void 0);var v=y=n=Object(o.a)([Object(d.a)("esri.rest.support.QuantizationParameters")],y)},718:function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return k})),r.d(t,"c",(function(){return S}));var n=r(7),i=r.n(n),a=r(2),s=r(4),u=r(12),o=r(21),c=r(22),l=r(11),h=r(750),f=r(770),d=r(53),p=r(71),b=[0,0];function y(e,t){if(!t)return null;if("x"in t){var r,n,i={x:0,y:0};return r=e(t.x,t.y,b),n=Object(c.a)(r,2),i.x=n[0],i.y=n[1],null!=t.z&&(i.z=t.z),null!=t.m&&(i.m=t.m),i}if("xmin"in t){var a,s,u,o,l={xmin:0,ymin:0,xmax:0,ymax:0};return a=e(t.xmin,t.ymin,b),s=Object(c.a)(a,2),l.xmin=s[0],l.ymin=s[1],u=e(t.xmax,t.ymax,b),o=Object(c.a)(u,2),l.xmax=o[0],l.ymax=o[1],t.hasZ&&(l.zmin=t.zmin,l.zmax=t.zmax,l.hasZ=!0),t.hasM&&(l.mmin=t.mmin,l.mmax=t.mmax,l.hasM=!0),l}return"rings"in t?{rings:v(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:v(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:m(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function v(e,t){var r,n=[],i=Object(o.a)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.push(m(a,t))}}catch(s){i.e(s)}finally{i.f()}return n}function m(e,t){var r,n=[],i=Object(o.a)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,s=t(a[0],a[1],[0,0]);n.push(s),a.length>2&&s.push(a[2]),a.length>3&&s.push(a[3])}}catch(u){i.e(u)}finally{i.f()}return n}function g(e,t){return j.apply(this,arguments)}function j(){return(j=Object(u.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return n=Array.isArray(t)?t.map((function(e){return Object(l.j)(e.geometry)&&e.geometry.spatialReference})):[t],e.next=5,Object(h.d)(n.map((function(e){return{source:e,dest:r}})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=y.bind(null,p.c),x=y.bind(null,p.f);function k(e,t,r){return e?(r||(r=t,t=e.spatialReference),Object(d.l)(t)&&Object(d.l)(r)&&!Object(d.d)(t,r)?Object(p.a)(t,r)?Object(d.p)(r)?O(e):x(e):Object(h.j)(f.a,[e],t,r,null)[0]:e):e}var w=function(){function e(){Object(a.a)(this,e),this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return Object(s.a)(e,[{key:"push",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r,n){var a,s=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length&&r&&n&&!Object(d.d)(r,n)){e.next=2;break}return e.abrupt("return",t);case 2:return a={geometries:t,inSpatialReference:r,outSpatialReference:n,resolve:null},e.abrupt("return",(this._jobs.push(a),new Promise((function(e){a.resolve=e,null===s._timer&&(s._timer=setTimeout(s._process,10))}))));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_process",value:function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,r=e.inSpatialReference,n=e.outSpatialReference,i=e.resolve;Object(p.a)(r,n)?Object(d.p)(n)?i(t.map(O)):i(t.map(x)):i(Object(h.j)(f.a,t,r,n,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}}]),e}(),_=new w;function S(e,t,r){return _.push(e,t,r)}},722:function(e,t,r){"use strict";r.r(t),r.d(t,"executeQuery",(function(){return v})),r.d(t,"executeQueryForCount",(function(){return k})),r.d(t,"executeQueryForExtent",(function(){return w})),r.d(t,"executeQueryForIds",(function(){return x})),r.d(t,"executeQueryPBF",(function(){return g})),r.d(t,"executeQueryPBFBuffer",(function(){return O})),r.d(t,"queryToQueryStringParameters",(function(){return y})),r.d(t,"runQuery",(function(){return _}));var n=r(7),i=r.n(n),a=r(13),s=r(12),u=r(82),o=r(11),c=r(27),l=r(62),h=r(696),f=r(782),d=r(723),p=r(757),b="Layer does not support extent calculation.";function y(e,t){var r=e.geometry,n=e.toJSON(),i=n;if(Object(o.j)(r)&&(i.geometry=JSON.stringify(r),i.geometryType=Object(l.c)(r),i.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),n.groupByFieldsForStatistics&&(i.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(",")),n.objectIds&&(i.objectIds=n.objectIds.join(",")),n.orderByFields&&(i.orderByFields=n.orderByFields.join(",")),!n.outFields||!n.returnDistinctValues&&(null!=t&&t.returnCountOnly||null!=t&&t.returnExtentOnly||null!=t&&t.returnIdsOnly)?delete i.outFields:-1!==n.outFields.indexOf("*")?i.outFields="*":i.outFields=n.outFields.join(","),n.outSR?i.outSR=n.outSR.wkid||JSON.stringify(n.outSR):r&&(n.returnGeometry||n.returnCentroid)&&(i.outSR=i.inSR),n.returnGeometry&&delete n.returnGeometry,n.outStatistics&&(i.outStatistics=JSON.stringify(n.outStatistics)),n.pixelSize&&(i.pixelSize=JSON.stringify(n.pixelSize)),n.quantizationParameters&&(i.quantizationParameters=JSON.stringify(n.quantizationParameters)),n.parameterValues&&(i.parameterValues=JSON.stringify(n.parameterValues)),n.rangeValues&&(i.rangeValues=JSON.stringify(n.rangeValues)),n.dynamicDataSource&&(i.layer=JSON.stringify({source:n.dynamicDataSource}),delete n.dynamicDataSource),n.timeExtent){var a=n.timeExtent,s=a.start,u=a.end;null==s&&null==u||(i.time=s===u?s:"".concat(null==s?"null":s,",").concat(null==u?"null":u)),delete n.timeExtent}return i}function v(e,t,r,n){return m.apply(this,arguments)}function m(){return(m=Object(s.a)(i.a.mark((function e(t,r,n,a){var s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(o.j)(r.timeExtent)||!r.timeExtent.isEmpty){e.next=4;break}e.t0={data:{features:[]}},e.next=7;break;case 4:return e.next=6,_(t,r,"json",a);case 6:e.t0=e.sent;case 7:return s=e.t0,e.abrupt("return",(Object(d.a)(r,n,s.data),s));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t,r,n){return j.apply(this,arguments)}function j(){return(j=Object(s.a)(i.a.mark((function e(t,r,n,a){var s,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(o.j)(r.timeExtent)||!r.timeExtent.isEmpty){e.next=2;break}return e.abrupt("return",Promise.resolve({data:n.createFeatureResult()}));case 2:return e.next=4,O(t,r,a);case 4:return s=e.sent,u=s,e.abrupt("return",(u.data=Object(f.a)(s.data,n),u));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e,t,r){return _(e,t,"pbf",r)}function x(e,t,r){return Object(o.j)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):_(e,t,"json",r,{returnIdsOnly:!0})}function k(e,t,r){return Object(o.j)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):_(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}function w(e,t,r){return Object(o.j)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):_(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(b);if(t.hasOwnProperty("count"))throw new Error(b);return e}))}function _(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s="string"==typeof e?Object(c.J)(e):e,l=t.geometry?[t.geometry]:[];return n.responseType="pbf"===r?"array-buffer":"json",Object(h.a)(l,null,n).then((function(e){var l=e&&e[0];Object(o.j)(l)&&((t=t.clone()).geometry=l);var h=Object(p.a)(Object(a.a)(Object(a.a)(Object(a.a)({},s.query),{},{f:r},i),y(t,i)));return Object(u.default)(Object(c.y)(s.path,"query"),Object(a.a)(Object(a.a)({},n),{},{query:Object(a.a)(Object(a.a)({},h),n.query)}))}))}},723:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(21),i=r(702);function a(e,t,r){if(r&&r.features&&r.hasZ){var a=Object(i.a)(r.geometryType,t,e.outSpatialReference);if(a){var s,u=Object(n.a)(r.features);try{for(u.s();!(s=u.n()).done;){a(s.value.geometry)}}catch(o){u.e(o)}finally{u.f()}}}}},726:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return d}));var n=r(2),i=r(4),a=r(5),s=r(6),u=r(0),o=r(60),c=r(183),l=r(1),h=r(10),f=r(763),d=function(e){var t=function(e){Object(a.a)(r,e);var t=Object(s.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"destroy",value:function(){this.destroyed||(this.handles.destroy(),this.updatingHandles.destroy())}},{key:"handles",get:function(){return this._get("handles")||new c.a}},{key:"updatingHandles",get:function(){return this._get("updatingHandles")||new f.a}}]),r}(e);return Object(u.a)([Object(l.b)({readOnly:!0})],t.prototype,"handles",null),Object(u.a)([Object(l.b)({readOnly:!0})],t.prototype,"updatingHandles",null),t=Object(u.a)([Object(h.a)("esri.core.HandleOwner")],t),t},p=function(e){Object(a.a)(r,e);var t=Object(s.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return r}(d(o.a));p=Object(u.a)([Object(h.a)("esri.core.HandleOwner")],p)},732:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return c}));var n=r(21),i=r(107),a=r(45),s=r(62),u={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new i.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:a.a.WebMercator}),minus180Line:new i.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:a.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new i.a({paths:[[[180,-180],[180,180]]],spatialReference:a.a.WGS84}),minus180Line:new i.a({paths:[[[-180,-180],[-180,180]]],spatialReference:a.a.WGS84})}};function o(e,t){return Math.ceil((e-t)/(2*t))}function c(e,t){var r,i=l(e),a=Object(n.a)(i);try{for(a.s();!(r=a.n()).done;){var s,u=r.value,o=Object(n.a)(u);try{for(o.s();!(s=o.n()).done;){s.value[0]+=t}}catch(c){o.e(c)}finally{o.f()}}}catch(c){a.e(c)}finally{a.f()}return e}function l(e){return Object(s.g)(e)?e.rings:e.paths}function h(e){var t=(null==e?void 0:e.isWebMercator)?102100:4326;return[u[t].minX,u[t].maxX]}},743:function(e,t,r){"use strict";r.d(t,"a",(function(){return I}));var n,i=r(13),a=r(2),s=r(4),u=r(5),o=r(6),c=r(0),l=r(42),h=r(26),f=r(11),d=r(135),p=r(1),b=(r(19),r(14)),y=(r(15),r(57)),v=r(10),m=r(43),g=r(48),j=r(45),O=r(333),x=r(53),k=r(71),w=r(768),_=new l.a({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"}),S=n=function(e){Object(u.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).dpi=96,n.format=null,n.origin=null,n.minScale=0,n.maxScale=0,n.size=null,n.spatialReference=null,n}return Object(s.a)(r,[{key:"isWrappable",get:function(){var e=this.spatialReference,t=this.origin;if(e&&t){var r=Object(x.e)(e);return e.isWrappable&&Math.abs(r.origin[0]-t.x)<=r.dx}return!1}},{key:"readOrigin",value:function(e,t){return g.a.fromJSON(Object(i.a)({spatialReference:t.spatialReference},e))}},{key:"lods",set:function(e){var t=this,r=0,n=0,i=[];this._levelToLOD={},e&&(r=-1/0,n=1/0,e.forEach((function(e){i.push(e.scale),r=e.scale>r?e.scale:r,n=e.scale<n?e.scale:n,t._levelToLOD[e.level]=e}))),this._set("scales",i),this._set("minScale",r),this._set("maxScale",n),this._set("lods",e),this._initializeUpsampleLevels()}},{key:"readSize",value:function(e,t){return[t.cols,t.rows]}},{key:"writeSize",value:function(e,t){t.cols=e[0],t.rows=e[1]}},{key:"zoomToScale",value:function(e){var t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];var r=Math.floor(e),n=r+1;return t[r]/Math.pow(t[r]/t[n],e-r)}},{key:"scaleToZoom",value:function(e){for(var t=this.scales,r=t.length-1,n=0;n<r;n++){var i=t[n],a=t[n+1];if(i<=e)return n;if(a===e)return n+1;if(i>e&&a<e)return n+Math.log(i/e)/Math.log(i/a)}return n}},{key:"snapScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,r=this.scaleToZoom(e);return r%Math.floor(r)>=t?this.zoomToScale(Math.ceil(r)):this.zoomToScale(Math.floor(r))}},{key:"tileAt",value:function(e,t,r,n){var i,a,s=this.lodAt(e);if(!s)return null;if("number"==typeof t)i=t,a=r;else if(Object(x.d)(t.spatialReference,this.spatialReference))i=t.x,a=t.y,n=r;else{var u=Object(k.d)(t,this.spatialReference);if(Object(f.i)(u))return null;i=u.x,a=u.y,n=r}var o=s.resolution*this.size[0],c=s.resolution*this.size[1];return n||(n={id:null,level:0,row:0,col:0,extent:Object(O.e)()}),n.level=e,n.row=Math.floor((this.origin.y-a)/c+.001),n.col=Math.floor((i-this.origin.x)/o+.001),this.updateTileInfo(n),n}},{key:"updateTileInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.lodAt(e.level);if(!r&&1===t){var n=this.lods[this.lods.length-1];n.level<e.level&&(r=n)}if(r){var i=e.level-r.level,a=r.resolution*this.size[0]/Math.pow(2,i),s=r.resolution*this.size[1]/Math.pow(2,i);e.id="".concat(e.level,"/").concat(e.row,"/").concat(e.col),e.extent||(e.extent=Object(O.e)()),e.extent[0]=this.origin.x+e.col*a,e.extent[1]=this.origin.y-(e.row+1)*s,e.extent[2]=e.extent[0]+a,e.extent[3]=e.extent[1]+s}}},{key:"upsampleTile",value:function(e){var t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}},{key:"getTileBounds",value:function(e,t){var r=this.lodAt(t.level).resolution,n=r*this.size[0],i=r*this.size[1];return e[0]=this.origin.x+t.col*n,e[1]=this.origin.y-(t.row+1)*i,e[2]=e[0]+n,e[3]=e[1]+i,e}},{key:"lodAt",value:function(e){return this._levelToLOD&&this._levelToLOD[e]||null}},{key:"clone",value:function(){return n.fromJSON(this.write({}))}},{key:"_initializeUpsampleLevels",value:function(){var e=this.lods;this._upsampleLevels=[];for(var t=null,r=0;r<e.length;r++){var n=e[r];this._upsampleLevels[n.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/n.resolution:0},t=n}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resolutionFactor,r=void 0===t?1:t,i=e.scales,a=e.size,s=void 0===a?256:a,u=e.spatialReference,o=void 0===u?j.a.WebMercator:u,c=e.numLODs,l=void 0===c?24:c;if(!Object(x.l)(o)){var h=[];if(i)for(var f=0;f<i.length;f++){var p=i[f];h.push({level:f,scale:p,resolution:p})}else for(var b=5e-4,y=l-1;y>=0;y--)h.unshift({level:y,scale:b,resolution:b}),b*=2;return new n({dpi:96,lods:h,origin:new g.a(0,0,o),size:[s,s],spatialReference:o})}var v=Object(x.e)(o),m=e.origin?new g.a({x:e.origin.x,y:e.origin.y,spatialReference:o}):new g.a(v?{x:v.origin[0],y:v.origin[1],spatialReference:o}:{x:0,y:0,spatialReference:o}),O=96,k=1/(39.37*Object(d.d)(o)*O),w=[];if(i)for(var _=0;_<i.length;_++){var S=i[_],I=S*k;w.push({level:_,scale:S,resolution:I})}else{var F=Object(x.h)(o)?512/s*591657527.5917094:256/s*591657527.591555,T=Math.ceil(l/r);w.push({level:0,scale:F,resolution:F*k});for(var R=1;R<T;R++){var M=F/Math.pow(2,r),P=M*k;w.push({level:R,scale:M,resolution:P}),F=M}}return new n({dpi:O,lods:w,origin:m,size:[s,s],spatialReference:o})}}]),r}(h.a);Object(c.a)([Object(p.b)({type:Number,json:{write:!0}})],S.prototype,"compressionQuality",void 0),Object(c.a)([Object(p.b)({type:Number,json:{write:!0}})],S.prototype,"dpi",void 0),Object(c.a)([Object(p.b)({type:String,json:{read:_.read,write:_.write,origins:{"web-scene":{read:!1,write:!1}}}})],S.prototype,"format",void 0),Object(c.a)([Object(p.b)({readOnly:!0})],S.prototype,"isWrappable",null),Object(c.a)([Object(p.b)({type:g.a,json:{write:!0}})],S.prototype,"origin",void 0),Object(c.a)([Object(y.a)("origin")],S.prototype,"readOrigin",null),Object(c.a)([Object(p.b)({type:[w.a],value:null,json:{write:!0}})],S.prototype,"lods",null),Object(c.a)([Object(p.b)({readOnly:!0})],S.prototype,"minScale",void 0),Object(c.a)([Object(p.b)({readOnly:!0})],S.prototype,"maxScale",void 0),Object(c.a)([Object(p.b)({readOnly:!0})],S.prototype,"scales",void 0),Object(c.a)([Object(p.b)({cast:function(e){return Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]}})],S.prototype,"size",void 0),Object(c.a)([Object(y.a)("size",["rows","cols"])],S.prototype,"readSize",null),Object(c.a)([Object(m.a)("size",{cols:{type:b.a},rows:{type:b.a}})],S.prototype,"writeSize",null),Object(c.a)([Object(p.b)({type:j.a,json:{write:!0}})],S.prototype,"spatialReference",void 0);var I=S=n=Object(c.a)([Object(v.a)("esri.layers.support.TileInfo")],S)},748:function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return P})),r.d(t,"c",(function(){return k})),r.d(t,"d",(function(){return w})),r.d(t,"e",(function(){return S})),r.d(t,"f",(function(){return x}));var n=r(7),i=r.n(n),a=r(12),s=r(42),u=r(11),o=r(135),c=r(245),l=r(62),h=r(696),f=r(53),d=(r(758),r(680)),p=r(681),b=r(718),y=new s.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),v=Object.freeze({}),m=new p.a,g=new p.a,j=new p.a,O={esriGeometryPoint:d.j,esriGeometryPolyline:d.l,esriGeometryPolygon:d.k,esriGeometryMultipoint:d.i};function x(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.hasZ,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.hasM;if(Object(u.i)(t))return null;var a=e.hasZ&&n,s=e.hasM&&i;if(r){var o=Object(d.r)(j,t,e.hasZ,e.hasM,"esriGeometryPoint",r,n,i);return Object(d.j)(o,a,s)}return Object(d.j)(t,a,s)}function k(e,t,r,n,i,a){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:r,c=t&&s,l=r&&o,h=Object(u.j)(n)?"coords"in n?n:n.geometry:null;if(Object(u.i)(h))return null;if(i){var f=Object(d.n)(g,h,t,r,e,i,s,o);return a&&(f=Object(d.r)(j,f,c,l,e,a)),O[e](f,c,l)}if(a){var p=Object(d.r)(j,h,t,r,e,a,s,o);return O[e](p,c,l)}return Object(d.u)(m,h,t,r,s,o),O[e](m,c,l)}function w(e,t,r){return _.apply(this,arguments)}function _(){return(_=Object(a.a)(i.a.mark((function e(t,r,n){var a,s,u,o,c,l,h,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.outFields,s=t.orderByFields,u=t.groupByFieldsForStatistics,o=t.outStatistics,a)for(c=0;c<a.length;c++)a[c]=a[c].trim();if(s)for(l=0;l<s.length;l++)s[l]=s[l].trim();if(u)for(h=0;h<u.length;h++)u[h]=u[h].trim();if(o)for(f=0;f<o.length;f++)o[f].onStatisticField&&(o[f].onStatisticField=o[f].onStatisticField.trim());return e.abrupt("return",(t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),S(t,r,n)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,r){return I.apply(this,arguments)}function I(){return(I=Object(a.a)(i.a.mark((function e(t,r,n){var a,s,o,f,d,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(a=t.where,t.where=a=a&&a.trim(),(!a||/^1 *= *1$/.test(a)||r&&r===a)&&(t.where=null),t.geometry){e.next=5;break}return e.abrupt("return",t);case 5:return e.next=7,F(t);case 7:return s=e.sent,t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel&&(o=t.geometry.spatialReference,(s=Object(c.a)(s)).spatialReference=o),t.geometry=s,e.next=12,Object(b.a)(s.spatialReference,n);case 12:return e.next=14,Object(h.a)(Object(l.a)(s));case 14:if(f=e.sent[0],!Object(u.i)(f)){e.next=17;break}throw v;case 17:return d=f.toJSON(),e.next=20,Object(b.b)(d,d.spatialReference,n);case 20:if(p=e.sent){e.next=23;break}throw v;case 23:return e.abrupt("return",(p.spatialReference=n,t.geometry=p,t));case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return T.apply(this,arguments)}function T(){return(T=Object(a.a)(i.a.mark((function e(t){var r,n,a,s,u,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.geometry,n=t.distance,a=t.units,null!=n&&!("vertexAttributes"in r)){e.next=3;break}return e.abrupt("return",r);case 3:if(s=r.spatialReference,u=a?y.fromJSON(a):Object(o.f)(s),!s||!Object(f.h)(s)&&!Object(f.p)(s)){e.next=9;break}e.t0=r,e.next=12;break;case 9:return e.next=11,Object(b.a)(s,f.b).then((function(){return Object(b.b)(r,f.b)}));case 11:e.t0=e.sent;case 12:return c=e.t0,e.next=15,R();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t1)(c.spatialReference,c,n,u));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(){return M.apply(this,arguments)}function M(){return(M=Object(a.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(9),r.e(19)]).then(r.bind(null,828));case 2:return e.abrupt("return",e.sent.geodesicBuffer);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return e&&C in e?JSON.parse(JSON.stringify(e,E)):e}var C="_geVersion",E=function(e,t){return e!==C?t:void 0}},752:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},754:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i}));var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{};function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function a(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}}).call(this,r(216))},757:function(e,t,r){"use strict";function n(e){var t={};for(var r in e)if("declaredClass"!==r){var i=e[r];if(null!=i&&"function"!=typeof i)if(Array.isArray(i)){t[r]=[];for(var a=0;a<i.length;a++)t[r][a]=n(i[a])}else"object"==typeof i?i.toJSON&&(t[r]=JSON.stringify(i)):t[r]=i}return t}r.d(t,"a",(function(){return n}))},758:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(21),i=r(11);function a(e,t){return e?t?4:3:t?3:2}function s(e,t,r,s,c){if(Object(i.i)(t)||!t.lengths.length)return null;var l="upperLeft"===(null==c?void 0:c.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);var h,f=e.coords,d=[],p=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],b=t.lengths,y=t.coords,v=a(r,s),m=0,g=Object(n.a)(b);try{for(g.s();!(h=g.n()).done;){var j=h.value,O=u(p,y,m,j,r,s,l);O&&d.push(O),m+=j*v}}catch(w){g.e(w)}finally{g.f()}if(d.sort((function(e,t){var n=l*e[2]-l*t[2];return 0===n&&r&&(n=e[4]-t[4]),n})),d.length){var x=6*d[0][2];f[0]=d[0][0]/x,f[1]=d[0][1]/x,r&&(x=6*d[0][4],f[2]=0!==x?d[0][3]/x:0),(f[0]<p[0]||f[0]>p[1]||f[1]<p[2]||f[1]>p[3]||r&&(f[2]<p[4]||f[2]>p[5]))&&(f.length=0)}if(!f.length){var k=t.lengths[0]?o(y,0,b[0],r,s):null;if(!k)return null;f[0]=k[0],f[1]=k[1],r&&k.length>2&&(f[2]=k[2])}return e}function u(e,t,r,n,i,s){for(var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o=a(i,s),c=r,l=r+o,h=0,f=0,d=0,p=0,b=0,y=0,v=n-1;y<v;y++,c+=o,l+=o){var m=t[c],g=t[c+1],j=t[c+2],O=t[l],x=t[l+1],k=t[l+2],w=m*x-O*g;p+=w,h+=(m+O)*w,f+=(g+x)*w,i&&(d+=(j+k)*(w=m*k-O*j),b+=w),m<e[0]&&(e[0]=m),m>e[1]&&(e[1]=m),g<e[2]&&(e[2]=g),g>e[3]&&(e[3]=g),i&&(j<e[4]&&(e[4]=j),j>e[5]&&(e[5]=j))}if(p*u>0&&(p*=-1),b*u>0&&(b*=-1),!p)return null;var _=[h,f,.5*p];return i&&(_[3]=d,_[4]=.5*b),_}function o(e,t,r,n,i){for(var s=a(n,i),u=t,o=t+s,d=0,p=0,b=0,y=0,v=0,m=r-1;v<m;v++,u+=s,o+=s){var g=e[u],j=e[u+1],O=e[u+2],x=e[o],k=e[o+1],w=e[o+2],_=n?l(g,j,O,x,k,w):c(g,j,x,k);if(_)if(d+=_,n){var S=f(g,j,O,x,k,w);p+=_*S[0],b+=_*S[1],y+=_*S[2]}else{var I=h(g,j,x,k);p+=_*I[0],b+=_*I[1]}}return d>0?n?[p/d,b/d,y/d]:[p/d,b/d]:r>0?n?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function c(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}function l(e,t,r,n,i,a){var s=n-e,u=i-t,o=a-r;return Math.sqrt(s*s+u*u+o*o)}function h(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function f(e,t,r,n,i,a){return[e+.5*(n-e),t+.5*(i-t),r+.5*(a-r)]}},759:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return o}));var n=r(21),i=r(23);r(29),r(11),r(209);function a(e){var t=null!=e.normalizationField||null!=e.normalizationType,r=null!=e.minValue||null!=e.maxValue,n=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!r&&!n}function s(e){var t=e.returnDistinct?Object(i.a)(new Set(e.values)):e.values,r=t.filter((function(e){return null!=e})).length,n={count:r};return e.supportsNullCount&&(n.nullcount=t.length-r),n}function u(e){var t,r=e.values,i=e.useSampleStdDev,a=e.supportsNullCount,s=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,o=null,c=null,l=null,h=null,f=0,d=null==e.minValue?-1/0:e.minValue,p=null==e.maxValue?1/0:e.maxValue,b=Object(n.a)(r);try{for(b.s();!(t=b.n()).done;){var y=t.value;Number.isFinite(y)?y>=d&&y<=p&&(o+=y,s=Math.min(s,y),u=Math.max(u,y),f++):"string"==typeof y&&f++}}catch(x){b.e(x)}finally{b.f()}if(f&&null!=o){c=o/f;var v,m=0,g=Object(n.a)(r);try{for(g.s();!(v=g.n()).done;){var j=v.value;Number.isFinite(j)&&j>=d&&j<=p&&(m+=Math.pow(j-c,2))}}catch(x){g.e(x)}finally{g.f()}h=i?f>1?m/(f-1):0:f>0?m/f:0,l=Math.sqrt(h)}else s=null,u=null;var O={avg:c,count:f,max:u,min:s,stddev:l,sum:o,variance:h};return a&&(O.nullcount=r.length-f),O}function o(e,t){return t?(["avg","stddev","variance"].forEach((function(t){null!=e[t]&&(e[t]=Math.ceil(e[t]))})),e):e}function c(e,t,r,n){var i=null;switch(t){case"log":0!==e&&(i=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(n)&&0!==n&&(i=e/n*100);break;case"field":Number.isFinite(r)&&0!==r&&(i=e/r);break;case"natural-log":e>0&&(i=Math.log(e));break;case"square-root":e>0&&(i=Math.pow(e,.5))}return i}},762:function(e,t,r){"use strict";function n(e,t){if(!e)return null;var r=t.featureAdapter,n=e.startTimeField,i=e.endTimeField,a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;if(n&&i)t.forEach((function(e){var t=r.getAttribute(e,n),u=r.getAttribute(e,i);null==t||isNaN(t)||(a=Math.min(a,t)),null==u||isNaN(u)||(s=Math.max(s,u))}));else{var u=n||i;t.forEach((function(e){var t=r.getAttribute(e,u);null==t||isNaN(t)||(a=Math.min(a,t),s=Math.max(s,t))}))}return{start:a,end:s}}function i(e,t,r){if(!t||!e)return null;var n=e.startTimeField,i=e.endTimeField;if(!n&&!i)return null;var a=t.start,s=t.end;return null===a&&null===s?null:void 0===a&&void 0===s?function(){return!1}:n&&i?function(e,t,r,n,i){return null!=n&&null!=i?function(a){var s=e.getAttribute(a,t),u=e.getAttribute(a,r);return(null==s||s<=i)&&(null==u||u>=n)}:null!=n?function(t){var i=e.getAttribute(t,r);return null==i||i>=n}:null!=i?function(r){var n=e.getAttribute(r,t);return null==n||n<=i}:void 0}(r,n,i,a,s):function(e,t,r,n){return null!=r&&null!=n&&r===n?function(n){return e.getAttribute(n,t)===r}:null!=r&&null!=n?function(i){var a=e.getAttribute(i,t);return a>=r&&a<=n}:null!=r?function(n){return e.getAttribute(n,t)>=r}:null!=n?function(r){return e.getAttribute(r,t)<=n}:void 0}(r,n||i,a,s)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}))},763:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(2),i=r(4),a=r(5),s=r(6),u=r(0),o=r(60),c=r(183),l=r(11),h=r(241),f=r(99),d=r(100),p=r(215),b=r(1),y=r(10),v=function(e){Object(a.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).updating=!1,e.handleId=0,e.handles=new c.a,e.scheduleHandleId=0,e.pendingPromises=new Set,e}return Object(i.a)(r,[{key:"destroy",value:function(){this.removeAll(),this.handles.destroy()}},{key:"add",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=0!=(1&i),s=++this.handleId;a||this.installSyncUpdatingWatch(e,t,s);var u=0!=(2&i)?Object(f.a)(e,t,r,a):e.watch(t,r,a);return this.handles.add(u,s),{remove:function(){return n.handles.remove(s)}}}},{key:"addOnCollectionPropertyChange",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=0!=(2&i),s=++this.handleId;return this.handles.add([Object(f.b)(e,t,"after-changes",this.createSyncUpdatingCallback()),Object(f.b)(e,t,"change",r,a?function(e){r({added:e.items,removed:[],moved:[],target:e})}:void 0)],s),{remove:function(){n.handles.remove(s)}}}},{key:"addOnCollectionChange",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=0!=(2&n),a=++this.handleId;return this.handles.add([e.on("after-changes",this.createSyncUpdatingCallback()),e.on("change",t)],a),i&&t({added:e.items,removed:[],moved:[],target:e}),{remove:function(){r.handles.remove(a)}}}},{key:"addPromise",value:function(e){var t=this;if(Object(l.i)(e))return e;var r=++this.handleId;this.handles.add({remove:function(){t.pendingPromises.delete(e)&&(0!==t.pendingPromises.size||t.handles.has(m)||t._set("updating",!1))}},r),this.pendingPromises.add(e),this._set("updating",!0);var n=function(){return t.handles.remove(r)};return e.then(n,n),e}},{key:"removeAll",value:function(){this.pendingPromises.clear(),this.handles.removeAll(),this._set("updating",!1)}},{key:"installSyncUpdatingWatch",value:function(e,t,r){var n=this.createSyncUpdatingCallback(),i=Object(p.b)((function(){return Object(d.c)(e,t)}),n);return this.handles.add(i,r),i}},{key:"createSyncUpdatingCallback",value:function(){var e=this;return function(){e.handles.remove(m),++e.scheduleHandleId;var t=e.scheduleHandleId;e._get("updating")||e._set("updating",!0),e.handles.add(Object(h.a)((function(){t===e.scheduleHandleId&&(e._set("updating",e.pendingPromises.size>0),e.handles.remove(m))})),m)}}}]),r}(o.a);Object(u.a)([Object(b.b)({readOnly:!0})],v.prototype,"updating",void 0),v=Object(u.a)([Object(y.a)("esri.views.support.WatchUpdatingTracking")],v);var m=-42},766:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(2),i=r(4),a=r(19),s=r(145),u=4294967296,o=Object(a.a)("esri-text-decoder")?new TextDecoder("utf-8"):null,c=Object(a.a)("safari")||Object(a.a)("ios")?6:Object(a.a)("ff")?12:32,l=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t?t.byteLength:0;Object(n.a)(this,e),this._tag=0,this._dataType=99,this.init(t,r,i,a)}return Object(i.a)(e,[{key:"init",value:function(e,t,r,n){this._data=e,this._dataView=t,this._pos=r,this._end=n}},{key:"clone",value:function(){return new e(this._data,this._dataView,this._pos,this._end)}},{key:"pos",value:function(){return this._pos}},{key:"move",value:function(e){this._pos=e}},{key:"nextTag",value:function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0}},{key:"next",value:function(){if(this._pos===this._end)return!1;var e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}},{key:"empty",value:function(){return this._pos>=this._end}},{key:"tag",value:function(){return this._tag}},{key:"getInt32",value:function(){return this._decodeVarint()}},{key:"getInt64",value:function(){return this._decodeVarint()}},{key:"getUInt32",value:function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))}},{key:"getUInt64",value:function(){return this._decodeVarint()}},{key:"getSInt32",value:function(){var e=this.getUInt32();return e>>>1^-(1&e)|0}},{key:"getSInt64",value:function(){return this._decodeSVarint()}},{key:"getBool",value:function(){var e=0!==this._data[this._pos];return this._skip(1),e}},{key:"getEnum",value:function(){return this._decodeVarint()}},{key:"getFixed64",value:function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+e.getUint32(t+4,!0)*u;return this._skip(8),r}},{key:"getSFixed64",value:function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+e.getInt32(t+4,!0)*u;return this._skip(8),r}},{key:"getDouble",value:function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}},{key:"getFixed32",value:function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}},{key:"getSFixed32",value:function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}},{key:"getFloat",value:function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}},{key:"getString",value:function(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r}},{key:"getBytes",value:function(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r}},{key:"getLength",value:function(){return this._getLengthUnsafe()}},{key:"processMessageWithArgs",value:function(e,t,r,n){var i=this.getMessage(),a=e(i,t,r,n);return i.release(),a}},{key:"processMessage",value:function(e){var t=this.getMessage(),r=e(t);return t.release(),r}},{key:"getMessage",value:function(){var t=this._getLength(),r=e.pool.acquire();return r.init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),r}},{key:"release",value:function(){e.pool.release(this)}},{key:"dataType",value:function(){return this._dataType}},{key:"skip",value:function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}}},{key:"skipLen",value:function(e){this._skip(e)}},{key:"_skip",value:function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e}},{key:"_decodeVarint",value:function(){var e,t=this._data,r=this._pos,n=0;if(this._end-r>=10)do{if(n|=127&(e=t[r++]),0==(128&e))break;if(n|=(127&(e=t[r++]))<<7,0==(128&e))break;if(n|=(127&(e=t[r++]))<<14,0==(128&e))break;if(n|=(127&(e=t[r++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[r++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var i=1;r!==this._end&&0!=(128&(e=t[r]));)++r,n+=(127&e)*i,i*=128;if(r===this._end)throw new Error("Varint overrun!");++r,n+=e*i}return this._pos=r,n}},{key:"_decodeSVarint",value:function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2}},{key:"_getLength",value:function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()}},{key:"_getLengthUnsafe",value:function(){return this.getUInt32()}},{key:"_toString",value:function(e,t,r){if((r=Math.min(this._end,r))-t>c&&o){var n=e.subarray(t,r);return o.decode(n)}for(var i="",a="",s=t;s<r;++s){var u=e[s];128&u?a+="%"+u.toString(16):(i+=decodeURIComponent(a)+String.fromCharCode(u),a="")}return a.length&&(i+=decodeURIComponent(a)),i}},{key:"_toBytes",value:function(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)}}]),e}();l.pool=new s.a(l,null,(function(e){e._data=null,e._dataView=null}))},768:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,i=r(2),a=r(4),s=r(5),u=r(6),o=r(0),c=r(26),l=r(1),h=(r(19),r(14)),f=(r(15),r(10)),d=n=function(e){Object(s.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).cols=null,n.level=0,n.levelValue=null,n.resolution=0,n.rows=null,n.scale=0,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}}]),r}(c.a);Object(o.a)([Object(l.b)({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],d.prototype,"cols",void 0),Object(o.a)([Object(l.b)({type:h.a,json:{write:!0}})],d.prototype,"level",void 0),Object(o.a)([Object(l.b)({type:String,json:{write:!0}})],d.prototype,"levelValue",void 0),Object(o.a)([Object(l.b)({type:Number,json:{write:!0}})],d.prototype,"resolution",void 0),Object(o.a)([Object(l.b)({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],d.prototype,"rows",void 0),Object(o.a)([Object(l.b)({type:Number,json:{write:!0}})],d.prototype,"scale",void 0);var p=d=n=Object(o.a)([Object(f.a)("esri.layers.support.LOD")],d)},769:function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return f}));var n=r(21),i=r(2),a=r(4),s=r(135),u=r(53),o=r(731),c=r(773),l=r(681),h=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],f=function(){function e(t){Object(i.a)(this,e),this.options=t,this.geometryTypes=h,this._coordinatePtr=0,this._vertexDimension=0}return Object(a.a)(e,[{key:"createFeatureResult",value:function(){return new c.a}},{key:"prepareFeatures",value:function(e){this._vertexDimension=2,e.hasZ&&this._vertexDimension++,e.hasM&&this._vertexDimension++}},{key:"finishFeatureResult",value:function(e){if(e&&e.features&&e.hasZ&&this.options.sourceSpatialReference&&e.spatialReference&&!Object(u.d)(e.spatialReference,this.options.sourceSpatialReference)&&!e.spatialReference.vcsWkid){var t=Object(s.e)(this.options.sourceSpatialReference)/Object(s.e)(e.spatialReference);if(1!==t){var r,i=Object(n.a)(e.features);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(Object(o.c)(a))for(var c=a.geometry.coords,l=2;l<c.length;l+=3)c[l]*=t}}catch(h){i.e(h)}finally{i.f()}}}}},{key:"addFeature",value:function(e,t){e.features.push(t)}},{key:"createFeature",value:function(){return new o.b}},{key:"createSpatialReference",value:function(){return{wkid:0}}},{key:"createGeometry",value:function(){return new l.a}},{key:"addField",value:function(e,t){e.fields.push(t)}},{key:"allocateCoordinates",value:function(e){e.coords.length=e.lengths.reduce((function(e,t){return e+t}),0)*this._vertexDimension,this._coordinatePtr=0}},{key:"addCoordinate",value:function(e,t){e.coords[this._coordinatePtr++]=t}},{key:"addCoordinatePoint",value:function(e,t){e.coords.push(t)}},{key:"addLength",value:function(e,t){e.lengths.push(t)}},{key:"addQueryGeometry",value:function(e,t){e.queryGeometry=t.queryGeometry,e.queryGeometryType=t.queryGeometryType}},{key:"createPointGeometry",value:function(){return new l.a}}]),e}()},770:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(2),i={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,r){var n=new a(e.getPointX(t),e.getPointY(t),r),i=e.hasZ(t),s=e.hasM(t);return i&&(n.z=e.getPointZ(t)),s&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new s(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new u(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new o(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){var n=e.hasZ(t),i=e.hasM(t),a=new c(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){var s=e.getZExtent(t);a.zmin=s.vmin,a.zmax=s.vmax}if(i){var u=e.getMExtent(t);a.mmin=u.vmin,a.mmax=u.vmax}return a}};var a=function e(t,r,i){Object(n.a)(this,e),this.x=t,this.y=r,this.spatialReference=i,this.z=void 0,this.m=void 0};var s=function e(t,r,i,a){Object(n.a)(this,e),this.rings=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),a&&(this.hasM=a)};var u=function e(t,r,i,a){Object(n.a)(this,e),this.paths=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),a&&(this.hasM=a)};var o=function e(t,r,i,a){Object(n.a)(this,e),this.points=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),a&&(this.hasM=a)};var c=function e(t,r,i,a,s){Object(n.a)(this,e),this.xmin=t,this.ymin=r,this.xmax=i,this.ymax=a,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}},771:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(2),i=r(4),a=r(708),s=function(){function e(t,r){Object(n.a)(this,e),this._storage=new a.b,this._storage.maxSize=t,r&&this._storage.registerRemoveFunc("",r)}return Object(i.a)(e,[{key:"put",value:function(e,t){this._storage.put(e,t,1,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.destroy()}}]),e}()},775:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return b})),r.d(t,"e",(function(){return y}));var n=r(22),i=r(11);r(62);var a=function(e,t,r){return[t,r]},s=function(e,t,r){return[t,r,e[2]]},u=function(e,t,r){return[t,r,e[2],e[3]]};function o(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function c(e,t){var r=e.scale,n=e.translate;return t*r[0]+n[0]}function l(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function h(e,t,r){var i=new Array(r.length);if(!r.length)return i;var a=Object(n.a)(e.scale,2),s=a[0],u=a[1],o=c(e,r[0][0]),h=l(e,r[0][1]);i[0]=t(r[0],o,h);for(var f=1;f<r.length;f++){var d=r[f];o+=d[0]*s,h-=d[1]*u,i[f]=t(d,o,h)}return i}function f(e,t,r){for(var n=new Array(r.length),i=0;i<r.length;i++)n[i]=h(e,t,r[i]);return n}function d(e,t,r,n,o){return Object(i.j)(r)&&(t.points=function(e,t,r,n){return h(e,r?n?u:s:n?s:a,t)}(e,r.points,n,o)),t}function p(e,t,r,n,a){return Object(i.i)(r)||(t.x=c(e,r.x),t.y=l(e,r.y),t!==r&&(n&&(t.z=r.z),a&&(t.m=r.m))),t}function b(e,t,r,n,o){return Object(i.j)(r)&&(t.rings=function(e,t,r,n){return f(e,r?n?u:s:n?s:a,t)}(e,r.rings,n,o)),t}function y(e,t,r,n,o){return Object(i.j)(r)&&(t.paths=function(e,t,r,n){return f(e,r?n?u:s:n?s:a,t)}(e,r.paths,n,o)),t}},778:function(e,t,r){"use strict";r.d(t,"a",(function(){return T})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return w}));var n=r(29),i=r(11),a=r(766),s=r(681),u=r(769),o=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],c=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],l=["upperLeft","lowerLeft"];function h(e){return e>=o.length?null:o[e]}function f(e){return e>=c.length?null:c[e]}function d(e){return e>=l.length?null:l[e]}function p(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function b(e,t,r){for(var n=t.createPointGeometry(r);e.next();)if(3===e.tag())for(var i=e.getUInt32(),a=e.pos()+i,s=0;e.pos()<a;)t.addCoordinatePoint(n,e.getSInt64(),s++);else e.skip();return n}function y(e,t,r){for(var n=t.createGeometry(r),i=2+(r.hasZ?1:0)+(r.hasM?1:0);e.next();)switch(e.tag()){case 2:for(var a=e.getUInt32(),s=e.pos()+a,u=0;e.pos()<s;)t.addLength(n,e.getUInt32(),u++);break;case 3:var o=e.getUInt32(),c=e.pos()+o,l=0;for(t.allocateCoordinates(n);e.pos()<c;)t.addCoordinate(n,e.getSInt64(),l),++l===i&&(l=0);break;default:e.skip()}return n}function v(e){for(var t=new s.a,r="esriGeometryPoint";e.next();)switch(e.tag()){case 2:for(var n=e.getUInt32(),i=e.pos()+n;e.pos()<i;)t.lengths.push(e.getUInt32());break;case 3:for(var a=e.getUInt32(),o=e.pos()+a;e.pos()<o;)t.coords.push(e.getSInt64());break;case 1:r=u.a[e.getEnum()];break;default:e.skip()}return{queryGeometry:t,queryGeometryType:r}}function m(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function g(e){for(var t={type:h(0)};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=h(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=f(e.getEnum());break;default:e.skip();break;case 6:t.defaultValue=e.getString()}return t}function j(e){for(var t={};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.isSystemMaintained=e.getBool();break;default:e.skip()}return t}function O(e,t,r,n){for(var i=t.createFeature(r),a=0;e.next();)switch(e.tag()){case 1:var s=n[a++].name;i.attributes[s]=e.processMessage(m);break;case 2:i.geometry=e.processMessageWithArgs(y,t,r);break;case 4:i.centroid=e.processMessageWithArgs(b,t,r);break;default:e.skip()}return i}function x(e){for(var t=[1,1,1,1];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function k(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function w(e){for(var t={originPosition:d(0)};e.next();)switch(e.tag()){case 1:t.originPosition=d(e.getEnum());break;case 2:t.scale=e.processMessage(x);break;case 3:t.translate=e.processMessage(k);break;default:e.skip()}return t}function _(e){for(var t={};e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function S(e,t){for(var r=t.createSpatialReference();e.next();)switch(e.tag()){case 1:r.wkid=e.getUInt32();break;case 5:r.wkt=e.getString();break;case 2:r.latestWkid=e.getUInt32();break;case 3:r.vcsWkid=e.getUInt32();break;case 4:r.latestVcsWkid=e.getUInt32();break;default:e.skip()}return r}function I(e,t){var r=t.createFeatureResult();r.geometryType=p(t,0);for(var n=!1;e.next();)switch(e.tag()){case 1:r.objectIdFieldName=e.getString();break;case 3:r.globalIdFieldName=e.getString();break;case 4:r.geohashFieldName=e.getString();break;case 5:r.geometryProperties=e.processMessage(_);break;case 7:r.geometryType=p(t,e.getEnum());break;case 8:r.spatialReference=e.processMessageWithArgs(S,t);break;case 10:r.hasZ=e.getBool();break;case 11:r.hasM=e.getBool();break;case 12:r.transform=e.processMessage(w);break;case 9:var i=e.getBool();r.exceededTransferLimit=i;break;case 13:t.addField(r,e.processMessage(g));break;case 15:n||(t.prepareFeatures(r),n=!0),t.addFeature(r,e.processMessageWithArgs(O,t,r,r.fields));break;case 2:r.uniqueIdField=e.processMessage(j);break;default:e.skip()}return t.finishFeatureResult(r),r}function F(e,t){for(var r={},n=null;e.next();)switch(e.tag()){case 4:n=e.processMessageWithArgs(v);break;case 1:r.featureResult=e.processMessageWithArgs(I,t);break;default:e.skip()}return Object(i.j)(n)&&r.featureResult&&t.addQueryGeometry(r,n),r}function T(e,t){try{for(var r=new a.a(new Uint8Array(e),new DataView(e)),i={};r.next();)2===r.tag()?i.queryResult=r.processMessageWithArgs(F,t):r.skip();return i}catch(s){throw new n.a("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:s})}}},782:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(21),i=r(778);function a(e,t){var r=Object(i.a)(e,t),a=r.queryResult.featureResult,s=r.queryResult.queryGeometry,u=r.queryResult.queryGeometryType;if(a&&a.features&&a.features.length&&a.objectIdFieldName){var o,c=a.objectIdFieldName,l=Object(n.a)(a.features);try{for(l.s();!(o=l.n()).done;){var h=o.value;h.attributes&&(h.objectId=h.attributes[c])}}catch(f){l.e(f)}finally{l.f()}}return a&&(a.queryGeometry=s,a.queryGeometryType=u),a}},798:function(e,t,r){"use strict";r.r(t),r.d(t,"FeatureServiceSnappingSourceWorker",(function(){return ie})),r.d(t,"default",(function(){return ae}));var n=r(7),i=r.n(n),a=r(13),s=r(12),u=r(2),o=r(4),c=r(5),l=r(6),h=r(0),f=r(184),d=r(183),p=r(11),b=r(30),y=r(99),v=r(1),m=(r(19),r(14),r(15)),g=r(10),j=r(45),O=r(831),x=r(809),k=r(743),w=r(698),_=r(670),S=r(22),I=r(21),F=r(137),T=r(60),R=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(u.a)(this,r),(e=t.apply(this,arguments)).updating=!1,e.pending=[],e}return Object(o.a)(r,[{key:"push",value:function(e,t){this.pending.push({promise:e,callback:t}),1===this.pending.length&&this.process()}},{key:"process",value:function(){var e=this;if(this.pending.length){this.updating=!0;var t=this.pending[0];t.promise.then((function(e){return t.callback(e)})).catch((function(){})).then((function(){e.pending.shift(),e.process()}))}else this.updating=!1}}]),r}(T.a);Object(h.a)([Object(v.b)()],R.prototype,"updating",void 0),R=Object(h.a)([Object(g.a)("esri.core.AsyncSequence")],R);var M=r(726),P=r(185),C=r(58),E=r(333),A=r(680),N=r(769),z=r(722),V=r(295),D=function(){function e(t,r){Object(u.a)(this,e),this.data=t,this.resolution=r,this.state={type:0},this.alive=!0}return Object(o.a)(e,[{key:"process",value:function(e){switch(this.state.type){case 0:return this.state=this.gotoFetchCount(this.state,e),this.state.task.promise.then(e.resume,e.resume);case 1:case 3:break;case 2:return this.state=this.gotoFetchFeatures(this.state,e),this.state.task.promise.then(e.resume,e.resume);case 4:this.state=this.goToDone(this.state,e)}return null}},{key:"debugInfo",get:function(){return{data:this.data,featureCount:this.featureCount,state:this.stateToString}}},{key:"featureCount",get:function(){switch(this.state.type){case 0:case 1:return 0;case 2:return this.state.featureCount;case 3:return this.state.previous.featureCount;case 4:return this.state.features.length;case 5:return this.state.previous.features.length}}},{key:"stateToString",get:function(){switch(this.state.type){case 0:return"created";case 1:return"fetch-count";case 2:return"fetched-count";case 3:return"fetch-features";case 4:return"fetched-features";case 5:return"done"}}},{key:"gotoFetchCount",value:function(e,t){var r=this;return{type:1,previous:e,task:Object(b.h)(function(){var e=Object(s.a)(i.a.mark((function e(n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(V.d)(t.fetchCount(r,n));case 2:a=e.sent,1===r.state.type&&(r.state=r.gotoFetchedCount(r.state,a.ok?a.value:1/0));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},{key:"gotoFetchedCount",value:function(e,t){return{type:2,featureCount:t,previous:e}}},{key:"gotoFetchFeatures",value:function(e,t){var r=this;return{type:3,previous:e,task:Object(b.h)(function(){var n=Object(s.a)(i.a.mark((function n(a){var s;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(V.d)(t.fetchFeatures(r,e.featureCount,a));case 2:s=n.sent,3===r.state.type&&(r.state=r.gotoFetchedFeatures(r.state,s.ok?s.value:[]));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}}},{key:"gotoFetchedFeatures",value:function(e,t){return{type:4,previous:e,features:t}}},{key:"goToDone",value:function(e,t){return t.finish(this,e.features),{type:5,previous:e}}},{key:"reset",value:function(){var e=this.state;switch(this.state={type:0},e.type){case 0:case 2:case 4:case 5:break;case 1:case 3:e.task.abort()}}},{key:"intersects",value:function(e){return!(!Object(p.i)(e)&&this.data.extent)||(Object(E.i)(e,B),Object(E.k)(this.data.extent,B))}}]),e}(),B=Object(E.e)(),q=m.a.getLogger("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiledFetcher"),Q=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var n;return Object(u.a)(this,r),(n=t.call(this,e)).tilesOfInterest=[],n.availability=0,n.pendingTiles=new Map,n.pendingEdits=new R,n.pendingEditsAbortController=Object(b.d)(),n}return Object(o.a)(r,[{key:"minimumVerticesPerFeature",get:function(){var e;switch(null==(e=this.store)?void 0:e.featureStore.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":return 1;case"esriGeometryPolygon":return 4;case"esriGeometryPolyline":return 2}}},{key:"filter",set:function(e){var t=this._get("filter"),r=this.filterProperties(e);JSON.stringify(t)!==JSON.stringify(r)&&this._set("filter",r)}},{key:"customParameters",set:function(e){var t=this._get("customParameters");JSON.stringify(t)!==JSON.stringify(e)&&this._set("customParameters",e)}},{key:"configuration",get:function(){return{filter:this.filter,customParameters:this.customParameters,tileInfo:this.tileInfo,tileSize:this.tileSize}}},{key:"tileInfo",set:function(e){var t=this._get("tileInfo");t!==e&&(Object(p.j)(e)&&Object(p.j)(t)&&JSON.stringify(e)===JSON.stringify(t)||(this._set("tileInfo",e),this.store.tileInfo=e))}},{key:"tileSize",set:function(e){this._get("tileSize")!==e&&this._set("tileSize",e)}},{key:"updating",get:function(){return this.updatingHandles.updating||this.pendingEdits.updating}},{key:"initialize",value:function(){var e=this;this.initializeFetchExtent(),this.updatingHandles.add(this,"configuration",(function(){return e.refresh()})),this.updatingHandles.add(this,"tilesOfInterest",(function(t,r){Object(F.c)(t,r,(function(e,t){return e.id===t.id}))||e.process()}),1)}},{key:"destroy",value:function(){var e=this;this.pendingTiles.forEach((function(t){return e.deletePendingTile(t)})),this.pendingTiles.clear(),this.store.destroy(),this.tilesOfInterest.length=0,this.pendingEditsAbortController.abort(),this.pendingEditsAbortController=null}},{key:"refresh",value:function(){var e=this;this.store.refresh(),this.pendingTiles.forEach((function(t){return e.deletePendingTile(t)})),this.process()}},{key:"applyEdits",value:function(e){var t=this;this.pendingEdits.push(e,function(){var e=Object(s.a)(i.a.mark((function e(r){var n,s,u,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==r.addedFeatures.length||0!==r.updatedFeatures.length||0!==r.deletedFeatures.length){e.next=2;break}return e.abrupt("return");case 2:n=Object(I.a)(t.pendingTiles);try{for(n.s();!(s=n.n()).done;)u=Object(S.a)(s.value,2),u[1].reset()}catch(i){n.e(i)}finally{n.f()}return o=Object(a.a)(Object(a.a)({},r),{},{deletedFeatures:r.deletedFeatures.map((function(e){var r=e.objectId,n=e.globalId;return r&&-1!==r?r:t.lookupObjectIdByGlobalId(n)}))}),e.next=7,t.updatingHandles.addPromise(t.store.processEdits(o,(function(e,r){return t.queryFeaturesById(e,r)}),t.pendingEditsAbortController.signal));case 7:t.processPendingTiles();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"initializeFetchExtent",value:function(){var e=this;if(this.capabilities.query.supportsExtent){var t=Object(b.h)(function(){var t=Object(s.a)(i.a.mark((function t(r){var n,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(z.executeQueryForExtent)(e.url,new _.a({where:"1=1",outSpatialReference:e.spatialReference,cacheHint:!!e.capabilities.query.supportsCacheHint||void 0}),{query:e.configuration.customParameters,signal:r});case 3:a=t.sent,e.store.extent=C.a.fromJSON(null==(n=a.data)?void 0:n.extent),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object(b.u)(t.t0),q.warn("Failed to fetch data extent",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}());this.updatingHandles.addPromise(t.promise.then((function(){return e.process()}))),this.handles.add(Object(P.b)((function(){return t.abort()})))}}},{key:"debugInfo",get:function(){return{numberOfFeatures:this.store.featureStore.numFeatures,tilesOfInterest:this.tilesOfInterest,pendingTiles:Array.from(this.pendingTiles.values()).map((function(e){return e.debugInfo})),storedTiles:this.store.debugInfo}}},{key:"process",value:function(){this.markTilesNotAlive(),this.createPendingTiles(),this.deletePendingTiles(),this.processPendingTiles()}},{key:"markTilesNotAlive",value:function(){var e,t=Object(I.a)(this.pendingTiles);try{for(t.s();!(e=t.n()).done;){Object(S.a)(e.value,2)[1].alive=!1}}catch(r){t.e(r)}finally{t.f()}}},{key:"createPendingTiles",value:function(){var e=this.collectMissingTilesInfo();if(this.setAvailability(Object(p.i)(e)?1:e.coveredArea/e.fullArea),!Object(p.i)(e)){var t,r=Object(I.a)(e.missingTiles);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=n.data,a=n.resolution,s=this.pendingTiles.get(i.id);s?(s.resolution=a,s.alive=!0):this.createPendingTile(i,a)}}catch(u){r.e(u)}finally{r.f()}}}},{key:"collectMissingTilesInfo",value:function(){for(var e=this,t=null,r=this.tilesOfInterest.length-1;r>=0;r--){var n=this.tilesOfInterest[r],i=this.store.process(n,(function(t,r){return e.verifyTileComplexity(t,r)}));Object(p.i)(t)?t=i:t.prepend(i)}return t}},{key:"deletePendingTiles",value:function(){var e,t=Object(I.a)(this.pendingTiles);try{for(t.s();!(e=t.n()).done;){var r=Object(S.a)(e.value,2)[1];r.alive||this.deletePendingTile(r)}}catch(n){t.e(n)}finally{t.f()}}},{key:"processPendingTiles",value:function(){var e=this,t={fetchCount:function(t,r){return e.fetchCount(t,r)},fetchFeatures:function(t,r,n){return e.fetchFeatures(t,r,n)},finish:function(t,r){return e.finishPendingTile(t,r)},resume:function(){return e.processPendingTiles()}};if(this.ensureFetchAllCounts(t)){var r,n=Object(I.a)(this.pendingTiles);try{for(n.s();!(r=n.n()).done;){var i=Object(S.a)(r.value,2)[1];this.verifyTileComplexity(this.store.getFeatureCount(i.data),i.resolution)&&this.updatingHandles.addPromise(i.process(t))}}catch(a){n.e(a)}finally{n.f()}}}},{key:"verifyTileComplexity",value:function(e,t){return this.verifyVertexComplexity(e)&&this.verifyFeatureDensity(e,t)}},{key:"verifyVertexComplexity",value:function(e){return e*this.minimumVerticesPerFeature<U}},{key:"verifyFeatureDensity",value:function(e,t){if(Object(p.i)(this.tileInfo))return!1;var r=this.tileSize*t;return e*(Z/(r*r))<J}},{key:"ensureFetchAllCounts",value:function(e){var t,r=!0,n=Object(I.a)(this.pendingTiles);try{for(n.s();!(t=n.n()).done;){var i=Object(S.a)(t.value,2)[1];i.state.type<2&&this.updatingHandles.addPromise(i.process(e)),i.state.type<=1&&(r=!1)}}catch(a){n.e(a)}finally{n.f()}return r}},{key:"finishPendingTile",value:function(e,t){this.store.add(e.data,t),this.deletePendingTile(e),this.updateAvailability()}},{key:"updateAvailability",value:function(){var e=this.collectMissingTilesInfo();this.setAvailability(Object(p.i)(e)?1:e.coveredArea/e.fullArea)}},{key:"setAvailability",value:function(e){this._set("availability",e)}},{key:"createPendingTile",value:function(e,t){var r=new D(e,t);return this.pendingTiles.set(e.id,r),r}},{key:"deletePendingTile",value:function(e){e.reset(),this.pendingTiles.delete(e.data.id)}},{key:"fetchCount",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.store.fetchCount(t.data,this.url,this.createCountQuery(t),{query:this.customParameters,timeout:L,signal:r}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchFeatures",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r,n){var a,s,u,o,c,l,h,f,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=0,u=0,o=r;case 1:return c=this.createFeaturesQuery(t),l=this.setPagingParameters(c,s,o),e.next=5,this.queryFeatures(c,n);case 5:if(h=e.sent,f=h.features,d=h.exceededTransferLimit,l&&(s+=Object(p.q)(c.num)),u+=f.length,a=a?a.concat(f):f,o=r-u,l&&d&&!(o<=0)){e.next=10;break}return e.abrupt("return",a);case 10:e.next=1;break;case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"filterProperties",value:function(e){return Object(p.i)(e)?{where:"1=1",gdbVersion:void 0,timeExtent:void 0}:{where:e.where||"1=1",timeExtent:e.timeExtent,gdbVersion:e.gdbVersion}}},{key:"lookupObjectIdByGlobalId",value:function(e){var t=this.globalIdField,r=this.objectIdField;if(Object(p.i)(t))throw new Error("Expected globalIdField to be defined");var n=null;if(this.store.featureStore.forEach((function(i){var a;e===i.attributes[t]&&(n=null!=(a=i.objectId)?a:i.attributes[r])})),Object(p.i)(n))throw new Error("Expected to find a feature with globalId ".concat(e));return n}},{key:"queryFeaturesById",value:function(e,t){var r=this.createFeaturesQuery(null);return r.objectIds=e,this.queryFeatures(r,t)}},{key:"queryFeatures",value:function(e,t){return this.capabilities.query.supportsFormatPBF?this.queryFeaturesPBF(e,t):this.queryFeaturesJSON(e,t)}},{key:"queryFeaturesPBF",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r){var n,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.sourceSpatialReference,e.next=3,Object(z.executeQueryPBF)(this.url,t,new N.b({sourceSpatialReference:n}),{query:this.configuration.customParameters,timeout:L,signal:r});case 3:return a=e.sent,s=a.data,e.abrupt("return",Object(A.v)(s));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeaturesJSON",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r){var n,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.sourceSpatialReference,e.next=3,Object(z.executeQuery)(this.url,t,n,{query:this.configuration.customParameters,timeout:L,signal:r});case 3:return a=e.sent,s=a.data,e.abrupt("return",Object(A.b)(s,this.objectIdField));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createCountQuery",value:function(e){var t=this.createBaseQuery(e);return this.capabilities.query.supportsCacheHint&&(t.cacheHint=!0),t}},{key:"createFeaturesQuery",value:function(e){var t=this.createBaseQuery(e);return t.outFields=this.globalIdField?[this.globalIdField,this.objectIdField]:[this.objectIdField],t.returnGeometry=!0,Object(p.j)(e)&&(this.capabilities.query.supportsResultType?t.resultType="tile":this.capabilities.query.supportsCacheHint&&(t.cacheHint=!0)),t}},{key:"createBaseQuery",value:function(e){var t=new _.a({returnZ:!1,returnM:!1,geometry:Object(p.j)(this.tileInfo)&&Object(p.j)(e)?Object(E.l)(e.data.extent,this.tileInfo.spatialReference):void 0}),r=this.configuration.filter;return Object(p.j)(r)&&(t.where=r.where,t.gdbVersion=r.gdbVersion,t.timeExtent=r.timeExtent),t.outSpatialReference=this.spatialReference,t}},{key:"setPagingParameters",value:function(e,t,r){if(!this.capabilities.query.supportsPagination)return!1;var n=this.capabilities.query,i=n.supportsMaxRecordCountFactor,a=n.supportsCacheHint,s=n.tileMaxRecordCount,u=n.maxRecordCount,o=n.supportsResultType,c=i?_.a.MAX_MAX_RECORD_COUNT_FACTOR:1,l=c*((o||a)&&s?s:u||G);return e.start=t,i?(e.maxRecordCountFactor=Math.min(c,Math.ceil(r/l)),e.num=Math.min(r,e.maxRecordCountFactor*l)):e.num=Math.min(r,l),!0}}]),r}(M.a);Object(h.a)([Object(v.b)({constructOnly:!0})],Q.prototype,"url",void 0),Object(h.a)([Object(v.b)({constructOnly:!0})],Q.prototype,"objectIdField",void 0),Object(h.a)([Object(v.b)({constructOnly:!0})],Q.prototype,"globalIdField",void 0),Object(h.a)([Object(v.b)({constructOnly:!0})],Q.prototype,"capabilities",void 0),Object(h.a)([Object(v.b)({constructOnly:!0})],Q.prototype,"sourceSpatialReference",void 0),Object(h.a)([Object(v.b)({constructOnly:!0})],Q.prototype,"spatialReference",void 0),Object(h.a)([Object(v.b)({constructOnly:!0})],Q.prototype,"store",void 0),Object(h.a)([Object(v.b)({readOnly:!0})],Q.prototype,"minimumVerticesPerFeature",null),Object(h.a)([Object(v.b)()],Q.prototype,"filter",null),Object(h.a)([Object(v.b)()],Q.prototype,"customParameters",null),Object(h.a)([Object(v.b)({readOnly:!0})],Q.prototype,"configuration",null),Object(h.a)([Object(v.b)()],Q.prototype,"tileInfo",null),Object(h.a)([Object(v.b)()],Q.prototype,"tileSize",null),Object(h.a)([Object(v.b)()],Q.prototype,"tilesOfInterest",void 0),Object(h.a)([Object(v.b)({readOnly:!0})],Q.prototype,"updating",null),Object(h.a)([Object(v.b)({readOnly:!0})],Q.prototype,"availability",void 0),Q=Object(h.a)([Object(g.a)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiledFetcher")],Q);var G=2e3,L=6e5,U=1e6,Z=25,J=1,H=r(984),Y=r(811),W=function(e){function t(){Object(u.a)(this,t),this._store=new Map,this._byteSize=0}return Object(o.a)(t,[{key:"set",value:function(e,t){this.delete(e),this._store.set(e,t),this._byteSize+=t.byteSize}},{key:"delete",value:function(e){var t=this._store.get(e);return!!this._store.delete(e)&&(this._byteSize-=t.byteSize,!0)}},{key:"get",value:function(e){return this.used(e),this._store.get(e)}},{key:"has",value:function(e){return this.used(e),this._store.has(e)}},{key:"clear",value:function(){this._store.clear()}},{key:"applyByteSizeLimit",value:function(e,t){var r,n=Object(I.a)(this._store);try{for(n.s();!(r=n.n()).done;){var i=Object(S.a)(r.value,2),a=i[0],s=i[1];if(this._byteSize<=e)break;this.delete(a),t(s)}}catch(u){n.e(u)}finally{n.f()}}},{key:"values",value:function(){return this._store.values()}},{key:e,value:function(){return this._store[Symbol.iterator]()}},{key:"used",value:function(e){var t=this._store.get(e);t&&(this._store.delete(e),this._store.set(e,t))}}]),t}(Symbol.iterator),X=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var n;return Object(u.a)(this,r),(n=t.call(this,e)).tileInfo=null,n.extent=null,n.maximumByteSize=10485760,n.tileBounds=new Y.a,n.tiles=new W,n.refCounts=new Map,n.tileFeatureCounts=new Map,n.tmpBoundingRect=Object(E.e)(),n}return Object(o.a)(r,[{key:"add",value:function(e,t){var r,n=this,i=[],a=Object(I.a)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value;0===this.referenceFeature(s.objectId)&&i.push(s)}}catch(u){a.e(u)}finally{a.f()}this.addTileStorage(e,new Set(t.map((function(e){return e.objectId}))),function(e){return e.reduce((function(e,t){return e+function(e){return 32+function(e){if(Object(p.i)(e))return 0;var t=Object(H.b)(e.lengths,4);return 32+Object(H.b)(e.coords,8)+t}(e.geometry)+Object(H.a)(e.attributes)}(t)}),0)}(t)),this.featureStore.addMany(i),this.tiles.applyByteSizeLimit(this.maximumByteSize,(function(e){return n.removeTileStorage(e)}))}},{key:"destroy",value:function(){this.clear(),this.tileFeatureCounts.clear()}},{key:"clear",value:function(){this.featureStore.clear(),this.tileBounds.clear(),this.tiles.clear(),this.refCounts.clear()}},{key:"refresh",value:function(){this.clear(),this.tileFeatureCounts.clear()}},{key:"processEdits",value:function(e,t,r){return this.processEditsDelete(e.deletedFeatures.concat(e.updatedFeatures)),this.processEditsRefetch(e.addedFeatures.concat(e.updatedFeatures),t,r)}},{key:"addTileStorage",value:function(e,t,r){this.tiles.set(e.id,new K(e,t,r)),this.tileBounds.set(e.id,e.extent),this.tileFeatureCounts.set(e.id,t.size)}},{key:"remove",value:function(e){var t=e.id,r=this.tiles.get(t);r&&this.removeTileStorage(r)}},{key:"removeTileStorage",value:function(e){var t,r=[],n=Object(I.a)(e.objectIds);try{for(n.s();!(t=n.n()).done;){var i=t.value;1===this.unreferenceFeature(i)&&r.push(i)}}catch(s){n.e(s)}finally{n.f()}this.featureStore.removeManyById(r);var a=e.data.id;this.tiles.delete(a),this.tileBounds.delete(a)}},{key:"processEditsDelete",value:function(e){this.featureStore.removeManyById(e);var t,r=Object(I.a)(this.tiles);try{for(r.s();!(t=r.n()).done;){var n,i=Object(S.a)(t.value,2)[1],a=Object(I.a)(e);try{for(a.s();!(n=a.n()).done;){var s=n.value;i.objectIds.delete(s)}}catch(l){a.e(l)}finally{a.f()}this.tileFeatureCounts.set(i.data.id,i.objectIds.size)}}catch(l){r.e(l)}finally{r.f()}var u,o=Object(I.a)(e);try{for(o.s();!(u=o.n()).done;){var c=u.value;this.refCounts.delete(c)}}catch(l){o.e(l)}finally{o.f()}}},{key:"processEditsRefetch",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r,n){var a,s,u,o,c,l,h,f=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t,n);case 2:a=e.sent.features,s=this.featureStore,u=s.hasZ,o=s.hasM,c=Object(I.a)(a);try{for(h=function(){var e=l.value,t=Object(A.o)(f.tmpBoundingRect,e.geometry,u,o);Object(p.i)(t)||f.tileBounds.forEachInBounds(t,(function(t){var r=f.tiles.get(t);f.featureStore.add(e),r.objectIds.has(e.objectId)||(r.objectIds.add(e.objectId),f.referenceFeature(e.objectId),f.tileFeatureCounts.set(r.data.id,r.objectIds.size))}))},c.s();!(l=c.n()).done;)h()}catch(i){c.e(i)}finally{c.f()}case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"process",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};if(Object(p.i)(this.tileInfo)||!e.extent||Object(p.j)(this.extent)&&!Object(E.k)(Object(E.i)(this.extent,this.tmpBoundingRect),e.extent))return new ee(e);if(this.tiles.has(e.id))return new ee(e);var r=this.createTileTree(e,this.tileInfo);return this.simplify(r,t,null,0,1),this.collectMissingTiles(e,r,this.tileInfo)}},{key:"debugInfo",get:function(){var e=this;return Array.from(this.tiles.values()).map((function(t){var r=t.data;return{data:r,featureCount:e.tileFeatureCounts.get(r.id)||0}}))}},{key:"getFeatureCount",value:function(e){var t=this.tileFeatureCounts.get(e.id);return null!=t?t:0}},{key:"fetchCount",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r,n,a){var s,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(s=this.tileFeatureCounts.get(t.id))){e.next=3;break}return e.abrupt("return",s);case 3:return e.next=5,Object(z.executeQueryForCount)(r,n,a);case 5:return u=e.sent,e.abrupt("return",(this.tileFeatureCounts.set(t.id,u.data.count),u.data.count));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"createTileTree",value:function(e,t){var r=this,n=new $(e.level,e.row,e.col);return t.updateTileInfo(n,1),this.tileBounds.forEachInBounds(e.extent,(function(i){var a=r.tiles.get(i).data;r.tilesAreRelated(e,a)&&r.populateChildren(n,a,t,r.tileFeatureCounts.get(a.id)||0)})),n}},{key:"tilesAreRelated",value:function(e,t){if(!e||!t)return!1;if(e.level===t.level)return e.row===t.row&&e.col===t.col;var r=e.level<t.level,n=r?e:t,i=r?t:e,a=1<<i.level-n.level;return Math.floor(i.row/a)===n.row&&Math.floor(i.col/a)===n.col}},{key:"populateChildren",value:function(e,t,r,n){var i=t.level-e.level-1;if(i<0)e.isLeaf=!0;else{var a=t.row>>i,s=t.col>>i,u=e.row<<1,o=s-(e.col<<1)+(a-u<<1),c=e.children[o];if(Object(p.j)(c))this.populateChildren(c,t,r,n);else{var l=new $(e.level+1,a,s);r.updateTileInfo(l,1),e.children[o]=l,this.populateChildren(l,t,r,n)}}}},{key:"simplify",value:function(e,t,r,n,i){var a=i*i;if(e.isLeaf)return t(this.getFeatureCount(e),i)?0:(this.remove(e),Object(p.j)(r)&&(r.children[n]=null),a);for(var s=i/2,u=s*s,o=0,c=0;c<e.children.length;c++){var l=e.children[c];o+=Object(p.j)(l)?this.simplify(l,t,e,c,s):u}return 0===o?this.mergeChildren(e):1-o/a<re&&(this.purge(e),Object(p.j)(r)&&(r.children[n]=null),o=a),o}},{key:"mergeChildren",value:function(e){var t=this,r=new Set,n=0;this.forEachLeaf(e,(function(e){var i=t.tiles.get(e.id);if(i){n+=i.byteSize;var a,s=Object(I.a)(i.objectIds);try{for(s.s();!(a=s.n()).done;){var u=a.value;r.has(u)||(r.add(u),t.referenceFeature(u))}}catch(o){s.e(o)}finally{s.f()}t.remove(e)}})),this.addTileStorage(e,r,n),e.isLeaf=!0,e.children[0]=e.children[1]=e.children[2]=e.children[3]=null,this.tileFeatureCounts.set(e.id,r.size)}},{key:"forEachLeaf",value:function(e,t){var r,n=Object(I.a)(e.children);try{for(n.s();!(r=n.n()).done;){var i=r.value;Object(p.i)(i)||(i.isLeaf?t(i):this.forEachLeaf(i,t))}}catch(a){n.e(a)}finally{n.f()}}},{key:"purge",value:function(e){if(!Object(p.i)(e))if(e.isLeaf)this.remove(e);else for(var t=0;t<e.children.length;t++){var r=e.children[t];this.purge(r),e.children[t]=null}}},{key:"collectMissingTiles",value:function(e,t,r){var n=new te(r,e,this.extent);return this.collectMissingTilesRecurse(t,n,1),n.info}},{key:"collectMissingTilesRecurse",value:function(e,t,r){if(!e.isLeaf)if(e.hasChildren)for(var n=r/2,i=0;i<e.children.length;i++){var a=e.children[i];Object(p.i)(a)?t.addMissing(e.level+1,(e.row<<1)+((2&i)>>1),(e.col<<1)+(1&i),n):this.collectMissingTilesRecurse(a,t,n)}else t.addMissing(e.level,e.row,e.col,r)}},{key:"referenceFeature",value:function(e){var t=(this.refCounts.get(e)||0)+1;return this.refCounts.set(e,t),1===t?0:2}},{key:"unreferenceFeature",value:function(e){var t=(this.refCounts.get(e)||0)-1;return 0===t?(this.refCounts.delete(e),1):(t>0&&this.refCounts.set(e,t),2)}},{key:"test",get:function(){var e=this;return{tiles:Array.from(this.tiles.values()).map((function(e){return"".concat(e.data.id,":[").concat(Array.from(e.objectIds),"]")})),featureReferences:Array.from(this.refCounts.keys()).map((function(t){return"".concat(t,":").concat(e.refCounts.get(t))}))}}}]),r}(T.a);Object(h.a)([Object(v.b)({constructOnly:!0})],X.prototype,"featureStore",void 0),Object(h.a)([Object(v.b)()],X.prototype,"tileInfo",void 0),Object(h.a)([Object(v.b)()],X.prototype,"extent",void 0),Object(h.a)([Object(v.b)()],X.prototype,"maximumByteSize",void 0),X=Object(h.a)([Object(g.a)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTileStore")],X);var K=function e(t,r,n){Object(u.a)(this,e),this.data=t,this.objectIds=r,this.byteSize=n},$=function(){function e(t,r,n){Object(u.a)(this,e),this.level=t,this.row=r,this.col=n,this.isLeaf=!1,this.extent=null,this.children=[null,null,null,null]}return Object(o.a)(e,[{key:"hasChildren",get:function(){return!this.isLeaf&&(Object(p.j)(this.children[0])||Object(p.j)(this.children[1])||Object(p.j)(this.children[2])||Object(p.j)(this.children[3]))}}]),e}(),ee=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(u.a)(this,e),this.missingTiles=r,this.fullArea=0,this.coveredArea=0,this.fullArea=Object(E.b)(t.extent),this.coveredArea=this.fullArea}return Object(o.a)(e,[{key:"prepend",value:function(e){this.missingTiles=e.missingTiles.concat(this.missingTiles),this.coveredArea+=e.coveredArea,this.fullArea+=e.fullArea}}]),e}(),te=function(){function e(t,r,n){Object(u.a)(this,e),this.tileInfo=t,this.extent=null,this.info=new ee(r),Object(p.j)(n)&&(this.extent=Object(E.i)(n))}return Object(o.a)(e,[{key:"addMissing",value:function(e,t,r,n){var i={id:null,level:e,row:t,col:r};this.tileInfo.updateTileInfo(i,1),!Object(p.j)(i.extent)||Object(p.j)(this.extent)&&!Object(E.k)(this.extent,i.extent)||(this.info.missingTiles.push({data:i,resolution:n}),this.info.coveredArea-=Object(E.b)(i.extent))}}]),e}(),re=.18751,ne=r(763),ie=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(u.a)(this,r),(e=t.apply(this,arguments)).isInitializing=!0,e.whenSetup=Object(b.f)(),e.handles=new d.a,e.updatingHandles=new ne.a,e.pendingApplyEdits=new Map,e}return Object(o.a)(r,[{key:"updating",get:function(){return this.featureFetcher.updating||this.isInitializing||this.updatingHandles.updating}},{key:"destroy",value:function(){this.featureFetcher.destroy(),this.queryEngine.destroy(),this.featureStore.clear(),this.handles.destroy()}},{key:"setup",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var r,n,s,u,o,c=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.serviceInfo,n=r.geometryType,s=r.objectIdField,u=r.timeInfo,o=r.fields,e.abrupt("return",(this.featureStore=new O.a(Object(a.a)(Object(a.a)({},t.serviceInfo),{},{hasZ:!1,hasM:!1})),this.queryEngine=new x.a({spatialReference:t.spatialReference,featureStore:this.featureStore,geometryType:n,fields:o,hasZ:!1,hasM:!1,objectIdField:s,timeInfo:u?w.a.fromJSON(u):null}),this.featureFetcher=new Q({store:new X({featureStore:this.featureStore}),url:t.serviceInfo.url,objectIdField:t.serviceInfo.objectIdField,globalIdField:t.serviceInfo.globalIdField,capabilities:t.serviceInfo.capabilities,spatialReference:j.a.fromJSON(t.spatialReference),sourceSpatialReference:j.a.fromJSON(t.serviceInfo.spatialReference)}),this.handles.add([this.featureFetcher.watch("availability",(function(e){return c.emit("notify-availability",{availability:e})}),!0),this.watch("updating",(function(){return c.notifyUpdating()}))]),this.whenSetup.resolve(),this.isInitializing=!1,this.configure(t.configuration)));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"configure",value:function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updatingHandles.addPromise(this.whenSetup.promise);case 2:return this.updateFeatureFetcherConfiguration(t),e.abrupt("return",{result:{}});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchCandidates",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.whenSetup.promise;case 2:return Object(b.v)(r),e.next=5,this.queryEngine.executeQueryForSnapping({point:t.point,distance:t.distance,types:t.types,query:Object(p.j)(t.filter)?t.filter:{where:"1=1"}},Object(p.j)(r)?r.signal:null);case 5:return e.t0=e.sent,e.abrupt("return",{result:e.t0});case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateTiles",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updatingHandles.addPromise(this.whenSetup.promise);case 2:return Object(b.v)(r),this.featureFetcher.tileSize=t.tileSize,this.featureFetcher.tilesOfInterest=t.tiles,this.featureFetcher.tileInfo=Object(p.j)(t.tileInfo)?k.a.fromJSON(t.tileInfo):null,e.abrupt("return",{result:{}});case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updatingHandles.addPromise(this.whenSetup.promise);case 2:return Object(b.v)(r),this.featureFetcher.refresh(),e.abrupt("return",{result:{}});case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"whenNotUpdating",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updatingHandles.addPromise(this.whenSetup.promise);case 2:return Object(b.v)(r),e.next=5,Object(b.y)(Object(y.e)(this,"updating"),r);case 5:return e.abrupt("return",{result:{}});case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getDebugInfo",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(Object(b.v)(r),{result:this.featureFetcher.debugInfo}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"beginApplyEdits",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.updatingHandles.addPromise(this.whenSetup.promise),Object(b.v)(r),n=Object(b.f)(),e.abrupt("return",(this.pendingApplyEdits.set(t.id,n),this.featureFetcher.applyEdits(n.promise),this.updatingHandles.addPromise(n.promise),{result:{}}));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"endApplyEdits",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.pendingApplyEdits.get(t.id),e.abrupt("return",(n&&n.resolve(t.edits),Object(b.v)(r),{result:{}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateFeatureFetcherConfiguration",value:function(e){this.featureFetcher.filter=Object(p.j)(e.filter)?_.a.fromJSON(e.filter):null,this.featureFetcher.customParameters=e.customParameters}},{key:"notifyUpdating",value:function(){this.emit("notify-updating",{updating:this.updating})}}]),r}(f.a.EventedAccessor);function ae(){return new ie}Object(h.a)([Object(v.b)({readOnly:!0})],ie.prototype,"updating",null),Object(h.a)([Object(v.b)()],ie.prototype,"isInitializing",void 0),ie=Object(h.a)([Object(g.a)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorker")],ie)},802:function(e,t,r){"use strict";r.d(t,"a",(function(){return R})),r.d(t,"b",(function(){return F})),r.d(t,"c",(function(){return I}));var n=r(7),i=r.n(n),a=r(21),s=r(12),u=r(29),o=r(101),c=r(235);var l=r(62),h=r(53);function f(e,t){return e?t?4:3:t?3:2}function d(e,t,r,n,i){if(!e)return!1;var s,u=f(t,r),o=e.coords,c=e.lengths,l=!1,h=0,d=Object(a.a)(c);try{for(d.s();!(s=d.n()).done;){var b=s.value;l=p(l,o,u,h,b,n,i),h+=b*u}}catch(y){d.e(y)}finally{d.f()}return l}function p(e,t,r,n,i,a,s){for(var u=e,o=n,c=n,l=n+i*r;c<l;c+=r){(o=c+r)===l&&(o=n);var h=t[c],f=t[c+1],d=t[o],p=t[o+1];(f<s&&p>=s||p<s&&f>=s)&&h+(s-f)/(p-f)*(d-h)<a&&(u=!u)}return u}var b=r(680),y=r(681),v=r(718),m=r(748),g="feature-store:unsupported-query",j={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},O={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},x={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},k={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function w(e){return!0===O[e]}function _(e){return!0===x[Object(l.c)(e)]}function S(e){return!0===k[e]}function I(e,t,n,i,a){if(Object(l.g)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var s=Object(b.e)(new y.a,t,!1,!1);return Promise.resolve((function(e){return function(e,t,r,n){return d(e,t,r,n.coords[0],n.coords[1])}(s,!1,!1,e)}))}if(Object(l.g)(t)&&"esriGeometryMultipoint"===n){var u=Object(b.e)(new y.a,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((function(e){return function(e,t,r,n,i,a){var s=f(i,a),u=n.coords,o=n.lengths;if(!o)return!1;for(var c=0,l=0;c<o.length;c++,l+=s)if(!d(e,t,r,u[l],u[l+1]))return!1;return!0}(u,!1,!1,e,i,a)}))}if(Object(l.d)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((function(e){return Object(o.e)(t,Object(m.c)(n,i,a,e))}));if(Object(l.d)(t)&&"esriGeometryMultipoint"===n&&"esriSpatialRelContains"===e)return Promise.resolve((function(e){return Object(o.d)(t,Object(m.c)(n,i,a,e))}));if(Object(l.d)(t)&&"esriSpatialRelIntersects"===e){var h=function(e){return"mesh"===e?c.a:Object(c.b)(e)}(n);return Promise.resolve((function(e){return h(t,Object(m.c)(n,i,a,e))}))}return Promise.all([r.e(9),r.e(19)]).then(r.bind(null,828)).then((function(r){var s=r[j[e]].bind(null,t.spatialReference,t);return function(e){return s(Object(m.c)(n,i,a,e))}}))}function F(e,t,r){return T.apply(this,arguments)}function T(){return(T=Object(s.a)(i.a.mark((function e(t,r,n){var a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.spatialRel,!(s=t.geometry)){e.next=11;break}if(w(a)){e.next=4;break}throw new u.a(g,"Unsupported query spatial relationship",{query:t});case 4:if(!Object(h.l)(s.spatialReference)||!Object(h.l)(n)){e.next=11;break}if(_(s)){e.next=7;break}throw new u.a(g,"Unsupported query geometry type",{query:t});case 7:if(S(r)){e.next=9;break}throw new u.a(g,"Unsupported layer geometry type",{query:t});case 9:if(!t.outSR){e.next=11;break}return e.abrupt("return",Object(v.a)(t.geometry&&t.geometry.spatialReference,t.outSR));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){if(Object(l.d)(e))return!0;if(Object(l.g)(e)){var t,r=Object(a.a)(e.rings);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(5!==n.length)return!1;if(n[0][0]!==n[1][0]||n[0][0]!==n[4][0]||n[2][0]!==n[3][0]||n[0][1]!==n[3][1]||n[0][1]!==n[4][1]||n[1][1]!==n[2][1])return!1}}catch(i){r.e(i)}finally{r.f()}return!0}return!1}},809:function(e,t,r){"use strict";r.d(t,"a",(function(){return ie}));var n=r(13),i=r(21),a=r(7),s=r.n(a),u=r(12),o=r(4),c=r(2),l=r(29),h=r(18),f=r(11),d=r(708),p=r(135),b=r(240),y=r(333),v=r(244),m=r(62),g=r(696),j=r(53),O=r(23),x=r(771),k=r(736),w=new(function(){function e(t,r){Object(c.a)(this,e),this._cache=new x.a(t),this._invalidCache=new x.a(r)}return Object(o.a)(e,[{key:"get",value:function(e,t){var r="".concat(t.uid,":").concat(e),n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{var i=k.WhereClause.create(e,t);return this._cache.put(r,i),i}catch(a){return this._invalidCache.put(r,null),null}}}]),e}())(50,500),_="feature-store:unsupported-query",S=" as ",I=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function F(e,t,r){if(!t)return!0;var n=w.get(t,e);if(!n)throw new l.a(_,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new l.a(_,"having does not contain a valid aggregate function",{having:t});var i=n.fieldNames;if(R(e,i,"having contains missing fields"),!n.getExpressions().every((function(t){var n=t.aggregateType,i=t.field,a=e.has(i)&&e.get(i).name;return r.some((function(t){var r=t.onStatisticField,i=t.statisticType;return(e.has(r)&&e.get(r).name)===a&&i.toLowerCase().trim()===n}))})))throw new l.a(_,"expressions in having should also exist in outStatistics",{having:t});return!0}function T(e,t){return e?w.get(e,t):null}function R(e,t,r){var n,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=[],u=Object(i.a)(t);try{for(u.s();!(n=u.n()).done;){var o=n.value;if("*"!==o&&!e.has(o))if(a){var c=M(o);try{var h=T(c,e);if(!h)throw new l.a(_,"invalid SQL expression",{where:c});if(!h.isStandardized)throw new l.a(_,"expression is not standard",{clause:h});R(e,h.fieldNames,"expression contains missing fields")}catch(d){var f=d&&d.details;if(f&&(f.clause||f.where))throw d;f&&f.missingFields?s.push.apply(s,Object(O.a)(f.missingFields)):s.push(o)}}else s.push(o)}}catch(p){u.e(p)}finally{u.f()}if(s.length)throw new l.a(_,r,{missingFields:s})}function M(e){return e.split(S)[0]}function P(e,t){var r=t.get(e);return!!r&&!I.has(r.type)}var C=r(718),E=r(752),A=r(775),N=r(680),z=r(759),V=function(){function e(t,r,n){Object(c.a)(this,e),this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=n,this.featureAdapter=r;var a=t.outFields;if(a&&-1===a.indexOf("*")){this.outFields=a;var s,u=0,o=Object(i.a)(a);try{for(o.s();!(s=o.n()).done;){var l=s.value,h=M(l),f=this.fieldsIndex.get(h),d=f?null:T(h,n),p=f?f.name:l.split(S)[1]||"FIELD_EXP_"+u++;this._fieldDataCache.set(l,{alias:p,clause:d})}}catch(b){o.e(b)}finally{o.f()}}}return Object(o.a)(e,[{key:"countDistinctValues",value:function(e){var t=this;return this.returnDistinctValues?(e.forEach((function(e){return t.getAttributes(e)})),this._returnDistinctMap.size):e.length}},{key:"getAttributes",value:function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}},{key:"getFieldValue",value:function(e,t,r){var n=r?r.name:t,i=null;return this._fieldDataCache.has(n)?i=this._fieldDataCache.get(n).clause:r||(i=T(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:i})),r?this.featureAdapter.getAttribute(e,n):i.calculateValue(e,this.featureAdapter)}},{key:"getNormalizedValue",value:function(e,t){var r=t.normalizationType,n=t.normalizationTotal,i=this.getFieldValue(e,t.field,t.fieldInfo);if(r&&Number.isFinite(i)){var a=this.getFieldValue(e,t.normalizationField,t.normalizationFieldInfo);i=Object(z.c)(i,r,a,n)}return i}},{key:"getExpressionValue",value:function(e,t,r){var n={attributes:this.featureAdapter.getAttributes(e)},i=r.createExecContext(n,t.viewInfo);return r.executeFunction(t.compiledFunc,i)}},{key:"validateItem",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:T(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}},{key:"validateItems",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:T(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}},{key:"_processAttributesForOutFields",value:function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);var r,n={},a=Object(i.a)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value,u=this._fieldDataCache.get(s),o=u.alias,c=u.clause;n[o]=c?c.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,o)}}catch(l){a.e(l)}finally{a.f()}return n}},{key:"_processAttributesForDistinctValues",value:function(e){if(Object(f.i)(e)||!this.returnDistinctValues)return e;var t=this.outFields,r=[];if(t){var n,a=Object(i.a)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value,u=this._fieldDataCache.get(s).alias;r.push(e[u])}}catch(h){a.e(h)}finally{a.f()}}else for(var o in e)r.push(e[o]);var c="".concat((t||["*"]).join(","),"=").concat(r.join(",")),l=this._returnDistinctMap.get(c)||0;return this._returnDistinctMap.set(c,++l),l>1?null:e}}]),e}(),D=r(762),B=r(748),q=r(209),Q=r(237);function G(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function L(e,t,r){return(r?e>t:e<t)?-1:(r?e<t:e>t)?1:0}function U(e,t,r){return r?t-e:e-t}function Z(e,t,r,n){if(r&&"esriFieldTypeDate"===r.type){var i=new Date(e).getTime(),a=new Date(t).getTime();if(!isNaN(i)&&!isNaN(a))return U(i,a,n)}if("number"==typeof e&&"number"==typeof t)return U(e,t,n);if("string"==typeof e&&"string"==typeof t){var s=e.toUpperCase(),u=t.toUpperCase();return!r||"esriFieldTypeGUID"!==r.type&&"esriFieldTypeGlobalID"!==r.type?L(s,u,n):L(G(s),G(u),n)}return n?1:-1}var J=function(){function e(t,r,n){Object(c.a)(this,e),this.items=t,this.queryGeometry=r,this.definitionExpression=n.definitionExpression,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.fieldsIndex=n.fieldsIndex,this.timeInfo=n.timeInfo,this.featureAdapter=n.featureAdapter,this.aggregateAdapter=n.aggregateAdapter}return Object(o.a)(e,[{key:"size",get:function(){return this.items.length}},{key:"createQueryResponseForCount",value:function(e){var t=new V(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);var r=e.groupByFieldsForStatistics,n=e.having;if(!(null==r?void 0:r.length))return 1;var a,s=new Map,u=new Map,o=new Set,c=e.outStatistics,l=Object(i.a)(c);try{for(l.s();!(a=l.n()).done;){var h=a.value,f="exceedslimit"!==h.statisticType?h.onStatisticField:void 0;if(!u.has(f)){var d,p=[],b=Object(i.a)(r);try{for(b.s();!(d=b.n()).done;){var y=d.value,v=this._getAttributeValues(t,y,s);p.push(v)}}catch(w){b.e(w)}finally{b.f()}u.set(f,this._calculateUniqueValues(p,t.returnDistinctValues))}var m=u.get(f);for(var g in m){var j=m[g],O=j.data,x=j.items,k=O.join(",");n&&!t.validateItems(x,n)||o.add(k)}}}catch(w){l.e(w)}finally{l.f()}return o.size}},{key:"createQueryResponse",value:function(e){var t;return t=e.outStatistics?e.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(Object(j.l)(e.outSR)&&!Object(j.d)(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=Object(B.b)(Object(n.a)({spatialReference:e.outSR},Object(C.b)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR))):t.queryGeometry=Object(B.b)(Object(n.a)({spatialReference:e.outSR},this.queryGeometry))),t}},{key:"createSnappingResponse",value:function(e,t){var r,n=this.featureAdapter,a=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),s=e.point,u=s.x,o=s.y,c="number"==typeof e.distance?e.distance:e.distance.x,l="number"==typeof e.distance?e.distance:e.distance.y,h={candidates:[]},d="esriGeometryPolygon"===this.geometryType,p=this.getPointCreator(e.point,this.spatialReference,t),b=Object(i.a)(this.items);try{for(b.s();!(r=b.n()).done;){var y=r.value,v=n.getGeometry(y);if(!Object(f.i)(v)){var m=v.coords,g=v.lengths;if(1&e.types)for(var j=0,O=0;O<g.length;O++)for(var x=g[O],k=0;k<x;k++,j+=a){var w=m[j],_=m[j+1];if(k!==x-1){var S=m[j+a],I=m[j+a+1],F=H(u,o,w,_,S,I),T=F.x,R=F.y,M=(u-T)/c,P=(o-R)/l,C=M*M+P*P;C<=1&&h.candidates.push({type:"edge",objectId:n.getObjectId(y),distance:Math.sqrt(C),target:p(T,R),start:p(w,_),end:p(S,I)})}}if(2&e.types)for(var E=d?m.length-a:m.length,A=0;A<E;A+=a){var N=m[A],z=m[A+1],V=(u-N)/c,D=(o-z)/l,B=V*V+D*D;B<=1&&h.candidates.push({type:"vertex",objectId:n.getObjectId(y),distance:Math.sqrt(B),target:p(N,z)})}}}}catch(q){b.e(q)}finally{b.f()}return h.candidates.sort((function(e,t){return e.distance-t.distance})),h}},{key:"getPointCreator",value:function(e,t,r){var n=Object(f.j)(r)&&!Object(j.d)(t,r)?function(e){return Object(C.b)(e,t,r)}:function(e){return e};return null!=e.z&&null!=e.m?function(t,r){return n({x:t,y:r,z:e.z,m:e.m})}:null!=e.z?function(t,r){return n({x:t,y:r,z:e.z})}:null!=e.m?function(t,r){return n({x:t,y:r,m:e.m})}:function(e,t){return n({x:e,y:t})}}},{key:"executeAttributesQuery",value:function(t){var r=T(t.where,this.fieldsIndex);if(!r)return Promise.resolve(this);if(r.isStandardized){var n,a=0,s=[],u=Object(i.a)(this.items);try{for(u.s();!(n=u.n()).done;){var o=n.value;r.testFeature(o,this.featureAdapter)&&(s[a++]=o)}}catch(l){u.e(l)}finally{u.f()}var c=new e(s,this.queryGeometry,this);return c.definitionExpression=t.where,Promise.resolve(c)}return Promise.reject(new TypeError("Where clause is not standardized"))}},{key:"executeAggregateIdsQuery",value:function(t){if(!t.aggregateIds||!t.aggregateIds.length||Object(f.i)(this.aggregateAdapter))return Promise.resolve(this);var r,n=new Set,a=Object(i.a)(t.aggregateIds);try{for(a.s();!(r=a.n()).done;){var s=r.value;this.aggregateAdapter.getFeatureObjectIds(s).forEach((function(e){return n.add(e)}))}}catch(o){a.e(o)}finally{a.f()}var u=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return n.has(u(e))})),this.queryGeometry,this))}},{key:"executeObjectIdsQuery",value:function(t){if(!t.objectIds||!t.objectIds.length)return Promise.resolve(this);var r=new Set(t.objectIds),n=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return r.has(n(e))})),this.queryGeometry,this))}},{key:"executeTimeQuery",value:function(t){var r=Object(D.b)(this.timeInfo,t.timeExtent,this.featureAdapter);if(!Object(f.j)(r))return Promise.resolve(this);var n=this.items.filter(r);return Promise.resolve(new e(n,this.queryGeometry,this))}},{key:"filterLatest",value:function(){var t,r=this.timeInfo,n=r.trackIdField,a=r.startTimeField,s=r.endTimeField||a,u=new Map,o=this.featureAdapter.getAttribute,c=Object(i.a)(this.items);try{for(c.s();!(t=c.n()).done;){var l=t.value,h=o(l,n),f=o(l,s),d=u.get(h);(!d||f>o(d,s))&&u.set(h,l)}}catch(b){c.e(b)}finally{c.f()}var p=Array.from(u.values());return Promise.resolve(new e(p,this.queryGeometry,this))}},{key:"project",value:function(){var t=Object(u.a)(s.a.mark((function t(r){var n,i,a=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&!Object(j.d)(this.spatialReference,r)){t.next=2;break}return t.abrupt("return",this);case 2:return n=this.featureAdapter,t.next=5,Object(C.c)(this.items.map((function(e){return Object(B.c)(a.geometryType,a.hasZ,a.hasM,n.getGeometry(e))})),this.spatialReference,r);case 5:return i=t.sent.map((function(e,t){return n.cloneWithGeometry(a.items[t],Object(N.d)(e,a.hasZ,a.hasM))})),t.abrupt("return",new e(i,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:r,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter}));case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"createSummaryStatisticsResponse",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){var n,i,a,u,o,c,l,h,f,d,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.field,i=r.normalizationField,a=r.normalizationType,u=r.normalizationTotal,o=r.minValue,c=r.maxValue,l=new V(t,this.featureAdapter,this.fieldsIndex),h=this.fieldsIndex.isDateField(n),!r.valueExpression){e.next=14;break}return e.next=11,this._getAttributeExpressionValues(l,r.valueExpression,r.viewInfoParams);case 11:e.t0=e.sent,e.next=15;break;case 14:e.t0=this._getAttributeNormalizedValues(l,{field:n,normalizationField:i,normalizationType:a,normalizationTotal:u});case 15:return f=e.t0,d=Object(z.d)({normalizationType:a,normalizationField:i,minValue:o,maxValue:c}),p=Object(q.j)(this.fieldsIndex.get(n))?Object(z.b)({values:f,supportsNullCount:d}):Object(z.a)({values:f,minValue:o,maxValue:c,useSampleStdDev:!a,supportsNullCount:d}),e.abrupt("return",Object(z.e)(p,h));case 19:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_sortFeatures",value:function(e,t,r){var n=this;if(e.length>1&&t&&t.length){var a,s=Object(i.a)(t.reverse());try{var u=function(){var t=a.value.split(" "),i=t[0],s=n.fieldsIndex.get(i),u=t[1]&&"desc"===t[1].toLowerCase();e.sort((function(e,t){return Z(r(e,i,s),r(t,i,s),s,u)}))};for(s.s();!(a=s.n()).done;)u()}catch(o){s.e(o)}finally{s.f()}}}},{key:"_createFeatureQueryResponse",value:function(e){var t=this,r=this.items,n=this.geometryType,i=this.hasM,a=this.hasZ,s=this.objectIdField,u=this.spatialReference,o=e.outFields,c=e.outSR,l=e.quantizationParameters,h=e.resultRecordCount,f=e.resultOffset,d=e.returnZ,p=e.returnM,b=null!=h&&r.length>(f||0)+h,y=o&&(o.indexOf("*")>-1?Object(O.a)(this.fieldsIndex.fields):o.map((function(e){return t.fieldsIndex.get(e)})));return{exceededTransferLimit:b,features:this._createFeatures(e,r),fields:y,geometryType:n,hasM:i&&p,hasZ:a&&d,objectIdFieldName:s,spatialReference:Object(B.b)(c||u),transform:l&&Object(A.a)(l)||null}}},{key:"_createFeatures",value:function(e,t){var r=new V(e,this.featureAdapter,this.fieldsIndex),n=this.hasM,a=this.hasZ,s=e.orderByFields,u=e.quantizationParameters,o=e.returnGeometry,c=e.returnCentroid,l=e.maxAllowableOffset,h=e.resultOffset,f=e.resultRecordCount,d=e.returnZ,p=void 0!==d&&d,b=e.returnM,y=a&&p,v=n&&(void 0!==b&&b),m=[],g=0,j=Object(O.a)(t);if(this._sortFeatures(j,s,(function(e,t,n){return r.getFieldValue(e,t,n)})),o||c){var x=Object(A.a)(u);if(o&&!c){var k,w=Object(i.a)(j);try{for(w.s();!(k=w.n()).done;){var _=k.value;m[g++]={attributes:r.getAttributes(_),geometry:Object(B.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(_),l,x,y,v)}}}catch(q){w.e(q)}finally{w.f()}}else if(!o&&c){var S,I=Object(i.a)(j);try{for(I.s();!(S=I.n()).done;){var F=S.value;m[g++]={attributes:r.getAttributes(F),centroid:Object(B.f)(this,this.featureAdapter.getCentroid(F,this),x)}}}catch(q){I.e(q)}finally{I.f()}}else{var T,R=Object(i.a)(j);try{for(R.s();!(T=R.n()).done;){var M=T.value;m[g++]={attributes:r.getAttributes(M),centroid:Object(B.f)(this,this.featureAdapter.getCentroid(M,this),x),geometry:Object(B.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(M),l,x,y,v)}}}catch(q){R.e(q)}finally{R.f()}}}else{var P,C=Object(i.a)(j);try{for(C.s();!(P=C.n()).done;){var E=P.value,N=r.getAttributes(E);N&&(m[g++]={attributes:N})}}catch(q){C.e(q)}finally{C.f()}}var z=h||0;if(null!=f){var D=z+f;m=m.slice(z,Math.min(m.length,D))}return m}},{key:"_createExceedsLimitQueryResponse",value:function(e){var t,r=!1,n=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,u=Object(i.a)(e.outStatistics);try{for(u.s();!(t=u.n()).done;){var o=t.value;if("exceedslimit"===o.statisticType){n=null!=o.maxPointCount?o.maxPointCount:Number.POSITIVE_INFINITY,a=null!=o.maxRecordCount?o.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=o.maxVertexCount?o.maxVertexCount:Number.POSITIVE_INFINITY;break}}}catch(h){u.e(h)}finally{u.f()}if("esriGeometryPoint"===this.geometryType)r=this.items.length>n;else if(this.items.length>a)r=!0;else{var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter;r=this.items.reduce((function(e,t){var r=l.getGeometry(t);return e+(Object(f.j)(r)&&r.coords.length||0)}),0)/c>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(r)}}]}}},{key:"_createStatisticsQueryResponse",value:function(e){var t,r=this,n={attributes:{}},a=[],s=new Map,u=new Map,o=new Map,c=new Map,l=new V(e,this.featureAdapter,this.fieldsIndex),h=e.outStatistics,f=e.groupByFieldsForStatistics,d=e.having,p=e.orderByFields,b=f&&f.length,y=!!b,v=y&&f[0],m=y&&!this.fieldsIndex.get(v),g=Object(i.a)(h);try{for(g.s();!(t=g.n()).done;){var j=t.value,O=j.outStatisticFieldName,x=j.statisticType,k=j,w="exceedslimit"!==x?j.onStatisticField:void 0,_="percentile_disc"===x||"percentile_cont"===x,S=y&&1===b&&(w===v||m)&&"count"===x;if(y){if(!o.has(w)){var I,F=[],T=Object(i.a)(f);try{for(T.s();!(I=T.n()).done;){var R=I.value,M=this._getAttributeValues(l,R,s);F.push(M)}}catch(z){T.e(z)}finally{T.f()}o.set(w,this._calculateUniqueValues(F,l.returnDistinctValues))}var P=o.get(w),C=function(e){var t=P[e],n=t.count,i=t.data,a=t.items,u=t.itemPositions,o=i.join(",");if(!d||l.validateItems(a,d)){var h=c.get(o)||{attributes:{}},p=null;if(S)p=n;else{var b=r._getAttributeValues(l,w,s),y=u.map((function(e){return b[e]}));p=_&&"statisticParameters"in k?r._getPercentileValue(k,y):r._getStatisticValue(k,y,null,l.returnDistinctValues)}h.attributes[O]=p,f.forEach((function(e,t){return h.attributes[r.fieldsIndex.get(e)?e:"EXPR_".concat(t+1)]=i[t]})),c.set(o,h)}};for(var E in P)C(E)}else{var A=this._getAttributeValues(l,w,s);n.attributes[O]=_&&"statisticParameters"in k?this._getPercentileValue(k,A):this._getStatisticValue(k,A,u,l.returnDistinctValues)}a.push({name:O,alias:O,type:"esriFieldTypeDouble"})}}catch(z){g.e(z)}finally{g.f()}var N=y?Array.from(c.values()):[n];return this._sortFeatures(N,p,(function(e,t){return e.attributes[t]})),{fields:a,features:N}}},{key:"_getStatisticValue",value:function(e,t,r,n){var i,a=e.onStatisticField,s=e.statisticType;return i=null!=r&&r.has(a)?r.get(a):Object(q.j)(this.fieldsIndex.get(a))?Object(z.b)({values:t,returnDistinct:n}):Object(z.a)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),r&&r.set(a,i),i["var"===s?"variance":s]}},{key:"_getPercentileValue",value:function(e,t){var r=e.onStatisticField,n=e.statisticParameters,i=e.statisticType,a=n.value,s="desc"===n.orderBy,u=this.fieldsIndex.get(r),o=Object(O.a)(t).filter((function(e){return null!=e})).sort((function(e,t){return Z(e,t,u,s)}));return this._calculatePercentile(o,a,"percentile_disc"===i)}},{key:"_getAttributeValues",value:function(e,t,r){if(r.has(t))return r.get(t);var n=this.fieldsIndex.get(t),i=this.items.map((function(r){return e.getFieldValue(r,t,n)}));return r.set(t,i),i}},{key:"_getAttributeNormalizedValues",value:function(e,t){var r=this;return this.items.map((function(n){return e.getNormalizedValue(n,{field:t.field,fieldInfo:r.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:r.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})}))}},{key:"_getAttributeExpressionValues",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r,n){var i,a,u,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Q.e)();case 2:return i=e.sent,a=i.arcadeUtils,u=a.createFunction(r),o=n&&a.getViewInfo(n),e.abrupt("return",this.items.map((function(e){return t.getExpressionValue(e,{compiledFunc:u,viewInfo:o},a)})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_calculateUniqueValues",value:function(e,t){for(var r={},n=this.items,a=n.length,s=0;s<a;s++){var u,o=n[s],c=[],l=Object(i.a)(e);try{for(l.s();!(u=l.n()).done;){var h=u.value;c.push(h[s])}}catch(d){l.e(d)}finally{l.f()}var f=c.join(",");t?null==r[f]&&(r[f]={count:1,data:c,items:[o],itemPositions:[s]}):null==r[f]?r[f]={count:1,data:c,items:[o],itemPositions:[s]}:(r[f].count++,r[f].items.push(o),r[f].itemPositions.push(s))}return r}},{key:"_calculatePercentile",value:function(e,t,r){if(0===e.length)return null;if(t<=0)return e[0];if(t>=1)return e[e.length-1];var n=(e.length-1)*t,i=Math.floor(n),a=i+1,s=n%1,u=e[i],o=e[a];return a>=e.length||r||"string"==typeof u||"string"==typeof o?u:u*(1-s)+o*s}}]),e}();function H(e,t,r,n,i,a){var s=i-r,u=a-n,o=s*s+u*u,c=(e-r)*s+(t-n)*u,l=Math.min(1,Math.max(0,c/o));return{x:r+s*l,y:n+u*l}}var Y=r(802),W=r(672),X=r(30),K=function(){function e(){Object(c.a)(this,e),this._tasks=new Array}return Object(o.a)(e,[{key:"length",get:function(){return this._tasks.length}},{key:"push",value:function(e,t,r){var n=this;return new Promise((function(i,a){return n._tasks.push(new $(i,a,e,t,r))}))}},{key:"unshift",value:function(e,t,r){var n=this;return new Promise((function(i,a){return n._tasks.unshift(new $(i,a,e,t,r))}))}},{key:"process",value:function(){if(0===this._tasks.length)return!1;var e=this._tasks.shift();try{var t=Object(X.n)(e.signal);if(t&&!e.abortCallback)e.reject(Object(X.e)());else{var r=t?e.abortCallback(Object(X.e)()):e.callback();Object(X.o)(r)?r.then(e.resolve,e.reject):e.resolve(r)}}catch(n){e.reject(n)}return!0}},{key:"cancelAll",value:function(){var e,t=Object(X.e)(),r=Object(i.a)(this._tasks);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(n.abortCallback){var a=n.abortCallback(t);n.resolve(a)}else n.reject(t)}}catch(s){r.e(s)}finally{r.f()}this._tasks.length=0}}]),e}(),$=function e(t,r,n,i,a){Object(c.a)(this,e),this.resolve=t,this.reject=r,this.callback=n,this.signal=i,this.abortCallback=a};var ee="feature-store:unsupported-query",te=new Set,re=new d.b(2e6),ne=0,ie=function(){function e(t){var r=this;Object(c.a)(this,e),this.capabilities={query:E.a},this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this.aggregateAdapter=t.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(function(){return r.clearCache()})),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new d.a(ne+++"$$",re)),this.fieldsIndex=new W.a(t.fields),t.scheduler&&t.priority&&(this._frameQueue=new K,this._frameTask=t.scheduler.registerTask(t.priority,this))}return Object(o.a)(e,[{key:"destroy",value:function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}},{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}},{key:"fullExtent",get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:Object(B.b)(this.spatialReference)}:null}},{key:"timeExtent",get:function(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(D.a)(this.timeInfo,this.featureStore)),this._timeExtent):null}},{key:"clearCache",value:function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}},{key:"executeQuery",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,i,a=this,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,i=Object(h.a)(t),e.prev=3,e.next=6,this._schedule((function(){return Object(B.d)(i,a.definitionExpression,a.spatialReference)}),r);case 6:return i=e.sent,e.next=9,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 9:return i=e.sent,e.next=12,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 12:return n=e.sent,e.next=15,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 15:return n=e.sent,e.next=18,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 18:return n=e.sent,e.next=21,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 21:return n=e.sent,e.next=24,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 24:n=e.sent,e.next=32;break;case 27:if(e.prev=27,e.t0=e.catch(3),e.t0===B.a){e.next=31;break}throw e.t0;case 31:n=new J([],null,this);case 32:return e.abrupt("return",n.createQueryResponse(i));case 33:case"end":return e.stop()}}),e,this,[[3,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForCount",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,i,a=this,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,(i=Object(h.a)(t)).returnGeometry=!1,i.returnCentroid=!1,i.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return Object(B.d)(i,a.definitionExpression,a.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 10:return i=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 13:return n=e.sent,e.next=16,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 25:n=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(4),e.t0===B.a){e.next=32;break}throw e.t0;case 32:return e.abrupt("return",0);case 33:return e.abrupt("return",n.createQueryResponseForCount(i));case 34:case"end":return e.stop()}}),e,this,[[4,28]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForExtent",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,i,a,u,o,c,l,f,d,y=this,v=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.length>0&&void 0!==v[0]?v[0]:{},r=v.length>1?v[1]:void 0,i=Object(h.a)(t),a=i.outSR,e.prev=4,e.next=7,this._schedule((function(){return Object(B.d)(i,y.definitionExpression,y.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return y._checkQuerySupport(i)}),r);case 10:return(i=e.sent).returnGeometry=!0,i.returnCentroid=!1,i.outSR=null,e.next=16,this._reschedule((function(){return y._executeGeometryQuery(i,r)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 25:return n=e.sent,e.next=28,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 28:if(n=e.sent,u=n.size){e.next=32;break}return e.abrupt("return",{count:u,extent:null});case 32:return Object(b.j)(se,b.a),this.featureStore.forEachBounds(n.items,(function(e){return Object(b.e)(se,e)}),ae),o={xmin:se[0],ymin:se[1],xmax:se[3],ymax:se[4],spatialReference:Object(B.b)(this.spatialReference)},this.hasZ&&isFinite(se[2])&&isFinite(se[5])&&(o.zmin=se[2],o.zmax=se[5]),(c=Object(C.b)(o,n.spatialReference,a)).spatialReference=Object(B.b)(a||this.spatialReference),c.xmax-c.xmin==0&&(l=Object(p.d)(c.spatialReference),c.xmin-=l,c.xmax+=l),c.ymax-c.ymin==0&&(f=Object(p.d)(c.spatialReference),c.ymin-=f,c.ymax+=f),this.hasZ&&null!=c.zmin&&null!=c.zmax&&c.zmax-c.zmin==0&&(d=Object(p.d)(c.spatialReference),c.zmin-=d,c.zmax+=d),e.abrupt("return",{count:u,extent:c});case 42:if(e.prev=42,e.t0=e.catch(4),e.t0!==B.a){e.next=46;break}return e.abrupt("return",{count:0,extent:null});case 46:throw e.t0;case 47:case"end":return e.stop()}}),e,this,[[4,42]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForIds",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1?n[1]:void 0,e.abrupt("return",this.executeQueryForIdSet(t,r).then((function(e){return Array.from(e)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForIdSet",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,a,u,o,c=this,l=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=l.length>1?l[1]:void 0,(a=Object(h.a)(t)).returnGeometry=!1,a.returnCentroid=!1,a.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return Object(B.d)(a,c.definitionExpression,c.spatialReference)}),r);case 7:return a=e.sent,e.next=10,this._reschedule((function(){return c._checkQuerySupport(a)}),r);case 10:return a=e.sent,e.next=13,this._reschedule((function(){return c._executeGeometryQuery(a,r)}),r);case 13:return n=e.sent,e.next=16,this._reschedule((function(){return n.executeAggregateIdsQuery(a)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeObjectIdsQuery(a)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeTimeQuery(a)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeAttributesQuery(a)}),r);case 25:return n=e.sent,u=n.items,o=new Set,e.next=29,this._reschedule((function(){var e,t=Object(i.a)(u);try{for(t.s();!(e=t.n()).done;){var r=e.value;o.add(n.featureAdapter.getObjectId(r))}}catch(a){t.e(a)}finally{t.f()}}),r);case 29:return e.abrupt("return",o);case 32:if(e.prev=32,e.t0=e.catch(4),e.t0!==B.a){e.next=36;break}return e.abrupt("return",new Set);case 36:throw e.t0;case 37:case"end":return e.stop()}}),e,this,[[4,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForSnapping",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){var i,a,u,o,c,l,h,d,p,b,y,v,O,x,k=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.point,a=t.distance,0!==t.types){e.next=3;break}return e.abrupt("return",{candidates:[]});case 3:return e.next=5,this._reschedule((function(){return k._checkQuerySupport(t.query)}),r);case 5:if(u=e.sent,o=!Object(j.d)(i.spatialReference,this.spatialReference),e.t0=o,!e.t0){e.next=11;break}return e.next=11,Object(C.a)(i.spatialReference,this.spatialReference);case 11:if(c="number"==typeof a?a:a.x,l="number"==typeof a?a:a.y,h={xmin:i.x-c,xmax:i.x+c,ymin:i.y-l,ymax:i.y+l,spatialReference:i.spatialReference},d=o?Object(C.b)(h,this.spatialReference):h){e.next=14;break}return e.abrupt("return",{candidates:[]});case 14:return e.next=16,Object(g.a)(Object(m.a)(i),null,{signal:r});case 16:return p=e.sent[0],e.next=19,Object(g.a)(Object(m.a)(d),null,{signal:r});case 19:if(b=e.sent[0],!Object(f.i)(p)&&!Object(f.i)(b)){e.next=22;break}return e.abrupt("return",{candidates:[]});case 22:return y=new J(this._searchFeatures(this._getQueryBBoxes(b.toJSON())),null,this),e.next=25,this._reschedule((function(){return y.executeObjectIdsQuery(u)}),r);case 25:return y=e.sent,e.next=28,this._reschedule((function(){return y.executeTimeQuery(u)}),r);case 28:return y=e.sent,e.next=31,this._reschedule((function(){return y.executeAttributesQuery(u)}),r);case 31:return y=e.sent,v=p.toJSON(),O=o?Object(C.b)(v,this.spatialReference):v,x=o?Math.max(d.xmax-d.xmin,d.ymax-d.ymin)/2:a,e.abrupt("return",y.createSnappingResponse(Object(n.a)(Object(n.a)({},t),{},{point:O,distance:x}),i.spatialReference));case 34:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForLatestObservations",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,i,a=this,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,this.timeInfo&&this.timeInfo.trackIdField){e.next=4;break}throw new l.a(ee,"Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});case 4:return i=Object(h.a)(t),e.prev=5,e.next=8,this._schedule((function(){return Object(B.d)(i,a.definitionExpression,a.spatialReference)}),r);case 8:return i=e.sent,e.next=11,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 11:return i=e.sent,e.next=14,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 14:return n=e.sent,e.next=17,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 17:return n=e.sent,e.next=20,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 20:return n=e.sent,e.next=23,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 23:return n=e.sent,e.next=26,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 26:return n=e.sent,e.next=29,this._reschedule((function(){return n.filterLatest()}),r);case 29:n=e.sent,e.next=37;break;case 32:if(e.prev=32,e.t0=e.catch(5),e.t0===B.a){e.next=36;break}throw e.t0;case 36:n=new J([],null,this);case 37:return e.abrupt("return",n.createQueryResponse(i));case 38:case"end":return e.stop()}}),e,this,[[5,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForSummaryStatistics",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,i,a=this,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,n=u.length>2?u[2]:void 0,t=Object(h.a)(t),e.prev=4,e.next=7,this._schedule((function(){return Object(B.d)(t,a.definitionExpression,a.spatialReference)}),n);case 7:return t=e.sent,e.next=10,this._reschedule((function(){return a._checkSummaryStatisticsSupport(t,r)}),n);case 10:return t=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(t,n)}),n);case 13:return i=e.sent,e.next=16,this._reschedule((function(){return i.executeAggregateIdsQuery(t)}),n);case 16:return i=e.sent,e.next=19,this._reschedule((function(){return i.executeObjectIdsQuery(t)}),n);case 19:return i=e.sent,e.next=22,this._reschedule((function(){return i.executeTimeQuery(t)}),n);case 22:return i=e.sent,e.next=25,this._reschedule((function(){return i.executeAttributesQuery(t)}),n);case 25:i=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(4),e.t0===B.a){e.next=32;break}throw e.t0;case 32:i=new J([],null,this);case 33:return e.abrupt("return",i.createSummaryStatisticsResponse(t,r));case 34:case"end":return e.stop()}}),e,this,[[4,28]])})));return function(){return e.apply(this,arguments)}}()},{key:"_schedule",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._frameQueue?this._frameQueue.push(t,r):t());case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_reschedule",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._frameQueue?this._frameQueue.unshift(t,r):t());case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"running",get:function(){return this._frameQueue.length>0}},{key:"runTask",value:function(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null}},{key:"_getAll",value:function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new J(e,null,this)}return this._allItems}},{key:"_executeGeometryQuery",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){var n,a,o,c,l,h,d,p,b,y,v,m,g,O,x,k,w,_,S,I,F,T,R,M=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.geometry,a=t.outSR,o=t.spatialRel,c=t.returnGeometry,l=t.returnCentroid,h=c||l,d=Object(j.l)(a)&&!Object(j.d)(this.spatialReference,a),!(p=this._geometryQueryCache?d&&h?JSON.stringify({geometry:n,spatialRelationship:o,outSpatialReference:a}):JSON.stringify({geometry:n,spatialRelationship:o}):null)){e.next=5;break}if(b=this._geometryQueryCache.get(p),Object(f.k)(b)){e.next=5;break}return e.abrupt("return",b);case 5:if(y=function(){var e=Object(u.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d||!h){e.next=5;break}return e.next=3,t.project(a);case 3:return r=e.sent,e.abrupt("return",(p&&M._geometryQueryCache.put(p,r,r.size||1),r));case 5:return e.abrupt("return",(p&&M._geometryQueryCache.put(p,t,t.size||1),t));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n){e.next=8;break}return e.abrupt("return",y(this._getAll()));case 8:if(v=this.featureAdapter,"esriSpatialRelDisjoint"!==o){e.next=22;break}if((m=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=13;break}return e.abrupt("return",y(this._getAll()));case 13:x=new Set,k=Object(i.a)(m);try{for(k.s();!(w=k.n()).done;)_=w.value,x.add(v.getObjectId(_))}catch(P){k.e(P)}finally{k.f()}return e.next=18,this._reschedule((function(){var e=0;g=new Array(x.size),M.featureStore.forEach((function(t){return g[e++]=t})),O=x}),r);case 18:return e.next=20,this._reschedule(Object(u.a)(s.a.mark((function e(){var t,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Y.c)(o,n,M.geometryType,M.hasZ,M.hasM);case 2:return t=e.sent,i=function(e){return!O.has(v.getObjectId(e))||t(v.getGeometry(e))},e.t0=J,e.next=7,M._runSpatialFilter(g,i,r);case 7:return e.t1=e.sent,e.t2=n,e.t3=M,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3));case 11:case"end":return e.stop()}}),e)}))),r);case 20:return S=e.sent,e.abrupt("return",y(S));case 22:if((I=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=26;break}return F=new J([],n,this),e.abrupt("return",(p&&this._geometryQueryCache.put(p,F,F.size||1),F));case 26:if(!this._canExecuteSoloPass(n,t)){e.next=28;break}return e.abrupt("return",y(new J(I,n,this)));case 28:return e.next=30,Object(Y.c)(o,n,this.geometryType,this.hasZ,this.hasM);case 30:return T=e.sent,e.next=33,this._runSpatialFilter(I,(function(e){return T(v.getGeometry(e))}),r);case 33:return R=e.sent,e.abrupt("return",y(new J(R,n,this)));case 35:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_runSpatialFilter",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r,n){var i,a,o,c=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",t);case 2:if(this._budget){e.next=4;break}return e.abrupt("return",t.filter((function(e){return r(e)})));case 4:return i=0,a=new Array,o=function(){var e=Object(u.a)(s.a.mark((function e(){var u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<t.length)){e.next=10;break}if(u=t[i],r(u)&&a.push(u),e.t0=c._budget.done,!e.t0){e.next=7;break}return e.next=7,c._reschedule((function(){return o()}),n);case 7:++i;case 8:e.next=0;break;case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",this._reschedule((function(){return o()}),n).then((function(){return a})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_canExecuteSoloPass",value:function(e,t){var r=this.geometryType,n=t.spatialRel;return Object(Y.a)(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))}},{key:"_getQueryBBoxes",value:function(e){if(Object(Y.a)(e)){if(Object(m.d)(e))return[Object(y.j)(e.xmin,e.ymin,e.xmax,e.ymax)];if(Object(m.g)(e))return e.rings.map((function(e){return Object(y.j)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[Object(v.a)(Object(y.e)(),e)]}},{key:"_searchFeatures",value:function(e){var t,r=Object(i.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.featureStore.forEachInBounds(n,(function(e){te.add(e)}))}}catch(u){r.e(u)}finally{r.f()}var a=new Array(te.size),s=0;return te.forEach((function(e){return a[s++]=e})),te.clear(),a}},{key:"_checkSummaryStatisticsSupport",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)){e.next=2;break}throw new l.a(ee,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkSummaryStatisticsParamsSupport(r),Object(Y.b)(t,this.geometryType,this.spatialReference),Object(C.a)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_checkSummaryStatisticsParamsSupport",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var r,n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],!t.valueExpression){e.next=7;break}return e.next=4,Object(Q.e)();case 4:n=e.sent,i=n.arcadeUtils,r=i.extractFieldNames(t.valueExpression);case 7:if(t.field&&r.push(t.field),t.normalizationField&&r.push(t.normalizationField),r.length){e.next=9;break}throw new l.a(ee,"params should have at least a field or valueExpression",{params:t});case 9:R(this.fieldsIndex,r,"params contains missing fields");case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_checkQuerySupport",value:function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)){e.next=2;break}throw new l.a(ee,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),Object(Y.b)(t,this.geometryType,this.spatialReference),Object(C.a)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_checkAttributesQuerySupport",value:function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues,i=e.outStatistics,a=i?i.map((function(e){return e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()})):[];if(r&&r.length>0){var s=" asc",u=" desc",o=r.map((function(e){var t=e.toLowerCase();return t.indexOf(s)>-1?t.split(s)[0]:t.indexOf(u)>-1?t.split(u)[0]:e})).filter((function(e){return-1===a.indexOf(e)}));R(this.fieldsIndex,o,"orderByFields contains missing fields")}if(t&&t.length>0)R(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new l.a(ee,"outFields should be specified for returnDistinctValues",{query:e});!function(e,t){if(!t)return!0;var r=w.get(t,e);if(!r)throw new l.a(_,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new l.a(_,"where clause is not standard",{where:t});R(e,r.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,e.where)}},{key:"_checkStatisticsQuerySupport",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var r,n,a,u,o,c,h,f,d,p,b;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.outStatistics,n=t.groupByFieldsForStatistics,a=t.having,u=n&&n.length,o=r&&r.length,!a){e.next=5;break}if(u&&o){e.next=4;break}throw new l.a(ee,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});case 4:F(this.fieldsIndex,a,r);case 5:if(!o){e.next=34;break}if(r.every((function(e){return"exceedslimit"!==e.statisticType}))){e.next=8;break}return e.abrupt("return");case 8:c=r.map((function(e){return e.onStatisticField})),R(this.fieldsIndex,c,"onStatisticFields contains missing fields"),u&&R(this.fieldsIndex,n,"groupByFieldsForStatistics contains missing fields"),h=Object(i.a)(r),e.prev=11,h.s();case 13:if((f=h.n()).done){e.next=26;break}if(d=f.value,p=d.onStatisticField,"percentile_disc"!==(b=d.statisticType)&&"percentile_cont"!==b||!("statisticParameters"in d)){e.next=22;break}if(d.statisticParameters){e.next=20;break}throw new l.a(ee,"statisticParamters should be set for percentile type",{definition:d,query:t});case 20:e.next=24;break;case 22:if("count"===b||!p||!P(p,this.fieldsIndex)){e.next=24;break}throw new l.a(ee,"outStatistics contains non-numeric fields",{definition:d,query:t});case 24:e.next=13;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(11),h.e(e.t0);case 31:return e.prev=31,h.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[11,28,31,34]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ae=Object(b.b)(),se=Object(b.b)()},811:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),i=r(4),a=r(19),s=r(863),u={minX:0,minY:0,maxX:0,maxY:0};var o=function(){function e(){var t=this;Object(n.a)(this,e),this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new s.a(9,Object(a.a)("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this._loadIndex=function(){if(t._indexInvalid){var e=new Array(t._idByBounds.size),r=0;t._idByBounds.forEach((function(t,n){e[r++]=n})),t._indexInvalid=!1,t._index.clear(),t._index.load(e)}else t._boundsToLoad.length&&(t._index.load(t._boundsToLoad.filter((function(e){return t._idByBounds.has(e)}))),t._boundsToLoad.length=0)}}return Object(i.a)(e,[{key:"clear",value:function(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}},{key:"delete",value:function(e){var t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}},{key:"forEachInBounds",value:function(e,t){var r=this;this._loadIndex(),function(e,t,r){u.minX=t[0],u.minY=t[1],u.maxX=t[2],u.maxY=t[3],e.search(u,r)}(this._index,e,(function(e){return t(r._idByBounds.get(e))}))}},{key:"get",value:function(e){return this._boundsById.get(e)}},{key:"has",value:function(e){return this._boundsById.has(e)}},{key:"invalidateIndex",value:function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}},{key:"set",value:function(e,t){if(!this._indexInvalid){var r=this._boundsById.get(e);r&&(this._index.remove(r),this._idByBounds.delete(r))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}]),e}()},831:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(21),i=r(2),a=r(4),s=r(29),u=r(184),o=r(15),c=r(11),l=r(240),h=r(333),f=r(680),d=r(811),p=r(758),b=r(731),y=r(681),v={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new b.b(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return e.centroid||(e.centroid=Object(p.a)(new y.a,e.geometry,t.hasZ,t.hasM)),e.centroid}},m=function(){function e(t){Object(i.a)(this,e),this.geometryInfo=t,this._boundsStore=new d.a,this._featuresById=new Map,this._markedIds=new Set,this.events=new u.a,this.featureAdapter=v}return Object(a.a)(e,[{key:"geometryType",get:function(){return this.geometryInfo.geometryType}},{key:"hasM",get:function(){return this.geometryInfo.hasM}},{key:"hasZ",get:function(){return this.geometryInfo.hasZ}},{key:"numFeatures",get:function(){return this._featuresById.size}},{key:"fullBounds",get:function(){var e=this;if(!this.numFeatures)return null;var t=Object(h.e)(h.a);return this._featuresById.forEach((function(r){var n=e._boundsStore.get(r.objectId);n&&(t[0]=Math.min(n[0],t[0]),t[1]=Math.min(n[1],t[1]),t[2]=Math.max(n[2],t[2]),t[3]=Math.max(n[3],t[3]))})),t}},{key:"storeStatistics",get:function(){var e=0;return this._featuresById.forEach((function(t){Object(c.j)(t.geometry)&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}},{key:"add",value:function(e){this._add(e),this._emitChanged()}},{key:"addMany",value:function(e){var t,r=Object(n.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this._add(i)}}catch(a){r.e(a)}finally{r.f()}this._emitChanged()}},{key:"clear",value:function(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}},{key:"removeById",value:function(e){var t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}},{key:"removeManyById",value:function(e){this._boundsStore.invalidateIndex();var t,r=Object(n.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=this._featuresById.get(i);a&&this._remove(a)}}catch(s){r.e(s)}finally{r.f()}this._emitChanged()}},{key:"forEachBounds",value:function(e,t,r){var i,a=Object(n.a)(e);try{for(a.s();!(i=a.n()).done;){var s=i.value,u=this._boundsStore.get(s.objectId);u&&t(Object(l.h)(r,u))}}catch(o){a.e(o)}finally{a.f()}}},{key:"getFeature",value:function(e){return this._featuresById.get(e)}},{key:"has",value:function(e){return this._featuresById.has(e)}},{key:"forEach",value:function(e){this._featuresById.forEach((function(t){return e(t)}))}},{key:"forEachInBounds",value:function(e,t){var r=this;this._boundsStore.forEachInBounds(e,(function(e){t(r._featuresById.get(e))}))}},{key:"startMarkingUsedFeatures",value:function(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}},{key:"sweep",value:function(){var e=this,t=!1;this._featuresById.forEach((function(r,n){e._markedIds.has(n)||(t=!0,e._remove(r))})),this._markedIds.clear(),t&&this._emitChanged()}},{key:"_emitChanged",value:function(){this.events.emit("changed",void 0)}},{key:"_add",value:function(e){if(e){var t=e.objectId;if(null!=t){var r,n=this._featuresById.get(t);if(this._markedIds.add(t),n?(e.displayId=n.displayId,r=this._boundsStore.get(t),this._boundsStore.delete(t)):Object(c.j)(this.onFeatureAdd)&&this.onFeatureAdd(e),Object(c.i)(e.geometry)||!e.geometry.coords||!e.geometry.coords.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);r=Object(f.o)(Object(c.j)(r)?r:Object(h.e)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),Object(c.j)(r)&&this._boundsStore.set(t,r),this._featuresById.set(t,e)}else o.a.getLogger("esri.layers.graphics.data.FeatureStore").error(new s.a("featurestore:invalid-feature","feature id is missing",{feature:e}))}}},{key:"_remove",value:function(e){return Object(c.j)(this.onFeatureRemove)&&this.onFeatureRemove(e),this._markedIds.delete(e.objectId),this._boundsStore.delete(e.objectId),this._featuresById.delete(e.objectId),e}}]),e}()},984:function(e,t,r){"use strict";function n(e){return 32+e.length}function i(e){if(!e)return 0;var t=32;for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];switch(typeof i){case"string":t+=n(i);break;case"number":t+=16;break;case"boolean":t+=4}}return t}function a(e,t){return 32+e.length*t}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}))}}]);
//# sourceMappingURL=51.eff65b7f.chunk.js.map