(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[3,92],{677:function(e,t,r){"use strict";r.d(t,"a",(function(){return I})),r.d(t,"b",(function(){return _}));var a=r(21),n=r(2),i=r(4),o=r(5),s=r(6),l=r(0),c=r(60),u=r(8),p=r(11),b=r(23),d=r(18),f=r(164),v=function(){function e(){Object(n.a)(this,e),this._propertyOriginMap=new Map,this._originStores=new Array(f.a),this._values=new Map}return Object(i.a)(e,[{key:"clone",value:function(t){var r=this,a=new e,n=this._originStores[0];n&&n.forEach((function(e,t){a.set(t,Object(d.a)(e),0)}));for(var i=function(e){var n=r._originStores[e];n&&n.forEach((function(r,n){t&&t.has(n)||a.set(n,Object(d.a)(r),e)}))},o=2;o<f.a;o++)i(o);return a}},{key:"get",value:function(e,t){var r=void 0===t?this._values:this._originStores[t];return r?r.get(e):void 0}},{key:"keys",value:function(e){var t=null==e?this._values:this._originStores[e];return t?Object(b.a)(t.keys()):[]}},{key:"set",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,a=this._originStores[r];if(a||(a=new Map,this._originStores[r]=a),a.set(e,t),!this._values.has(e)||Object(p.c)(this._propertyOriginMap.get(e))<=r){var n=this._values.get(e);return this._values.set(e,t),this._propertyOriginMap.set(e,r),n!==t}return!1}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,r=this._originStores[t];if(r){var a=r.get(e);if(r.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===t){this._values.delete(e);for(var n=t-1;n>=0;n--){var i=this._originStores[n];if(i&&i.has(e)){this._values.set(e,i.get(e)),this._propertyOriginMap.set(e,n);break}}}return a}}},{key:"has",value:function(e,t){var r=void 0===t?this._values:this._originStores[t];return!!r&&r.has(e)}},{key:"revert",value:function(e,t){for(;t>0&&!this.has(e,t);)--t;var r=this._originStores[t],a=r&&r.get(e),n=this._values.get(e);return this._values.set(e,a),this._propertyOriginMap.set(e,t),n!==a}},{key:"originOf",value:function(e){return this._propertyOriginMap.get(e)||0}},{key:"forEach",value:function(e){this._values.forEach(e)}}]),e}(),h=r(336),y=r(69),O=r(10),j=function(e){var t=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(n.a)(this,r);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];e=t.call.apply(t,[this].concat(i));var s=Object(p.c)(Object(y.a)(Object(u.a)(e))),l=s.metadatas,c=s.store,b=new v;return s.store=b,c.keys().forEach((function(e){b.set(e,c.get(e),0)})),Object.keys(l).forEach((function(e){s.internalGet(e)&&b.set(e,s.internalGet(e),0)})),e}return Object(i.a)(r,[{key:"read",value:function(e,t){Object(h.a)(this,e,t)}},{key:"getAtOrigin",value:function(e,t){var r=g(this),a=Object(f.d)(t);if("string"==typeof e)return r.get(e,a);var n={};return e.forEach((function(e){n[e]=r.get(e,a)})),n}},{key:"originOf",value:function(e){return Object(f.b)(this.originIdOf(e))}},{key:"originIdOf",value:function(e){return g(this).originOf(e)}},{key:"revert",value:function(e,t){var r=g(this),a=Object(f.d)(t),n=Object(y.a)(this);("string"==typeof e?"*"===e?r.keys(a):[e]:e).forEach((function(e){n.invalidate(e),r.revert(e,a),n.commit(e)}))}}]),r}(e);return t=Object(l.a)([Object(O.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],t),t};function g(e){return Object(y.a)(e).store}var m=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return r}(j(c.a));m=Object(l.a)([Object(O.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],m);var w=r(335);function k(e){return Object(y.a)(e).store}var I=function(e){var t=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){Object(n.a)(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return t.call.apply(t,[this].concat(a))}return r}(function(e){var t=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){Object(n.a)(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return t.call.apply(t,[this].concat(a))}return Object(i.a)(r,[{key:"clear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";return k(this).delete(e,Object(f.d)(t))}},{key:"write",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(w.b)(this,e=e||{},t),e}},{key:"setAtOrigin",value:function(e,t,r){Object(y.a)(this).setAtOrigin(e,t,Object(f.d)(r))}},{key:"removeOrigin",value:function(e){var t,r=k(this),n=Object(f.d)(e),i=r.keys(n),o=Object(a.a)(i);try{for(o.s();!(t=o.n()).done;){var s=t.value;r.originOf(s)===n&&r.set(s,r.get(s,n),6)}}catch(l){o.e(l)}finally{o.f()}}},{key:"updateOrigin",value:function(e,t){for(var r=k(this),a=Object(f.d)(t),n=this.get(e),i=a+1;i<f.a;++i)r.delete(e,i);r.set(e,n,a)}},{key:"toJSON",value:function(e){return this.write({},e)}}]),r}(e);return(t=Object(l.a)([Object(O.a)("esri.core.WriteableMultiOriginJSONSupport")],t)).prototype.toJSON.isDefaultToJSON=!0,t}(j(e)));return t=Object(l.a)([Object(O.a)("esri.core.MultiOriginJSONSupport")],t)},_=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return r}(I(c.a));_=Object(l.a)([Object(O.a)("esri.core.MultiOriginJSONSupport")],_)},682:function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var a=r(7),n=r.n(a),i=r(12),o=r(2),s=r(4),l=r(5),c=r(6),u=r(0),p=r(68),b=(r(114),r(82)),d=r(29),f=r(184),v=r(239),h=r(142),y=r(15),O=r(30),j=r(27),g=r(1),m=(r(19),r(14),r(10)),w=r(58),k=r(45),I=0,_=y.a.getLogger("esri.layers.Layer"),S=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.apply(this,arguments)).attributionDataUrl=null,e.fullExtent=new w.a(-180,-90,180,90,k.a.WGS84),e.id=Date.now().toString(16)+"-layer-"+I++,e.legendEnabled=!0,e.listMode="show",e.opacity=1,e.parent=null,e.popupEnabled=!0,e.attributionVisible=!0,e.spatialReference=k.a.WGS84,e.title=null,e.type=null,e.url=null,e.visible=!0,e}return Object(s.a)(a,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){var r,a;Object(O.m)(t)||y.a.getLogger(e.declaredClass).error("#load()","Failed to load layer (title: '".concat(null!=(r=e.title)?r:"no title","', id: '").concat(null!=(a=e.id)?a:"no id","')"),{error:t})}))}},{key:"destroy",value:function(){if(this.parent){var e=this,t=this.parent;"layers"in t&&t.layers.includes(e)?t.layers.remove(e):"tables"in t&&t.tables.includes(e)?t.tables.remove(e):"baseLayers"in t&&t.baseLayers.includes(e)?t.baseLayers.remove(e):"baseLayers"in t&&t.referenceLayers.includes(e)&&t.referenceLayers.remove(e)}}},{key:"hasAttributionData",get:function(){return null!=this.attributionDataUrl}},{key:"parsedUrl",get:function(){var e=this.url;return e?Object(j.J)(e):null}},{key:"fetchAttributionData",value:function(){var e=Object(i.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.attributionDataUrl,!this.hasAttributionData||!t){e.next=5;break}return e.next=4,Object(b.default)(t,{query:{f:"json"},responseType:"json"});case 4:return e.abrupt("return",e.sent.data);case 5:throw new d.a("layer:no-attribution-data","Layer does not have attribution data");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"fromArcGISServerUrl",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var a,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="string"==typeof t?{url:t}:t,e.next=3,r.e(85).then(r.bind(null,783));case 3:return i=e.sent,e.prev=4,e.next=7,i.fromUrl(a);case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),_.error("#fromArcGISServerUrl({ url: '"+a.url+"'})","Failed to create layer from arcgis server url",e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"fromPortalItem",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var a,i,o,s,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="portalItem"in t?t:{portalItem:t},e.next=3,Promise.all([r.e(17),r.e(97)]).then(r.bind(null,774));case 3:return i=e.sent,e.prev=4,e.next=7,i.fromItem(a);case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),o=a&&a.portalItem,s=o&&o.id||"unset",l=o&&o.portal&&o.portal.url||p.a.portalUrl,_.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+l+"', id: '"+s+"')",e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}()}]),a}(f.a.EventedMixin(Object(v.a)(h.a)));Object(u.a)([Object(g.b)({type:String})],S.prototype,"attributionDataUrl",void 0),Object(u.a)([Object(g.b)({type:w.a})],S.prototype,"fullExtent",void 0),Object(u.a)([Object(g.b)({readOnly:!0})],S.prototype,"hasAttributionData",null),Object(u.a)([Object(g.b)({type:String})],S.prototype,"id",void 0),Object(u.a)([Object(g.b)({type:Boolean,nonNullable:!0})],S.prototype,"legendEnabled",void 0),Object(u.a)([Object(g.b)({type:["show","hide","hide-children"]})],S.prototype,"listMode",void 0),Object(u.a)([Object(g.b)({type:Number,range:{min:0,max:1},nonNullable:!0})],S.prototype,"opacity",void 0),Object(u.a)([Object(g.b)()],S.prototype,"parent",void 0),Object(u.a)([Object(g.b)({readOnly:!0})],S.prototype,"parsedUrl",null),Object(u.a)([Object(g.b)({type:Boolean})],S.prototype,"popupEnabled",void 0),Object(u.a)([Object(g.b)({type:Boolean})],S.prototype,"attributionVisible",void 0),Object(u.a)([Object(g.b)({type:k.a})],S.prototype,"spatialReference",void 0),Object(u.a)([Object(g.b)({type:String})],S.prototype,"title",void 0),Object(u.a)([Object(g.b)({type:String,readOnly:!0,json:{read:!1}})],S.prototype,"type",void 0),Object(u.a)([Object(g.b)()],S.prototype,"url",void 0),Object(u.a)([Object(g.b)({type:Boolean,nonNullable:!0})],S.prototype,"visible",void 0);var x=S=Object(u.a)([Object(m.a)("esri.layers.Layer")],S)},699:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var a=r(13),n=r(7),i=r.n(n),o=r(12),s=r(2),l=r(4),c=r(77),u=r(65),p=r(5),b=r(6),d=r(0),f=r(83),v=r(82),h=r(295),y=r(29),O=r(15),j=r(11),g=r(30),m=r(27),w=r(1),k=(r(19),r(14),r(57)),I=r(10),_=r(43),S=r(85),x=r(334),L=r(338),F=O.a.getLogger("esri.layers.mixins.PortalLayer"),E=function(e){var t=function(e){Object(p.a)(n,e);var t=Object(b.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments)).resourceReferences={portalItem:null,paths:[]},e.userHasEditingPrivileges=!0,e}return Object(l.a)(n,[{key:"destroy",value:function(){var e;null==(e=this.portalItem)||e.destroy(),this.portalItem=null}},{key:"portalItem",set:function(e){e!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",e))}},{key:"readPortalItem",value:function(e,t,r){if(t.itemId)return new x.default({id:t.itemId,portal:r&&r.portal})}},{key:"writePortalItem",value:function(e,t){e&&e.id&&(t.itemId=e.id)}},{key:"loadFromPortal",value:function(){var e=Object(o.a)(i.a.mark((function e(t,a){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.portalItem||!this.portalItem.id){e.next=14;break}return e.prev=1,e.next=4,r.e(17).then(r.bind(null,781));case 4:return n=e.sent,Object(g.v)(a),e.next=8,n.load({instance:this,supportedTypes:t.supportedTypes,validateItem:t.validateItem,supportsData:t.supportsData},a);case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(1),Object(g.m)(e.t0)||F.warn("Failed to load layer (".concat(this.title,", ").concat(this.id,") portal item (").concat(this.portalItem.id,")\n  ").concat(e.t0)),e.t0;case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"finishLoadEditablePortalLayer",value:function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,this.fetchUserHasEditingPrivileges(t).catch((function(e){return Object(g.u)(e),!0}));case 3:e.t1=e.sent,e.t0._set.call(e.t0,"userHasEditingPrivileges",e.t1);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchUserHasEditingPrivileges",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.url?null==f.b?void 0:f.b.findCredential(this.url):null){e.next=3;break}return e.abrupt("return",!0);case 3:if(M.credential!==r){e.next=7;break}e.t0=M.user,e.next=10;break;case 7:return e.next=9,this.fetchEditingUser(t);case 9:e.t0=e.sent;case 10:return a=e.t0,e.abrupt("return",(M.credential=r,M.user=a,Object(j.i)(a)||null==a.privileges||a.privileges.includes("features:user:edit")));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchEditingUser",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var r,a,n,o,s,l,c,u,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=null==(r=this.portalItem)||null==(a=r.portal)?void 0:a.user)){e.next=3;break}return e.abrupt("return",n);case 3:if(null!=(o=f.b.findServerInfo(this.url))&&o.owningSystemUrl){e.next=6;break}return e.abrupt("return",null);case 6:if(s="".concat(o.owningSystemUrl,"/sharing/rest"),!(l=S.a.getDefault())||!l.loaded||Object(m.C)(l.restUrl)!==Object(m.C)(s)){e.next=9;break}return e.abrupt("return",l.user);case 9:return c="".concat(s,"/community/self"),u=Object(j.j)(t)?t.signal:null,e.next=13,Object(h.c)(Object(v.default)(c,{authMode:"no-prompt",query:{f:"json"},signal:u}));case 13:return p=e.sent,e.abrupt("return",p.ok?L.default.fromJSON(p.value.data):null);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"read",value:function(e,t){t&&(t.layer=this),Object(c.a)(Object(u.a)(n.prototype),"read",this).call(this,e,t)}},{key:"write",value:function(e,t){var r=t&&t.portal,i=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||S.a.getDefault());return r&&i&&!Object(m.r)(i.restUrl,r.restUrl)?(t.messages&&t.messages.push(new y.a("layer:cross-portal","The layer '".concat(this.title," (").concat(this.id,")' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer"),{layer:this})),null):Object(c.a)(Object(u.a)(n.prototype),"write",this).call(this,e,Object(a.a)(Object(a.a)({},t),{},{layer:this}))}}]),n}(e);return Object(d.a)([Object(w.b)({type:x.default})],t.prototype,"portalItem",null),Object(d.a)([Object(k.a)("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),Object(d.a)([Object(_.a)("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),Object(d.a)([Object(w.b)()],t.prototype,"resourceReferences",void 0),Object(d.a)([Object(w.b)({readOnly:!0})],t.prototype,"userHasEditingPrivileges",void 0),t=Object(d.a)([Object(I.a)("esri.layers.mixins.PortalLayer")],t),t},M={credential:null,user:null}},755:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var a=r(214),n=r(209),i=r(151),o=(r(90),r(255),r(152)),s=(r(153),r(154),r(262)),l=r(404),c=["oid","global-id"],u=["oid","global-id","guid"];function p(e,t){var r=e.displayField,s=e.editFieldsInfo,l=e.fields,c=e.objectIdField,u=e.title;if(!l)return null;var p=y({editFieldsInfo:s,fields:l,objectIdField:c},t);if(!p.length)return null;var b=function(e){var t=Object(n.g)(e),r=e.titleBase;return t?"".concat(r,": {").concat(t.trim(),"}"):r}({titleBase:u,fields:l,displayField:r}),d=[new o.a,new i.a];return new a.a({title:b,content:d,fieldInfos:p})}var b=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],d=function(e,t){var r=t.editFieldsInfo,a=t.objectIdField,n=t.visibleFieldNames;return n?n.has(e.name):!v(e.name,r)&&(!a||e.name!==a)&&!(c.indexOf(e.type)>-1)&&!b.some((function(t){return t.test(e.name)}))};function f(e,t){return"oid"===e.type?-1:"oid"===t.type?1:j(e)?-1:j(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function v(e,t){if(!e||!t)return!1;var r=t.creationDateField,a=t.creatorField,n=t.editDateField,i=t.editorField;return-1!==[r&&r.toLowerCase(),a&&a.toLowerCase(),n&&n.toLowerCase(),i&&i.toLowerCase()].indexOf(e.toLowerCase())}function h(e,t){return e.editable&&-1===u.indexOf(e.type)&&!v(e.name,t)}function y(e,t){var r=e.editFieldsInfo,a=e.fields,n=e.objectIdField;return function(e,t){var r=e;return t&&(e=e.filter((function(e){return-1===t.indexOf(e.type)}))),e===r&&(e=e.slice()),e.sort(f),e}(a,(null==t?void 0:t.ignoreFieldTypes)||g).map((function(e){return new s.a({fieldName:e.name,isEditable:h(e,r),label:e.alias,format:O(e),visible:d(e,{editFieldsInfo:r,objectIdField:n,visibleFieldNames:null==t?void 0:t.visibleFieldNames})})}))}function O(e){switch(e.type){case"small-integer":case"integer":case"single":return new l.a({digitSeparator:!0,places:0});case"double":return new l.a({digitSeparator:!0,places:2});case"date":return new l.a({dateFormat:"long-month-day-year"});default:return null}}function j(e){return"name"===(e.name&&e.name.toLowerCase())||("name"===(e.alias&&e.alias.toLowerCase())||void 0)}var g=["geometry","blob","raster","guid","xml"]}}]);
//# sourceMappingURL=3.a173b2e3.chunk.js.map