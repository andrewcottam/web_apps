{"version":3,"sources":["../node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js","../node_modules/@arcgis/core/renderers/support/lengthUtils.js","../node_modules/@arcgis/core/layers/mixins/ArcGISService.js","../node_modules/@arcgis/core/core/LRUCache.js","../node_modules/@arcgis/core/layers/support/TileInfo.js","../node_modules/@arcgis/core/layers/support/LOD.js","../node_modules/@arcgis/core/layers/support/TilemapCache.js","../node_modules/@arcgis/core/layers/support/Tilemap.js","../node_modules/@arcgis/core/layers/support/serviceTileInfoProperty.js","../node_modules/@arcgis/core/layers/mixins/ArcGISCachedService.js"],"names":["l","mapserver","imageserver","featureserver","sceneserver","streamserver","vectortileserver","a","Object","values","c","RegExp","join","f","v","p","e","test","d","t","r","n","path","match","s","i","o","u","indexOf","title","w","slice","serverType","toLowerCase","sublayer","parseInt","url","m","serviceUrl","sublayerId","Number","replace","toUpperCase","h","push","length","y","g","O","logger","layer","layerId","nonStandardUrlAllowed","C","toString","S","inches","feet","yards","miles","millimeters","centimeters","decimeters","meters","kilometers","radius","this","_get","originOf","_set","getLogger","declaredClass","prototype","type","String","_storage","maxSize","registerRemoveFunc","put","pop","get","clearAll","destroy","x","PNG","PNG8","PNG24","PNG32","JPEG","JPG","DIB","TIFF","EMF","PS","PDF","GIF","SVG","SVGZ","Mixed","MIXED","LERC","LERC2D","RAW","pbf","dpi","format","origin","minScale","maxScale","size","spatialReference","isWrappable","Math","abs","dx","fromJSON","_levelToLOD","forEach","scale","level","_initializeUpsampleLevels","cols","rows","scales","floor","log","scaleToZoom","zoomToScale","ceil","lodAt","resolution","id","row","col","extent","updateTileInfo","lods","_upsampleLevels","parentLevel","factor","write","resolutionFactor","WebMercator","numLODs","unshift","json","read","origins","readOnly","value","cast","Array","isArray","j","levelValue","location","left","top","width","height","_allAvailability","byteSize","_tileAvailabilityBitSet","Uint8Array","service","request","query","tileServers","then","data","catch","details","httpStatus","valid","response","definition","validateJSON","freeze","_updateFromData","T","_handles","_pendingTilemapRequests","_availableLevels","levels","cacheByteSize","_prefetchingEnabled","_tilemapCache","add","watch","_initializeTilemapDefinition","_initializeAvailableLevels","error","Promise","reject","_tmpTilemapDefinition","_tilemapFromCache","resolve","signal","b","fromDefinition","getAvailability","tileInfo","upsampleTile","fetchTilemap","fetchAvailability","fetchAvailabilityUpsample","_fetchAvailabilityUpsamplePrefetch","has","abort","remove","_prefetches","removeUnordered","_maxPrefetch","parsedUrl","clear","prefetchingEnabled","hasTilemap","initialSize","constructOnly","_","source","reader","minLOD","maxLOD","ignoreMinMaxLOD","filter","round","arguments","copyright","tilemapCache","version","capabilities"],"mappings":"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","file":"static/js/15.705e7a39.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../core/maybe.js\";import{urlToObject as r,removeTrailingSlash as t,removeQueryParameters as n,join as s,Url as i,makeAbsolute as o}from\"../../core/urlUtils.js\";import{w as u}from\"../../chunks/persistableUrlUtils.js\";const l={mapserver:\"MapServer\",imageserver:\"ImageServer\",featureserver:\"FeatureServer\",sceneserver:\"SceneServer\",streamserver:\"StreamServer\",vectortileserver:\"VectorTileServer\"},a=Object.values(l),c=new RegExp(`^((?:https?:)?\\\\/\\\\/\\\\S+?\\\\/rest\\\\/services\\\\/(.+?)\\\\/(${a.join(\"|\")}))(?:\\\\/(?:layers\\\\/)?(\\\\d+))?`,\"i\"),f=new RegExp(`^((?:https?:)?\\\\/\\\\/\\\\S+?\\\\/([^\\\\/\\\\n]+)\\\\/(${a.join(\"|\")}))(?:\\\\/(?:layers\\\\/)?(\\\\d+))?`,\"i\"),v=/(.*?)\\/(?:layers\\/)?(\\d+)\\/?$/i;function p(e){return!!c.test(e)}function d(e){const t=r(e),n=t.path.match(c)||t.path.match(f);if(!n)return null;const[,s,i,o,u]=n,a=i.indexOf(\"/\");return{title:w(-1!==a?i.slice(a+1):i),serverType:l[o.toLowerCase()],sublayer:null!=u&&\"\"!==u?parseInt(u,10):null,url:{path:s}}}function m(e){const t=r(e).path.match(v);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function w(e){return(e=e.replace(/\\s*[/_]+\\s*/g,\" \"))[0].toUpperCase()+e.slice(1)}function h(r,t){const n=[];if(r){const t=d(r);e(t)&&t.title&&n.push(t.title)}if(t){const e=w(t);n.push(e)}if(2===n.length){if(-1!==n[0].toLowerCase().indexOf(n[1].toLowerCase()))return n[0];if(-1!==n[1].toLowerCase().indexOf(n[0].toLowerCase()))return n[1]}return n.join(\" - \")}function y(e){if(!e)return!1;const r=\".arcgis.com/\",t=\"//services\",n=\"//tiles\",s=\"//features\",i=-1!==(e=e.toLowerCase()).indexOf(r),o=-1!==e.indexOf(t)||-1!==e.indexOf(n)||-1!==e.indexOf(s);return i&&o}function x(e,r){return r&&e&&-1!==e.toLowerCase().indexOf(r.toLowerCase())}function g(e,r){return e?t(n(e,r)):e}function O(s){let{url:i}=s;if(!i)return{url:i};i=n(i,s.logger);const o=r(i),u=d(o.path);let l;if(e(u))null!=u.sublayer&&null==s.layer.layerId&&(l=u.sublayer),i=u.url.path;else if(s.nonStandardUrlAllowed){const r=m(o.path);e(r)&&(i=r.serviceUrl,l=r.sublayerId)}return{url:t(i),layerId:l}}function C(e,r,t,n,i){u(r,n,\"url\",i),n.url&&null!=e.layerId&&(n.url=s(n.url,t,e.layerId.toString()))}function S(e){if(!e)return!1;const r=e.toLowerCase(),t=-1!==r.indexOf(\"/services/\"),n=-1!==r.indexOf(\"/mapserver/wmsserver\"),s=-1!==r.indexOf(\"/imageserver/wmsserver\"),i=-1!==r.indexOf(\"/wmsserver\");return t&&(n||s||i)}function L(e){if(!e)return!1;const r=new i(o(e)).authority.toLowerCase();return\"server.arcgisonline.com\"===r||\"services.arcgisonline.com\"===r}function b(e){if(!e)return!1;return new i(o(e)).authority.toLowerCase().includes(\"arcgis.com\")}export{w as cleanTitle,b as isAGOLUrl,p as isArcGISUrl,y as isHostedAgolService,x as isHostedSecuredProxyService,L as isServerOrServicesAGOLUrl,S as isWmsServer,d as parse,m as parseNonStandardSublayerUrl,g as sanitizeUrl,O as sanitizeUrlWithLayerId,a as serverTypes,h as titleFromUrlAndName,C as writeUrlWithLayerId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{convertUnit as e,lengthToDegrees as s}from\"../../core/unitUtils.js\";import{earth as t}from\"../../geometry/support/Ellipsoid.js\";const m={inches:e(1,\"meters\",\"inches\"),feet:e(1,\"meters\",\"feet\"),\"us-feet\":e(1,\"meters\",\"us-feet\"),yards:e(1,\"meters\",\"yards\"),miles:e(1,\"meters\",\"miles\"),\"nautical-miles\":e(1,\"meters\",\"nautical-miles\"),millimeters:e(1,\"meters\",\"millimeters\"),centimeters:e(1,\"meters\",\"centimeters\"),decimeters:e(1,\"meters\",\"decimeters\"),meters:e(1,\"meters\",\"meters\"),kilometers:e(1,\"meters\",\"kilometers\"),\"decimal-degrees\":1/s(1,\"meters\",t.radius)};export{m as meterIn};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Logger.js\";import{isSome as e}from\"../../core/maybe.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import{parse as i,sanitizeUrl as l}from\"../support/arcgisLayerUrl.js\";const p=p=>{let c=class extends p{get title(){if(this._get(\"title\")&&\"defaults\"!==this.originOf(\"title\"))return this._get(\"title\");if(this.url){const t=i(this.url);if(e(t)&&t.title)return t.title}return this._get(\"title\")||\"\"}set title(t){this._set(\"title\",t)}set url(t){this._set(\"url\",l(t,r.getLogger(this.declaredClass)))}};return t([s()],c.prototype,\"title\",null),t([s({type:String})],c.prototype,\"url\",null),c=t([o(\"esri.layers.mixins.ArcGISService\")],c),c};export{p as ArcGISService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{MemCacheStorage as t}from\"./MemCache.js\";class e{constructor(e,s){this._storage=new t,this._storage.maxSize=e,s&&this._storage.registerRemoveFunc(\"\",s)}put(t,e,s){this._storage.put(t,e,s,1)}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}}export{e as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{JSONMap as t}from\"../../core/jsonMap.js\";import{JSONSupport as o}from\"../../core/JSONSupport.js\";import{isNone as r}from\"../../core/maybe.js\";import{getMetersPerUnitForSR as s}from\"../../core/unitUtils.js\";import{property as i}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import{Integer as l}from\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{reader as n}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as p}from\"../../core/accessorSupport/decorators/writer.js\";import c from\"../../geometry/Point.js\";import u from\"../../geometry/SpatialReference.js\";import{create as f}from\"../../geometry/support/aaBoundingRect.js\";import{isValid as h,getInfo as m,isGeographic as d,equals as g}from\"../../geometry/support/spatialReferenceUtils.js\";import{project as y}from\"../../geometry/support/webMercatorUtils.js\";import v from\"./LOD.js\";var w;const x=new t({PNG:\"png\",PNG8:\"png8\",PNG24:\"png24\",PNG32:\"png32\",JPEG:\"jpg\",JPG:\"jpg\",DIB:\"dib\",TIFF:\"tiff\",EMF:\"emf\",PS:\"ps\",PDF:\"pdf\",GIF:\"gif\",SVG:\"svg\",SVGZ:\"svgz\",Mixed:\"mixed\",MIXED:\"mixed\",LERC:\"lerc\",LERC2D:\"lerc2d\",RAW:\"raw\",pbf:\"pbf\"});let S=w=class extends o{constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.minScale=0,this.maxScale=0,this.size=null,this.spatialReference=null}static create(e={}){const{resolutionFactor:t=1,scales:o,size:r=256,spatialReference:i=u.WebMercator,numLODs:l=24}=e;if(!h(i)){const e=[];if(o)for(let t=0;t<o.length;t++){const r=o[t];e.push({level:t,scale:r,resolution:r})}else{let t=5e-4;for(let o=l-1;o>=0;o--)e.unshift({level:o,scale:t,resolution:t}),t*=2}return new w({dpi:96,lods:e,origin:new c(0,0,i),size:[r,r],spatialReference:i})}const n=m(i),a=e.origin?new c({x:e.origin.x,y:e.origin.y,spatialReference:i}):new c(n?{x:n.origin[0],y:n.origin[1],spatialReference:i}:{x:0,y:0,spatialReference:i}),p=96,f=1/(s(i)*39.37*p),g=[];if(o)for(let s=0;s<o.length;s++){const e=o[s],t=e*f;g.push({level:s,scale:e,resolution:t})}else{let e=d(i)?512/r*591657527.5917094:256/r*591657527.591555;const o=Math.ceil(l/t);g.push({level:0,scale:e,resolution:e*f});for(let r=1;r<o;r++){const o=e/2**t,s=o*f;g.push({level:r,scale:o,resolution:s}),e=o}}return new w({dpi:p,lods:g,origin:a,size:[r,r],spatialReference:i})}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const o=m(e);return e.isWrappable&&Math.abs(o.origin[0]-t.x)<=o.dx}return!1}readOrigin(e,t){return c.fromJSON({spatialReference:t.spatialReference,...e})}set lods(e){let t=0,o=0;const r=[];this._levelToLOD={},e&&(t=-1/0,o=1/0,e.forEach((e=>{r.push(e.scale),t=e.scale>t?e.scale:t,o=e.scale<o?e.scale:o,this._levelToLOD[e.level]=e}))),this._set(\"scales\",r),this._set(\"minScale\",t),this._set(\"maxScale\",o),this._set(\"lods\",e),this._initializeUpsampleLevels()}readSize(e,t){return[t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[1]}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];{const o=Math.floor(e),r=o+1;return t[o]/(t[o]/t[r])**(e-o)}}scaleToZoom(e){const t=this.scales,o=t.length-1;let r=0;for(;r<o;r++){const o=t[r],s=t[r+1];if(o<=e)return r;if(s===e)return r+1;if(o>e&&s<e)return r+Math.log(o/e)/Math.log(o/s)}return r}snapScale(e,t=.95){const o=this.scaleToZoom(e);return o%Math.floor(o)>=t?this.zoomToScale(Math.ceil(o)):this.zoomToScale(Math.floor(o))}tileAt(e,t,o,s){const i=this.lodAt(e);if(!i)return null;let l,n;if(\"number\"==typeof t)l=t,n=o;else if(g(t.spatialReference,this.spatialReference))l=t.x,n=t.y,s=o;else{const e=y(t,this.spatialReference);if(r(e))return null;l=e.x,n=e.y,s=o}const a=i.resolution*this.size[0],p=i.resolution*this.size[1];return s||(s={id:null,level:0,row:0,col:0,extent:f()}),s.level=e,s.row=Math.floor((this.origin.y-n)/p+.001),s.col=Math.floor((l-this.origin.x)/a+.001),this.updateTileInfo(s),s}updateTileInfo(e,t=0){let o=this.lodAt(e.level);if(!o&&1===t){const t=this.lods[this.lods.length-1];t.level<e.level&&(o=t)}if(!o)return;const r=e.level-o.level,s=o.resolution*this.size[0]/2**r,i=o.resolution*this.size[1]/2**r;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=f()),e.extent[0]=this.origin.x+e.col*s,e.extent[1]=this.origin.y-(e.row+1)*i,e.extent[2]=e.extent[0]+s,e.extent[3]=e.extent[1]+i}upsampleTile(e){const t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,t){const{resolution:o}=this.lodAt(t.level),r=o*this.size[0],s=o*this.size[1];return e[0]=this.origin.x+t.col*r,e[1]=this.origin.y-(t.row+1)*s,e[2]=e[0]+r,e[3]=e[1]+s,e}lodAt(e){return this._levelToLOD&&this._levelToLOD[e]||null}clone(){return w.fromJSON(this.write({}))}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let o=0;o<e.length;o++){const r=e[o];this._upsampleLevels[r.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/r.resolution:0},t=r}}};e([i({type:Number,json:{write:!0}})],S.prototype,\"compressionQuality\",void 0),e([i({type:Number,json:{write:!0}})],S.prototype,\"dpi\",void 0),e([i({type:String,json:{read:x.read,write:x.write,origins:{\"web-scene\":{read:!1,write:!1}}}})],S.prototype,\"format\",void 0),e([i({readOnly:!0})],S.prototype,\"isWrappable\",null),e([i({type:c,json:{write:!0}})],S.prototype,\"origin\",void 0),e([n(\"origin\")],S.prototype,\"readOrigin\",null),e([i({type:[v],value:null,json:{write:!0}})],S.prototype,\"lods\",null),e([i({readOnly:!0})],S.prototype,\"minScale\",void 0),e([i({readOnly:!0})],S.prototype,\"maxScale\",void 0),e([i({readOnly:!0})],S.prototype,\"scales\",void 0),e([i({cast:e=>Array.isArray(e)?e:\"number\"==typeof e?[e,e]:[256,256]})],S.prototype,\"size\",void 0),e([n(\"size\",[\"rows\",\"cols\"])],S.prototype,\"readSize\",null),e([p(\"size\",{cols:{type:l},rows:{type:l}})],S.prototype,\"writeSize\",null),e([i({type:u,json:{write:!0}})],S.prototype,\"spatialReference\",void 0),S=w=e([a(\"esri.layers.support.TileInfo\")],S);var j=S;export{j as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{JSONSupport as o}from\"../../core/JSONSupport.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import{Integer as t}from\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";var i;let l=i=class extends o{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new i({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};e([r({type:Number,json:{write:!0,origins:{\"web-document\":{read:!1,write:!1},\"portal-item\":{read:!1,write:!1}}}})],l.prototype,\"cols\",void 0),e([r({type:t,json:{write:!0}})],l.prototype,\"level\",void 0),e([r({type:String,json:{write:!0}})],l.prototype,\"levelValue\",void 0),e([r({type:Number,json:{write:!0}})],l.prototype,\"resolution\",void 0),e([r({type:Number,json:{write:!0,origins:{\"web-document\":{read:!1,write:!1},\"portal-item\":{read:!1,write:!1}}}})],l.prototype,\"rows\",void 0),e([r({type:Number,json:{write:!0}})],l.prototype,\"scale\",void 0),l=i=e([s(\"esri.layers.support.LOD\")],l);var p=l;export{p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../request.js\";import i from\"../../core/Accessor.js\";import l from\"../../core/Error.js\";import r from\"../../core/Handles.js\";import s from\"../../core/Logger.js\";import a from\"../../core/LRUCache.js\";import o from\"../../core/PooledArray.js\";import{onAbort as n,createAbortError as c,isAbortError as h,createAbortController as p,isAborted as m}from\"../../core/promiseUtils.js\";import{waitTicks as u}from\"../../core/scheduling.js\";import{objectToQuery as f}from\"../../core/urlUtils.js\";import{init as v}from\"../../core/watchUtils.js\";import{property as y}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import{cast as _}from\"../../core/accessorSupport/decorators/cast.js\";import{subclass as d}from\"../../core/accessorSupport/decorators/subclass.js\";import{tilemapDefinitionId as b,Tilemap as g}from\"./Tilemap.js\";var w;const T=s.getLogger(\"esri.layers.support.TilemapCache\");let j=w=class extends i{constructor(e){super(e),this._handles=new r,this._pendingTilemapRequests={},this._availableLevels={},this.levels=5,this.cacheByteSize=2097152,this.request=t,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new a(this.cacheByteSize),this._handles.add([this.watch([\"layer.parsedUrl\",\"layer.tileServers?\"],(()=>this._initializeTilemapDefinition())),v(this,\"layer.tileInfo.lods\",(e=>this._initializeAvailableLevels(e)),!0)]),this._initializeTilemapDefinition()}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}castLevels(e){return e<=2?(T.error(\"Minimum levels for Tilemap is 3, but got \",e),3):e}get size(){return 1<<this.levels}fetchTilemap(e,t,i,r){if(!this._availableLevels[e])return Promise.reject(new l(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`));const s=this._tmpTilemapDefinition,a=this._tilemapFromCache(e,t,i,s);if(a)return Promise.resolve(a);const o=r&&r.signal;return r={...r,signal:null},new Promise(((e,t)=>{n(o,(()=>t(c())));const i=b(s);let l=this._pendingTilemapRequests[i];if(!l){l=g.fromDefinition(s,r).then((e=>(this._tilemapCache.put(i,e,e.byteSize),e)));const e=()=>delete this._pendingTilemapRequests[i];this._pendingTilemapRequests[i]=l,l.then(e,e)}l.then(e,t)}))}getAvailability(e,t,i){if(!this._availableLevels[e])return\"unavailable\";const l=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return l?l.getAvailability(t,i):\"unknown\"}getAvailabilityUpsample(e,t,i,l){l.level=e,l.row=t,l.col=i;const r=this.layer.tileInfo;for(r.updateTileInfo(l);;){const e=this.getAvailability(l.level,l.row,l.col);if(\"unavailable\"!==e)return e;if(!r.upsampleTile(l))return\"unavailable\"}}fetchAvailability(e,t,i,r){return this._availableLevels[e]?this.fetchTilemap(e,t,i,r).catch((e=>e)).then((r=>{if(r instanceof g){const s=r.getAvailability(t,i);return\"unavailable\"===s?Promise.reject(new l(\"tile-map:tile-unavailable\",\"Tile is not available\",{level:e,row:t,col:i})):s}if(h(r))throw r;return\"unknown\"})):Promise.reject(new l(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`))}fetchAvailabilityUpsample(e,t,i,l,r){l.level=e,l.row=t,l.col=i;const s=this.layer.tileInfo;s.updateTileInfo(l);const a=this.fetchAvailability(e,t,i,r).catch((e=>{if(h(e))throw e;if(s.upsampleTile(l))return this.fetchAvailabilityUpsample(l.level,l.row,l.col,l);throw e}));return this._fetchAvailabilityUpsamplePrefetch(l.id,e,t,i,r,a),a}async _fetchAvailabilityUpsamplePrefetch(e,t,i,l,r,s){if(!this._prefetchingEnabled)return;const a=`prefetch-${e}`;if(this._handles.has(a))return;const o=p();s.then((()=>o.abort()),(()=>o.abort()));let n=!1;const c={remove(){n||(n=!0,o.abort())}};if(this._handles.add(c,a),await u(10,o.signal).catch((()=>{})),n||(n=!0,this._handles.remove(a)),m(o))return;const h={id:e,level:t,row:i,col:l},f={...r,signal:o.signal},v=this.layer.tileInfo;for(let p=0;w._prefetches.length<w._maxPrefetch&&v.upsampleTile(h);++p){const e=this.fetchAvailability(h.level,h.row,h.col,f);w._prefetches.push(e);const t=()=>{w._prefetches.removeUnordered(e)};e.then(t,t)}}_initializeTilemapDefinition(){if(!this.layer.parsedUrl)return;const e=this.layer.parsedUrl,t=e.query;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?f(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,i,l){l.level=e,l.row=t-t%this.size,l.col=i-i%this.size;const r=b(l);return this._tilemapCache.get(r)}_initializeAvailableLevels(e){this._availableLevels={},e&&e.forEach((e=>this._availableLevels[e.level]=!0))}get test(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,i,l)=>!!e._tilemapFromCache(t,i,l,e._tmpTilemapDefinition)}}};j._maxPrefetch=4,j._prefetches=new o({initialSize:w._maxPrefetch}),e([y({constructOnly:!0,type:Number})],j.prototype,\"levels\",void 0),e([_(\"levels\")],j.prototype,\"castLevels\",null),e([y({readOnly:!0,type:Number})],j.prototype,\"size\",null),e([y({constructOnly:!0,type:Number})],j.prototype,\"cacheByteSize\",void 0),e([y({constructOnly:!0})],j.prototype,\"layer\",void 0),e([y({constructOnly:!0})],j.prototype,\"request\",void 0),j=w=e([d(\"esri.layers.support.TilemapCache\")],j);export{j as TilemapCache};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport t from\"../../request.js\";import{constant as i}from\"../../core/arrayUtils.js\";import e from\"../../core/Error.js\";import{clone as a}from\"../../core/lang.js\";class l{constructor(){this.location={left:0,top:0,width:0,height:0},this._allAvailability=\"unknown\",this.byteSize=40}getAvailability(t,i){if(\"unknown\"!==this._allAvailability)return this._allAvailability;const e=(t-this.location.top)*this.location.width+(i-this.location.left),a=e%8,l=e>>3,o=this._tileAvailabilityBitSet;return l<0||l>o.length?\"unknown\":o[l]&1<<a?\"available\":\"unavailable\"}_updateFromData(t){const i=this.location.width,e=this.location.height;let a=!0,l=!0;const o=Math.ceil(i*e/8),n=new Uint8Array(o);let r=0;for(let s=0;s<t.length;s++){const i=s%8;t[s]?(l=!1,n[r]|=1<<i):a=!1,7===i&&++r}l?this._allAvailability=\"unavailable\":a?this._allAvailability=\"available\":(this._allAvailability=\"unknown\",this._tileAvailabilityBitSet=n,this.byteSize+=n.length)}static fromDefinition(a,o){const r=a.service.request||t,{row:s,col:h,width:c,height:m}=a,d={query:{f:\"json\"}};return o=o?{...d,...o}:d,r(n(a),o).then((t=>t.data)).catch((t=>{if(t&&t.details&&422===t.details.httpStatus)return{location:{top:s,left:h,width:c,height:m},valid:!0,data:i(c*m,0)};throw t})).then((t=>{if(t.location&&(t.location.top!==s||t.location.left!==h||t.location.width!==c||t.location.height!==m))throw new e(\"tilemap:location-mismatch\",\"Tilemap response for different location than requested\",{response:t,definition:{top:s,left:h,width:c,height:m}});return l.fromJSON(t)}))}static fromJSON(t){l.validateJSON(t);const i=new l;return i.location=Object.freeze(a(t.location)),i._updateFromData(t.data),Object.freeze(i)}static validateJSON(t){if(!t||!t.location)throw new e(\"tilemap:missing-location\",\"Location missing from tilemap response\");if(!1===t.valid)throw new e(\"tilemap:invalid\",\"Tilemap response was marked as invalid\");if(!t.data)throw new e(\"tilemap:missing-data\",\"Data missing from tilemap response\");if(!Array.isArray(t.data))throw new e(\"tilemap:data-mismatch\",\"Data must be an array of numbers\");if(t.data.length!==t.location.width*t.location.height)throw new e(\"tilemap:data-mismatch\",\"Number of data items does not match width/height of tilemap\")}}function o(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function n(t){let i;if(\"vector-tile\"===t.service.type)i=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;else{const e=t.service.tileServers;i=`${e&&e.length?e[t.row%e.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}const e=t.service.query;return e&&(i=`${i}?${e}`),i}export{l as Tilemap,l as default,o as tilemapDefinitionId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"./TileInfo.js\";const r={type:e,json:{origins:{service:{read:{source:[\"tileInfo\",\"minScale\",\"maxScale\",\"minLOD\",\"maxLOD\"],reader:n}}}}};function n(r,n,l,o){if(!r)return null;const{minScale:i,maxScale:t,minLOD:m,maxLOD:s}=n;if(null!=m&&null!=s)return o&&o.ignoreMinMaxLOD?e.fromJSON(r):e.fromJSON({...r,lods:r.lods.filter((({level:e})=>null!=e&&e>=m&&e<=s))});if(0!==i&&0!==t){const n=e=>Math.round(1e4*e)/1e4,l=i?n(i):1/0,o=t?n(t):-1/0;return e.fromJSON({...r,lods:r.lods.filter((e=>{const r=n(e.scale);return r<=l&&r>=o}))})}return e.fromJSON(r)}export{n as readServiceTileInfo,r as serviceTileInfoProperty};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{reader as o}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{serviceTileInfoProperty as i}from\"../support/serviceTileInfoProperty.js\";import{TilemapCache as p}from\"../support/TilemapCache.js\";import a from\"../../geometry/SpatialReference.js\";const s=s=>{let l=class extends s{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}readMinScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}readMaxScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,r){return r.capabilities&&r.capabilities.indexOf(\"Tilemap\")>-1?new p({layer:this}):null}};return e([r({json:{read:{source:\"copyrightText\"}}})],l.prototype,\"copyright\",void 0),e([r()],l.prototype,\"minScale\",void 0),e([o(\"service\",\"minScale\")],l.prototype,\"readMinScale\",null),e([r()],l.prototype,\"maxScale\",void 0),e([o(\"service\",\"maxScale\")],l.prototype,\"readMaxScale\",null),e([r({type:a})],l.prototype,\"spatialReference\",void 0),e([r({readOnly:!0})],l.prototype,\"supportsBlankTile\",null),e([r(i)],l.prototype,\"tileInfo\",void 0),e([r()],l.prototype,\"tilemapCache\",void 0),e([o(\"service\",\"tilemapCache\",[\"capabilities\"])],l.prototype,\"readTilemapCache\",null),e([r()],l.prototype,\"version\",void 0),l=e([t(\"esri.layers.mixins.ArcGISCachedService\")],l),l};export{s as ArcGISCachedService};\n"],"sourceRoot":""}