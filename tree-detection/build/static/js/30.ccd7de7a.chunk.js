(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[30],{1109:function(e,t,n){"use strict";n.r(t),n.d(t,"ElevationQuery",(function(){return C})),n.d(t,"GeometryDescriptor",(function(){return F})),n.d(t,"default",(function(){return C})),n.d(t,"getFinestLodIndex",(function(){return L}));var a=n(5),r=n(6),i=n(21),o=n(7),s=n.n(o),u=n(13),l=n(12),c=n(2),f=n(4),h=n(295),p=n(29),v=n(11),m=n(30),d=n(135),y=n(144),b=n(48),x=n(107),M=n(750),j=n(333),k=(n(114),n(19),n(15)),O=n(101),w=n(71),T=k.a.getLogger("esri.layers.support.ElevationSampler"),g=function(){function e(){Object(c.a)(this,e)}return Object(f.a)(e,[{key:"queryElevation",value:function(e){return function(e,t){var n=q(e,t.spatialReference);if(!n)return null;switch(e.type){case"point":!function(e,t,n){e.z=Object(v.r)(n.elevationAt(t),0)}(e,n,t);break;case"polyline":!function(e,t,n){E.spatialReference=t.spatialReference;for(var a=e.hasM&&!e.hasZ,r=0;r<e.paths.length;r++)for(var i=e.paths[r],o=t.paths[r],s=0;s<i.length;s++){var u=i[s],l=o[s];E.x=l[0],E.y=l[1],a&&(u[3]=u[2]),u[2]=Object(v.r)(n.elevationAt(E),0)}e.hasZ=!0}(e,n,t);break;case"multipoint":!function(e,t,n){E.spatialReference=t.spatialReference;for(var a=e.hasM&&!e.hasZ,r=0;r<e.points.length;r++){var i=e.points[r],o=t.points[r];E.x=o[0],E.y=o[1],a&&(i[3]=i[2]),i[2]=Object(v.r)(n.elevationAt(E),0)}e.hasZ=!0}(e,n,t)}return e}(e.clone(),this)}},{key:"on",value:function(){return A}},{key:"projectIfRequired",value:function(e,t){return q(e,t)}}]),e}(),R=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e,a,r){var i;Object(c.a)(this,n),(i=t.call(this)).tile=e,i.noDataValue=r,i.extent=Object(j.l)(e.tile.extent,a.spatialReference);var o=Object(d.d)(a.spatialReference),s=a.lodAt(e.tile.level).resolution*o;return i.demResolution={min:s,max:s},i}return Object(f.a)(n,[{key:"spatialReference",get:function(){return this.extent.spatialReference}},{key:"contains",value:function(e){var t=this.projectIfRequired(e,this.spatialReference);return Object(O.e)(this.extent,t)}},{key:"elevationAt",value:function(e){var t=this.projectIfRequired(e,this.spatialReference);if(Object(v.i)(t))return null;if(!this.contains(e)){var n=this.extent,a="".concat(n.xmin,", ").concat(n.ymin,", ").concat(n.xmax,", ").concat(n.ymax);T.warn("#elevationAt()","Point used to sample elevation (".concat(e.x,", ").concat(e.y,") is outside of the sampler extent (").concat(a,")"))}return this.tile.sample(t.x,t.y)}}]),n}(g),_=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e,a,r){var i,o;Object(c.a)(this,n),i=t.call(this),"number"==typeof a?(i.noDataValue=a,o=null):(o=a,i.noDataValue=r),i.samplers=o?e.map((function(e){return new R(e,o,i.noDataValue)})):e;var s=i.samplers[0];if(s){i.extent=s.extent.clone();var u=s.demResolution,l=u.min,f=u.max;i.demResolution={min:l,max:f};for(var h=1;h<i.samplers.length;h++){var p=i.samplers[h];i.extent.union(p.extent),i.demResolution.min=Math.min(i.demResolution.min,p.demResolution.min),i.demResolution.max=Math.max(i.demResolution.max,p.demResolution.max)}}else i.extent=Object(j.l)(Object(j.e)(),o.spatialReference),i.demResolution={min:0,max:0};return i}return Object(f.a)(n,[{key:"spatialReference",get:function(){return this.extent.spatialReference}},{key:"elevationAt",value:function(e){var t=this.projectIfRequired(e,this.spatialReference);if(!t)return null;var n,a=Object(i.a)(this.samplers);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r.contains(t))return r.elevationAt(t)}}catch(o){a.e(o)}finally{a.f()}return T.warn("#elevationAt()","Point used to sample elevation (".concat(e.x,", ").concat(e.y,") is outside of the sampler")),null}}]),n}(g);function q(e,t){if(Object(v.i)(e))return null;var n=e.spatialReference;if(n.equals(t))return e;var a=Object(w.d)(e,t);return a||T.error("Cannot project geometry spatial reference (wkid:".concat(n.wkid,") to elevation sampler spatial reference (wkid:").concat(t.wkid,")")),a}var E=new b.a,A={remove:function(){}},I=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(Object(c.a)(this,e),this.tile=t,Object(v.j)(n)){var a=t.extent;this.samplerData={pixelData:n.values,width:n.width,height:n.height,safeWidth:.99999999*(n.width-1),noDataValue:n.noDataValue,dx:(n.width-1)/(a[2]-a[0]),dy:(n.width-1)/(a[3]-a[1]),x0:a[0],y1:a[3]}}}return Object(f.a)(e,[{key:"sample",value:function(e,t){if(!Object(v.i)(this.samplerData)){var n=this.samplerData,a=n.safeWidth,r=n.width,i=n.pixelData,o=n.noDataValue,s=n.dx,u=n.dy,l=n.y1,c=n.x0,f=D(u*(l-t),0,a),h=D(s*(e-c),0,a),p=Math.floor(f),m=Math.floor(h),d=p*r+m,y=d+r,b=i[d],x=i[y],M=i[d+1],j=i[y+1];if(b!==o&&x!==o&&M!==o&&j!==o){var k=h-m,O=b+(M-b)*k;return O+(x+(j-x)*k-O)*(f-p)}}}}]),e}();function D(e,t,n){return e<t?t:e>n?n:e}var C=function(){function e(){Object(c.a)(this,e)}return Object(f.a)(e,[{key:"queryAll",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a){var r,i,o,l,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=a&&a.ignoreInvisibleLayers?t.filter((function(e){return e.visible})):t.slice()).length){e.next=2;break}throw new p.a("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");case 2:return r=F.fromGeometry(n),i=!1,a&&a.returnSampleInfo||(i=!0),o=Object(u.a)(Object(u.a)(Object(u.a)({},P),a),{},{returnSampleInfo:!0}),e.next=8,this.query(t[t.length-1],r,o);case 8:return l=e.sent,e.next=11,this._queryAllContinue(t,l,o);case 11:return c=e.sent,e.abrupt("return",(c.geometry=c.geometry.export(),i&&delete c.sampleInfo,c));case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"query",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new p.a("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");case 2:if(n&&(n instanceof F||"point"===n.type||"multipoint"===n.type||"polyline"===n.type)){e.next=4;break}throw new p.a("elevation-query:invalid-geometry","Only point, polyline and multipoint geometries can be used to query elevation");case 4:return r=Object(u.a)(Object(u.a)({},P),a),i=new z(t,n.spatialReference,r),o=r.signal,e.next=7,t.load({signal:o});case 7:return e.next=9,this._createGeometryDescriptor(i,n,o);case 9:return e.next=11,this._selectTiles(i,o);case 11:return e.next=13,this._populateElevationTiles(i,o);case 13:return this._sampleGeometryWithElevation(i),e.abrupt("return",this._createQueryResult(i,o));case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"createSampler",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new p.a("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");case 2:if(n&&"extent"===n.type){e.next=4;break}throw new p.a("elevation-query:invalid-extent","Invalid or undefined extent");case 4:return r=Object(u.a)(Object(u.a)({},P),a),e.abrupt("return",this._createSampler(t,n,r));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"createSamplerAll",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a){var r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=a&&a.ignoreInvisibleLayers?t.filter((function(e){return e.visible})):t.slice()).length){e.next=2;break}throw new p.a("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");case 2:if(n&&"extent"===n.type){e.next=4;break}throw new p.a("elevation-query:invalid-extent","Invalid or undefined extent");case 4:return r=Object(u.a)(Object(u.a)(Object(u.a)({},P),a),{},{returnSampleInfo:!0}),e.next=7,this._createSampler(t[t.length-1],n,r);case 7:return i=e.sent,e.abrupt("return",this._createSamplerAllContinue(t,n,i,r));case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"_createSampler",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a,r){var i,o,u,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.signal,e.next=3,t.load({signal:i});case 3:if(o=n.spatialReference,u=t.tileInfo.spatialReference,e.t0=o.equals(u),e.t0){e.next=9;break}return e.next=8,Object(M.d)([{source:o,dest:u}],{signal:i});case 8:n=Object(M.h)(n,u);case 9:return l=new V(t,n,a,r),e.next=12,this._selectTiles(l,i);case 12:return e.next=14,this._populateElevationTiles(l,i);case 14:return e.abrupt("return",new _(l.elevationTiles,l.layer.tileInfo,l.options.noDataValue));case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"_createSamplerAllContinue",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a,r){var i,o,u,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.pop(),t.length){e.next=2;break}return e.abrupt("return",a);case 2:return i=a.samplers.map((function(e){return Object(j.i)(e.extent)})),e.next=5,this._createSampler(t[t.length-1],n,r,i);case 5:if(0!==(o=e.sent).samplers.length){e.next=8;break}return e.abrupt("return",a);case 8:return u=a.samplers.concat(o.samplers),l=new _(u,r.noDataValue),e.abrupt("return",this._createSamplerAllContinue(t,n,l,r));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"_queryAllContinue",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a){var r,i,o,u,l,c,f,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=t.pop(),i=n.geometry.coordinates,o=[],u=[],l=0;l<i.length;l++)(c=n.sampleInfo[l]).demResolution>=0?c.source||(c.source=r):t.length&&(o.push(i[l]),u.push(l));if(t.length&&0!==o.length){e.next=4;break}return e.abrupt("return",n);case 4:return f=n.geometry.clone(o),e.next=7,this.query(t[t.length-1],f,a);case 7:return h=e.sent,e.abrupt("return",(u.forEach((function(e,t){i[e].z=h.geometry.coordinates[t].z,n.sampleInfo[e].demResolution=h.sampleInfo[t].demResolution})),this._queryAllContinue(t,n,a)));case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"_createQueryResult",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.geometry.project(t.outSpatialReference,n);case 2:return e.t0=e.sent.export(),e.t1=t.options.noDataValue,a={geometry:e.t0,noDataValue:e.t1},e.abrupt("return",(t.options.returnSampleInfo&&(a.sampleInfo=this._extractSampleInfo(t)),t.geometry.coordinates.forEach((function(e){e.tile=null,e.elevationTile=null})),a));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_createGeometryDescriptor",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a){var r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.layer.tileInfo.spatialReference,!(n instanceof F)){e.next=7;break}return e.next=4,n.project(i,a);case 4:r=e.sent,e.next=10;break;case 7:return e.next=9,Object(M.d)([{source:n.spatialReference,dest:i}],{signal:a});case 9:r=Object(M.h)(n,i);case 10:if(r){e.next=12;break}throw new p.a("elevation-query:spatial-reference-mismatch","Cannot query elevation in '".concat(n.spatialReference.wkid,"' on an elevation service in '").concat(i.wkid,"'"));case 12:t.geometry=F.fromGeometry(r);case 13:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"_selectTiles",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.options.demResolution,"geometry"===t.type&&this._preselectOutsideLayerExtent(t),"number"!=typeof a){e.next=5;break}this._selectTilesClosestResolution(t),e.next=14;break;case 5:if("finest-contiguous"!==a){e.next=10;break}return e.next=8,this._selectTilesFinestContiguous(t,n);case 8:e.next=14;break;case 10:if("auto"===a){e.next=12;break}throw new p.a("elevation-query:invalid-dem-resolution","Invalid dem resolution value '".concat(a,'\', expected a number, "finest-contiguous" or "auto"'));case 12:return e.next=14,this._selectTilesAuto(t,n);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_preselectOutsideLayerExtent",value:function(e){var t=new I(null);t.sample=function(){return e.options.noDataValue},e.outsideExtentTile=t;var n=e.layer.fullExtent;e.geometry.coordinates.forEach((function(e){var a=e.x,r=e.y;(a<n.xmin||a>n.xmax||r<n.ymin||r>n.ymax)&&(e.elevationTile=t)}))}},{key:"_selectTilesClosestResolution",value:function(e){var t=e.layer.tileInfo,n=this._findNearestDemResolutionLODIndex(t,e.options.demResolution);e.selectTilesAtLOD(n)}},{key:"_findNearestDemResolutionLODIndex",value:function(e,t){for(var n=t/Object(d.d)(e.spatialReference),a=e.lods[0],r=0,i=1;i<e.lods.length;i++){var o=e.lods[i];Math.abs(o.resolution-n)<Math.abs(a.resolution-n)&&(a=o,r=i)}return r}},{key:"_selectTilesFinestContiguous",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=L(t.layer.tileInfo,t.options.minDemResolution),e.next=3,this._selectTilesFinestContiguousAt(t,a,n);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_selectTilesFinestContiguousAt",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,a){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.layer,t.selectTilesAtLOD(n),!(n<0)){e.next=3;break}return e.abrupt("return");case 3:if(i=r.tilemapCache,o=t.getTilesToFetch(),e.prev=4,!i){e.next=10;break}return e.next=8,Object(m.y)(Promise.all(o.map((function(e){return i.fetchAvailability(e.level,e.row,e.col,{signal:a})}))),a);case 8:e.next=14;break;case 10:return e.next=12,this._populateElevationTiles(t,a);case 12:if(t.allElevationTilesFetched()){e.next=14;break}throw t.clearElevationTiles(),new p.a("elevation-query:has-unavailable-tiles");case 14:e.next=21;break;case 16:return e.prev=16,e.t0=e.catch(4),Object(m.u)(e.t0),e.next=21,this._selectTilesFinestContiguousAt(t,n-1,a);case 21:case"end":return e.stop()}}),e,this,[[4,16]])})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"_populateElevationTiles",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a,r,i,o,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.getTilesToFetch(),r={},i=t.options.cache,o=t.options.noDataValue,u=a.map(function(){var e=Object(l.a)(s.a.mark((function e(a){var u,l,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u="".concat(t.layer.uid,":").concat(a.id,":").concat(o),l=Object(v.j)(i)?i.get(u):null,!Object(v.j)(l)){e.next=6;break}e.t0=l,e.next=9;break;case 6:return e.next=8,t.layer.fetchTile(a.level,a.row,a.col,{noDataValue:o,signal:n});case 8:e.t0=e.sent;case 9:c=e.t0,Object(v.j)(i)&&i.put(u,c),r[a.id]=new I(a,c);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=3,Object(m.y)(Object(m.j)(u),n);case 3:t.populateElevationTiles(r);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_selectTilesAuto",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a,r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._selectTilesAutoFinest(t),this._reduceTilesForMaximumRequests(t),a=t.layer.tilemapCache){e.next=4;break}return e.abrupt("return",this._selectTilesAutoPrefetchUpsample(t,n));case 4:return r=t.getTilesToFetch(),i={},o=r.map(function(){var e=Object(l.a)(s.a.mark((function e(t){var r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={id:null,level:0,row:0,col:0,extent:Object(j.e)()},e.next=3,Object(h.c)(a.fetchAvailabilityUpsample(t.level,t.row,t.col,r,{signal:n}));case 3:!1===(o=e.sent).ok?Object(m.u)(o.error):i[t.id]=r;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=7,Object(m.y)(Promise.all(o),n);case 7:t.remapTiles(i);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_reduceTilesForMaximumRequests",value:function(e){var t=e.layer.tileInfo,n=0,a={},r=function(e){e.id in a?a[e.id]++:(a[e.id]=1,n++)},i=function(e){var t=a[e.id];1===t?(delete a[e.id],n--):a[e.id]=t-1};e.forEachTileToFetch(r,i);for(var o=!0;o&&(o=!1,e.forEachTileToFetch((function(a){n<=e.options.maximumAutoTileRequests||(i(a),t.upsampleTile(a)&&(o=!0),r(a))}),i),o););}},{key:"_selectTilesAutoFinest",value:function(e){var t=L(e.layer.tileInfo,e.options.minDemResolution);e.selectTilesAtLOD(t,e.options.maximumAutoTileRequests)}},{key:"_selectTilesAutoPrefetchUpsample",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.layer.tileInfo,e.next=3,this._populateElevationTiles(t,n);case 3:if(r=!1,t.forEachTileToFetch((function(e,t){a.upsampleTile(e)?r=!0:t()})),e.t0=r,!e.t0){e.next=9;break}return e.next=9,this._selectTilesAutoPrefetchUpsample(t,n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_sampleGeometryWithElevation",value:function(e){e.geometry.coordinates.forEach((function(t){var n=t.elevationTile,a=e.options.noDataValue;if(n){var r=n.sample(t.x,t.y);Object(v.j)(r)?a=r:t.elevationTile=null}t.z=a}))}},{key:"_extractSampleInfo",value:function(e){var t=e.layer.tileInfo,n=Object(d.d)(t.spatialReference);return e.geometry.coordinates.map((function(a){var r=-1;return a.elevationTile&&a.elevationTile!==e.outsideExtentTile&&(r=t.lodAt(a.elevationTile.tile.level).resolution*n),{demResolution:r}}))}}]),e}(),F=function(){function e(){Object(c.a)(this,e)}return Object(f.a)(e,[{key:"export",value:function(){return this._exporter(this.coordinates,this.spatialReference)}},{key:"clone",value:function(t){var n=this,a=new e;return a.geometry=this.geometry,a.spatialReference=this.spatialReference,a.coordinates=t||this.coordinates.map((function(e){return n._cloneCoordinate(e)})),a._exporter=this._exporter,a}},{key:"project",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a,r,i,o,u=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.spatialReference.equals(t)){e.next=2;break}return e.abrupt("return",this.clone());case 2:return e.next=4,Object(M.d)([{source:this.spatialReference,dest:t}],{signal:n});case 4:if(a=new y.a({spatialReference:this.spatialReference,points:this.coordinates.map((function(e){return[e.x,e.y]}))}),r=Object(M.h)(a,t)){e.next=7;break}return e.abrupt("return",null);case 7:return i=this.coordinates.map((function(e,t){var n=u._cloneCoordinate(e),a=r.points[t];return n.x=a[0],n.y=a[1],n})),o=this.clone(i),e.abrupt("return",(o.spatialReference=t,o));case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_cloneCoordinate",value:function(e){return{x:e.x,y:e.y,z:e.z,m:e.m,tile:null,elevationTile:null}}}],[{key:"fromGeometry",value:function(t){var n=new e;if(n.geometry=t,n.spatialReference=t.spatialReference,t instanceof e)n.coordinates=t.coordinates.map((function(e){return n._cloneCoordinate(e)})),n._exporter=function(e,n){var a=t.clone(e);return a.spatialReference=n,a};else switch(t.type){case"point":var a=t,r=a.hasZ,o=a.hasM;n.coordinates=r&&o?[{x:a.x,y:a.y,z:a.z,m:a.m}]:r?[{x:a.x,y:a.y,z:a.z}]:o?[{x:a.x,y:a.y,m:a.m}]:[{x:a.x,y:a.y}],n._exporter=function(e,n){return t.hasM?new b.a(e[0].x,e[0].y,e[0].z,e[0].m,n):new b.a(e[0].x,e[0].y,e[0].z,n)};break;case"multipoint":var s=t,u=s.hasZ,l=s.hasM;n.coordinates=u&&l?s.points.map((function(e){return{x:e[0],y:e[1],z:e[2],m:e[3]}})):u?s.points.map((function(e){return{x:e[0],y:e[1],z:e[2]}})):l?s.points.map((function(e){return{x:e[0],y:e[1],m:e[2]}})):s.points.map((function(e){return{x:e[0],y:e[1]}})),n._exporter=function(e,n){return t.hasM?new y.a({points:e.map((function(e){return[e.x,e.y,e.z,e.m]})),hasZ:!0,hasM:!0,spatiaReference:n}):new y.a(e.map((function(e){return[e.x,e.y,e.z]})),n)};break;case"polyline":var c,f=t,h=[],p=[],v=t.hasZ,m=t.hasM,d=0,M=Object(i.a)(f.paths);try{for(M.s();!(c=M.n()).done;){var j=c.value;if(p.push([d,d+j.length]),d+=j.length,v&&m){var k,O=Object(i.a)(j);try{for(O.s();!(k=O.n()).done;){var w=k.value;h.push({x:w[0],y:w[1],z:w[2],m:w[3]})}}catch(C){O.e(C)}finally{O.f()}}else if(v){var T,g=Object(i.a)(j);try{for(g.s();!(T=g.n()).done;){var R=T.value;h.push({x:R[0],y:R[1],z:R[2]})}}catch(C){g.e(C)}finally{g.f()}}else if(m){var _,q=Object(i.a)(j);try{for(q.s();!(_=q.n()).done;){var E=_.value;h.push({x:E[0],y:E[1],m:E[2]})}}catch(C){q.e(C)}finally{q.f()}}else{var A,I=Object(i.a)(j);try{for(I.s();!(A=I.n()).done;){var D=A.value;h.push({x:D[0],y:D[1]})}}catch(C){I.e(C)}finally{I.f()}}}}catch(C){M.e(C)}finally{M.f()}n.coordinates=h,n._exporter=function(e,n){var a=t.hasM?e.map((function(e){return[e.x,e.y,e.z,e.m]})):e.map((function(e){return[e.x,e.y,e.z]})),r=p.map((function(e){return a.slice(e[0],e[1])}));return new x.a({paths:r,hasM:t.hasM,hasZ:!0,spatialReference:n})}}return n}}]),e}(),S=function e(t,n){Object(c.a)(this,e),this.layer=t,this.options=n},z=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e,a,r){var i;return Object(c.a)(this,n),(i=t.call(this,e,r)).outSpatialReference=a,i.type="geometry",i}return Object(f.a)(n,[{key:"selectTilesAtLOD",value:function(e){if(e<0)this.geometry.coordinates.forEach((function(e){return e.tile=null}));else{var t=this.layer.tileInfo,n=t.lods[e].level;this.geometry.coordinates.forEach((function(e){e.tile=t.tileAt(n,e.x,e.y)}))}}},{key:"allElevationTilesFetched",value:function(){return!this.geometry.coordinates.some((function(e){return!e.elevationTile}))}},{key:"clearElevationTiles",value:function(){var e,t=Object(i.a)(this.geometry.coordinates);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.elevationTile!==this.outsideExtentTile&&(n.elevationTile=null)}}catch(a){t.e(a)}finally{t.f()}}},{key:"populateElevationTiles",value:function(e){var t,n=Object(i.a)(this.geometry.coordinates);try{for(n.s();!(t=n.n()).done;){var a=t.value;!a.elevationTile&&a.tile&&(a.elevationTile=e[a.tile.id])}}catch(r){n.e(r)}finally{n.f()}}},{key:"remapTiles",value:function(e){var t,n=Object(i.a)(this.geometry.coordinates);try{for(n.s();!(t=n.n()).done;){var a=t.value;a.tile=e[a.tile.id]}}catch(r){n.e(r)}finally{n.f()}}},{key:"getTilesToFetch",value:function(){var e,t={},n=[],a=Object(i.a)(this.geometry.coordinates);try{for(a.s();!(e=a.n()).done;){var r=e.value,o=r.tile;r.elevationTile||!r.tile||t[o.id]||(t[o.id]=o,n.push(o))}}catch(s){a.e(s)}finally{a.f()}return n}},{key:"forEachTileToFetch",value:function(e){var t,n=Object(i.a)(this.geometry.coordinates);try{var a=function(){var n=t.value;n.tile&&!n.elevationTile&&e(n.tile,(function(){return n.tile=null}))};for(n.s();!(t=n.n()).done;)a()}catch(r){n.e(r)}finally{n.f()}}}]),n}(S),V=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e,a,r,i){var o;return Object(c.a)(this,n),(o=t.call(this,e,r)).type="extent",o.elevationTiles=[],o.candidateTiles=[],o.fetchedCandidates=new Set,o.extent=a.intersection(e.fullExtent),o.maskExtents=i,o}return Object(f.a)(n,[{key:"selectTilesAtLOD",value:function(e,t){var n=this._maximumLodForRequests(t),a=Math.min(n,e);a<0?this.candidateTiles.length=0:this._selectCandidateTilesCoveringExtentAt(a)}},{key:"_maximumLodForRequests",value:function(e){var t=this.layer.tileInfo;if(!e)return t.lods.length-1;var n=this.extent;if(Object(v.i)(n))return-1;for(var a=t.lods.length-1;a>=0;a--){var r=t.lods[a],i=r.resolution*t.size[0],o=r.resolution*t.size[1];if(Math.ceil(n.width/i)*Math.ceil(n.height/o)<=e)return a}return-1}},{key:"allElevationTilesFetched",value:function(){return this.candidateTiles.length===this.elevationTiles.length}},{key:"clearElevationTiles",value:function(){this.elevationTiles.length=0,this.fetchedCandidates.clear()}},{key:"populateElevationTiles",value:function(e){var t,n=Object(i.a)(this.candidateTiles);try{for(n.s();!(t=n.n()).done;){var a=t.value,r=e[a.id];r&&(this.fetchedCandidates.add(a),this.elevationTiles.push(r))}}catch(o){n.e(o)}finally{n.f()}}},{key:"remapTiles",value:function(e){this.candidateTiles=this._uniqueNonOverlappingTiles(this.candidateTiles.map((function(t){return e[t.id]})))}},{key:"getTilesToFetch",value:function(){return this.candidateTiles}},{key:"forEachTileToFetch",value:function(e,t){var n=this,a=this.candidateTiles;this.candidateTiles=[],a.forEach((function(a){if(n.fetchedCandidates.has(a))t&&t(a);else{var r=!1;e(a,(function(){return r=!0})),r?t&&t(a):n.candidateTiles.push(a)}})),this.candidateTiles=this._uniqueNonOverlappingTiles(this.candidateTiles,t)}},{key:"_uniqueNonOverlappingTiles",value:function(e,t){var n,a={},r=[],o=Object(i.a)(e);try{for(o.s();!(n=o.n()).done;){var s=n.value;a[s.id]?t&&t(s):(a[s.id]=s,r.push(s))}}catch(l){o.e(l)}finally{o.f()}var u=r.sort((function(e,t){return e.level-t.level}));return u.filter((function(e,n){for(var a=0;a<n;a++)if(Object(j.c)(u[a].extent,e.extent))return t&&t(e),!1;return!0}))}},{key:"_selectCandidateTilesCoveringExtentAt",value:function(e){this.candidateTiles.length=0;var t=this.extent;if(!Object(v.i)(t))for(var n=this.layer.tileInfo,a=n.lods[e],r=n.tileAt(a.level,t.xmin,t.ymin),i=a.resolution*n.size[0],o=a.resolution*n.size[1],s=Math.ceil((t.xmax-r.extent[0])/i),u=Math.ceil((t.ymax-r.extent[1])/o),l=0;l<u;l++)for(var c=0;c<s;c++){var f={id:null,level:r.level,row:r.row-l,col:r.col+c};n.updateTileInfo(f),this._tileIsMasked(f)||this.candidateTiles.push(f)}}},{key:"_tileIsMasked",value:function(e){return!!this.maskExtents&&this.maskExtents.some((function(t){return Object(j.c)(t,e.extent)}))}}]),n}(S);function L(e,t){var n=e.lods.length-1;if(t>0){var a=e.lods.findIndex((function(e){return e.resolution<t}));0===a?n=0:a>0&&(n=a-1)}return n}var P={maximumAutoTileRequests:20,noDataValue:0,returnSampleInfo:!1,demResolution:"auto",minDemResolution:0}},738:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return x})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return M})),n.d(t,"l",(function(){return o})),n.d(t,"m",(function(){return f}));var a=n(211),r=n(93);function i(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function o(e,t,n,a,r,i,o,s,u,l,c,f,h,p,v,m,d){return e[0]=t,e[1]=n,e[2]=a,e[3]=r,e[4]=i,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e[9]=c,e[10]=f,e[11]=h,e[12]=p,e[13]=v,e[14]=m,e[15]=d,e}function s(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function u(e,t){if(e===t){var n=t[1],a=t[2],r=t[3],i=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=a,e[9]=i,e[11]=t[14],e[12]=r,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function l(e,t){var n=t[0],a=t[1],r=t[2],i=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],h=t[10],p=t[11],v=t[12],m=t[13],d=t[14],y=t[15],b=n*s-a*o,x=n*u-r*o,M=n*l-i*o,j=a*u-r*s,k=a*l-i*s,O=r*l-i*u,w=c*m-f*v,T=c*d-h*v,g=c*y-p*v,R=f*d-h*m,_=f*y-p*m,q=h*y-p*d,E=b*q-x*_+M*R+j*g-k*T+O*w;return E?(E=1/E,e[0]=(s*q-u*_+l*R)*E,e[1]=(r*_-a*q-i*R)*E,e[2]=(m*O-d*k+y*j)*E,e[3]=(h*k-f*O-p*j)*E,e[4]=(u*g-o*q-l*T)*E,e[5]=(n*q-r*g+i*T)*E,e[6]=(d*M-v*O-y*x)*E,e[7]=(c*O-h*M+p*x)*E,e[8]=(o*_-s*g+l*w)*E,e[9]=(a*g-n*_-i*w)*E,e[10]=(v*k-m*M+y*b)*E,e[11]=(f*M-c*k-p*b)*E,e[12]=(s*T-o*R-u*w)*E,e[13]=(n*R-a*T+r*w)*E,e[14]=(m*x-v*j-d*b)*E,e[15]=(c*j-f*x+h*b)*E,e):null}function c(e,t,n){var a=t[0],r=t[1],i=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],h=t[9],p=t[10],v=t[11],m=t[12],d=t[13],y=t[14],b=t[15],x=n[0],M=n[1],j=n[2],k=n[3];return e[0]=x*a+M*s+j*f+k*m,e[1]=x*r+M*u+j*h+k*d,e[2]=x*i+M*l+j*p+k*y,e[3]=x*o+M*c+j*v+k*b,x=n[4],M=n[5],j=n[6],k=n[7],e[4]=x*a+M*s+j*f+k*m,e[5]=x*r+M*u+j*h+k*d,e[6]=x*i+M*l+j*p+k*y,e[7]=x*o+M*c+j*v+k*b,x=n[8],M=n[9],j=n[10],k=n[11],e[8]=x*a+M*s+j*f+k*m,e[9]=x*r+M*u+j*h+k*d,e[10]=x*i+M*l+j*p+k*y,e[11]=x*o+M*c+j*v+k*b,x=n[12],M=n[13],j=n[14],k=n[15],e[12]=x*a+M*s+j*f+k*m,e[13]=x*r+M*u+j*h+k*d,e[14]=x*i+M*l+j*p+k*y,e[15]=x*o+M*c+j*v+k*b,e}function f(e,t,n){var a,r,i,o,s,u,l,c,f,h,p,v,m=n[0],d=n[1],y=n[2];return t===e?(e[12]=t[0]*m+t[4]*d+t[8]*y+t[12],e[13]=t[1]*m+t[5]*d+t[9]*y+t[13],e[14]=t[2]*m+t[6]*d+t[10]*y+t[14],e[15]=t[3]*m+t[7]*d+t[11]*y+t[15]):(a=t[0],r=t[1],i=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],h=t[9],p=t[10],v=t[11],e[0]=a,e[1]=r,e[2]=i,e[3]=o,e[4]=s,e[5]=u,e[6]=l,e[7]=c,e[8]=f,e[9]=h,e[10]=p,e[11]=v,e[12]=a*m+s*d+f*y+t[12],e[13]=r*m+u*d+h*y+t[13],e[14]=i*m+l*d+p*y+t[14],e[15]=o*m+c*d+v*y+t[15]),e}function h(e,t,n){var a=n[0],r=n[1],i=n[2];return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function p(e,t,n,a){var i,o,s,u,l,c,f,h,p,v,m,d,y,b,x,M,j,k,O,w,T,g,R,_,q=a[0],E=a[1],A=a[2],I=Math.sqrt(q*q+E*E+A*A);return I<r.a?null:(q*=I=1/I,E*=I,A*=I,i=Math.sin(n),s=1-(o=Math.cos(n)),u=t[0],l=t[1],c=t[2],f=t[3],h=t[4],p=t[5],v=t[6],m=t[7],d=t[8],y=t[9],b=t[10],x=t[11],M=q*q*s+o,j=E*q*s+A*i,k=A*q*s-E*i,O=q*E*s-A*i,w=E*E*s+o,T=A*E*s+q*i,g=q*A*s+E*i,R=E*A*s-q*i,_=A*A*s+o,e[0]=u*M+h*j+d*k,e[1]=l*M+p*j+y*k,e[2]=c*M+v*j+b*k,e[3]=f*M+m*j+x*k,e[4]=u*O+h*w+d*T,e[5]=l*O+p*w+y*T,e[6]=c*O+v*w+b*T,e[7]=f*O+m*w+x*T,e[8]=u*g+h*R+d*_,e[9]=l*g+p*R+y*_,e[10]=c*g+v*R+b*_,e[11]=f*g+m*R+x*_,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function v(e,t){var n=Math.sin(t),a=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function m(e,t,n){var a=t[0],r=t[1],i=t[2],o=t[3],s=a+a,u=r+r,l=i+i,c=a*s,f=a*u,h=a*l,p=r*u,v=r*l,m=i*l,d=o*s,y=o*u,b=o*l;return e[0]=1-(p+m),e[1]=f+b,e[2]=h-y,e[3]=0,e[4]=f-b,e[5]=1-(c+m),e[6]=v+d,e[7]=0,e[8]=h+y,e[9]=v-d,e[10]=1-(c+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}var d=Object(a.e)();function y(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function b(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function x(e,t){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],h=e[9],p=e[10],v=e[11],m=e[12],d=e[13],y=e[14],b=e[15],x=t[0],M=t[1],j=t[2],k=t[3],O=t[4],w=t[5],T=t[6],g=t[7],R=t[8],_=t[9],q=t[10],E=t[11],A=t[12],I=t[13],D=t[14],C=t[15];return Math.abs(n-x)<=r.a*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(a-M)<=r.a*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(i-j)<=r.a*Math.max(1,Math.abs(i),Math.abs(j))&&Math.abs(o-k)<=r.a*Math.max(1,Math.abs(o),Math.abs(k))&&Math.abs(s-O)<=r.a*Math.max(1,Math.abs(s),Math.abs(O))&&Math.abs(u-w)<=r.a*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(l-T)<=r.a*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-g)<=r.a*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(f-R)<=r.a*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(h-_)<=r.a*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(p-q)<=r.a*Math.max(1,Math.abs(p),Math.abs(q))&&Math.abs(v-E)<=r.a*Math.max(1,Math.abs(v),Math.abs(E))&&Math.abs(m-A)<=r.a*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(d-I)<=r.a*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(y-D)<=r.a*Math.max(1,Math.abs(y),Math.abs(D))&&Math.abs(b-C)<=r.a*Math.max(1,Math.abs(b),Math.abs(C))}function M(e){var t=r.a,n=e[0],a=e[1],i=e[2],o=e[4],s=e[5],u=e[6],l=e[8],c=e[9],f=e[10];return Math.abs(1-(n*n+o*o+l*l))<=t&&Math.abs(1-(a*a+s*s+c*c))<=t&&Math.abs(1-(i*i+u*u+f*f))<=t}var j=c,k=y;Object.freeze({__proto__:null,copy:i,set:o,identity:s,transpose:u,invert:l,adjoint:function(e,t){var n=t[0],a=t[1],r=t[2],i=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],h=t[10],p=t[11],v=t[12],m=t[13],d=t[14],y=t[15];return e[0]=s*(h*y-p*d)-f*(u*y-l*d)+m*(u*p-l*h),e[1]=-(a*(h*y-p*d)-f*(r*y-i*d)+m*(r*p-i*h)),e[2]=a*(u*y-l*d)-s*(r*y-i*d)+m*(r*l-i*u),e[3]=-(a*(u*p-l*h)-s*(r*p-i*h)+f*(r*l-i*u)),e[4]=-(o*(h*y-p*d)-c*(u*y-l*d)+v*(u*p-l*h)),e[5]=n*(h*y-p*d)-c*(r*y-i*d)+v*(r*p-i*h),e[6]=-(n*(u*y-l*d)-o*(r*y-i*d)+v*(r*l-i*u)),e[7]=n*(u*p-l*h)-o*(r*p-i*h)+c*(r*l-i*u),e[8]=o*(f*y-p*m)-c*(s*y-l*m)+v*(s*p-l*f),e[9]=-(n*(f*y-p*m)-c*(a*y-i*m)+v*(a*p-i*f)),e[10]=n*(s*y-l*m)-o*(a*y-i*m)+v*(a*l-i*s),e[11]=-(n*(s*p-l*f)-o*(a*p-i*f)+c*(a*l-i*s)),e[12]=-(o*(f*d-h*m)-c*(s*d-u*m)+v*(s*h-u*f)),e[13]=n*(f*d-h*m)-c*(a*d-r*m)+v*(a*h-r*f),e[14]=-(n*(s*d-u*m)-o*(a*d-r*m)+v*(a*u-r*s)),e[15]=n*(s*h-u*f)-o*(a*h-r*f)+c*(a*u-r*s),e},determinant:function(e){var t=e[0],n=e[1],a=e[2],r=e[3],i=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],f=e[10],h=e[11],p=e[12],v=e[13],m=e[14],d=e[15];return(t*o-n*i)*(f*d-h*m)-(t*s-a*i)*(c*d-h*v)+(t*u-r*i)*(c*m-f*v)+(n*s-a*o)*(l*d-h*p)-(n*u-r*o)*(l*m-f*p)+(a*u-r*s)*(l*v-c*p)},multiply:c,translate:f,scale:h,rotate:p,rotateX:function(e,t,n){var a=Math.sin(n),r=Math.cos(n),i=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*r+l*a,e[5]=o*r+c*a,e[6]=s*r+f*a,e[7]=u*r+h*a,e[8]=l*r-i*a,e[9]=c*r-o*a,e[10]=f*r-s*a,e[11]=h*r-u*a,e},rotateY:function(e,t,n){var a=Math.sin(n),r=Math.cos(n),i=t[0],o=t[1],s=t[2],u=t[3],l=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*r-l*a,e[1]=o*r-c*a,e[2]=s*r-f*a,e[3]=u*r-h*a,e[8]=i*a+l*r,e[9]=o*a+c*r,e[10]=s*a+f*r,e[11]=u*a+h*r,e},rotateZ:function(e,t,n){var a=Math.sin(n),r=Math.cos(n),i=t[0],o=t[1],s=t[2],u=t[3],l=t[4],c=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*r+l*a,e[1]=o*r+c*a,e[2]=s*r+f*a,e[3]=u*r+h*a,e[4]=l*r-i*a,e[5]=c*r-o*a,e[6]=f*r-s*a,e[7]=h*r-u*a,e},fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromRotation:function(e,t,n){var a,i,o,s=n[0],u=n[1],l=n[2],c=Math.sqrt(s*s+u*u+l*l);return c<r.a?null:(s*=c=1/c,u*=c,l*=c,a=Math.sin(t),o=1-(i=Math.cos(t)),e[0]=s*s*o+i,e[1]=u*s*o+l*a,e[2]=l*s*o-u*a,e[3]=0,e[4]=s*u*o-l*a,e[5]=u*u*o+i,e[6]=l*u*o+s*a,e[7]=0,e[8]=s*l*o+u*a,e[9]=u*l*o-s*a,e[10]=l*l*o+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},fromXRotation:v,fromYRotation:function(e,t){var n=Math.sin(t),a=Math.cos(t);return e[0]=a,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromZRotation:function(e,t){var n=Math.sin(t),a=Math.cos(t);return e[0]=a,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromRotationTranslation:m,fromQuat2:function(e,t){var n=d,a=-t[0],r=-t[1],i=-t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=a*a+r*r+i*i+o*o;return f>0?(n[0]=2*(s*o+c*a+u*i-l*r)/f,n[1]=2*(u*o+c*r+l*a-s*i)/f,n[2]=2*(l*o+c*i+s*r-u*a)/f):(n[0]=2*(s*o+c*a+u*i-l*r),n[1]=2*(u*o+c*r+l*a-s*i),n[2]=2*(l*o+c*i+s*r-u*a)),m(e,t,n),e},getTranslation:function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},getScaling:function(e,t){var n=t[0],a=t[1],r=t[2],i=t[4],o=t[5],s=t[6],u=t[8],l=t[9],c=t[10];return e[0]=Math.sqrt(n*n+a*a+r*r),e[1]=Math.sqrt(i*i+o*o+s*s),e[2]=Math.sqrt(u*u+l*l+c*c),e},getRotation:function(e,t){var n=t[0]+t[5]+t[10],a=0;return n>0?(a=2*Math.sqrt(n+1),e[3]=.25*a,e[0]=(t[6]-t[9])/a,e[1]=(t[8]-t[2])/a,e[2]=(t[1]-t[4])/a):t[0]>t[5]&&t[0]>t[10]?(a=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/a,e[0]=.25*a,e[1]=(t[1]+t[4])/a,e[2]=(t[8]+t[2])/a):t[5]>t[10]?(a=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/a,e[0]=(t[1]+t[4])/a,e[1]=.25*a,e[2]=(t[6]+t[9])/a):(a=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/a,e[0]=(t[8]+t[2])/a,e[1]=(t[6]+t[9])/a,e[2]=.25*a),e},fromRotationTranslationScale:function(e,t,n,a){var r=t[0],i=t[1],o=t[2],s=t[3],u=r+r,l=i+i,c=o+o,f=r*u,h=r*l,p=r*c,v=i*l,m=i*c,d=o*c,y=s*u,b=s*l,x=s*c,M=a[0],j=a[1],k=a[2];return e[0]=(1-(v+d))*M,e[1]=(h+x)*M,e[2]=(p-b)*M,e[3]=0,e[4]=(h-x)*j,e[5]=(1-(f+d))*j,e[6]=(m+y)*j,e[7]=0,e[8]=(p+b)*k,e[9]=(m-y)*k,e[10]=(1-(f+v))*k,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},fromRotationTranslationScaleOrigin:function(e,t,n,a,r){var i=t[0],o=t[1],s=t[2],u=t[3],l=i+i,c=o+o,f=s+s,h=i*l,p=i*c,v=i*f,m=o*c,d=o*f,y=s*f,b=u*l,x=u*c,M=u*f,j=a[0],k=a[1],O=a[2],w=r[0],T=r[1],g=r[2],R=(1-(m+y))*j,_=(p+M)*j,q=(v-x)*j,E=(p-M)*k,A=(1-(h+y))*k,I=(d+b)*k,D=(v+x)*O,C=(d-b)*O,F=(1-(h+m))*O;return e[0]=R,e[1]=_,e[2]=q,e[3]=0,e[4]=E,e[5]=A,e[6]=I,e[7]=0,e[8]=D,e[9]=C,e[10]=F,e[11]=0,e[12]=n[0]+w-(R*w+E*T+D*g),e[13]=n[1]+T-(_*w+A*T+C*g),e[14]=n[2]+g-(q*w+I*T+F*g),e[15]=1,e},fromQuat:function(e,t){var n=t[0],a=t[1],r=t[2],i=t[3],o=n+n,s=a+a,u=r+r,l=n*o,c=a*o,f=a*s,h=r*o,p=r*s,v=r*u,m=i*o,d=i*s,y=i*u;return e[0]=1-f-v,e[1]=c+y,e[2]=h-d,e[3]=0,e[4]=c-y,e[5]=1-l-v,e[6]=p+m,e[7]=0,e[8]=h+d,e[9]=p-m,e[10]=1-l-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},frustum:function(e,t,n,a,r,i,o){var s=1/(n-t),u=1/(r-a),l=1/(i-o);return e[0]=2*i*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(r+a)*u,e[10]=(o+i)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*i*2*l,e[15]=0,e},perspective:function(e,t,n,a,r){var i,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(i=1/(a-r),e[10]=(r+a)*i,e[14]=2*r*a*i):(e[10]=-1,e[14]=-2*a),e},perspectiveFromFieldOfView:function(e,t,n,a){var r=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(r+i);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(o-s)*u*.5,e[9]=(r-i)*l*.5,e[10]=a/(n-a),e[11]=-1,e[12]=0,e[13]=0,e[14]=a*n/(n-a),e[15]=0,e},ortho:function(e,t,n,a,r,i,o){var s=1/(t-n),u=1/(a-r),l=1/(i-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*s,e[13]=(r+a)*u,e[14]=(o+i)*l,e[15]=1,e},lookAt:function(e,t,n,a){var i,o,u,l,c,f,h,p,v,m,d=t[0],y=t[1],b=t[2],x=a[0],M=a[1],j=a[2],k=n[0],O=n[1],w=n[2];return Math.abs(d-k)<r.a&&Math.abs(y-O)<r.a&&Math.abs(b-w)<r.a?s(e):(h=d-k,p=y-O,v=b-w,i=M*(v*=m=1/Math.sqrt(h*h+p*p+v*v))-j*(p*=m),o=j*(h*=m)-x*v,u=x*p-M*h,(m=Math.sqrt(i*i+o*o+u*u))?(i*=m=1/m,o*=m,u*=m):(i=0,o=0,u=0),l=p*u-v*o,c=v*i-h*u,f=h*o-p*i,(m=Math.sqrt(l*l+c*c+f*f))?(l*=m=1/m,c*=m,f*=m):(l=0,c=0,f=0),e[0]=i,e[1]=l,e[2]=h,e[3]=0,e[4]=o,e[5]=c,e[6]=p,e[7]=0,e[8]=u,e[9]=f,e[10]=v,e[11]=0,e[12]=-(i*d+o*y+u*b),e[13]=-(l*d+c*y+f*b),e[14]=-(h*d+p*y+v*b),e[15]=1,e)},targetTo:function(e,t,n,a){var r=t[0],i=t[1],o=t[2],s=a[0],u=a[1],l=a[2],c=r-n[0],f=i-n[1],h=o-n[2],p=c*c+f*f+h*h;p>0&&(c*=p=1/Math.sqrt(p),f*=p,h*=p);var v=u*h-l*f,m=l*c-s*h,d=s*f-u*c;return(p=v*v+m*m+d*d)>0&&(v*=p=1/Math.sqrt(p),m*=p,d*=p),e[0]=v,e[1]=m,e[2]=d,e[3]=0,e[4]=f*d-h*m,e[5]=h*v-c*d,e[6]=c*m-f*v,e[7]=0,e[8]=c,e[9]=f,e[10]=h,e[11]=0,e[12]=r,e[13]=i,e[14]=o,e[15]=1,e},str:function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},frob:function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e},subtract:y,multiplyScalar:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e},multiplyScalarAndAdd:function(e,t,n,a){return e[0]=t[0]+n[0]*a,e[1]=t[1]+n[1]*a,e[2]=t[2]+n[2]*a,e[3]=t[3]+n[3]*a,e[4]=t[4]+n[4]*a,e[5]=t[5]+n[5]*a,e[6]=t[6]+n[6]*a,e[7]=t[7]+n[7]*a,e[8]=t[8]+n[8]*a,e[9]=t[9]+n[9]*a,e[10]=t[10]+n[10]*a,e[11]=t[11]+n[11]*a,e[12]=t[12]+n[12]*a,e[13]=t[13]+n[13]*a,e[14]=t[14]+n[14]*a,e[15]=t[15]+n[15]*a,e},exactEquals:b,equals:x,isOrthoNormal:M,mul:j,sub:k})}}]);
//# sourceMappingURL=30.ccd7de7a.chunk.js.map