(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[7],{667:function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n=r(21),s=r(2),o=r(4),a=r(83),i=r(29),c=r(122),u=r(11),l=r(30),f=r(674),h=r(296),d={statsWorker:function(){return r.e(99).then(r.bind(null,787))},geometryEngineWorker:function(){return Promise.all([r.e(9),r.e(82)]).then(r.bind(null,788))},CSVSourceWorker:function(){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(8),r.e(59)]).then(r.bind(null,803))},EdgeProcessingWorker:function(){return Promise.all([r.e(12),r.e(81)]).then(r.bind(null,797))},ElevationSamplerWorker:function(){return Promise.all([r.e(4),r.e(8),r.e(12),r.e(20),r.e(111)]).then(r.bind(null,789))},FeatureServiceSnappingSourceWorker:function(){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(8),r.e(51)]).then(r.bind(null,798))},GeoJSONSourceWorker:function(){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(8),r.e(58)]).then(r.bind(null,790))},LercWorker:function(){return r.e(89).then(r.bind(null,791))},MemorySourceWorker:function(){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(8),r.e(57)]).then(r.bind(null,792))},PBFDecoderWorker:function(){return Promise.all([r.e(6),r.e(65)]).then(r.bind(null,800))},Pipeline:function(){return Promise.all([r.e(2),r.e(4),r.e(5),r.e(6),r.e(39)]).then(r.bind(null,795))},PointCloudWorker:function(){return Promise.all([r.e(4),r.e(27),r.e(75)]).then(r.bind(null,799))},RasterWorker:function(){return r.e(63).then(r.bind(null,793))},SceneLayerWorker:function(){return r.e(121).then(r.bind(null,804))},WFSSourceWorker:function(){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(8),r.e(56)]).then(r.bind(null,794))},WorkerTileHandler:function(){return Promise.all([r.e(26),r.e(23),r.e(93)]).then(r.bind(null,796))}},p=f.a.CLOSE,b=f.a.ABORT,v=f.a.INVOKE,g=f.a.RESPONSE,m=f.a.OPEN_PORT,k=f.a.ON,y=function(){function e(t){Object(s.a)(this,e),this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=t,this._timer=null,this._process=this._process.bind(this)}return Object(o.a)(e,[{key:"push",value:function(e){e.type===f.a.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),null===this._timer&&(this._timer=setTimeout(this._process,0)))}},{key:"clear",value:function(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}},{key:"_process",value:function(){this._timer=null;var e,t=Object(n.a)(this._invokeMessages);try{for(t.s();!(e=t.n()).done;){var r=e.value;this._cancelledJobIds.has(r.jobId)||this._invoke(r)}}catch(s){t.e(s)}finally{t.f()}this._cancelledJobIds.clear(),this._invokeMessages.length=0}}]),e}(),_=function(){function e(t,r){var n=this;Object(s.a)(this,e),this._port=t,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new y((function(e){return n._onInvokeMessage(e)})),this._client=r.client,this._onMessage=this._onMessage.bind(this),this._channel=r.channel,this._schedule=r.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}return Object(o.a)(e,[{key:"close",value:function(){this._post({type:p}),this._close()}},{key:"isBusy",value:function(){return this._outJobs.size>0}},{key:"invoke",value:function(e,t,r){var n=this,s=r&&r.signal,o=r&&r.transferList;if(!this._port)return Promise.reject(new i.a("worker:port-closed","Cannot call invoke('".concat(e,"'), port is closed"),{methodName:e,data:t}));var a=Object(f.b)();return new Promise((function(r,i){var c=Object(l.r)(s,(function(){var e,t=n._outJobs.get(a);t&&(n._outJobs.delete(a),null==(e=t.abortHandle)||e.remove(),n._post({type:b,jobId:a}),i(Object(l.e)()))})),u={resolve:r,reject:i,abortHandle:c,debugInfo:e};n._outJobs.set(a,u),n._post({type:v,jobId:a,methodName:e,abortable:null!=s},t,o)}))}},{key:"on",value:function(e,t){var r=new MessageChannel;function n(e){t(e.data)}return this._port.postMessage({type:f.a.ON,eventType:e,port:r.port2},[r.port2]),r.port1.addEventListener("message",n),r.port1.start(),{remove:function(){r.port1.postMessage({type:f.a.CLOSE}),r.port1.close(),r.port1.removeEventListener("message",n)}}}},{key:"openPort",value:function(){var e=new MessageChannel;return this._post({type:m,port:e.port2}),e.port1}},{key:"_close",value:function(){this._channel&&(this._channel=null),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((function(e){var t;null==(t=e.abortHandle)||t.remove(),e.reject(Object(l.e)("Worker closing, aborting job calling '".concat(e.debugInfo,"'")))})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=this._client=this._schedule=null}},{key:"_onMessage",value:function(e){var t=this;Object(u.j)(this._schedule)?this._schedule((function(){return t._processMessage(e)})):this._processMessage(e)}},{key:"_processMessage",value:function(e){var t=Object(f.d)(e);if(t)switch(t.type){case g:this._onResponseMessage(t);break;case v:this._invokeQueue.push(t);break;case b:this._onAbortMessage(t);break;case p:this._onCloseMessage();break;case m:this._onOpenPortMessage(t);break;case k:this._onOnMessage(t)}}},{key:"_onAbortMessage",value:function(e){var t=this._inJobs,r=e.jobId,n=t.get(r);this._invokeQueue.push(e),n&&(n.controller&&n.controller.abort(),t.delete(r))}},{key:"_onCloseMessage",value:function(){var t=this._client;this._close(),t&&"destroy"in t&&e.clients.get(this)===t&&t.destroy(),e.clients.delete(this),t&&t.remoteClient&&(t.remoteClient=null)}},{key:"_onInvokeMessage",value:function(e){var t,r=this,n=e.methodName,s=e.jobId,o=e.data,a=e.abortable?Object(l.d)():null,i=this._inJobs,c=this._client,u=c[n];try{if(!u&&n&&-1!==n.indexOf("."))for(var h=n.split("."),d=0;d<h.length-1;d++)u=(c=c[h[d]])[h[d+1]];if("function"!=typeof u)throw new TypeError("".concat(n," is not a function"));t=u.call(c,o,{client:this,signal:a?a.signal:null})}catch(p){return void this._post({type:g,jobId:s,error:Object(f.e)(p)})}Object(l.p)(t)?(i.set(s,{controller:a,promise:t}),t.then((function(e){i.has(s)&&(i.delete(s),r._post({type:g,jobId:s},e))}),(function(e){i.has(s)&&(i.delete(s),Object(l.m)(e)||r._post({type:g,jobId:s,error:Object(f.e)(e||{message:"Error encountered at method ".concat(n)})}))}))):this._post({type:g,jobId:s},t)}},{key:"_onOpenPortMessage",value:function(t){new e(t.port,{client:this._client})}},{key:"_onOnMessage",value:function(e){var t=e.port,r=this._client.on(e.eventType,(function(e){t.postMessage(e)})),n=Object(c.c)(e.port,"message",(function(e){Object(f.d)(e).type===f.a.CLOSE&&(n.remove(),r.remove(),t.close())}))}},{key:"_onResponseMessage",value:function(e){var t,r=e.jobId,n=e.error,s=e.data,o=this._outJobs;if(o.has(r)){var a=o.get(r);o.delete(r),null==(t=a.abortHandle)||t.remove(),n?a.reject(i.a.fromJSON(JSON.parse(n))):a.resolve(s)}}},{key:"_post",value:function(e,t,r){return Object(f.c)(this._port,e,t,r)}}],[{key:"connect",value:function(t){var r,n=new MessageChannel;r="function"==typeof t?new t:"default"in t&&"function"==typeof t.default?new t.default:t;var s=new e(n.port1,{channel:n,client:r});return"object"==typeof r&&"remoteClient"in r&&(r.remoteClient=s),e.clients.set(s,r),n.port2}},{key:"loadWorker",value:function(e){var t=d[e];return t?t():Promise.resolve(null)}}]),e}();_.kernelInfo={revision:h.b,version:a.d,buildDate:h.a},_.clients=new Map},674:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return c}));var n,s,o=r(19);(s=n||(n={}))[s.HANDSHAKE=0]="HANDSHAKE",s[s.OPEN=1]="OPEN",s[s.OPENED=2]="OPENED",s[s.RESPONSE=3]="RESPONSE",s[s.INVOKE=4]="INVOKE",s[s.ABORT=5]="ABORT",s[s.CLOSE=6]="CLOSE",s[s.OPEN_PORT=7]="OPEN_PORT",s[s.ON=8]="ON";var a=0;function i(){return a++}function c(e){return e?"string"==typeof e?JSON.stringify({name:"message",message:e}):e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details||{stack:e.stack}}):null}function u(e,t,r,s){var o;t.type!==n.OPEN_PORT?t.type===n.INVOKE||t.type===n.RESPONSE?(!function(e){return e&&"object"==typeof e&&("result"in e||"transferList"in e)}(r)?(o=f(s),t.data=r):(o=f(r.transferList),t.data=r.result),o?e.postMessage(t,o):e.postMessage(t)):e.postMessage(t):e.postMessage(t,[t.port])}function l(e){if(!e)return null;var t=e.data;return t?"string"==typeof t?JSON.parse(t):t:null}function f(e){if(!e||!e.length)return null;if(Object(o.a)("esri-workers-arraybuffer-transfer"))return e;var t=e.filter((function(e){return!function(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name}(e)}));return t.length?t:null}},685:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(21),s=r(2),o=r(4),a=r(185),i=r(15),c=r(30),u=r(667),l=i.a.getLogger("esri.core.workers.Connection"),f=function(){function e(){Object(s.a)(this,e),this._clients=new Array,this._clientPromises=new Array,this._clientIdx=0}return Object(o.a)(e,[{key:"destroy",value:function(){this.close()}},{key:"closed",get:function(){return!this._clients||!this._clients.length}},{key:"open",value:function(e,t){var r=this;return new Promise((function(n,s){var o=!0,a=function(e){Object(c.v)(t.signal),o&&(o=!1,e())};r._clients.length=e.length,r._clientPromises.length=e.length;for(var i=function(o){var i=e[o];Object(c.p)(i)?r._clientPromises[o]=i.then((function(e){return r._clients[o]=new u.a(e,t),a(n),r._clients[o]}),(function(){return a(s),null})):(r._clients[o]=new u.a(i,t),r._clientPromises[o]=Promise.resolve(r._clients[o]),a(n))},l=0;l<e.length;++l)i(l)}))}},{key:"broadcast",value:function(e,t,r){for(var n=new Array(this._clientPromises.length),s=0;s<this._clientPromises.length;++s){var o=this._clientPromises[s];n[s]=o.then((function(n){return n.invoke(e,t,r)}))}return n}},{key:"close",value:function(){var e,t=Object(n.a)(this._clientPromises);try{for(t.s();!(e=t.n()).done;){e.value.then((function(e){return e.close()}))}}catch(r){t.e(r)}finally{t.f()}this._clients.length=0,this._clientPromises.length=0}},{key:"getAvailableClient",value:function(){for(var e,t=0;t<this._clients.length;++t){var r=this._clients[t];if(r){if(!r.isBusy())return Promise.resolve(r)}else(e=e||[]).push(this._clientPromises[t])}return e?Promise.race(e):(this._clientIdx=(this._clientIdx+1)%this._clients.length,Promise.resolve(this._clients[this._clientIdx]))}},{key:"invoke",value:function(e,t,r){var n=null;return Array.isArray(r)?(l.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),n={transferList:r}):n=r,this.closed?Promise.reject(new Error("Connection closed")):this.getAvailableClient().then((function(r){return r.invoke(e,t,n)}))}},{key:"on",value:function(e,t){var r=this;return Promise.all(this._clientPromises).then((function(){return Object(a.a)(r._clients.map((function(r){return r.on(e,t)})))}))}},{key:"openPorts",value:function(){var e=this;return new Promise((function(t){for(var r=new Array(e._clientPromises.length),n=r.length,s=function(s){e._clientPromises[s].then((function(e){r[s]=e.openPort(),0==--n&&t(r)}))},o=0;o<e._clientPromises.length;++o)s(o)}))}},{key:"test",get:function(){return{numClients:this._clients.length}}}]),e}()},727:function(e,t,r){"use strict";r.d(t,"a",(function(){return te}));var n=r(13),s=r(7),o=r.n(s),a=r(12),i=r(29),c=r(19),u=r(30),l=r(685),f=r(667),h=r(2),d=r(4),p=r(83),b=r(15),v=r(674),g=r(54),m=r(68),k=(r(243),r(27)),y=r(21),_={};function O(e){var t,r={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:Object(n.a)({},e.has),map:Object(n.a)({},e.map),packages:e.packages&&e.packages.concat()||[],paths:Object(n.a)({},e.paths)};return e.hasOwnProperty("async")||(r.async=!0),e.hasOwnProperty("isDebug")||(r.isDebug=!1),e.baseUrl||(r.baseUrl=_.baseUrl),null==(t=_.packages)||t.forEach((function(e){!function(e,t){var r,n=Object(y.a)(e);try{for(n.s();!(r=n.n()).done;)if(r.value.name===t.name)return}catch(s){n.e(s)}finally{n.f()}e.push(t)}(r.packages,e)})),r}var j,w,P=r(37),E=function e(){var t=this;Object(h.a)(this,e);var r=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((function(e){t[e]=function(){return r[e].apply(r,arguments)}}))},M=P.a.MutationObserver||P.a.WebKitMutationObserver,N=function(){var e;if(P.a.process&&P.a.process.nextTick)e=function(e){P.a.process.nextTick(e)};else if(P.a.Promise)e=function(e){P.a.Promise.resolve().then(e)};else if(M){var t=[],r=document.createElement("div");new M((function(){for(;t.length>0;)t.shift()()})).observe(r,{attributes:!0}),e=function(e){t.push(e),r.setAttribute("queueStatus","1")}}return e}(),I=function(){var e=P.a.MessageEvent;try{new e("message",{data:null})}catch(t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.data,n=t.bubbles,s=void 0!==n&&n,o=t.cancelable,a=void 0!==o&&o,i=document.createEvent("Event");return i.initEvent(e,s,a),i.data=r,i}}return function(t,r){return new e(t,r)}}(),S=function(){function e(){Object(h.a)(this,e),this._dispatcher=new E,this._workerPostMessage({type:v.a.HANDSHAKE})}return Object(d.a)(e,[{key:"terminate",value:function(){}},{key:"onmessage",get:function(){return this._onmessageHandler},set:function(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}},{key:"onmessageerror",get:function(){return this._onmessageerrorHandler},set:function(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}},{key:"onerror",get:function(){return this._onerrorHandler},set:function(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}},{key:"postMessage",value:function(e){var t=this;N((function(){t._workerMessageHandler(I("message",{data:e}))}))}},{key:"dispatchEvent",value:function(e){return this._dispatcher.dispatchEvent(e)}},{key:"addEventListener",value:function(e,t,r){this._dispatcher.addEventListener(e,t,r)}},{key:"removeEventListener",value:function(e,t,r){this._dispatcher.removeEventListener(e,t,r)}},{key:"_workerPostMessage",value:function(e){var t=this;N((function(){t.dispatchEvent(I("message",{data:e}))}))}},{key:"_workerMessageHandler",value:function(){var e=Object(a.a)(o.a.mark((function e(t){var r,n,s,a,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=Object(v.d)(t))||r.type!==v.a.OPEN){e.next=13;break}return n=r.modulePath,s=r.jobId,e.next=5,f.a.loadWorker(n);case 5:if(a=e.sent,e.t0=a,e.t0){e.next=11;break}return e.next=10,import(n);case 10:a=e.sent;case 11:i=f.a.connect(a),this._workerPostMessage({type:v.a.OPENED,jobId:s,data:i});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),J=r(75),L=r(296),A=b.a.getLogger("esri.core.workers"),C=v.a.HANDSHAKE,x='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,buildDate:r,version:t}=configuration.kernelInfo,{revision:n,buildDate:i,version:s}=e.kernelInfo;o!==n&&console.warn(`[esri.core.workers] Version mismatch detected between ArcGIS API for JavaScript and assets:\nAPI version: ${t} [Date: ${r}, Revision: ${o.slice(0,8)}]\nAssets version: ${s} [Date: ${i}, Revision: ${n.slice(0,8)}]`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let e;function t(o){const t=e.connect(o);self.postMessage({type:2,jobId:r,data:t},[t])}"function"==typeof define&&define.amd?require([workerPath],(r=>{e=r.default||r,checkWorkerRevision(e),e.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((r=>(e=r.default,checkWorkerRevision(e),e.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):(self.RemoteClient||importScripts(workerPath),e=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(e),e.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const e=outgoing.get(r);outgoing.delete(r),o.error?e.reject(JSON.parse(o.error)):e.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});',R="Failed to create Worker. Fallback to execute module in main thread";function H(){return W.apply(this,arguments)}function W(){return(W=Object(a.a)(o.a.mark((function e(){var t,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(c.a)("esri-workers")){e.next=2;break}return e.abrupt("return",D(new S));case 2:if(!j&&!w)try{t=x.replace('"{CONFIGURATION}"',"'".concat(U(),"'")),j=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}catch(n){w=n||{}}if(j)try{r=new Worker(j,{name:"esri-worker-"+B++})}catch(n){A.warn(R,w),r=new S}else A.warn(R,w),r=new S;return e.abrupt("return",D(r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return T.apply(this,arguments)}function T(){return(T=Object(a.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){function r(s){var o=Object(v.d)(s);o&&o.type===C&&(t.removeEventListener("message",r),t.removeEventListener("error",n),e(t))}function n(e){e.preventDefault(),t.removeEventListener("message",r),t.removeEventListener("error",n),A.warn("Failed to create Worker. Fallback to execute module in main thread",e),(t=new S).addEventListener("message",r),t.addEventListener("error",n)}t.addEventListener("message",r),t.addEventListener("error",n)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){var e;if(null!=m.a.default){var t=Object(n.a)({},m.a);delete t.default,e=JSON.parse(JSON.stringify(t))}else e=JSON.parse(JSON.stringify(m.a));e.assetsPath=Object(k.z)(e.assetsPath),e.request.interceptors=[],e.log.interceptors=[],e.locale=Object(J.b)(),e.has={"csp-restrictions":Object(c.a)("csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":Object(c.a)("esri-2d-update-debug"),"esri-2d-query-centroid-enabled":Object(c.a)("esri-2d-query-centroid-enabled"),"featurelayer-pbf":Object(c.a)("featurelayer-pbf"),"featurelayer-simplify-thresholds":Object(c.a)("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":Object(c.a)("featurelayer-simplify-payload-size-factors"),"esri-atomics":Object(c.a)("esri-atomics"),"esri-shared-array-buffer":Object(c.a)("esri-shared-array-buffer"),"esri-tiles-debug":Object(c.a)("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":Object(c.a)("esri-workers-arraybuffer-transfer"),"host-webworker":1},e.workers.loaderUrl&&(e.workers.loaderUrl=Object(k.z)(e.workers.loaderUrl)),e.workers.workerPath?e.workers.workerPath=Object(k.z)(e.workers.workerPath):e.workers.workerPath=Object(k.z)(Object(g.a)("esri/core/workers/RemoteClient.js"));var r=m.a.workers.loaderConfig,s=O({baseUrl:null==r?void 0:r.baseUrl,locale:Object(J.b)(),has:Object(n.a)({"csp-restrictions":Object(c.a)("csp-restrictions"),"dojo-test-sniff":0,"host-webworker":1},null==r?void 0:r.has),map:Object(n.a)({},null==r?void 0:r.map),paths:Object(n.a)({},null==r?void 0:r.paths),packages:(null==r?void 0:r.packages)||[]}),o={version:p.d,buildDate:L.a,revision:L.b};return JSON.stringify({esriConfig:e,loaderConfig:s,kernelInfo:o})}var B=0,K=b.a.getLogger("esri.core.workers"),F=v.a.ABORT,q=v.a.INVOKE,V=v.a.OPEN,z=v.a.OPENED,$=v.a.RESPONSE,G=function(){function e(t,r){Object(h.a)(this,e),this._outJobs=new Map,this._inJobs=new Map,this.worker=t,this.id=r,t.addEventListener("message",this._onMessage.bind(this)),t.addEventListener("error",(function(e){e.preventDefault(),K.error(e)}))}return Object(d.a)(e,[{key:"terminate",value:function(){this.worker.terminate()}},{key:"open",value:function(){var e=Object(a.a)(o.a.mark((function e(t){var r,n,s,a=this,i=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},n=r.signal,s=Object(v.b)(),e.abrupt("return",new Promise((function(e,r){var o={resolve:e,reject:r,abortHandle:Object(u.r)(n,(function(){a._outJobs.delete(s),a._post({type:F,jobId:s})}))};a._outJobs.set(s,o),a._post({type:V,jobId:s,modulePath:t})})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_onMessage",value:function(e){var t=Object(v.d)(e);if(t)switch(t.type){case z:this._onOpenedMessage(t);break;case $:this._onResponseMessage(t);break;case F:this._onAbortMessage(t);break;case q:this._onInvokeMessage(t)}}},{key:"_onAbortMessage",value:function(e){var t=this._inJobs,r=e.jobId,n=t.get(r);n&&(n.controller&&n.controller.abort(),t.delete(r))}},{key:"_onInvokeMessage",value:function(e){var t,r=this,n=e.methodName,s=e.jobId,o=e.data,a=e.abortable?Object(u.d)():null,i=this._inJobs,c=p.e[n];try{if("function"!=typeof c)throw new TypeError("".concat(n," is not a function"));t=c.call(null,o,{signal:a?a.signal:null})}catch(l){return void this._post({type:$,jobId:s,error:Object(v.e)(l)})}Object(u.p)(t)?(i.set(s,{controller:a,promise:t}),t.then((function(e){i.has(s)&&(i.delete(s),r._post({type:$,jobId:s},e))}),(function(e){i.has(s)&&(i.delete(s),e||(e={message:"Error encountered at method"+n}),Object(u.m)(e)||r._post({type:$,jobId:s,error:Object(v.e)(e||{message:"Error encountered at method ".concat(n)})}))}))):this._post({type:$,jobId:s},t)}},{key:"_onOpenedMessage",value:function(e){var t,r=e.jobId,n=e.data,s=this._outJobs.get(r);s&&(this._outJobs.delete(r),null==(t=s.abortHandle)||t.remove(),s.resolve(n))}},{key:"_onResponseMessage",value:function(e){var t,r=e.jobId,n=e.error,s=e.data,o=this._outJobs.get(r);o&&(this._outJobs.delete(r),null==(t=o.abortHandle)||t.remove(),n?o.reject(i.a.fromJSON(JSON.parse(n))):o.resolve(s))}},{key:"_post",value:function(e,t,r){return Object(v.c)(this.worker,e,t,r)}}],[{key:"create",value:function(){var t=Object(a.a)(o.a.mark((function t(r){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H();case 2:return n=t.sent,t.abrupt("return",new e(n,r));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}(),Q=Object(c.a)("esri-workers-debug")?1:Object(c.a)("host-browser")?navigator.hardwareConcurrency-1:0;Q||(Q=Object(c.a)("safari")&&Object(c.a)("mac")||Object(c.a)("trident")?7:2);var X=0,Y=[];function Z(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(a.a)(o.a.mark((function e(t,r){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new l.a,e.next=3,n.open(t,r);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){return re.apply(this,arguments)}function re(){return re=Object(a.a)(o.a.mark((function e(t){var r,s,a,l,h,d,p,b,v,g=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=g.length>1&&void 0!==g[1]?g[1]:{},"string"==typeof t){e.next=3;break}throw new i.a("workers:undefined-module","modulePath is missing");case 3:if(s=r.strategy||"distributed",Object(c.a)("host-webworker")&&!Object(c.a)("esri-workers")&&(s="local"),"local"!==s){e.next=16;break}return e.next=7,f.a.loadWorker(t);case 7:if(a=e.sent,e.t0=a,e.t0){e.next=13;break}return e.next=12,import(t);case 12:a=e.sent;case 13:return Object(u.v)(r.signal),l=r.client||a,e.abrupt("return",Z([f.a.connect(a)],Object(n.a)(Object(n.a)({},r),{},{client:l})));case 16:return e.next=18,se();case 18:if(Object(u.v)(r.signal),"dedicated"!==s){e.next=28;break}return h=X++%Q,e.t1=Z,e.next=24,Y[h].open(t,r);case 24:return e.t2=e.sent,e.t3=[e.t2],e.t4=r,e.abrupt("return",(0,e.t1)(e.t3,e.t4));case 28:if(!(r.maxNumWorkers&&r.maxNumWorkers>0)){e.next=34;break}if(!((d=Math.min(r.maxNumWorkers,Q))<Q)){e.next=34;break}for(p=new Array(d),b=0;b<d;++b)v=X++%Q,p[b]=Y[v].open(t,r);return e.abrupt("return",Z(p,r));case 34:return e.abrupt("return",Z(Y.map((function(e){return e.open(t,r)})),r));case 35:case"end":return e.stop()}}),e)}))),re.apply(this,arguments)}var ne=null;function se(){return oe.apply(this,arguments)}function oe(){return(oe=Object(a.a)(o.a.mark((function e(){var t,r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ne){e.next=2;break}return e.abrupt("return",ne);case 2:for(Object(u.d)(),t=[],r=function(e){var r=G.create(e).then((function(t){return Y[e]=t,t}));t.push(r)},n=0;n<Q;n++)r(n);return e.abrupt("return",ne=Promise.all(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=7.af5039cf.chunk.js.map