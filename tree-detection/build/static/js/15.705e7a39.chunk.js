(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[15],{676:function(e,t,i){"use strict";i.d(t,"a",(function(){return b})),i.d(t,"b",(function(){return f})),i.d(t,"c",(function(){return O})),i.d(t,"d",(function(){return g})),i.d(t,"e",(function(){return h})),i.d(t,"f",(function(){return p})),i.d(t,"g",(function(){return m})),i.d(t,"h",(function(){return y})),i.d(t,"i",(function(){return d})),i.d(t,"j",(function(){return j}));var r=i(22),a=i(11),n=i(27),l=i(87),o={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},c=Object.values(o),s=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(".concat(c.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),u=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(".concat(c.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),v=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function f(e){return!!s.test(e)}function h(e){var t=Object(n.J)(e),i=t.path.match(s)||t.path.match(u);if(!i)return null;var a=Object(r.a)(i,5),l=a[1],c=a[2],v=a[3],f=a[4],h=c.indexOf("/");return{title:b(-1!==h?c.slice(h+1):c),serverType:o[v.toLowerCase()],sublayer:null!=f&&""!==f?parseInt(f,10):null,url:{path:l}}}function p(e){var t=Object(n.J)(e).path.match(v);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function b(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function d(e,t){var i=[];if(e){var r=h(e);Object(a.j)(r)&&r.title&&i.push(r.title)}if(t){var n=b(t);i.push(n)}if(2===i.length){if(-1!==i[0].toLowerCase().indexOf(i[1].toLowerCase()))return i[0];if(-1!==i[1].toLowerCase().indexOf(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function O(e){if(!e)return!1;var t=-1!==(e=e.toLowerCase()).indexOf(".arcgis.com/"),i=-1!==e.indexOf("//services")||-1!==e.indexOf("//tiles")||-1!==e.indexOf("//features");return t&&i}function m(e,t){return e?Object(n.H)(Object(n.G)(e,t)):e}function y(e){var t=e.url;if(!t)return{url:t};t=Object(n.G)(t,e.logger);var i,r=Object(n.J)(t),l=h(r.path);if(Object(a.j)(l))null!=l.sublayer&&null==e.layer.layerId&&(i=l.sublayer),t=l.url.path;else if(e.nonStandardUrlAllowed){var o=p(r.path);Object(a.j)(o)&&(t=o.serviceUrl,i=o.sublayerId)}return{url:Object(n.H)(t),layerId:i}}function j(e,t,i,r,a){Object(l.f)(t,r,"url",a),r.url&&null!=e.layerId&&(r.url=Object(n.y)(r.url,i,e.layerId.toString()))}function g(e){if(!e)return!1;var t=e.toLowerCase(),i=-1!==t.indexOf("/services/"),r=-1!==t.indexOf("/mapserver/wmsserver"),a=-1!==t.indexOf("/imageserver/wmsserver"),n=-1!==t.indexOf("/wmsserver");return i&&(r||a||n)}},683:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(135),a=i(70),n={inches:Object(r.b)(1,"meters","inches"),feet:Object(r.b)(1,"meters","feet"),"us-feet":Object(r.b)(1,"meters","us-feet"),yards:Object(r.b)(1,"meters","yards"),miles:Object(r.b)(1,"meters","miles"),"nautical-miles":Object(r.b)(1,"meters","nautical-miles"),millimeters:Object(r.b)(1,"meters","millimeters"),centimeters:Object(r.b)(1,"meters","centimeters"),decimeters:Object(r.b)(1,"meters","decimeters"),meters:Object(r.b)(1,"meters","meters"),kilometers:Object(r.b)(1,"meters","kilometers"),"decimal-degrees":1/Object(r.i)(1,"meters",a.a.radius)}},710:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(2),a=i(4),n=i(5),l=i(6),o=i(0),c=i(15),s=i(11),u=i(1),v=(i(19),i(14),i(10)),f=i(676),h=function(e){var t=function(e){Object(n.a)(i,e);var t=Object(l.a)(i);function i(){return Object(r.a)(this,i),t.apply(this,arguments)}return Object(a.a)(i,[{key:"title",get:function(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){var e=Object(f.e)(this.url);if(Object(s.j)(e)&&e.title)return e.title}return this._get("title")||""},set:function(e){this._set("title",e)}},{key:"url",set:function(e){this._set("url",Object(f.g)(e,c.a.getLogger(this.declaredClass)))}}]),i}(e);return Object(o.a)([Object(u.b)()],t.prototype,"title",null),Object(o.a)([Object(u.b)({type:String})],t.prototype,"url",null),t=Object(o.a)([Object(v.a)("esri.layers.mixins.ArcGISService")],t)}},712:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(2),a=i(4),n=i(708),l=function(){function e(t,i){Object(r.a)(this,e),this._storage=new n.b,this._storage.maxSize=t,i&&this._storage.registerRemoveFunc("",i)}return Object(a.a)(e,[{key:"put",value:function(e,t,i){this._storage.put(e,t,i,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.destroy()}},{key:"maxSize",get:function(){return this._storage.maxSize},set:function(e){this._storage.maxSize=e}}]),e}()},743:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var r,a=i(13),n=i(2),l=i(4),o=i(5),c=i(6),s=i(0),u=i(42),v=i(26),f=i(11),h=i(135),p=i(1),b=(i(19),i(14)),d=(i(15),i(57)),O=i(10),m=i(43),y=i(48),j=i(45),g=i(333),w=i(53),_=i(71),S=i(768),x=new u.a({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"}),k=r=function(e){Object(o.a)(i,e);var t=Object(c.a)(i);function i(e){var r;return Object(n.a)(this,i),(r=t.call(this,e)).dpi=96,r.format=null,r.origin=null,r.minScale=0,r.maxScale=0,r.size=null,r.spatialReference=null,r}return Object(l.a)(i,[{key:"isWrappable",get:function(){var e=this.spatialReference,t=this.origin;if(e&&t){var i=Object(w.e)(e);return e.isWrappable&&Math.abs(i.origin[0]-t.x)<=i.dx}return!1}},{key:"readOrigin",value:function(e,t){return y.a.fromJSON(Object(a.a)({spatialReference:t.spatialReference},e))}},{key:"lods",set:function(e){var t=this,i=0,r=0,a=[];this._levelToLOD={},e&&(i=-1/0,r=1/0,e.forEach((function(e){a.push(e.scale),i=e.scale>i?e.scale:i,r=e.scale<r?e.scale:r,t._levelToLOD[e.level]=e}))),this._set("scales",a),this._set("minScale",i),this._set("maxScale",r),this._set("lods",e),this._initializeUpsampleLevels()}},{key:"readSize",value:function(e,t){return[t.cols,t.rows]}},{key:"writeSize",value:function(e,t){t.cols=e[0],t.rows=e[1]}},{key:"zoomToScale",value:function(e){var t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];var i=Math.floor(e),r=i+1;return t[i]/Math.pow(t[i]/t[r],e-i)}},{key:"scaleToZoom",value:function(e){for(var t=this.scales,i=t.length-1,r=0;r<i;r++){var a=t[r],n=t[r+1];if(a<=e)return r;if(n===e)return r+1;if(a>e&&n<e)return r+Math.log(a/e)/Math.log(a/n)}return r}},{key:"snapScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,i=this.scaleToZoom(e);return i%Math.floor(i)>=t?this.zoomToScale(Math.ceil(i)):this.zoomToScale(Math.floor(i))}},{key:"tileAt",value:function(e,t,i,r){var a,n,l=this.lodAt(e);if(!l)return null;if("number"==typeof t)a=t,n=i;else if(Object(w.d)(t.spatialReference,this.spatialReference))a=t.x,n=t.y,r=i;else{var o=Object(_.d)(t,this.spatialReference);if(Object(f.i)(o))return null;a=o.x,n=o.y,r=i}var c=l.resolution*this.size[0],s=l.resolution*this.size[1];return r||(r={id:null,level:0,row:0,col:0,extent:Object(g.e)()}),r.level=e,r.row=Math.floor((this.origin.y-n)/s+.001),r.col=Math.floor((a-this.origin.x)/c+.001),this.updateTileInfo(r),r}},{key:"updateTileInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.lodAt(e.level);if(!i&&1===t){var r=this.lods[this.lods.length-1];r.level<e.level&&(i=r)}if(i){var a=e.level-i.level,n=i.resolution*this.size[0]/Math.pow(2,a),l=i.resolution*this.size[1]/Math.pow(2,a);e.id="".concat(e.level,"/").concat(e.row,"/").concat(e.col),e.extent||(e.extent=Object(g.e)()),e.extent[0]=this.origin.x+e.col*n,e.extent[1]=this.origin.y-(e.row+1)*l,e.extent[2]=e.extent[0]+n,e.extent[3]=e.extent[1]+l}}},{key:"upsampleTile",value:function(e){var t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}},{key:"getTileBounds",value:function(e,t){var i=this.lodAt(t.level).resolution,r=i*this.size[0],a=i*this.size[1];return e[0]=this.origin.x+t.col*r,e[1]=this.origin.y-(t.row+1)*a,e[2]=e[0]+r,e[3]=e[1]+a,e}},{key:"lodAt",value:function(e){return this._levelToLOD&&this._levelToLOD[e]||null}},{key:"clone",value:function(){return r.fromJSON(this.write({}))}},{key:"_initializeUpsampleLevels",value:function(){var e=this.lods;this._upsampleLevels=[];for(var t=null,i=0;i<e.length;i++){var r=e[i];this._upsampleLevels[r.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/r.resolution:0},t=r}}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resolutionFactor,i=void 0===t?1:t,a=e.scales,n=e.size,l=void 0===n?256:n,o=e.spatialReference,c=void 0===o?j.a.WebMercator:o,s=e.numLODs,u=void 0===s?24:s;if(!Object(w.l)(c)){var v=[];if(a)for(var f=0;f<a.length;f++){var p=a[f];v.push({level:f,scale:p,resolution:p})}else for(var b=5e-4,d=u-1;d>=0;d--)v.unshift({level:d,scale:b,resolution:b}),b*=2;return new r({dpi:96,lods:v,origin:new y.a(0,0,c),size:[l,l],spatialReference:c})}var O=Object(w.e)(c),m=e.origin?new y.a({x:e.origin.x,y:e.origin.y,spatialReference:c}):new y.a(O?{x:O.origin[0],y:O.origin[1],spatialReference:c}:{x:0,y:0,spatialReference:c}),g=96,_=1/(39.37*Object(h.d)(c)*g),S=[];if(a)for(var x=0;x<a.length;x++){var k=a[x],T=k*_;S.push({level:x,scale:k,resolution:T})}else{var z=Object(w.h)(c)?512/l*591657527.5917094:256/l*591657527.591555,L=Math.ceil(u/i);S.push({level:0,scale:z,resolution:z*_});for(var A=1;A<L;A++){var D=z/Math.pow(2,i),M=D*_;S.push({level:A,scale:D,resolution:M}),z=D}}return new r({dpi:g,lods:S,origin:m,size:[l,l],spatialReference:c})}}]),i}(v.a);Object(s.a)([Object(p.b)({type:Number,json:{write:!0}})],k.prototype,"compressionQuality",void 0),Object(s.a)([Object(p.b)({type:Number,json:{write:!0}})],k.prototype,"dpi",void 0),Object(s.a)([Object(p.b)({type:String,json:{read:x.read,write:x.write,origins:{"web-scene":{read:!1,write:!1}}}})],k.prototype,"format",void 0),Object(s.a)([Object(p.b)({readOnly:!0})],k.prototype,"isWrappable",null),Object(s.a)([Object(p.b)({type:y.a,json:{write:!0}})],k.prototype,"origin",void 0),Object(s.a)([Object(d.a)("origin")],k.prototype,"readOrigin",null),Object(s.a)([Object(p.b)({type:[S.a],value:null,json:{write:!0}})],k.prototype,"lods",null),Object(s.a)([Object(p.b)({readOnly:!0})],k.prototype,"minScale",void 0),Object(s.a)([Object(p.b)({readOnly:!0})],k.prototype,"maxScale",void 0),Object(s.a)([Object(p.b)({readOnly:!0})],k.prototype,"scales",void 0),Object(s.a)([Object(p.b)({cast:function(e){return Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]}})],k.prototype,"size",void 0),Object(s.a)([Object(d.a)("size",["rows","cols"])],k.prototype,"readSize",null),Object(s.a)([Object(m.a)("size",{cols:{type:b.a},rows:{type:b.a}})],k.prototype,"writeSize",null),Object(s.a)([Object(p.b)({type:j.a,json:{write:!0}})],k.prototype,"spatialReference",void 0);var T=k=r=Object(s.a)([Object(O.a)("esri.layers.support.TileInfo")],k)},768:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r,a=i(2),n=i(4),l=i(5),o=i(6),c=i(0),s=i(26),u=i(1),v=(i(19),i(14)),f=(i(15),i(10)),h=r=function(e){Object(l.a)(i,e);var t=Object(o.a)(i);function i(e){var r;return Object(a.a)(this,i),(r=t.call(this,e)).cols=null,r.level=0,r.levelValue=null,r.resolution=0,r.rows=null,r.scale=0,r}return Object(n.a)(i,[{key:"clone",value:function(){return new r({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}}]),i}(s.a);Object(c.a)([Object(u.b)({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],h.prototype,"cols",void 0),Object(c.a)([Object(u.b)({type:v.a,json:{write:!0}})],h.prototype,"level",void 0),Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],h.prototype,"levelValue",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],h.prototype,"resolution",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],h.prototype,"rows",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],h.prototype,"scale",void 0);var p=h=r=Object(c.a)([Object(f.a)("esri.layers.support.LOD")],h)},840:function(e,t,i){"use strict";i.d(t,"a",(function(){return M}));var r,a=i(7),n=i.n(a),l=i(12),o=i(13),c=i(2),s=i(4),u=i(5),v=i(6),f=i(0),h=i(82),p=i(60),b=i(29),d=i(183),O=i(15),m=i(712),y=i(297),j=i(30),g=i(241),w=i(27),_=i(99),S=i(1),x=(i(19),i(97)),k=i(10),T=i(137),z=i(18),L=function(){function e(){Object(c.a)(this,e),this.location={left:0,top:0,width:0,height:0},this._allAvailability="unknown",this.byteSize=40}return Object(s.a)(e,[{key:"getAvailability",value:function(e,t){if("unknown"!==this._allAvailability)return this._allAvailability;var i=(e-this.location.top)*this.location.width+(t-this.location.left),r=i%8,a=i>>3,n=this._tileAvailabilityBitSet;return a<0||a>n.length?"unknown":n[a]&1<<r?"available":"unavailable"}},{key:"_updateFromData",value:function(e){for(var t=this.location.width,i=this.location.height,r=!0,a=!0,n=Math.ceil(t*i/8),l=new Uint8Array(n),o=0,c=0;c<e.length;c++){var s=c%8;e[c]?(a=!1,l[o]|=1<<s):r=!1,7===s&&++o}a?this._allAvailability="unavailable":r?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=l,this.byteSize+=l.length)}}],[{key:"fromDefinition",value:function(t,i){var r=t.service.request||h.default,a=t.row,n=t.col,l=t.width,c=t.height,s={query:{f:"json"}};return i=i?Object(o.a)(Object(o.a)({},s),i):s,r(function(e){var t;if("vector-tile"===e.service.type)t="".concat(e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height);else{var i=e.service.tileServers;t="".concat(i&&i.length?i[e.row%i.length]:e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}var r=e.service.query;return r&&(t="".concat(t,"?").concat(r)),t}(t),i).then((function(e){return e.data})).catch((function(e){if(e&&e.details&&422===e.details.httpStatus)return{location:{top:a,left:n,width:l,height:c},valid:!0,data:Object(T.b)(l*c,0)};throw e})).then((function(t){if(t.location&&(t.location.top!==a||t.location.left!==n||t.location.width!==l||t.location.height!==c))throw new b.a("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:a,left:n,width:l,height:c}});return e.fromJSON(t)}))}},{key:"fromJSON",value:function(t){e.validateJSON(t);var i=new e;return i.location=Object.freeze(Object(z.a)(t.location)),i._updateFromData(t.data),Object.freeze(i)}},{key:"validateJSON",value:function(e){if(!e||!e.location)throw new b.a("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new b.a("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new b.a("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new b.a("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new b.a("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}]),e}();function A(e){return"".concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}var D=O.a.getLogger("esri.layers.support.TilemapCache"),M=r=function(e){Object(u.a)(i,e);var t=Object(v.a)(i);function i(e){var r;return Object(c.a)(this,i),(r=t.call(this,e))._handles=new d.a,r._pendingTilemapRequests={},r._availableLevels={},r.levels=5,r.cacheByteSize=2097152,r.request=h.default,r._prefetchingEnabled=!0,r}return Object(s.a)(i,[{key:"initialize",value:function(){var e=this;this._tilemapCache=new m.a(this.cacheByteSize),this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],(function(){return e._initializeTilemapDefinition()})),Object(_.a)(this,"layer.tileInfo.lods",(function(t){return e._initializeAvailableLevels(t)}),!0)]),this._initializeTilemapDefinition()}},{key:"destroy",value:function(){this._handles&&(this._handles.destroy(),this._handles=null)}},{key:"castLevels",value:function(e){return e<=2?(D.error("Minimum levels for Tilemap is 3, but got ",e),3):e}},{key:"size",get:function(){return 1<<this.levels}},{key:"fetchTilemap",value:function(e,t,i,r){var a=this;if(!this._availableLevels[e])return Promise.reject(new b.a("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")));var n=this._tmpTilemapDefinition,l=this._tilemapFromCache(e,t,i,n);if(l)return Promise.resolve(l);var c=r&&r.signal;return r=Object(o.a)(Object(o.a)({},r),{},{signal:null}),new Promise((function(e,t){Object(j.q)(c,(function(){return t(Object(j.e)())}));var i=A(n),l=a._pendingTilemapRequests[i];if(!l){l=L.fromDefinition(n,r).then((function(e){return a._tilemapCache.put(i,e,e.byteSize),e}));var o=function(){return delete a._pendingTilemapRequests[i]};a._pendingTilemapRequests[i]=l,l.then(o,o)}l.then(e,t)}))}},{key:"getAvailability",value:function(e,t,i){if(!this._availableLevels[e])return"unavailable";var r=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return r?r.getAvailability(t,i):"unknown"}},{key:"getAvailabilityUpsample",value:function(e,t,i,r){r.level=e,r.row=t,r.col=i;var a=this.layer.tileInfo;for(a.updateTileInfo(r);;){var n=this.getAvailability(r.level,r.row,r.col);if("unavailable"!==n)return n;if(!a.upsampleTile(r))return"unavailable"}}},{key:"fetchAvailability",value:function(e,t,i,r){return this._availableLevels[e]?this.fetchTilemap(e,t,i,r).catch((function(e){return e})).then((function(r){if(r instanceof L){var a=r.getAvailability(t,i);return"unavailable"===a?Promise.reject(new b.a("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i})):a}if(Object(j.m)(r))throw r;return"unknown"})):Promise.reject(new b.a("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")))}},{key:"fetchAvailabilityUpsample",value:function(e,t,i,r,a){var n=this;r.level=e,r.row=t,r.col=i;var l=this.layer.tileInfo;l.updateTileInfo(r);var o=this.fetchAvailability(e,t,i,a).catch((function(e){if(Object(j.m)(e))throw e;if(l.upsampleTile(r))return n.fetchAvailabilityUpsample(r.level,r.row,r.col,r);throw e}));return this._fetchAvailabilityUpsamplePrefetch(r.id,e,t,i,a,o),o}},{key:"_fetchAvailabilityUpsamplePrefetch",value:function(){var e=Object(l.a)(n.a.mark((function e(t,i,a,l,c,s){var u,v,f,h,p,b,d,O,m,y=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._prefetchingEnabled){e.next=2;break}return e.abrupt("return");case 2:if(u="prefetch-".concat(t),!this._handles.has(u)){e.next=5;break}return e.abrupt("return");case 5:return v=Object(j.d)(),s.then((function(){return v.abort()}),(function(){return v.abort()})),f=!1,h={remove:function(){f||(f=!0,v.abort())}},this._handles.add(h,u),e.next=12,Object(g.b)(10,v.signal).catch((function(){}));case 12:if(f||(f=!0,this._handles.remove(u)),!Object(j.n)(v)){e.next=15;break}return e.abrupt("return");case 15:for(p={id:t,level:i,row:a,col:l},b=Object(o.a)(Object(o.a)({},c),{},{signal:v.signal}),d=this.layer.tileInfo,O=function(e){var t=y.fetchAvailability(p.level,p.row,p.col,b);r._prefetches.push(t);var i=function(){r._prefetches.removeUnordered(t)};t.then(i,i)},m=0;r._prefetches.length<r._maxPrefetch&&d.upsampleTile(p);++m)O();case 18:case"end":return e.stop()}}),e,this)})));return function(t,i,r,a,n,l){return e.apply(this,arguments)}}()},{key:"_initializeTilemapDefinition",value:function(){if(this.layer.parsedUrl){var e=this.layer.parsedUrl,t=e.query;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?Object(w.D)(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}}},{key:"_tilemapFromCache",value:function(e,t,i,r){r.level=e,r.row=t-t%this.size,r.col=i-i%this.size;var a=A(r);return this._tilemapCache.get(a)}},{key:"_initializeAvailableLevels",value:function(e){var t=this;this._availableLevels={},e&&e.forEach((function(e){return t._availableLevels[e.level]=!0}))}},{key:"test",get:function(){var e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:function(t,i,r){return!!e._tilemapFromCache(t,i,r,e._tmpTilemapDefinition)}}}}]),i}(p.a);M._maxPrefetch=4,M._prefetches=new y.a({initialSize:r._maxPrefetch}),Object(f.a)([Object(S.b)({constructOnly:!0,type:Number})],M.prototype,"levels",void 0),Object(f.a)([Object(x.a)("levels")],M.prototype,"castLevels",null),Object(f.a)([Object(S.b)({readOnly:!0,type:Number})],M.prototype,"size",null),Object(f.a)([Object(S.b)({constructOnly:!0,type:Number})],M.prototype,"cacheByteSize",void 0),Object(f.a)([Object(S.b)({constructOnly:!0})],M.prototype,"layer",void 0),Object(f.a)([Object(S.b)({constructOnly:!0})],M.prototype,"request",void 0),M=r=Object(f.a)([Object(k.a)("esri.layers.support.TilemapCache")],M)},856:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return n}));var r=i(13),a=i(743),n={type:a.a,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:l}}}}};function l(e,t,i,n){if(!e)return null;var l=t.minScale,o=t.maxScale,c=t.minLOD,s=t.maxLOD;if(null!=c&&null!=s)return n&&n.ignoreMinMaxLOD?a.a.fromJSON(e):a.a.fromJSON(Object(r.a)(Object(r.a)({},e),{},{lods:e.lods.filter((function(e){var t=e.level;return null!=t&&t>=c&&t<=s}))}));if(0!==l&&0!==o){var u=function(e){return Math.round(1e4*e)/1e4},v=l?u(l):1/0,f=o?u(o):-1/0;return a.a.fromJSON(Object(r.a)(Object(r.a)({},e),{},{lods:e.lods.filter((function(e){var t=u(e.scale);return t<=v&&t>=f}))}))}return a.a.fromJSON(e)}},917:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i(2),a=i(4),n=i(5),l=i(6),o=i(0),c=(i(114),i(1)),s=(i(19),i(14),i(15),i(57)),u=i(10),v=i(856),f=i(840),h=i(45),p=function(e){var t=function(e){Object(n.a)(i,e);var t=Object(l.a)(i);function i(){var e;return Object(r.a)(this,i),(e=t.apply(this,arguments)).copyright=null,e.minScale=0,e.maxScale=0,e.spatialReference=null,e.tileInfo=null,e.tilemapCache=null,e}return Object(a.a)(i,[{key:"readMinScale",value:function(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}},{key:"readMaxScale",value:function(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}},{key:"supportsBlankTile",get:function(){return this.version>=10.2}},{key:"readTilemapCache",value:function(e,t){return t.capabilities&&t.capabilities.indexOf("Tilemap")>-1?new f.a({layer:this}):null}}]),i}(e);return Object(o.a)([Object(c.b)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),Object(o.a)([Object(c.b)()],t.prototype,"minScale",void 0),Object(o.a)([Object(s.a)("service","minScale")],t.prototype,"readMinScale",null),Object(o.a)([Object(c.b)()],t.prototype,"maxScale",void 0),Object(o.a)([Object(s.a)("service","maxScale")],t.prototype,"readMaxScale",null),Object(o.a)([Object(c.b)({type:h.a})],t.prototype,"spatialReference",void 0),Object(o.a)([Object(c.b)({readOnly:!0})],t.prototype,"supportsBlankTile",null),Object(o.a)([Object(c.b)(v.b)],t.prototype,"tileInfo",void 0),Object(o.a)([Object(c.b)()],t.prototype,"tilemapCache",void 0),Object(o.a)([Object(s.a)("service","tilemapCache",["capabilities"])],t.prototype,"readTilemapCache",null),Object(o.a)([Object(c.b)()],t.prototype,"version",void 0),t=Object(o.a)([Object(u.a)("esri.layers.mixins.ArcGISCachedService")],t)}}}]);
//# sourceMappingURL=15.705e7a39.chunk.js.map